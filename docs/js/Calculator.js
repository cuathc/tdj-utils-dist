import{E as ae,d as z,s as j,_ as L,o as _,c as C,G,A as K,f as w,e as s,k as se,n as he,H as Me,I as Be,J as qe,K as Re,L as Ne,M as we,q as H,a as k,r as F,N as Fe,g as n,i as d,j as ne,w as M,B as ee,O as Se,F as q,h as J,p as oe,l as le,P as Te,b as te,v as De,T as Ke,Q as ve,R as Oe,S as je,u as Ge,U as He,C as $e}from"./index.js";import{_ as Ue}from"./lodash.js";import{u as Je}from"./useHeroes.js";import Pe from"./InputNumber.js";import{a as ze}from"./useTransformTools.js";import{s as Le}from"./data.js";let me=0,ye=0;const We=500;function Ce(){const e=Math.floor(new Date().getTime()/1e3);ye===e?me++:me=0,ye=e;const t=e.toString(16);return`${(We<<16|me&255).toString(16)}.${t}`}async function ge(){try{return await ae.getAll("calculator")}catch{return[]}}async function Qe(e){try{await ae.add("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function x(e){try{await ae.put("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function Xe(e){try{await ae.delete("calculator",e)}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}function Ye(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Ze(){return{a:0}}function xe(){return{att:0,k:0}}function Ie(){return{a1:1.5,a2:0,att:"15+10+8",att2:"0",da:"10+10",db:"4+10+20",dc:"0",id:"0",cd:"30",name:"1.5\u6280\u80FD",defGain:"0"}}function et(){return{a1:1.5,a2:0,att:0,att2:0,id:0,da:0,db:0,dc:0,cd:0,defGain:0}}function tt(){return[Ie()]}function st(){return{hp:"10000",def:"1872",defGain:"15+5",ra:"0",rb:"4+10"}}const nt=z({props:{active:Boolean,label:String,dir:String,color:String},setup(e){const t=j({});function r(h){const $=h.currentTarget.getBoundingClientRect();switch(e.dir){case"left":t.value={top:`${$.top+$.height/2}px`,right:`${window.innerWidth-$.left}px`,maxWidth:"100%"};break;case"right":t.value={top:`${$.top+$.height/2}px`,left:`${$.right}px`,maxWidth:"100%"};break;case"top":t.value={bottom:`${window.innerHeight-$.top}px`,left:`${$.left+$.width/2}px`,maxWidth:"100%"};break;default:t.value={top:`${$.bottom}px`,left:`${$.left+$.width/2}px`,maxWidth:"100%"}}}return{style:t,onEnter:r}}});function at(e,t,r,h,y,$){return _(),C("div",{class:se(["c-tooltip",{active:e.active}]),onMouseenter:t[0]||(t[0]=(...f)=>e.onEnter&&e.onEnter(...f))},[G(e.$slots,"label",{},()=>[K(w(e.label),1)]),s("div",{class:se(["c-tooltip-inner",e.dir?`c-tooltip-${e.dir}`:"c-tooltip-bottom",e.color?`c-tooltip-${e.color}`:""]),style:he(e.style)},[G(e.$slots,"default")],6)],34)}var ot=L(nt,[["render",at]]);const lt=z({components:{Divider:Me,Tooltip:ot,CalcInput:Be,IconUp:qe,IconDown:Re,IconClose:Ne,IconCopy:we},props:{panel:{type:Object,required:!0},state:{type:Object,required:!0},enemyState:{type:Object,required:!0},itemState:{type:Object,required:!0},showUp:Boolean,showDown:Boolean},emits:["update:itemState","close","up","down","copy"],setup(e,{emit:t}){const r=H({editor:!1,name:""}),h=(v,l)=>{if(v==="name")return;const p=e.itemState;switch(v){case"a1":case"a2":typeof l=="number"&&(p[v]=l);break;default:typeof l=="string"&&(p[v]=l)}t("update:itemState",p)},y=H(et()),$=k({set:v=>h("a1",v),get:()=>e.itemState.a1}),f=k({set:v=>h("a2",v),get:()=>e.itemState.a2}),g=k({set:v=>h("att",v),get:()=>e.itemState.att}),o=k({set:v=>h("att2",v),get:()=>e.itemState.att2}),i=k({set:v=>h("id",v),get:()=>e.itemState.id}),D=k({set:v=>h("da",v),get:()=>e.itemState.da}),S=k({set:v=>h("db",v),get:()=>e.itemState.db}),V=k({set:v=>h("dc",v),get:()=>e.itemState.dc}),N=k({set:v=>h("cd",v),get:()=>e.itemState.cd}),c=k({set:v=>h("defGain",v),get:()=>e.itemState.defGain}),U=H({a1:$,a2:f,att:g,att2:o,da:D,db:S,dc:V,id:i,cd:N,defGain:c}),T=k(()=>{const{state:v}=e,l=(100+y.att)/100;return Math.ceil(v.att*l)}),a=k(()=>{const{state:v}=e,l=(100+y.att+y.att2)/100;return Math.ceil(v.att*l)}),B=()=>{const{state:v,enemyState:l}=e,p=(100+y.da-l.ra)/100,I=(100+y.db-l.rb)/100,E=(100+y.dc)/100,P=(100+y.cd)/100,ce=(100-y.id)/100,W=(100+l.defGain+y.defGain)/100,Z=Math.max(0,Math.max(0,l.def*W)*ce),pe=Math.max(1,T.value*(1+v.k)-Z),Ee=Math.max(1,a.value*(1+v.k)-Z),_e=pe*$.value*p*I,Ae=Math.ceil(_e*P),be=Ee*f.value*p*I*E,Ve=Math.ceil(be*P);return{r01:Math.ceil(_e),r01c:Ae,r02:Math.ceil(be),r02c:Ve}},m=k(()=>B().r01),u=k(()=>B().r01c),A=k(()=>B().r02),O=k(()=>B().r02c);B();function X(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&t("close")}function Y(){r.editor=!0,r.name=e.itemState.name}function ue(){const v=r.name;if(r.editor=!1,r.name="",!v)return;const l=e.itemState;l.name=v,t("update:itemState",l)}function ie(){t("up")}function de(){t("down")}function re(){t("copy")}return{vars:r,values:U,result:y,satt:T,r01:m,r01c:u,r02:A,r02c:O,onClose:X,onRename:Y,onNameEnter:ue,onUp:ie,onDown:de,onCopy:re}}}),R=e=>(oe("data-v-de56d5fa"),e=e(),le(),e),ut={class:"row"},it={class:"col-item"},dt=R(()=>s("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),rt=K(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),ct={class:"input-group"},pt=["step"],mt=R(()=>s("div",{class:"input-ext"},"\u500D",-1)),vt={class:"label"},ft={class:"input-group"},ht=R(()=>s("div",{style:{clear:"both"}},null,-1)),_t={class:"col-item"},bt=R(()=>s("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),$t=K(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),yt={class:"input-group"},Ct=["step"],gt=R(()=>s("div",{class:"input-ext"},"\u500D",-1)),kt={class:"label"},Bt={class:"input-group"},wt={class:"col-item"},Ft=R(()=>s("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),St={class:"static-control text-center"},Dt={class:"darkgold"},Ut=R(()=>s("div",{style:{clear:"both"}},null,-1)),It={class:"col-item"},Et=R(()=>s("div",{class:"label"},[s("span",{class:"darkgold"},"\u4E00\u6BB5\u4F24\u5BB3"),s("span",{class:"red"},"(\u66B4\u51FB)")],-1)),At={class:"static-control text-center"},Vt={class:"darkgold"},Mt={class:"red bold"},qt={class:"col-item"},Rt=R(()=>s("div",{class:"label"},[s("span",{class:"darkgold"},"\u4E8C\u6BB5\u4F24\u5BB3"),s("span",{class:"red"},"(\u66B4\u51FB)")],-1)),Nt={class:"static-control text-center"},Tt={class:"darkgold"},Kt={class:"red bold"},Ot={class:"col-item"},jt=R(()=>s("div",{class:"label"},"\u5269\u4F59\u6C14\u8840",-1)),Gt={class:"static-control text-center"},Ht={class:"darkgold"},Jt={class:"red bold"};function Pt(e,t,r,h,y,$){const f=F("IconCopy"),g=F("IconUp"),o=F("IconDown"),i=F("IconClose"),D=F("Divider"),S=F("Tooltip"),V=F("CalcInput"),N=Fe("autofocus");return _(),C(q,null,[n(D,{orientation:"left"},{action:d(()=>[s("span",{onClick:t[4]||(t[4]=(...c)=>e.onCopy&&e.onCopy(...c))},[n(f,{class:"close"})]),e.showUp?(_(),C("span",{key:0,onClick:t[5]||(t[5]=(...c)=>e.onUp&&e.onUp(...c))},[n(g,{class:"close"})])):ne("",!0),e.showDown?(_(),C("span",{key:1,onClick:t[6]||(t[6]=(...c)=>e.onDown&&e.onDown(...c))},[n(o,{class:"close"})])):ne("",!0),s("span",{onClick:t[7]||(t[7]=(...c)=>e.onClose&&e.onClose(...c))},[n(i,{class:"close"})])]),default:d(()=>[e.vars.editor?M((_(),C("input",{key:0,class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=c=>e.vars.name=c),onKeypress:t[1]||(t[1]=Se((...c)=>e.onNameEnter&&e.onNameEnter(...c),["enter"])),onBlur:t[2]||(t[2]=(...c)=>e.onNameEnter&&e.onNameEnter(...c))},null,544)),[[ee,e.vars.name],[N]]):(_(),C("span",{key:1,class:"calc-item-title",onClick:t[3]||(t[3]=(...c)=>e.onRename&&e.onRename(...c))},w(e.itemState.name||"\u6A21\u677F"),1))]),_:1}),s("div",ut,[s("div",it,[n(S,{dir:"top"},{label:d(()=>[dt]),default:d(()=>[rt]),_:1}),s("div",ct,[M(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[8]||(t[8]=c=>e.values.a1=c)},null,8,pt),[[ee,e.values.a1,void 0,{number:!0}]]),mt])]),(_(),C(q,null,J([{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],c=>s("div",{class:"col-item",key:c.name},[n(S,{dir:"top"},{label:d(()=>[s("div",vt,w(c.label),1)]),default:d(()=>[K(" "+w(c.tip),1)]),_:2},1024),s("div",ft,[n(V,{class:"input",modelValue:e.values[c.name],"onUpdate:modelValue":U=>e.values[c.name]=U,result:e.result[c.name],"onUpdate:result":U=>e.result[c.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),ht,s("div",_t,[n(S,{dir:"top"},{label:d(()=>[bt]),default:d(()=>[$t]),_:1}),s("div",yt,[M(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[9]||(t[9]=c=>e.values.a2=c)},null,8,Ct),[[ee,e.values.a2,void 0,{number:!0}]]),gt])]),(_(),C(q,null,J([{name:"att2",label:"\u653B\u51FB2%",tip:"\u6389\u8840\u540E\u52A0\u653B\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u9632\u5FA1\u4FEE\u6B63"}],c=>s("div",{class:"col-item",key:c.name},[n(S,{dir:"top"},{label:d(()=>[s("div",kt,w(c.label),1)]),default:d(()=>[K(" "+w(c.tip),1)]),_:2},1024),s("div",Bt,[n(V,{class:"input",modelValue:e.values[c.name],"onUpdate:modelValue":U=>e.values[c.name]=U,result:e.result[c.name],"onUpdate:result":U=>e.result[c.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),s("div",wt,[Ft,s("div",St,[s("span",Dt,w(e.satt),1)])]),Ut,s("div",It,[Et,s("div",At,[s("span",Vt,w(e.r01),1),s("span",Mt,"("+w(e.r01c)+")",1)])]),s("div",qt,[Rt,s("div",Nt,[s("span",Tt,w(e.r02),1),s("span",Kt,"("+w(e.r02c)+")",1)])]),s("div",Ot,[jt,s("div",Gt,[s("span",Ht,w((+e.enemyState.hp||0)-e.r01-e.r02),1),s("span",Jt," ("+w((+e.enemyState.hp||0)-e.r01c-e.r02c)+") ",1)])])])],64)}var zt=L(lt,[["render",Pt],["__scopeId","data-v-de56d5fa"]]);const Lt=z({components:{CalcItem:zt,CalcInput:Be},props:{data:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const r=k(()=>e.data.basic),h=k(()=>e.data.state),y=k(()=>e.data.enemyState),$=k(()=>e.data.items),f=H(Ze()),g=H({hp:0,def:0,defGain:0,ra:0,rb:0}),o=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],i=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],D=()=>{const m=r.value.c/100;r.value.g=Math.ceil(f.a+r.value.w*m+r.value.x),h.value.att=r.value.w+r.value.g},S=async()=>{t("update:data",e.data)},V=(m,u)=>{u==="panel"&&D(),S()},N=(m,u)=>{const A=e.data.items;!A||(A[u]=m,S())},c=()=>{const m=e.data.items;!m||(m.push(Ie()),S())},U=m=>{const u=e.data.items;!u||(u.splice(m,1),S())},T=m=>{const u=e.data.items;if(!u)return;const A=u[m],O=u[m-1];u[m-1]=A,u[m]=O,S()},a=m=>{const u=e.data.items;if(!u)return;const A=u[m],O=u[m+1];u[m+1]=A,u[m]=O,S()},B=m=>{const u=e.data.items;if(!u)return;const A=u[m];u.push(Ue.cloneDeep(A)),S()};return Te(()=>[e.data.basic.w],()=>{D()}),{panel:r,state:h,enemyState:y,panelResult:f,enemyStateResult:g,panelModels:o,enemyModels:i,update:V,items:$,updateItemState:N,addItem:c,delItem:U,upItem:T,downItem:a,copyItem:B}}}),Q=e=>(oe("data-v-1f4e9020"),e=e(),le(),e),Wt=Q(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Qt={class:"row"},Xt={class:"label"},Yt={class:"input-group"},Zt=["step","onUpdate:modelValue","onChange"],xt=["value"],es={class:"col-item"},ts=Q(()=>s("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),ss={class:"static-control text-center"},ns={class:"darkgold"},as={class:"col-item"},os=Q(()=>s("div",{class:"label"},"\u514B\u5236",-1)),ls=Q(()=>s("option",{value:0},"\u666E\u901A",-1)),us=["value"],is=["value"],ds=["value"],rs=Q(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),cs={class:"row"},ps={class:"label"},ms={class:"input-group"},vs={key:0,class:"input-ext"},fs={class:"heading"},hs=Q(()=>s("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),_s={class:"heading-actions"};function bs(e,t,r,h,y,$){const f=F("CalcInput"),g=F("CalcItem");return _(),C("div",null,[Wt,s("div",Qt,[(_(!0),C(q,null,J(e.panelModels,o=>(_(),C("div",{class:"col-item",key:o.name},[s("div",Xt,w(o.label),1),s("div",Yt,[o.name in e.panelResult?(_(),te(f,{key:0,modelValue:e.panel[o.name],"onUpdate:modelValue":i=>e.panel[o.name]=i,result:e.panelResult[o.name],"onUpdate:result":i=>e.panelResult[o.name]=i,onChange:i=>e.update(o.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):M((_(),C("input",{key:1,type:"number",class:"input",style:he({textAlign:o.align}),min:"0",step:o.step,"onUpdate:modelValue":i=>e.panel[o.name]=i,onChange:i=>e.update(o.name,"panel")},null,44,Zt)),[[ee,e.panel[o.name],void 0,{number:!0}]]),o.name==="w"?(_(),C("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${e.panel.g}`},null,8,xt)):ne("",!0)])]))),128)),s("div",es,[ts,s("div",ss,[s("span",ns,w(e.state.att),1)])]),s("div",as,[os,s("div",null,[M(s("select",{class:"select",style:{width:"100%"},"onUpdate:modelValue":t[0]||(t[0]=o=>e.state.k=o),onChange:t[1]||(t[1]=o=>e.update("k","state"))},[ls,s("option",{value:.3},"\u514B\u5236",8,us),s("option",{value:-.25},"\u88AB\u514B\u5236",8,is),s("option",{value:.5},"\u6FC0\u8361",8,ds)],544),[[De,e.state.k,void 0,{number:!0}]])])])]),rs,s("div",cs,[(_(!0),C(q,null,J(e.enemyModels,o=>(_(),C("div",{class:"col-item",key:o.name},[s("div",ps,w(o.label),1),s("div",ms,[n(f,{modelValue:e.enemyState[o.name],"onUpdate:modelValue":i=>e.enemyState[o.name]=i,result:e.enemyStateResult[o.name],"onUpdate:result":i=>e.enemyStateResult[o.name]=i,onChange:i=>e.update(o.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),o.precent?(_(),C("div",vs,"%")):ne("",!0)])]))),128))]),s("div",fs,[hs,s("div",_s,[s("div",{class:"btn btn-primary btn-sm",onClick:t[2]||(t[2]=(...o)=>e.addItem&&e.addItem(...o))},"\u6DFB\u52A0")])]),(_(!0),C(q,null,J(e.items,(o,i)=>(_(),te(g,{key:o,panel:e.panel,state:e.state,enemyState:e.enemyStateResult,itemState:o,showUp:i>0,showDown:e.items&&i<e.items.length-1,"onUpdate:itemState":D=>e.updateItemState(D,i),onClose:D=>e.delItem(i),onUp:D=>e.upItem(i),onDown:D=>e.downItem(i),onCopy:D=>e.copyItem(i)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))])}var $s=L(Lt,[["render",bs],["__scopeId","data-v-1f4e9020"]]);const ys=z({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(e,{emit:t}){return{wrapClass:k(()=>["c-action-sheet-wrapper",e.class,{show:e.show}]),onClick:($,f)=>{t("click",{item:$,index:f}),t("close",!1)},onClose:()=>{t("update:show",!1),t("close",!1)}}}}),Cs={class:"c-action-sheet-section"},gs={class:"c-action-sheet-extra"},ks={class:"c-action-sheet-list"},Bs=["onClick"];function ws(e,t,r,h,y,$){return _(),te(Ke,{to:"body"},[s("div",{class:se(e.wrapClass)},[s("div",{class:"c-action-sheet-mask",onClick:t[0]||(t[0]=(...f)=>e.onClose&&e.onClose(...f))}),s("div",Cs,[s("div",{class:"c-action-sheet-body",style:he({maxHeight:e.height})},[s("div",gs,[G(e.$slots,"extra")]),s("div",ks,[(_(!0),C(q,null,J(e.list,(f,g)=>(_(),C("div",{class:"c-action-sheet-item",key:g,onClick:o=>e.onClick(f,g)},[G(e.$slots,"default",{record:f})],8,Bs))),128))])],4)])],2)])}var fe=L(ys,[["render",ws]]);fe.install=e=>{e.component("action-sheet",fe)};const Fs=z({components:{ActionSheet:fe},props:{show:Boolean},emits:["click","update:show"],setup(e,{emit:t}){const{heroes:r,getHeroIcon:h}=Je();return{heroes:r,getHeroIcon:h,onClick:$=>{t("click",$)}}}}),Ss={class:"hero-item"},Ds=["src","alt","title"],Us={class:"hero-item-label"};function Is(e,t,r,h,y,$){const f=F("ActionSheet");return _(),te(f,{class:"hero-select",show:e.show,list:e.heroes,height:"80vh",onClick:e.onClick,"onUpdate:show":t[0]||(t[0]=g=>e.$emit("update:show",g))},{extra:d(()=>[G(e.$slots,"extra")]),default:d(({record:g})=>[s("div",Ss,[s("img",{src:e.getHeroIcon(g),alt:g.name,title:g.name,width:"128",height:"128"},null,8,Ds),s("div",Us,w(g.name),1)])]),_:3},8,["show","list","onClick"])}var Es=L(Fs,[["render",Is]]);const As=z({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(e,{emit:t}){const r=k({get:()=>e.activeKey,set:y=>{t("update:activeKey",y)}});return{active:r,toggle:()=>{const y=!r.value;r.value=y,t("toggle",y)}}}}),Vs=e=>(oe("data-v-2b5ca870"),e=e(),le(),e),Ms=Vs(()=>s("div",{class:"panel-icon"},[s("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[s("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),qs={class:"panel-title"},Rs={class:"panel-body"},Ns={class:"panel-content"};function Ts(e,t,r,h,y,$){return _(),C("div",{class:se(["panel",{active:e.active}])},[s("div",{class:"panel-header",onClick:t[1]||(t[1]=(...f)=>e.toggle&&e.toggle(...f))},[Ms,s("div",qs,[G(e.$slots,"header",{},()=>[K(w(e.header)+"\xA0",1)],!0)]),s("div",{class:"panel-actions",onClick:t[0]||(t[0]=ve(()=>{},["stop"]))},[G(e.$slots,"actions",{},void 0,!0)])]),s("div",Rs,[s("div",Ns,[G(e.$slots,"default",{},void 0,!0)])])],2)}var Ks=L(As,[["render",Ts],["__scopeId","data-v-2b5ca870"]]);const ke=(e,t)=>{const r=URL.createObjectURL(e),h=document.createElement("a");h.href=r,h.target="_blank",h.download=t,h.click(),URL.revokeObjectURL(r)};const Os=z({components:{Calculator:$s,CollapsePanel:Ks,InputNumber:Pe,HeroSelect:Es,IconCopy:we,IconEdit:Oe},setup(){const e=j(),t=H({index:-1,title:""}),r=j([]),h=async()=>{const p={id:Ce(),title:"\u6A21\u677F",basic:Ye(),state:xe(),enemyState:st(),items:tt()};await Qe(p),r.value.push(p)},y=async l=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const I=r.value[l];await Xe(I.id),r.value.splice(l,1)},$=async l=>{const p=r.value[l];if(!p)return;const I=t.title;if(!I){f();return}p.title=I,f(),await x(p)},f=()=>{t.index=-1,t.title=""},g=l=>{const p=new Blob([JSON.stringify([l])],{type:"application/json"});ke(p,`${l.title}.json`)},o=async l=>{r.value=l},i=j(""),D=l=>new Promise((p,I)=>{const E=new FileReader;E.onload=()=>{p(E.result)},E.onerror=()=>{I(E.error)},E.readAsText(l)}),S=async l=>{const p=l.currentTarget,I=Array.prototype.slice.call(p.files);if(p.value="",!I||!I[0])return;const E=I[0],P=await D(E),ce=JSON.parse(P);for(const W of ce){await x(W);const Z=r.value.findIndex(pe=>pe.id===W.id);Z===-1?r.value.push(W):r.value[Z]=W}},V=async()=>{const l=await ge(),p=new Blob([JSON.stringify(l)],{type:"application/json"});ke(p,"calculator.json")};async function N(l,p){!r.value[p]||(r.value[p]=l,await x(l))}const c=j(-1),U=H({input:"2283/1.35*1.39",result:0}),{translate:T,xinyao:a,huazhen:B}=ze(),m=l=>Math.ceil(l),u=H({show:!1,qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,hs_qixue:0,hs_patt:0,hs_pdef:0,hs_matt:0,hs_mdef:0,hs_huixin:0,x_qixue:0,x_patt:0,x_pdef:0,x_matt:0,x_mdef:0,x_huixin:0}),A=k(()=>{const l={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0};return e.value&&(l.qixue=e.value.t[0]+e.value.d[0]+e.value.h[0],l.patt=e.value.t[1]+e.value.d[1]+e.value.h[1],l.matt=e.value.t[2]+e.value.d[2]+e.value.h[2],l.pdef=e.value.t[3]+e.value.d[3]+e.value.h[3],l.mdef=e.value.t[4]+e.value.d[4]+e.value.h[4]),{qixue:Math.round(u.qixue+u.qixue*u.hs_qixue+l.qixue+u.x_qixue),patt:Math.round(u.patt+u.patt*u.hs_patt+l.patt+u.x_patt),pdef:Math.round(u.pdef+u.pdef*u.hs_pdef+l.pdef+u.x_pdef),matt:Math.round(u.matt+u.matt*u.hs_matt+l.matt+u.x_matt),mdef:Math.round(u.mdef+u.mdef*u.hs_mdef+l.mdef+u.x_mdef),huixin:Math.round(u.huixin+u.huixin*u.hs_huixin+l.huixin+u.x_huixin)}}),O=l=>{const p=T(l);u.show=!0,u.qixue=p.qixue,u.patt=p.patt,u.pdef=p.pdef,u.matt=p.matt,u.mdef=p.mdef,u.huixin=p.huixin},X=j(!1),Y=j(-1),ue=j(null),ie=l=>{X.value=!0,Y.value=l},de=({item:l})=>{X.value=!1;const p=Y.value;if(p===-1)O(l);else{const E=r.value[p],P=T(l);E.title==="\u6A21\u677F"&&(E.title=l.name),E.basic.w=Math.max(P.patt,P.matt),x(E)}},re=l=>{const p=Ue.cloneDeep(l);p.id=Ce(),console.log(p),r.value.push(p),x(p)};async function v(){const l=await ge();o(l)}return je(()=>{v()}),{stones:Le,stone:e,vars:t,activeKey:c,quick:U,list:r,add:h,rename:$,renameClose:f,remove:y,itemExport:g,download:i,onUpdateData:N,importData:S,exportData:V,heroes:Ge,max:Math.max,modal:u,ckValue:A,ceilResult:m,selectTpl:O,selectShow:X,selectIndex:Y,selectValue:ue,openSelect:ie,selectHero:de,copyItem:re,xinyao:a,huazhen:B}}}),b=e=>(oe("data-v-61c94c21"),e=e(),le(),e),js={class:"wrapper"},Gs={class:"toolbar"},Hs={style:{padding:"6px 16px"}},Js=K("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Ps={class:"c-upload"},zs=b(()=>s("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Ls={class:"transform-tools-popover"},Ws={class:"transform-tools-popover-toolbar"},Qs={class:"transform-tools-popover-content"},Xs=b(()=>s("div",{class:"input-group-title"},"\u57FA\u7840",-1)),Ys={class:"grids"},Zs=b(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),xs=b(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),en=b(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),tn=b(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),sn=b(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),nn=b(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),an={class:"input-group-title"},on=b(()=>s("span",null,"\u9B42\u77F3",-1)),ln=b(()=>s("option",{value:void 0},"\u65E0",-1)),un=["value"],dn={class:"grids"},rn=b(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),cn=b(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),pn=b(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),mn=b(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),vn=b(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),fn=b(()=>s("div",{class:"input-group-title"},"\u661F\u4E4B\u6676",-1)),hn={class:"grids"},_n=b(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),bn=b(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),$n=b(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),yn=b(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),Cn=b(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),gn=b(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),kn=b(()=>s("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Bn={class:"grids"},wn=b(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),Fn=b(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),Sn=b(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),Dn=b(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),Un=b(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),In=b(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),En={style:{padding:"6px 16px"}},An={class:"input-group"},Vn=b(()=>s("div",{class:"input-ext"},"=",-1)),Mn={class:"content"},qn={class:"container"},Rn=["onKeypress"],Nn={key:1},Tn=["onClick"],Kn=["onClick"],On=["onClick"],jn=K(" \u91CD\u547D\u540D "),Gn=["onClick"],Hn=K(" \u590D\u5236 "),Jn=["onClick"],Pn=["onClick"],zn={style:{"text-align":"center"}},Ln=b(()=>s("span",null,"\u661F\u8000",-1)),Wn=b(()=>s("span",null,"\u5316\u81FB",-1));function Qn(e,t,r,h,y,$){const f=F("c-col"),g=F("c-row"),o=F("input-number"),i=F("c-space"),D=F("calc-input"),S=F("IconEdit"),V=F("IconCopy"),N=F("Calculator",!0),c=F("CollapsePanel"),U=F("HeroSelect"),T=Fe("autofocus");return _(),C("div",js,[s("div",Gs,[s("div",Hs,[n(g,{flex:"",middle:"",gutter:16},{default:d(()=>[n(f,{flex:"0 0 auto"},{default:d(()=>[Js]),_:1}),n(f,{flex:"0 0 auto"},{default:d(()=>[s("button",{class:"btn btn-sm btn-link",onClick:t[0]||(t[0]=a=>e.modal.show=!e.modal.show)}," \u9762\u677F ")]),_:1}),n(f,{flex:"1 1 0"}),n(f,{flex:"0 0 auto"},{default:d(()=>[s("div",Ps,[zs,s("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:t[1]||(t[1]=(...a)=>e.importData&&e.importData(...a))},null,32)]),s("button",{class:"btn btn-success",onClick:t[2]||(t[2]=(...a)=>e.exportData&&e.exportData(...a))},"\u5BFC\u51FA"),s("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=a=>e.add())},"\u6DFB\u52A0")]),_:1})]),_:1}),M(s("div",Ls,[s("div",Ws,[n(g,{flex:"",middle:"",gutter:0},{default:d(()=>[n(f,{flex:"1 1 auto"},{default:d(()=>[s("button",{class:"btn btn-sm btn-link",onClick:t[4]||(t[4]=a=>e.openSelect(-1))}," \u53C2\u8003 ")]),_:1}),n(f,null,{default:d(()=>[s("span",{class:"transform-tools-popover-close",onClick:t[5]||(t[5]=a=>e.modal.show=!1)}," \xD7 ")]),_:1})]),_:1})]),s("div",Qs,[Xs,s("div",Ys,[n(i,null,{default:d(()=>[Zs,n(o,{value:e.modal.qixue,"onUpdate:value":t[6]||(t[6]=a=>e.modal.qixue=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[xs,n(o,{value:e.modal.patt,"onUpdate:value":t[7]||(t[7]=a=>e.modal.patt=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[en,n(o,{value:e.modal.pdef,"onUpdate:value":t[8]||(t[8]=a=>e.modal.pdef=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[tn,n(o,{value:e.modal.matt,"onUpdate:value":t[9]||(t[9]=a=>e.modal.matt=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[sn,n(o,{value:e.modal.mdef,"onUpdate:value":t[10]||(t[10]=a=>e.modal.mdef=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[nn,n(o,{value:e.modal.huixin,"onUpdate:value":t[11]||(t[11]=a=>e.modal.huixin=a)},null,8,["value"])]),_:1})]),s("div",an,[n(i,null,{default:d(()=>[on,M(s("select",{class:"input","onUpdate:modelValue":t[12]||(t[12]=a=>e.stone=a)},[ln,(_(!0),C(q,null,J(e.stones,(a,B)=>(_(),C("option",{key:B,value:a},w(a.name),9,un))),128))],512),[[De,e.stone]])]),_:1})]),s("div",dn,[n(i,null,{default:d(()=>[rn,n(o,{value:e.modal.hs_qixue,"onUpdate:value":t[13]||(t[13]=a=>e.modal.hs_qixue=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[cn,n(o,{value:e.modal.hs_patt,"onUpdate:value":t[14]||(t[14]=a=>e.modal.hs_patt=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[pn,n(o,{value:e.modal.hs_pdef,"onUpdate:value":t[15]||(t[15]=a=>e.modal.hs_pdef=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[mn,n(o,{value:e.modal.hs_matt,"onUpdate:value":t[16]||(t[16]=a=>e.modal.hs_matt=a)},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[vn,n(o,{value:e.modal.hs_mdef,"onUpdate:value":t[17]||(t[17]=a=>e.modal.hs_mdef=a)},null,8,["value"])]),_:1})]),fn,s("div",hn,[n(i,null,{default:d(()=>[_n,n(o,{value:e.modal.x_qixue,"onUpdate:value":t[18]||(t[18]=a=>e.modal.x_qixue=a),min:0,max:456,placeholder:"0~456"},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[bn,n(o,{value:e.modal.x_patt,"onUpdate:value":t[19]||(t[19]=a=>e.modal.x_patt=a),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[$n,n(o,{value:e.modal.x_pdef,"onUpdate:value":t[20]||(t[20]=a=>e.modal.x_pdef=a),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[yn,n(o,{value:e.modal.x_matt,"onUpdate:value":t[21]||(t[21]=a=>e.modal.x_matt=a),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[Cn,n(o,{value:e.modal.x_mdef,"onUpdate:value":t[22]||(t[22]=a=>e.modal.x_mdef=a),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[gn,n(o,{value:e.modal.x_huixin,"onUpdate:value":t[23]||(t[23]=a=>e.modal.x_huixin=a),min:0,max:104,placeholder:"0~104"},null,8,["value"])]),_:1})]),kn,s("div",Bn,[n(i,null,{default:d(()=>[wn,n(o,{readonly:"",value:e.ckValue.qixue},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[Fn,n(o,{readonly:"",value:e.ckValue.patt},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[Sn,n(o,{readonly:"",value:e.ckValue.pdef},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[Dn,n(o,{readonly:"",value:e.ckValue.matt},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[Un,n(o,{readonly:"",value:e.ckValue.mdef},null,8,["value"])]),_:1}),n(i,null,{default:d(()=>[In,n(o,{readonly:"",value:e.ckValue.huixin},null,8,["value"])]),_:1})])])],512),[[He,e.modal.show]])]),s("div",En,[s("div",An,[n(D,{modelValue:e.quick.input,"onUpdate:modelValue":t[24]||(t[24]=a=>e.quick.input=a),result:e.quick.result,"onUpdate:result":t[25]||(t[25]=a=>e.quick.result=a),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Vn,n(o,{readonly:"",value:e.ceilResult(e.quick.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),s("div",Mn,[s("div",qn,[(_(!0),C(q,null,J(e.list,(a,B)=>(_(),te(c,{key:a.id,activeKey:B===e.activeKey,onToggle:m=>e.activeKey=m?B:-1},{header:d(()=>[n(g,{flex:"",middle:""},{default:d(()=>[n(f,null,{default:d(()=>[e.vars.index===B?M((_(),C("input",{key:0,type:"text",class:"input","onUpdate:modelValue":t[26]||(t[26]=m=>e.vars.title=m),onClick:t[27]||(t[27]=ve(()=>{},["stop"])),onKeypress:Se(m=>e.rename(B),["enter"])},null,40,Rn)),[[ee,e.vars.title],[T]]):(_(),C("span",Nn,w(a.title),1))]),_:2},1024),n(f,{class:"ml-4",onClick:t[28]||(t[28]=ve(()=>{},["stop"]))},{default:d(()=>[e.vars.index===B?(_(),C("button",{key:0,class:"btn btn-sm btn-link",onClick:m=>e.rename(B)}," \u786E\u8BA4 ",8,Tn)):(_(),C(q,{key:1},[s("button",{class:"btn btn-sm btn-link",onClick:m=>e.openSelect(B)}," \u9009\u62E9 ",8,Kn),s("button",{class:"btn btn-sm btn-link",onClick:m=>{e.vars.index=B,e.vars.title=a.title}},[n(S,{class:"svg-icon"}),jn],8,On),s("button",{class:"btn btn-sm btn-link",onClick:m=>e.copyItem(a)},[n(V,{class:"svg-icon"}),Hn],8,Gn)],64))]),_:2},1024)]),_:2},1024)]),actions:d(()=>[s("button",{class:"btn btn-sm btn-success-outline",onClick:m=>e.itemExport(a)}," \u5BFC\u51FA ",8,Jn),s("button",{class:"btn btn-sm btn-danger-outline",onClick:m=>e.remove(B)}," \u5220\u9664 ",8,Pn)]),default:d(()=>[n(N,{data:a,"onUpdate:data":m=>e.onUpdateData(m,B)},null,8,["data","onUpdate:data"])]),_:2},1032,["activeKey","onToggle"]))),128))])]),n(U,{show:e.selectShow,"onUpdate:show":t[31]||(t[31]=a=>e.selectShow=a),onClick:e.selectHero},{extra:d(()=>[s("div",zn,[n(i,null,{default:d(()=>[s("label",null,[Ln,M(s("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=a=>e.xinyao=a)},null,512),[[$e,e.xinyao]])]),s("label",null,[Wn,M(s("input",{type:"checkbox","onUpdate:modelValue":t[30]||(t[30]=a=>e.huazhen=a)},null,512),[[$e,e.huazhen]])])]),_:1})])]),_:1},8,["show","onClick"])])}var sa=L(Os,[["render",Qn],["__scopeId","data-v-61c94c21"]]);export{sa as default};
