import{_ as nt,J as Xt,o as p,c as h,f as t,K as Wt,L as Zt,M as Yt,N as ct,d as mt,r as Z,O as qt,H as Bt,g as E,P as kt,G as Ht,b as ht,t as te,a as et,e as v,w as B,u as o,k as X,Q as ee,h as L,z as at,R as Vt,S as se,F as I,j as R,U as ne,x as Y,V as xt,W as Gt,p as At,m as St,D as lt,T as Nt,I as ue,n as oe,X as ae,l as ft,q as yt,v as Pt,A as pt,E as Et,Y as G,Z as le,i as Ct}from"./index.js";import{D as ce,u as ie}from"./useHeroes.js";import{_ as Dt}from"./lodash.js";import{C as de}from"./CollapsePanel.js";import Ut from"./InputNumber.js";import{b as zt,d as It,a as re,i as pe}from"./shared.js";import{S as W,a as _e}from"./star-crystals.js";import{s as Lt}from"./data.js";import"./index2.js";const fe=["width","height"],ve=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),he=[ve];function me(s,n,e,u,l,y){return p(),h("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},he,8,fe)}const Fe=nt(Xt,[["render",me]]),be=["width","height"],Be=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),$e=[Be];function Ce(s,n,e,u,l,y){return p(),h("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},$e,8,be)}const ye=nt(Wt,[["render",Ce]]),xe=["width","height"],ge=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),we=[ge];function Ee(s,n,e,u,l,y){return p(),h("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},we,8,xe)}const Ot=nt(Zt,[["render",Ee]]),ke=["width","height"],De=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Ae=[De];function Se(s,n,e,u,l,y){return p(),h("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},Ae,8,ke)}const Me=nt(Yt,[["render",Se]]);let jt=0,Jt=0;const Ue=500;function Rt(){const s=Math.floor(new Date().getTime()/1e3);Jt===s?jt++:jt=0,Jt=s;const n=s.toString(16);return`${(Ue<<16|jt&255).toString(16)}.${n}`}async function je(){try{return await ct.getAll("calculator")}catch{return[]}}async function Ve(s){try{await ct.add("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function wt(s){try{await ct.put("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ie(s){try{await ct.delete("calculator",s)}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Te(s){try{const u=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await ct.wrap(u.put(l))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function He(s){try{const u=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await ct.wrap(u.delete(l))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}function Pe(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Je(){return{a:0}}function Re(){return{att:0}}function Kt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function qe(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ge(){return[Kt()]}function Ne(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const ze=mt({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(s,{emit:n}){const e=Z(),u=Z({}),l=Z(s.active),y=()=>{const C=e.value.getBoundingClientRect();switch(l.value=!0,n("update:active",l.value),s.dir){case"left":u.value={top:`${C.top+C.height/2}px`,right:`${window.innerWidth-C.left-4}px`,maxWidth:"100%"};break;case"right":u.value={top:`${C.top+C.height/2}px`,left:`${C.right+4}px`,maxWidth:"100%"};break;case"top":u.value={bottom:`${window.innerHeight-C.top-4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"};break;default:u.value={top:`${C.bottom+4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"}}};let r;const c=()=>{r=window.setTimeout(y,s.wait)},w=()=>{clearTimeout(r),l.value=!1,n("update:active",l.value)};return qt(()=>s.active,x=>{l.value=x}),{el:e,style:u,tActive:l,onEnter:c,onOut:w}}});const Le={class:"c-tooltip-label"};function Oe(s,n,e,u,l,y){return p(),h("div",{ref:"el",class:kt(["c-tooltip",{active:s.tActive,inline:s.inline}]),onMouseenter:n[0]||(n[0]=(...r)=>s.onEnter&&s.onEnter(...r)),onMouseout:n[1]||(n[1]=(...r)=>s.onOut&&s.onOut(...r))},[Bt(s.$slots,"label",{},()=>[t("div",Le,E(s.label),1)]),t("div",{class:kt(["c-tooltip-inner",s.dir?`c-tooltip-${s.dir}`:"c-tooltip-bottom",s.color?`c-tooltip-${s.color}`:""]),style:Ht(s.style)},[Bt(s.$slots,"default")],6)],34)}const _t=nt(ze,[["render",Oe]]),ut=s=>(At("data-v-a6a2fd75"),s=s(),St(),s),Ke=["onKeypress"],Qe=["onKeypress"],Xe=ut(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),We=Y(" \u514B\u523630%"),Ze=ut(()=>t("br",null,null,-1)),Ye=Y("\u88AB\u514B\u5236-25%"),ts=ut(()=>t("br",null,null,-1)),es=Y("\u6FC0\u836150% "),ss=["onClick"],ns=["onClick"],us={class:"row"},os={class:"col-item"},as=ut(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ls=Y(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),cs={class:"input-group"},is=["step"],ds=ut(()=>t("div",{class:"input-ext"},"\u500D",-1)),rs={class:"label"},ps={class:"input-group"},_s=ut(()=>t("div",{style:{clear:"both"}},null,-1)),fs={class:"col-item"},vs=ut(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),hs=Y(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),ms={class:"input-group"},Fs=["step"],bs=ut(()=>t("div",{class:"input-ext"},"\u500D",-1)),Bs={class:"label"},$s={class:"input-group"},Cs={class:"col-item"},ys=ut(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),xs={class:"static-control text-center"},gs={class:"darkgold"},ws=ut(()=>t("div",{style:{clear:"both"}},null,-1)),Es={class:"label"},ks={class:"bold darkgold"},Ds=ut(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),As={class:"static-control text-center"},Ss={class:"bold darkgold"},Ms={class:"bold red"},Us={class:"label bold"},js={class:"static-control text-center"},Vs={class:"bold darkgold"},Is={key:0,class:"bold red"},Ts=mt({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(s,{emit:n}){const e=s,u=ht({editor:!1,name:"",desc:{f:!1,v:""}}),l=ht(qe()),y=te(e,"itemState"),r=()=>{n("update:itemState",y.value)},c=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],w=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],x=et(()=>{const{state:F}=e,d=(100+l.att)/100;return Math.ceil(F.att*d)}),C=et(()=>{const{state:F}=e,d=(100+l.att+l.att2)/100;return Math.ceil(F.att*d)}),P=()=>{const{enemyState:F}=e,d=y.value,A=(100+d.kz)/100,m=(100+l.da-F.ra)/100,j=(100+l.da+l.da2-F.ra)/100,K=(100+l.db-F.rb)/100,Ft=(100+l.dc)/100,dt=(100+l.dx)/100,V=(100+l.dx+l.dx2)/100,$=(100+l.cd)/100,J=(100-l.id)/100,z=(100+F.defGain)/100,$t=(100+F.defGain+l.defGain)/100,i=Math.max(0,Math.max(0,F.def*z+F.defExt)*J),b=Math.max(0,Math.max(0,F.def*$t+F.defExt)*J),a=Math.max(1,x.value*A-i),S=Math.max(1,C.value*A-b),H=a*d.a1*m*K*dt,tt=Math.ceil(H*$),ot=S*d.a2*j*K*Ft*V,rt=Math.ceil(ot*$);return{r01:Math.ceil(H),r01c:tt,r02:Math.ceil(ot),r02c:rt}},f=et(()=>P());function _(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&n("close")}function k(){u.editor=!0,u.name=e.itemState.name}function D(){const F=u.name;if(u.editor=!1,u.name="",!F)return;const d=e.itemState;d.name=F,n("update:itemState",d)}function q(){u.desc.f=!0,u.desc.v=e.itemState.desc}function T(){const F=u.desc.v;if(u.desc.f=!1,u.desc.v="",!F)return;const d=e.itemState;d.desc=F,n("update:itemState",d)}function U(){n("up")}function N(){n("down")}function M(){n("copy")}return(F,d)=>{const A=Gt("autofocus");return p(),h(I,null,[v(o(ne),{orientation:"left"},{action:B(()=>[t("span",{onClick:M},[v(o(Ot),{class:"close"})]),s.showUp?(p(),h("span",{key:0,onClick:U},[v(o(Fe),{class:"close"})])):X("",!0),s.showDown?(p(),h("span",{key:1,onClick:N},[v(o(ye),{class:"close"})])):X("",!0),t("span",{onClick:_},[v(o(ee),{class:"close"})])]),default:B(()=>[u.editor?L((p(),h("input",{key:0,class:"input",type:"text","onUpdate:modelValue":d[0]||(d[0]=m=>u.name=m),onKeypress:Vt(D,["enter"]),onBlur:D},null,40,Ke)),[[at,u.name],[A]]):(p(),h("span",{key:1,class:"calc-item-title",onClick:k},E(o(y).name||"\u6A21\u677F"),1)),u.desc.f?L((p(),h("input",{key:2,class:"input",type:"text","onUpdate:modelValue":d[1]||(d[1]=m=>u.desc.v=m),onKeypress:Vt(T,["enter"]),onBlur:T},null,40,Qe)),[[at,u.desc.v],[A]]):(p(),h("span",{key:3,class:"calc-item-desc",onClick:q},E(o(y).desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),v(o(se),{style:{width:"120px"}},{default:B(()=>[v(o(_t),{dir:"top"},{label:B(()=>[Xe]),default:B(()=>[We,Ze,Ye,ts,es]),_:1}),t("div",null,[v(o(ce),null,{popover:B(({onClose:m})=>[t("div",{class:"list",onClick:j=>m()},[(p(),h(I,null,R([{label:"\u666E\u901A",value:0},{label:"\u514B\u5236",value:30},{label:"\u88AB\u514B\u5236",value:-25},{label:"\u6FC0\u8361",value:50}],({label:j,value:K})=>t("div",{key:j,class:"list-item",onClick:Ft=>{o(y).kz=K,r()}},E(j),9,ns)),64))],8,ss)]),default:B(()=>[L(t("input",{class:"input",type:"number","onUpdate:modelValue":d[2]||(d[2]=m=>o(y).kz=m)},null,512),[[at,o(y).kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",us,[t("div",os,[v(o(_t),{dir:"top"},{label:B(()=>[as]),default:B(()=>[ls]),_:1}),t("div",cs,[L(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":d[3]||(d[3]=m=>o(y).a1=m),onInput:r},null,40,is),[[at,o(y).a1,void 0,{number:!0}]]),ds])]),(p(),h(I,null,R(c,m=>t("div",{class:"col-item",key:m.name},[v(o(_t),{dir:"top"},{label:B(()=>[t("div",rs,E(m.label),1)]),default:B(()=>[Y(" "+E(m.tip),1)]),_:2},1024),t("div",ps,[v(o(xt),{class:"input",modelValue:o(y)[m.name],"onUpdate:modelValue":j=>o(y)[m.name]=j,result:l[m.name],"onUpdate:result":[j=>l[m.name]=j,r]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),_s,t("div",fs,[v(o(_t),{dir:"top"},{label:B(()=>[vs]),default:B(()=>[hs]),_:1}),t("div",ms,[L(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":d[4]||(d[4]=m=>o(y).a2=m),onInput:r},null,40,Fs),[[at,o(y).a2,void 0,{number:!0}]]),bs])]),(p(),h(I,null,R(w,m=>t("div",{class:"col-item",key:m.name},[v(o(_t),{dir:"top"},{label:B(()=>[t("div",Bs,E(m.label),1)]),default:B(()=>[Y(" "+E(m.tip),1)]),_:2},1024),t("div",$s,[v(o(xt),{class:"input",modelValue:o(y)[m.name],"onUpdate:modelValue":j=>o(y)[m.name]=j,result:l[m.name],"onUpdate:result":[j=>l[m.name]=j,r]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Cs,[ys,t("div",xs,[t("span",gs,E(o(x)),1)])]),ws,(p(!0),h(I,null,R([o(f)],m=>(p(),h(I,null,[(p(!0),h(I,null,R([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:m.r01,v2:m.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:m.r02,v2:m.r02c}],(j,K)=>(p(),h("div",{class:"col-item",key:K},[t("div",Es,[t("span",ks,E(j.label),1),Ds]),t("div",As,[t("span",Ss,E(j.v),1),t("span",Ms,"("+E(j.v2)+")",1)])]))),128)),(p(!0),h(I,null,R([{label:"\u4E0D\u66B4\u51FB",value:m.r01+m.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:m.r01c+m.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:m.r01+m.r02c},{label:"\u5168\u66B4\u51FB",value:m.r01c+m.r02c}],(j,K)=>(p(),h("div",{class:"col-item",key:K},[t("div",Us,E(j.label),1),t("div",js,[t("span",Vs,E(j.value),1),(+s.enemyState.hp||0)<=j.value?(p(),h("span",Is," \u51FB\u6740 ")):X("",!0)])]))),128))],64))),256))])],64)}}});const Hs=nt(Ts,[["__scopeId","data-v-a6a2fd75"]]),Mt=s=>(At("data-v-bd82d11d"),s=s(),St(),s),Ps=Mt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Js={class:"row"},Rs={class:"label"},qs={class:"input-group"},Gs=["step","onUpdate:modelValue","onChange"],Ns=["value"],zs={class:"col-item"},Ls=Mt(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Os={class:"static-control text-center"},Ks={class:"darkgold"},Qs=Mt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),Xs={class:"row"},Ws={class:"label"},Zs={key:1,class:"label"},Ys={class:"input-group"},tn={key:0,class:"input-ext"},en=Mt(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),sn=mt({__name:"Calculator",props:{data:null},emits:["update:data"],setup(s,{emit:n}){const e=s,u=et(()=>e.data.basic),l=et(()=>e.data.state),y=et(()=>e.data.enemyState),r=et(()=>e.data.items),c=ht(Je()),w=ht({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),x=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],C=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],P=()=>{const M=u.value.c/100;u.value.g=Math.ceil(c.a+u.value.w*M+u.value.x),l.value.att=u.value.w+u.value.g},f=async()=>{n("update:data",e.data)},_=(M,F)=>{F==="panel"&&P(),f()},k=(M,F)=>{const d=e.data.items;!d||(d[F]=M,f())},D=()=>{const M=e.data.items;!M||(M.push(Kt()),f())},q=M=>{const F=e.data.items;!F||(F.splice(M,1),f())},T=M=>{const F=e.data.items;if(!F)return;const d=F[M],A=F[M-1];F[M-1]=d,F[M]=A,f()},U=M=>{const F=e.data.items;if(!F)return;const d=F[M],A=F[M+1];F[M+1]=d,F[M]=A,f()},N=M=>{const F=e.data.items;if(!F)return;const d=F[M];F.push(Dt.cloneDeep(d)),f()};return qt(()=>[e.data.basic.w],()=>{P()}),(M,F)=>(p(),h("div",null,[Ps,t("div",Js,[(p(),h(I,null,R(x,d=>t("div",{class:"col-item",key:d.name},[t("div",Rs,E(d.label),1),t("div",qs,[d.name in c?(p(),lt(o(xt),{key:0,modelValue:o(u)[d.name],"onUpdate:modelValue":A=>o(u)[d.name]=A,result:c[d.name],"onUpdate:result":A=>c[d.name]=A,onChange:A=>_(d.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):L((p(),h("input",{key:1,type:"number",class:"input",style:Ht({textAlign:d.align}),min:"0",step:d.step,"onUpdate:modelValue":A=>o(u)[d.name]=A,onChange:A=>_(d.name,"panel")},null,44,Gs)),[[at,o(u)[d.name],void 0,{number:!0}]]),d.name==="w"?(p(),h("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${o(u).g}`},null,8,Ns)):X("",!0)])])),64)),t("div",zs,[Ls,t("div",Os,[t("span",Ks,E(o(l).att),1)])])]),Qs,t("div",Xs,[(p(),h(I,null,R(C,d=>t("div",{class:"col-item",key:d.name},[d.tips?(p(),lt(o(_t),{key:0,dir:"top"},{label:B(()=>[t("div",Ws,E(d.label),1)]),default:B(()=>[Y(" "+E(d.tips),1)]),_:2},1024)):(p(),h("div",Zs,E(d.label),1)),t("div",Ys,[v(o(xt),{modelValue:o(y)[d.name],"onUpdate:modelValue":A=>o(y)[d.name]=A,result:w[d.name],"onUpdate:result":A=>w[d.name]=A,onChange:A=>_(d.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),d.precent?(p(),h("div",tn,"%")):X("",!0)])])),64))]),t("div",{class:"heading"},[en,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:D},"\u6DFB\u52A0")])]),(p(!0),h(I,null,R(o(r),(d,A)=>(p(),lt(Hs,{key:d,panel:o(u),state:o(l),enemyState:w,itemState:d,showUp:A>0,showDown:o(r)&&A<o(r).length-1,"onUpdate:itemState":m=>k(m,A),onClose:m=>q(A),onUp:m=>T(A),onDown:m=>U(A),onCopy:m=>N(A)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const nn=nt(sn,[["__scopeId","data-v-bd82d11d"]]),un=mt({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(s,{emit:n}){return{wrapClass:et(()=>["c-action-sheet-wrapper",s.class,{show:s.show}]),onClick:(y,r)=>{n("click",{item:y,index:r}),n("close",!1)},onClose:()=>{n("update:show",!1),n("close",!1)}}}});const on={class:"c-action-sheet-section"},an={class:"c-action-sheet-extra"},ln={class:"c-action-sheet-list"},cn=["onClick"];function dn(s,n,e,u,l,y){return p(),lt(Nt,{to:"body"},[t("div",{class:kt(s.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:n[0]||(n[0]=(...r)=>s.onClose&&s.onClose(...r))}),t("div",on,[t("div",{class:"c-action-sheet-body",style:Ht({maxHeight:s.height})},[t("div",an,[Bt(s.$slots,"extra")]),t("div",ln,[(p(!0),h(I,null,R(s.list,(r,c)=>(p(),h("div",{class:"c-action-sheet-item",key:c,onClick:w=>s.onClick(r,c)},[Bt(s.$slots,"default",{record:r})],8,cn))),128))])],4)])],2)])}const Tt=nt(un,[["render",dn]]);Tt.install=s=>{s.component("action-sheet",Tt)};const rn={class:"hero-item"},pn={class:"hero-item__inner"},_n=["src"],fn=["src","alt","title"],vn={class:"hero-item__label"},hn=mt({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(s,{emit:n}){const{heroes:e,getHeroIcon:u,getHeroIconBg:l}=ie(),y=et(()=>e.value.slice().sort((c,w)=>w.weight-c.weight)),r=c=>{n("click",c)};return(c,w)=>(p(),lt(o(Tt),{class:"hero-select",show:s.show,list:o(y),height:"80vh",onClick:r,"onUpdate:show":w[0]||(w[0]=x=>c.$emit("update:show",x))},{extra:B(()=>[Bt(c.$slots,"extra")]),default:B(({record:x})=>[t("div",rn,[t("div",pn,[t("img",{src:o(l)(x)},null,8,_n),t("img",{src:o(u)(x),alt:x.name,title:x.name},null,8,fn),t("div",vn,E(x.name),1)])])]),_:3},8,["show","list"]))}});function mn(){const s="red_team",n=ue(),e=Z([]),u=Z(!1),l=Z(),y=async f=>{const k=(await n.transaction(s,"readwrite")).objectStore(s),D=await n.wrap(k.put(f));return e.value.find(T=>T._id===f._id)||(f._id=D,e.value.push(f)),D},r=async f=>{const k=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(k.delete(f._id)),e.value=e.value.filter(D=>D._id!==f._id)},c=async f=>{const _=await n.transaction(s,"readwrite"),k=_.objectStore(s);for(const D of f)await n.wrap(k.put(D));await n.twrap(_),await x()},w=async()=>{const _=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(_.clear()),e.value=[]},x=async()=>{const _=(await n.transaction(s,"readonly")).objectStore(s),k=await n.wrap(_.getAll()).catch(()=>[]);k.forEach(D=>{D.scList||(D.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:W.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:W.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:W.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:W.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:W.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:W.DEF}])}),e.value=k},C=async f=>{const _=JSON.parse(await f.text());if(!zt(_)||_.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const k=_.data;k.forEach(D=>delete D._id),await c(k)},P=async()=>{const f={type:"red_team",data:e.value},_=new Blob([JSON.stringify(f)],{type:"application/json"});It(_,"red_team.json")};return x(),{scShow:u,scSelected:l,put:y,del:r,puts:c,clear:w,all:x,list:e,importData:C,exportData:P}}const bt=s=>s%1>.5?Math.ceil(s):Math.floor(s);function Fn(){const s=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:W.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:W.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:W.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:W.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:W.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:W.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0,jjQixue:0,jjPatt:0,jjPdef:0,jjMatt:0,jjMdef:0,jjHuixin:0}),n=Z(s()),e=et(()=>{const r=[0,0,0,0,0,0];return n.value.scList.forEach(c=>{!c.v||(r[0]+=c.v.qixue,r[1]+=c.v.patt,r[2]+=c.v.pdef,r[3]+=c.v.matt,r[4]+=c.v.mdef,r[5]+=c.v.huixin)}),r}),u=et(()=>{const r=n.value,c={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},w=Lt.find(P=>r.stoneName===P.name);w&&(c.qixue=w.t[0]+w.d[0]+w.h[0],c.patt=w.t[1]+w.d[1]+w.h[1],c.matt=w.t[2]+w.d[2]+w.h[2],c.pdef=w.t[3]+w.d[3]+w.h[3],c.mdef=w.t[4]+w.d[4]+w.h[4]);const x={qixue:r.hsQixue/100,patt:r.hsPatt/100,pdef:r.hsPdef/100,matt:r.hsMatt/100,mdef:r.hsMdef/100,huixin:r.hsHuixin/100},C=e.value;return{qixue:bt(r.qixue*x.qixue+c.qixue+C[0]+r.jjQixue),patt:bt(r.patt*x.patt+c.patt+C[1]+r.jjPatt),pdef:bt(r.pdef*x.pdef+c.pdef+C[2]+r.jjPdef),matt:bt(r.matt*x.matt+c.matt+C[3]+r.jjMatt),mdef:bt(r.mdef*x.mdef+c.mdef+C[4]+r.jjMdef),huixin:bt(r.huixin*x.huixin+c.huixin+C[5]+r.jjHuixin)}}),l=et(()=>{const r=u.value,c={qixue:(100+n.value.rQixue)/100,patt:(100+n.value.rPatt)/100,pdef:(100+n.value.rPdef)/100,matt:(100+n.value.rMatt)/100,mdef:(100+n.value.rMdef)/100,huixin:(100+n.value.rHuixin)/100};return{qixue:Math.round((n.value.qixue+r.qixue)*c.qixue),patt:Math.round((n.value.patt+r.patt)*c.patt),pdef:Math.round((n.value.pdef+r.pdef)*c.pdef),matt:Math.round((n.value.matt+r.matt)*c.matt),mdef:Math.round((n.value.mdef+r.mdef)*c.mdef),huixin:Math.round((n.value.huixin+r.huixin)*c.huixin)}});return{state:n,pValue:u,ckValue:l,scSum:e,reset:()=>{n.value=s()},defState:s}}const bn={},Bn={class:"c-upload"};function $n(s,n){return p(),h("div",Bn,[Bt(s.$slots,"default",{},void 0,!0),t("input",oe({type:"file",class:"c-upload-input",accept:"application/json"},s.$attrs),null,16)])}const Cn=nt(bn,[["render",$n],["__scopeId","data-v-b3879154"]]),yn=[1020,330,270,0,150,0],xn=[930,360,253,0,120,0],gn=[870,390,240,0,150,0],wn=[870,0,240,390,150,0],En=[780,360,210,0,180,0],kn=[810,390,180,0,210,0],Dn=[750,360,210,0,150,0],An=[690,0,180,390,240,0],Sn=[750,0,180,360,270,0],Mn=[750,0,210,330,270,0],st={xk:gn,xkf:wn,ys:Dn,tw:yn,tw2:xn,zs:An,zs2:Sn,zy:Mn,yf:En,yf2:kn,none:[0,0,0,0,0,0]};function Un(s,n){switch(n){case"\u4EFB\u65AD\u79BB":return st.xkf;case"\u65E0\u76F8\xB7\u5F2D\u670D":case"\u4E5D\u9634":case"\u4E0A\u5B98\u8FDC":case"\u9C9C\u4E8E\u8D85":case"\u9AD8\u621A":case"\u963F\u5C14\u6CF0\u5DF4":return st.tw2;case"\u90F8\u9634":case"\u97E9\u65E0\u7802":return st.zs2;case"\u9B54\u5316\u7687\u752B\u7533":case"\u5251\u90AA":case"\u6768\u4E91\u4F50":case"\u7075\u9F29":return st.yf2}switch(s){case"\u4FA0\u5BA2":return st.xk;case"\u7FBD\u58EB":return st.ys;case"\u94C1\u536B":return st.tw;case"\u5492\u5E08":return st.zs;case"\u795D\u7531":return st.zy;case"\u5FA1\u98CE":return st.yf;default:return st.none}}const O=s=>(At("data-v-c5068b1e"),s=s(),St(),s),jn={class:"transform-tools-popover"},Vn={class:"transform-tools-popover-toolbar"},In=["value"],Tn=["value"],Hn=O(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Pn={class:"transform-tools-popover-content"},Jn={class:"grid-group"},Rn={class:"grid-group-item"},qn={class:"input-group-title"},Gn=O(()=>t("span",null,"\u57FA\u7840",-1)),Nn={class:"grids"},zn={class:"input-label"},Ln={class:"input-group"},On={class:"input green"},Kn={class:"grid-group-item"},Qn={class:"input-group-title"},Xn=O(()=>t("span",null,"\u9B42\u77F3",-1)),Wn=O(()=>t("option",{value:""},"\u65E0",-1)),Zn=["value"],Yn={class:"grids"},tu=O(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),eu=O(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),su=O(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),nu=O(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),uu=O(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),ou={class:"grid-group-item"},au={class:"input-group-title"},lu=Y(" \u661F\u4E4B\u6676 "),cu=O(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),iu=O(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),du=O(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),ru={class:"grids"},pu=["onClick","onContextmenu"],_u={key:0},fu={key:1},vu={key:2},hu={key:3},mu={key:4},Fu={key:5},bu={key:1},Bu={class:"grid-group-item"},$u=O(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),Cu={class:"grids"},yu={class:"input-label"},xu={class:"input"},gu={class:"grid-group-item"},wu=O(()=>t("div",{class:"input-group-title"},"\u7CBE\u8FDB\u5C5E\u6027",-1)),Eu={class:"grids"},ku={class:"input-label"},Du={class:"grid-group-item"},Au=O(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63%",-1)),Su={class:"grids"},Mu={class:"input-label"},Uu={class:"grid-group-item"},ju=O(()=>t("div",{class:"input-group-title"},"\u6700\u7EC8\u53C2\u8003",-1)),Vu={class:"grids"},Iu={class:"input-label"},Tu={class:"input"},Hu=mt({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(s,{emit:n}){const{state:e,pValue:u,ckValue:l,scSum:y,reset:r,defState:c}=Fn(),{list:w,put:x,del:C,clear:P,importData:f,exportData:_}=mn(),k=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],D=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],q=[{t:"\u6C14\u8840",n:"jjQixue"},{t:"\u7269\u653B",n:"jjPatt"},{t:"\u7269\u9632",n:"jjPdef"},{t:"\u6CD5\u653B",n:"jjMatt"},{t:"\u6CD5\u9632",n:"jjMdef"},{t:"\u4F1A\u5FC3",n:"jjHuixin"}],T=Z(!1),U=Z(),N=V=>{U.value=V,T.value=!0},M=V=>{!U.value||(U.value.v=V)},F=()=>{const V=Dt.cloneDeep(e.value);x(V).then($=>{e.value._id=$,alert("\u5DF2\u4FDD\u5B58")}).catch($=>{console.log($),alert("\u4FDD\u5B58\u5931\u8D25")})},d=()=>{const V=Dt.cloneDeep(e.value);delete V._id,V.name+=" copy",x(V).then($=>{V._id=$,e.value=V}).catch($=>{console.log($),alert("\u590D\u5236\u5931\u8D25")})},A=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||C(e.value).then(()=>{r()}).catch($=>{console.log($),alert("\u5220\u9664\u5931\u8D25")})},m=V=>{const $=V.currentTarget;if(!$.files)return;const J=Array.prototype.slice.call($.files);$.value="",J[0]&&f(J[0])},j=()=>{_()},K=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||P().catch($=>{console.log($),alert("\u6E05\u7A7A\u5931\u8D25")})},Ft=(V,$)=>{e.value.name=V.name;const J=Un(V.career,V.name);e.value.qixue=$.qixue,e.value.patt=$.patt,e.value.pdef=$.pdef,e.value.matt=$.matt,e.value.mdef=$.mdef,e.value.huixin=$.huixin,e.value.jjQixue=J[0],e.value.jjPatt=J[1],e.value.jjPdef=J[2],e.value.jjMatt=J[3],e.value.jjMdef=J[4],e.value.jjHuixin=J[5]},dt=()=>{n("reference")};return n("init",Ft),(V,$)=>{const J=ft("c-col"),z=ft("c-space"),$t=ft("c-row");return L((p(),h("div",jn,[t("div",Vn,[v($t,{flex:"",middle:"",gutter:8},{default:B(()=>[v(J,null,{default:B(()=>[t("button",{class:"btn btn-sm btn-link",onClick:dt},"\u53C2\u8003")]),_:1}),v(J,null,{default:B(()=>[Y("ID: "+E(o(e)._id),1)]),_:1}),v(J,{flex:"1 1 auto"},{default:B(()=>[v(z,null,{default:B(()=>[L(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":$[0]||($[0]=i=>yt(e)?e.value=i:null)},[t("option",{value:o(c)()},"\u7A7A\u6A21\u7248",8,In),(p(!0),h(I,null,R(o(w),i=>(p(),h("option",{key:i._id,value:i},E(i.name),9,Tn))),128))],512),[[Pt,o(e)]]),t("button",{class:"btn btn-sm btn-primary",onClick:F},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:d},"\u590D\u5236"),o(e)._id?(p(),h("button",{key:0,class:"btn btn-sm btn-danger",onClick:A},"\u5220\u9664")):X("",!0),v(Cn,{onChange:m},{default:B(()=>[Hn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:j},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:K},"\u6E05\u7A7A")]),_:1})]),_:1}),v(J,null,{default:B(()=>[t("span",{class:"transform-tools-popover-close",onClick:$[1]||($[1]=i=>n("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Pn,[t("div",Jn,[t("div",Rn,[t("div",qn,[v(z,null,{default:B(()=>[Gn,L(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":$[2]||($[2]=i=>o(e).name=i)},null,512),[[at,o(e).name]])]),_:1})]),t("div",Nn,[(p(),h(I,null,R(k,i=>v(z,{key:i.n},{default:B(()=>[t("label",zn,E(i.t),1),t("div",Ln,[v(o(pt),{readonly:"",value:o(e)[i.n]},null,8,["value"]),t("div",On,"+"+E(o(u)[i.n]),1)])]),_:2},1024)),64))])]),t("div",Kn,[t("div",Qn,[v(z,null,{default:B(()=>[Xn,L(t("select",{class:"input input-select","onUpdate:modelValue":$[3]||($[3]=i=>o(e).stoneName=i)},[Wn,(p(!0),h(I,null,R(o(Lt),(i,b)=>(p(),h("option",{key:b,value:i.name},E(i.name),9,Zn))),128))],512),[[Pt,o(e).stoneName]])]),_:1})]),t("div",Yn,[v(z,null,{default:B(()=>[tu,v(o(pt),{value:o(e).hsQixue,"onUpdate:value":$[4]||($[4]=i=>o(e).hsQixue=i)},null,8,["value"])]),_:1}),v(z,null,{default:B(()=>[eu,v(o(pt),{value:o(e).hsPatt,"onUpdate:value":$[5]||($[5]=i=>o(e).hsPatt=i)},null,8,["value"])]),_:1}),v(z,null,{default:B(()=>[su,v(o(pt),{value:o(e).hsPdef,"onUpdate:value":$[6]||($[6]=i=>o(e).hsPdef=i)},null,8,["value"])]),_:1}),v(z,null,{default:B(()=>[nu,v(o(pt),{value:o(e).hsMatt,"onUpdate:value":$[7]||($[7]=i=>o(e).hsMatt=i)},null,8,["value"])]),_:1}),v(z,null,{default:B(()=>[uu,v(o(pt),{value:o(e).hsMdef,"onUpdate:value":$[8]||($[8]=i=>o(e).hsMdef=i)},null,8,["value"])]),_:1})])]),t("div",ou,[t("div",au,[lu,v(o(_t),{label:"?",inline:"",dir:"right"},{default:B(()=>[cu,iu,du]),_:1})]),t("div",ru,[(p(!0),h(I,null,R(o(e).scList,(i,b)=>(p(),h("div",{key:b,class:kt(["sc-props",{selected:U.value===i,s1:o(W).ATT===i.pos,s2:o(W).XUE===i.pos,s3:o(W).DEF===i.pos}]),onClick:a=>N(i),onContextmenu:Et(a=>i.v=void 0,["prevent"])},[i.v?(p(),h(I,{key:0},[i.v.qixue>0?(p(),h("span",_u,"\u6C14\u8840+"+E(i.v.qixue),1)):X("",!0),i.v.patt>0?(p(),h("span",fu,"\u7269\u653B+"+E(i.v.patt),1)):X("",!0),i.v.pdef>0?(p(),h("span",vu,"\u7269\u9632+"+E(i.v.pdef),1)):X("",!0),i.v.matt>0?(p(),h("span",hu,"\u6CD5\u653B+"+E(i.v.matt),1)):X("",!0),i.v.mdef>0?(p(),h("span",mu,"\u6CD5\u9632+"+E(i.v.mdef),1)):X("",!0),i.v.huixin>0?(p(),h("span",Fu,"\u4F1A\u5FC3+"+E(i.v.huixin),1)):X("",!0)],64)):(p(),h("span",bu,E(i.n),1))],42,pu))),128))]),(p(),lt(Nt,{to:"body"},[U.value?(p(),lt(o(_e),{key:0,show:T.value,"onUpdate:show":$[9]||($[9]=i=>T.value=i),position:U.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:M},null,8,["show","position"])):X("",!0)]))]),t("div",Bu,[$u,t("div",Cu,[(p(),h(I,null,R(k,(i,b)=>v(z,{key:b},{default:B(()=>[t("label",yu,E(i.t),1),t("div",xu,"+"+E(o(y)[b]),1)]),_:2},1024)),64))])]),t("div",gu,[wu,t("div",Eu,[(p(),h(I,null,R(q,(i,b)=>v(z,{key:b},{default:B(()=>[t("label",ku,E(i.t),1),v(o(pt),{value:o(e)[i.n],"onUpdate:value":a=>o(e)[i.n]=a,min:"0"},null,8,["value","onUpdate:value"])]),_:2},1024)),64))])]),t("div",Du,[Au,t("div",Su,[(p(),h(I,null,R(D,(i,b)=>v(z,{key:b},{default:B(()=>[t("label",Mu,E(i.t),1),v(o(xt),{modelValue:o(e)[i.c],"onUpdate:modelValue":a=>o(e)[i.c]=a,result:o(e)[i.r],"onUpdate:result":a=>o(e)[i.r]=a},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",Uu,[ju,t("div",Vu,[(p(),h(I,null,R(k,i=>v(z,{key:i.n},{default:B(()=>[t("label",Iu,E(i.t),1),t("div",Tu,E(o(l)[i.n]),1)]),_:2},1024)),64))])])])])],512)),[[ae,s.show]])}}});const Pu=nt(Hu,[["__scopeId","data-v-c5068b1e"]]);function vt(s){return(s%1>.5?Math.ceil:Math.floor)(s)}function Qt(s){const{basic:n,enemyState:e}=s,u={w:n.w,a:G(n.a),c:n.c,x:n.x,g:0,att:0};u.g=vt(n.w*n.c/100+u.a+u.x),u.att=n.w+u.g;const l={hp:G(e.hp),ra:G(e.ra),rb:G(e.rb),def:G(e.def),defExt:G(e.defExt),defGain:G(e.defGain)};return{b:u,e:l}}function Ju(s,n){const{b:e,e:u}=Qt(s),l={a1:n.a1,a2:n.a2,att:G(n.att),att2:G(n.att2),da:G(n.da),da2:G(n.da2),db:G(n.db),dc:G(n.dc),dx:G(n.dx),dx2:G(n.dx2),id:G(n.id),cd:G(n.cd),defGain:G(n.defGain),kz:n.kz||0},y=e.att*(100+l.att)/100,r=e.att*(100+l.att+l.att2)/100,c=(100+l.kz)/100,w=(100+l.da-u.ra)/100,x=(100+l.da+l.da2-u.ra)/100,C=(100+l.db-u.rb)/100,P=(100+l.dc)/100,f=(100+l.dx)/100,_=(100+l.dx+l.dx2)/100,k=(100+l.cd)/100,D=(100-l.id)/100,q=(100+u.defGain)/100,T=(100+u.defGain+l.defGain)/100,U=Math.max(0,Math.max(0,u.def*q+u.defExt)*D),N=Math.max(0,Math.max(0,u.def*T+u.defExt)*D),M=Math.max(1,y*c-U),F=Math.max(1,r*c-N),d=M*l.a1*w*C*f,A=vt(d*k),m=F*l.a2*x*C*P*_,j=vt(m*k);return{satt:y,satt2:r,r01:vt(d),r01c:A,r02:vt(m),r02c:j}}function Ru(s){const n=s.items||[],e=document.createElement("canvas");e.width=800,e.height=8+160+n.reduce((_,k)=>{let D=30;return D+=50,k.a1>0&&(D+=30),k.a2>0&&(D+=50),(k.a1>0||k.a2>0)&&(D+=20),k.a1>0&&k.a2>0&&(D+=20),D+=20,_+D},0)+8;const u=e.getContext("2d");if(!u)return;const l=s.basic,y=s.enemyState,{b:r}=Qt(s),c={x:0,y:0},w=(_,k,D)=>{D?(c.x+=_,c.y+=k):(c.x=_,c.y=k)},x=(_=0)=>{c.x=8+_*16},C=(_=0)=>{c.x=8,c.y+=_},P=(_,k="#222222")=>{u.save(),u.fillStyle=k;const{width:D}=u.measureText(_);u.fillText(_,c.x,c.y),c.x+=D+16,u.restore()},f=(_,...k)=>{u.save();const D=typeof _=="string"?_:_[0],q=typeof _=="string"?"#222222":_[1];u.fillStyle=q,u.font="bold 16px sans-serif";const{width:T}=u.measureText(D);u.fillText(D,c.x,c.y),c.x+=T+8,u.restore(),u.save(),u.font="16px sans-serif";for(const U of k){const N=typeof U=="string"?U:U[0],M=typeof U=="string"?"#ff4446":U[1];u.fillStyle=M;const{width:F}=u.measureText(N);u.fillText(N,c.x,c.y),c.x+=F+8}c.x+=8,u.restore()};u.fillStyle="#FBFFF0",u.fillRect(0,0,e.width,e.height),w(8,28),u.textBaseline="bottom",u.font="bold 20px sans-serif",P(s.title),C(40),u.font="bold 18px sans-serif",P("\u653B\u65B9:"),u.font="16px sans-serif",C(30),x(2),f("\u653B\u51FB:",`${l.w}`,[`+${r.g}`,"#55a14f"]),f("\u9B42\u77F3\u653B\u51FB:",`${l.a}`),f("\u9B42\u77F3\u653B\u51FB%:",`${l.c}`),f("\u661F\u4E4B\u6676\u653B\u51FB:",`${l.x}`),C(30),u.font="bold 18px sans-serif",P("\u5B88\u65B9:"),C(30),x(2),f("\u6C14\u8840:",`${y.hp}`),f("\u9632\u5FA1:",`${y.def}`),f("\u9632\u5FA1%:",`${y.defGain}`),f("\u9644\u52A0\u9632\u5FA1:",`${y.defExt}`),C(20),x(2),f("\u514D\u4F24A%:",`${y.ra}`),f("\u514D\u4F24B%:",`${y.rb}`),C(30);for(const _ of n){const{satt:k,satt2:D,r01:q,r01c:T,r02:U,r02c:N}=Ju(s,_);u.font="bold 18px sans-serif",P(_.name,"#a30000"),u.font="14px sans-serif",P(_.desc||"\u65E0\u63CF\u8FF0","#a30000"),u.font="16px sans-serif",f("\u514B\u5236:",`${_.kz||0}%`),C(30),x(2),f("\u653B\u51FB%:",`${_.att}`),f("\u7A7F\u900F%:",`${_.id}`),f("\u66B4\u4F24%:",`${_.cd}`),C(20),x(2),f("\u589E\u4F24A%:",`${_.da}`),f("\u589E\u4F24B%:",`${_.db}`),f("\u589E\u4F24X%:",`${_.dx}`),C(30),_.a1>0&&(x(2),f("\u6280\u80FD\u3001\u666E\u653B:",`${_.a1}\u500D`),f("\u653B\u51FB:",[`${vt(k)}`,"#b8860b"]),C(30)),_.a2>0&&(x(2),f("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${_.a2}\u500D`),f("\u653B\u51FB\u4FEE\u6B63%:",_.att2),f("\u9632\u5FA1\u4FEE\u6B63%:",_.defGain),f("\u653B\u51FB:",[`${vt(D)}`,"#b8860b"]),C(20),x(2),f("\u589E\u4F24C%:",_.dc),f("\u589E\u4F24A\u4FEE\u6B63%:",_.da2),f("\u589E\u4F24X\u4FEE\u6B63%:",_.dx2),C(30)),x(2),q>0&&f(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${q}`,"#b8860b"],[`${T}`,"#ff4446"]),U>0&&f(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${U}`,"#b8860b"],[`${N}`,"#ff4446"]),C(20),q>0&&U>0&&(x(2),f(["\u4E0D\u66B4\u51FB","#b8860b"],[`${q+U}`,"#ff4446"]),f(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${T+U}`,"#ff4446"]),f(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${q+N}`,"#ff4446"]),f(["\u5168\u66B4\u51FB","#b8860b"],[`${T+N}`,"#ff4446"]),C(20)),C(20)}e.toBlob(_=>{!_||window.open(URL.createObjectURL(_))})}function qu(){return{exportImage:Ru}}const it=s=>(At("data-v-ea213ffe"),s=s(),St(),s),Gu={class:"wrapper"},Nu={class:"toolbar"},zu={style:{padding:"6px 16px"}},Lu=Y("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Ou={class:"c-upload"},Ku=it(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Qu={style:{padding:"6px 16px"}},Xu={class:"input-group"},Wu=it(()=>t("div",{class:"input-ext"},"=",-1)),Zu={class:"content"},Yu={class:"container"},to=["value"],eo=Y(" \u2007 "),so=["onKeypress"],no={key:1},uo=["onClick"],oo=["onClick"],ao=["onClick"],lo=Y(" \u91CD\u547D\u540D "),co=["onClick"],io=Y(" \u590D\u5236 "),ro=["onClick"],po=["onClick"],_o=["onClick"],fo={style:{"text-align":"center"}},vo=it(()=>t("span",null,"\u7B49\u7EA7",-1)),ho=it(()=>t("span",null,"\u53CA\u8EAB",-1)),mo=it(()=>t("span",null,"\u661F\u8000",-1)),Fo=it(()=>t("span",null,"\u5316\u81FB",-1)),bo=it(()=>t("span",null,"\u661F\u9B42",-1)),Bo=it(()=>t("span",null,"\u661F\u8F89",-1)),$o=mt({__name:"Calculator",setup(s){const{exportImage:n}=qu(),e=ht({id:"",title:"",selecteds:[],search:""}),u=Z([]),l=et(()=>u.value.filter(b=>b.title.indexOf(e.search)>-1)),y=async()=>{const a={id:Rt(),title:"\u6A21\u677F",basic:Pe(),state:Re(),enemyState:Ne(),items:Ge()};await Ve(a),u.value.push(a)},r=async b=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const S=u.value.findIndex(H=>H.id===b);S!==-1&&(await Ie(u.value[S].id),u.value.splice(S,1))},c=async b=>{const a=e.title;if(!a){w();return}const S=u.value.findIndex(tt=>tt.id===b);if(S===-1)return;const H=u.value[S];H.title=a,w(),await wt(H)},w=()=>{e.id="",e.title=""},x=b=>{try{n(b)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},C=b=>{const a={type:"calculator",data:[b]},S=new Blob([JSON.stringify(a)],{type:"application/json"});It(S,`${b.title}.json`)},P=async b=>{u.value=b},f=b=>new Promise((a,S)=>{const H=new FileReader;H.onload=()=>{a(H.result)},H.onerror=()=>{S(H.error)},H.readAsText(b)}),_=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let a=l.value;e.selecteds.length>0&&(a=e.selecteds.map(S=>l.value[S]).filter(S=>S)),await He(a.map(S=>S.id)),i()},k=async b=>{const a=b.currentTarget,S=Array.prototype.slice.call(a.files);if(a.value="",!S||!S[0])return;const H=S[0],tt=await f(H),ot=JSON.parse(tt);let rt=[];if(pe(ot))rt=ot;else if(zt(ot)&&ot.type==="calculator")rt=ot.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Te(rt),i()},D=async()=>{let b="calculator.json",a=l.value;e.selecteds.length>0&&(a=e.selecteds.map(tt=>l.value[tt]).filter(tt=>tt),b="calculator-selected.json");const S={type:"calculator",data:a},H=new Blob([JSON.stringify(S)],{type:"application/json"});It(H,b)};async function q(b,a){const S=u.value.findIndex(tt=>tt.id===a);S===-1||!u.value[S]||(u.value[S]=b,await wt(b))}const T=Z(-1),U=ht({input:"2283/1.35*1.39",result:0}),{translate:N,level:M,xingyao:F,huazhen:d,xinghun:A,xinghui:m}=re(),j=b=>Math.ceil(b),K=ht({show:!1}),Ft=b=>{const a=N(b);dt.value&&dt.value(b,a)},dt=Z(),V=Z(!1),$=Z(),J=b=>{V.value=!0,$.value=b},z=({item:b})=>{if(V.value=!1,$.value){const a=$.value,S=N(b);a.title==="\u6A21\u677F"&&(a.title=b.name),a.basic.w=Math.max(S.patt,S.matt),wt(a)}else Ft(b)},$t=b=>{const a=Dt.cloneDeep(b);a.id=Rt(),console.log(a),u.value.push(a),wt(a)};async function i(){const b=await je();e.selecteds=[],P(b)}return le(()=>{i()}),(b,a)=>{const S=ft("c-col"),H=ft("c-row"),tt=ft("calc-input"),ot=ft("c-space"),rt=Gt("autofocus");return p(),h("div",Gu,[t("div",Nu,[t("div",zu,[v(H,{flex:"",middle:"",gutter:16},{default:B(()=>[v(S,{flex:"0 0 auto"},{default:B(()=>[Lu]),_:1}),v(S,{flex:"0 0 auto"},{default:B(()=>[t("button",{class:"btn btn-sm btn-link",onClick:a[0]||(a[0]=g=>K.show=!K.show)},"\u9762\u677F"),e.selecteds.length>0?(p(),h("button",{key:0,class:"btn btn-success",onClick:a[1]||(a[1]=g=>e.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):X("",!0)]),_:1}),v(S,{flex:"1 1 0"},{default:B(()=>[L(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":a[2]||(a[2]=g=>e.search=g)},null,512),[[at,e.search]])]),_:1}),v(S,{flex:"0 0 auto"},{default:B(()=>[t("button",{class:"btn btn-danger",onClick:_},E(e.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Ou,[Ku,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:k},null,32)]),t("button",{class:"btn btn-success",onClick:D},E(e.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:a[3]||(a[3]=g=>y())},"\u6DFB\u52A0")]),_:1})]),_:1}),v(Pu,{show:K.show,"onUpdate:show":a[4]||(a[4]=g=>K.show=g),onReference:a[5]||(a[5]=g=>J()),onInit:a[6]||(a[6]=g=>dt.value=g)},null,8,["show"])]),t("div",Qu,[t("div",Xu,[v(tt,{modelValue:U.input,"onUpdate:modelValue":a[7]||(a[7]=g=>U.input=g),result:U.result,"onUpdate:result":a[8]||(a[8]=g=>U.result=g),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Wu,v(Ut,{readonly:"",value:j(U.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",Zu,[t("div",Yu,[(p(!0),h(I,null,R(o(l),(g,gt)=>(p(),lt(o(de),{key:g.id,activeKey:gt===T.value,onToggle:Q=>T.value=Q?gt:-1},{header:B(()=>[v(H,{flex:"",middle:""},{default:B(()=>[v(S,null,{default:B(()=>[L(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":a[9]||(a[9]=Q=>e.selecteds=Q),value:gt,onClick:a[10]||(a[10]=Et(()=>{},["stop"]))},null,8,to),[[Ct,e.selecteds]]),eo]),_:2},1024),v(S,null,{default:B(()=>[e.id===g.id?L((p(),h("input",{key:0,type:"text",class:"input","onUpdate:modelValue":a[11]||(a[11]=Q=>e.title=Q),onClick:a[12]||(a[12]=Et(()=>{},["stop"])),onKeypress:Vt(Q=>c(g.id),["enter"])},null,40,so)),[[at,e.title],[rt]]):(p(),h("span",no,E(g.title),1))]),_:2},1024),v(S,{class:"ml-4",onClick:a[13]||(a[13]=Et(()=>{},["stop"]))},{default:B(()=>[e.id===g.id?(p(),h("button",{key:0,class:"btn btn-sm btn-link",onClick:Q=>c(g.id)},"\u786E\u8BA4",8,uo)):(p(),h(I,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:Q=>J(g)},"\u9009\u62E9",8,oo),t("button",{class:"btn btn-sm btn-link",onClick:Q=>{e.id=g.id,e.title=g.title}},[v(o(Me),{class:"svg-icon"}),lo],8,ao),t("button",{class:"btn btn-sm btn-link",onClick:Q=>$t(g)},[v(o(Ot),{class:"svg-icon"}),io],8,co)],64))]),_:2},1024)]),_:2},1024)]),actions:B(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:Q=>x(g)},"\u5BFC\u51FA\u56FE\u50CF",8,ro),t("button",{class:"btn btn-sm btn-success-outline",onClick:Q=>C(g)},"\u5BFC\u51FA",8,po),t("button",{class:"btn btn-sm btn-danger-outline",onClick:Q=>r(g.id)},"\u5220\u9664",8,_o)]),default:B(()=>[gt===T.value?(p(),lt(o(nn),{key:0,data:g,"onUpdate:data":Q=>q(Q,g.id)},null,8,["data","onUpdate:data"])):X("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),v(o(hn),{show:V.value,"onUpdate:show":a[20]||(a[20]=g=>V.value=g),onClick:z},{extra:B(()=>[t("div",fo,[v(ot,null,{default:B(()=>[t("label",null,[vo,v(Ut,{class:"mini-input",min:"0",max:"70",value:o(M).v,"onUpdate:value":a[14]||(a[14]=g=>o(M).v=g)},null,8,["value"])]),t("label",null,[ho,v(Ut,{class:"mini-input",min:"0",max:"16",value:o(M).eq,"onUpdate:value":a[15]||(a[15]=g=>o(M).eq=g)},null,8,["value"])]),t("label",null,[mo,L(t("input",{type:"checkbox","onUpdate:modelValue":a[16]||(a[16]=g=>yt(F)?F.value=g:null)},null,512),[[Ct,o(F)]])]),t("label",null,[Fo,L(t("input",{type:"checkbox","onUpdate:modelValue":a[17]||(a[17]=g=>yt(d)?d.value=g:null)},null,512),[[Ct,o(d)]])]),t("label",null,[bo,L(t("input",{type:"checkbox","onUpdate:modelValue":a[18]||(a[18]=g=>yt(A)?A.value=g:null)},null,512),[[Ct,o(A)]])]),t("label",null,[Bo,L(t("input",{type:"checkbox","onUpdate:modelValue":a[19]||(a[19]=g=>yt(m)?m.value=g:null)},null,512),[[Ct,o(m)]])])]),_:1})])]),_:1},8,["show"])])}}});const So=nt($o,[["__scopeId","data-v-ea213ffe"]]);export{So as default};
