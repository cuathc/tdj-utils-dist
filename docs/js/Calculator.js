import{_ as N,E as Ye,o as v,c as b,e as s,G as xe,H as et,I as tt,J as st,K as re,d as Q,s as R,L as He,M as K,j as ue,n as Be,f as M,N as nt,O as we,q as W,a as E,g as o,h as r,w as q,B as se,F as P,r as T,k as U,i as X,P as Pe,A as O,p as pe,l as ve,Q as qe,R as ot,S as le,b as ie,T as at,U as l,V as lt,z as ut,W as it,X as dt,v as Ue,Y as H,Z as ct,u as rt,C as he}from"./index.js";import{_ as ce}from"./lodash.js";import{u as pt}from"./useHeroes.js";import vt from"./InputNumber.js";import{b as Te,d as ye,a as mt,i as _t}from"./shared.js";import{s as Ne}from"./data.js";const ft=["width","height"],ht=s("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),bt=[ht];function $t(e,t,n,f,m,p){return v(),b("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},bt,8,ft)}const gt=N(Ye,[["render",$t]]),Ct=["width","height"],yt=s("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),Ft=[yt];function Bt(e,t,n,f,m,p){return v(),b("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},Ft,8,Ct)}const wt=N(xe,[["render",Bt]]),kt=["width","height"],Dt=s("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Et=[Dt];function St(e,t,n,f,m,p){return v(),b("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},Et,8,kt)}const Mt=N(et,[["render",St]]),Ut=["width","height"],At=s("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),It=[At];function Vt(e,t,n,f,m,p){return v(),b("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},It,8,Ut)}const Re=N(tt,[["render",Vt]]),Ht=["width","height"],Pt=s("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),qt=[Pt];function Tt(e,t,n,f,m,p){return v(),b("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},qt,8,Ht)}const Nt=N(st,[["render",Tt]]);let Ce=0,Ae=0;const Rt=500;function Ie(){const e=Math.floor(new Date().getTime()/1e3);Ae===e?Ce++:Ce=0,Ae=e;const t=e.toString(16);return`${(Rt<<16|Ce&255).toString(16)}.${t}`}async function Ot(){try{return await re.getAll("calculator")}catch{return[]}}async function jt(){try{await re.clear("calculator")}catch(e){alert(e.message)}}async function Kt(e){try{await re.add("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function de(e){try{await re.put("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function Ve(e){try{await re.delete("calculator",e)}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}function Gt(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Lt(){return{a:0}}function Qt(){return{att:0,k:0}}function Oe(){return{a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",name:"1.5\u6280\u80FD",att2:"0",da2:"0",dx2:"0",defGain:"0"}}function zt(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Jt(){return[Oe()]}function Wt(){return{hp:"10000",def:"1872",defGain:"15+5",ra:"0",rb:"4+10"}}const Xt=Q({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(e,{emit:t}){const n=R(),f=R({}),m=R(e.active),p=()=>{const c=n.value.getBoundingClientRect();switch(m.value=!0,t("update:active",m.value),e.dir){case"left":f.value={top:`${c.top+c.height/2}px`,right:`${window.innerWidth-c.left-4}px`,maxWidth:"100%"};break;case"right":f.value={top:`${c.top+c.height/2}px`,left:`${c.right+4}px`,maxWidth:"100%"};break;case"top":f.value={bottom:`${window.innerHeight-c.top-4}px`,left:`${c.left+c.width/2}px`,maxWidth:"100%"};break;default:f.value={top:`${c.bottom+4}px`,left:`${c.left+c.width/2}px`,maxWidth:"100%"}}};let d;const w=()=>{d=setTimeout(p,e.wait)},k=()=>{clearTimeout(d),m.value=!1,t("update:active",m.value)};return He(()=>e.active,D=>{m.value=D}),{el:n,style:f,tActive:m,onEnter:w,onOut:k}}});const Zt={class:"c-tooltip-label"};function Yt(e,t,n,f,m,p){return v(),b("div",{ref:"el",class:ue(["c-tooltip",{active:e.tActive,inline:e.inline}]),onMouseenter:t[0]||(t[0]=(...d)=>e.onEnter&&e.onEnter(...d)),onMouseout:t[1]||(t[1]=(...d)=>e.onOut&&e.onOut(...d))},[K(e.$slots,"label",{},()=>[s("div",Zt,M(e.label),1)]),s("div",{class:ue(["c-tooltip-inner",e.dir?`c-tooltip-${e.dir}`:"c-tooltip-bottom",e.color?`c-tooltip-${e.color}`:""]),style:Be(e.style)},[K(e.$slots,"default")],6)],34)}const ke=N(Xt,[["render",Yt]]),xt=Q({components:{Divider:nt,Tooltip:ke,CalcInput:we,IconUp:wt,IconDown:Mt,IconClose:gt,IconCopy:Re},props:{panel:{type:Object,required:!0},state:{type:Object,required:!0},enemyState:{type:Object,required:!0},itemState:{type:Object,required:!0},showUp:Boolean,showDown:Boolean},emits:["update:itemState","close","up","down","copy"],setup(e,{emit:t}){const n=W({editor:!1,name:""}),f=(a,y)=>{if(a==="name")return;const A=e.itemState;switch(a){case"a1":case"a2":typeof y=="number"&&(A[a]=y);break;default:typeof y=="string"&&(A[a]=y)}t("update:itemState",A)},m=W(zt()),p=E({set:a=>f("a1",a),get:()=>e.itemState.a1}),d=E({set:a=>f("a2",a),get:()=>e.itemState.a2}),w=E({set:a=>f("att",a),get:()=>e.itemState.att}),k=E({set:a=>f("id",a),get:()=>e.itemState.id}),D=E({set:a=>f("da",a),get:()=>e.itemState.da}),c=E({set:a=>f("db",a),get:()=>e.itemState.db}),$=E({set:a=>f("dc",a),get:()=>e.itemState.dc}),V=E({set:a=>f("dx",a),get:()=>e.itemState.dx}),j=E({set:a=>f("cd",a),get:()=>e.itemState.cd}),_=E({set:a=>f("att2",a),get:()=>e.itemState.att2}),I=E({set:a=>f("da2",a),get:()=>e.itemState.da2}),G=E({set:a=>f("dx2",a),get:()=>e.itemState.dx2}),L=E({set:a=>f("defGain",a),get:()=>e.itemState.defGain}),C=W({a1:p,a2:d,att:w,da:D,db:c,dc:$,dx:V,id:k,cd:j,att2:_,da2:I,dx2:G,defGain:L}),g=E(()=>{const{state:a}=e,y=(100+m.att)/100;return Math.ceil(a.att*y)}),h=E(()=>{const{state:a}=e,y=(100+m.att+m.att2)/100;return Math.ceil(a.att*y)}),u=()=>{const{state:a,enemyState:y}=e,A=(100+a.k)/100,J=(100+m.da-y.ra)/100,te=(100+m.da+m.da2-y.ra)/100,oe=(100+m.db-y.rb)/100,ae=(100+m.dc)/100,fe=(100+m.dx)/100,ge=(100+m.dx+m.dx2)/100,De=(100+m.cd)/100,Ee=(100-m.id)/100,Ge=(100+y.defGain)/100,Le=(100+y.defGain+m.defGain)/100,Qe=Math.max(0,Math.max(0,y.def*Ge)*Ee),ze=Math.max(0,Math.max(0,y.def*Le)*Ee),Je=Math.max(1,g.value*A-Qe),We=Math.max(1,h.value*A-ze),Se=Je*p.value*J*oe*fe,Xe=Math.ceil(Se*De),Me=We*d.value*te*oe*ae*ge,Ze=Math.ceil(Me*De);return{r01:Math.ceil(Se),r01c:Xe,r02:Math.ceil(Me),r02c:Ze}},B=E(()=>u().r01),z=E(()=>u().r01c),Y=E(()=>u().r02),i=E(()=>u().r02c);u();function x(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&t("close")}function ee(){n.editor=!0,n.name=e.itemState.name}function be(){const a=n.name;if(n.editor=!1,n.name="",!a)return;const y=e.itemState;y.name=a,t("update:itemState",y)}function $e(){t("up")}function _e(){t("down")}function F(){t("copy")}return{vars:n,values:C,result:m,satt:g,r01:B,r01c:z,r02:Y,r02c:i,onClose:x,onRename:ee,onNameEnter:be,onUp:$e,onDown:_e,onCopy:F}}});const Z=e=>(pe("data-v-51aeb895"),e=e(),ve(),e),es={class:"row"},ts={class:"col-item"},ss=Z(()=>s("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ns=O(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),os={class:"input-group"},as=["step"],ls=Z(()=>s("div",{class:"input-ext"},"\u500D",-1)),us={class:"label"},is={class:"input-group"},ds=Z(()=>s("div",{style:{clear:"both"}},null,-1)),cs={class:"col-item"},rs=Z(()=>s("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),ps=O(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),vs={class:"input-group"},ms=["step"],_s=Z(()=>s("div",{class:"input-ext"},"\u500D",-1)),fs={class:"label"},hs={class:"input-group"},bs={class:"col-item"},$s=Z(()=>s("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),gs={class:"static-control text-center"},Cs={class:"darkgold"},ys=Z(()=>s("div",{style:{clear:"both"}},null,-1)),Fs={class:"label"},Bs={class:"bold darkgold"},ws=Z(()=>s("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),ks={class:"static-control text-center"},Ds={class:"bold darkgold"},Es={class:"bold red"},Ss={class:"label bold"},Ms={class:"static-control text-center"},Us={class:"bold darkgold"},As={key:0,class:"bold red"};function Is(e,t,n,f,m,p){const d=U("IconCopy"),w=U("IconUp"),k=U("IconDown"),D=U("IconClose"),c=U("Divider"),$=U("Tooltip"),V=U("CalcInput"),j=qe("autofocus");return v(),b(P,null,[o(c,{orientation:"left"},{action:r(()=>[s("span",{onClick:t[4]||(t[4]=(..._)=>e.onCopy&&e.onCopy(..._))},[o(d,{class:"close"})]),e.showUp?(v(),b("span",{key:0,onClick:t[5]||(t[5]=(..._)=>e.onUp&&e.onUp(..._))},[o(w,{class:"close"})])):X("",!0),e.showDown?(v(),b("span",{key:1,onClick:t[6]||(t[6]=(..._)=>e.onDown&&e.onDown(..._))},[o(k,{class:"close"})])):X("",!0),s("span",{onClick:t[7]||(t[7]=(..._)=>e.onClose&&e.onClose(..._))},[o(D,{class:"close"})])]),default:r(()=>[e.vars.editor?q((v(),b("input",{key:0,class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=_=>e.vars.name=_),onKeypress:t[1]||(t[1]=Pe((..._)=>e.onNameEnter&&e.onNameEnter(..._),["enter"])),onBlur:t[2]||(t[2]=(..._)=>e.onNameEnter&&e.onNameEnter(..._))},null,544)),[[se,e.vars.name],[j]]):(v(),b("span",{key:1,class:"calc-item-title",onClick:t[3]||(t[3]=(..._)=>e.onRename&&e.onRename(..._))},M(e.itemState.name||"\u6A21\u677F"),1))]),_:1}),s("div",es,[s("div",ts,[o($,{dir:"top"},{label:r(()=>[ss]),default:r(()=>[ns]),_:1}),s("div",os,[q(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[8]||(t[8]=_=>e.values.a1=_)},null,8,as),[[se,e.values.a1,void 0,{number:!0}]]),ls])]),(v(),b(P,null,T([{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],_=>s("div",{class:"col-item",key:_.name},[o($,{dir:"top"},{label:r(()=>[s("div",us,M(_.label),1)]),default:r(()=>[O(" "+M(_.tip),1)]),_:2},1024),s("div",is,[o(V,{class:"input",modelValue:e.values[_.name],"onUpdate:modelValue":I=>e.values[_.name]=I,result:e.result[_.name],"onUpdate:result":I=>e.result[_.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),ds,s("div",cs,[o($,{dir:"top"},{label:r(()=>[rs]),default:r(()=>[ps]),_:1}),s("div",vs,[q(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[9]||(t[9]=_=>e.values.a2=_)},null,8,ms),[[se,e.values.a2,void 0,{number:!0}]]),_s])]),(v(),b(P,null,T([{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],_=>s("div",{class:"col-item",key:_.name},[o($,{dir:"top"},{label:r(()=>[s("div",fs,M(_.label),1)]),default:r(()=>[O(" "+M(_.tip),1)]),_:2},1024),s("div",hs,[o(V,{class:"input",modelValue:e.values[_.name],"onUpdate:modelValue":I=>e.values[_.name]=I,result:e.result[_.name],"onUpdate:result":I=>e.result[_.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),s("div",bs,[$s,s("div",gs,[s("span",Cs,M(e.satt),1)])]),ys,(v(!0),b(P,null,T([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:e.r01,v2:e.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:e.r02,v2:e.r02c}],(_,I)=>(v(),b("div",{class:"col-item",key:I},[s("div",Fs,[s("span",Bs,M(_.label),1),ws]),s("div",ks,[s("span",Ds,M(_.v),1),s("span",Es,"("+M(_.v2)+")",1)])]))),128)),(v(!0),b(P,null,T([{label:"\u4E0D\u66B4\u51FB",value:e.r01+e.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:e.r01c+e.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:e.r01+e.r02c},{label:"\u5168\u66B4\u51FB",value:e.r01c+e.r02c}],(_,I)=>(v(),b("div",{class:"col-item",key:I},[s("div",Ss,M(_.label),1),s("div",Ms,[s("span",Us,M(_.value),1),(+e.enemyState.hp||0)<=_.value?(v(),b("span",As," \u51FB\u6740 ")):X("",!0)])]))),128))])],64)}const Vs=N(xt,[["render",Is],["__scopeId","data-v-51aeb895"]]),Hs=["onClick"],Ps=Q({__name:"dropdown",props:{pos:{default:"lt"}},setup(e){const t=R(!1),n=()=>{t.value=!0},f=()=>{t.value=!1};return window.addEventListener("click",f,!1),ot(()=>{window.removeEventListener("click",f,!1)}),(m,p)=>(v(),b("div",{class:ue(["dropdown",[{active:t.value}]]),onClick:le(n,["stop"])},[K(m.$slots,"default",{},void 0,!0),s("div",{class:ue(["dropdown-popover",["dropdown-"+e.pos]]),onClick:p[0]||(p[0]=le(()=>{},["stop"]))},[K(m.$slots,"popover",{onClose:f},void 0,!0)],2)],10,Hs))}});const je=N(Ps,[["__scopeId","data-v-3bf2fdb0"]]);je.install=e=>{e.component("dropdown",Ke)};const Ke=je,qs=Q({components:{CalcItem:Vs,CalcInput:we,Tooltip:ke,Dropdown:Ke},props:{data:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const n=E(()=>e.data.basic),f=E(()=>e.data.state),m=E(()=>e.data.enemyState),p=E(()=>e.data.items),d=W(Lt()),w=W({hp:0,def:0,defGain:0,ra:0,rb:0}),k=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],D=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],c=()=>{const g=n.value.c/100;n.value.g=Math.ceil(d.a+n.value.w*g+n.value.x),f.value.att=n.value.w+n.value.g},$=async()=>{t("update:data",e.data)},V=(g,h)=>{h==="panel"&&c(),$()},j=(g,h)=>{const u=e.data.items;!u||(u[h]=g,$())},_=()=>{const g=e.data.items;!g||(g.push(Oe()),$())},I=g=>{const h=e.data.items;!h||(h.splice(g,1),$())},G=g=>{const h=e.data.items;if(!h)return;const u=h[g],B=h[g-1];h[g-1]=u,h[g]=B,$()},L=g=>{const h=e.data.items;if(!h)return;const u=h[g],B=h[g+1];h[g+1]=u,h[g]=B,$()},C=g=>{const h=e.data.items;if(!h)return;const u=h[g];h.push(ce.cloneDeep(u)),$()};return He(()=>[e.data.basic.w],()=>{c()}),{panel:n,state:f,enemyState:m,panelResult:d,enemyStateResult:w,panelModels:k,enemyModels:D,update:V,items:p,updateItemState:j,addItem:_,delItem:I,upItem:G,downItem:L,copyItem:C}}});const ne=e=>(pe("data-v-910b1719"),e=e(),ve(),e),Ts=ne(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Ns={class:"row"},Rs={class:"label"},Os={class:"input-group"},js=["step","onUpdate:modelValue","onChange"],Ks=["value"],Gs={class:"col-item"},Ls=ne(()=>s("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Qs={class:"static-control text-center"},zs={class:"darkgold"},Js={class:"col-item"},Ws=ne(()=>s("div",{class:"label"},"\u514B\u5236%",-1)),Xs=O(" \u514B\u523630%"),Zs=ne(()=>s("br",null,null,-1)),Ys=O("\u88AB\u514B\u5236-25%"),xs=ne(()=>s("br",null,null,-1)),en=O("\u6FC0\u836150% "),tn=["onClick"],sn=ne(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),nn={class:"row"},on={class:"label"},an={class:"input-group"},ln={key:0,class:"input-ext"},un={class:"heading"},dn=ne(()=>s("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),cn={class:"heading-actions"};function rn(e,t,n,f,m,p){const d=U("CalcInput"),w=U("Tooltip"),k=U("Dropdown"),D=U("CalcItem");return v(),b("div",null,[Ts,s("div",Ns,[(v(!0),b(P,null,T(e.panelModels,c=>(v(),b("div",{class:"col-item",key:c.name},[s("div",Rs,M(c.label),1),s("div",Os,[c.name in e.panelResult?(v(),ie(d,{key:0,modelValue:e.panel[c.name],"onUpdate:modelValue":$=>e.panel[c.name]=$,result:e.panelResult[c.name],"onUpdate:result":$=>e.panelResult[c.name]=$,onChange:$=>e.update(c.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):q((v(),b("input",{key:1,type:"number",class:"input",style:Be({textAlign:c.align}),min:"0",step:c.step,"onUpdate:modelValue":$=>e.panel[c.name]=$,onChange:$=>e.update(c.name,"panel")},null,44,js)),[[se,e.panel[c.name],void 0,{number:!0}]]),c.name==="w"?(v(),b("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${e.panel.g}`},null,8,Ks)):X("",!0)])]))),128)),s("div",Gs,[Ls,s("div",Qs,[s("span",zs,M(e.state.att),1)])]),s("div",Js,[o(w,{dir:"top"},{label:r(()=>[Ws]),default:r(()=>[Xs,Zs,Ys,xs,en]),_:1}),s("div",null,[o(k,null,{popover:r(({onClose:c})=>[s("div",{class:"list",onClick:()=>{c(),e.update("k","state")}},[s("div",{class:"list-item",onClick:t[2]||(t[2]=$=>e.state.k=0)},"\u666E\u901A"),s("div",{class:"list-item",onClick:t[3]||(t[3]=$=>e.state.k=30)},"\u514B\u5236"),s("div",{class:"list-item",onClick:t[4]||(t[4]=$=>e.state.k=-25)},"\u88AB\u514B\u5236"),s("div",{class:"list-item",onClick:t[5]||(t[5]=$=>e.state.k=50)},"\u6FC0\u8361")],8,tn)]),default:r(()=>[q(s("input",{class:"input",type:"number","onUpdate:modelValue":t[0]||(t[0]=c=>e.state.k=c),onChange:t[1]||(t[1]=c=>e.update("k","state")),list:"d1"},null,544),[[se,e.state.k,void 0,{number:!0}]])]),_:1})])])]),sn,s("div",nn,[(v(!0),b(P,null,T(e.enemyModels,c=>(v(),b("div",{class:"col-item",key:c.name},[s("div",on,M(c.label),1),s("div",an,[o(d,{modelValue:e.enemyState[c.name],"onUpdate:modelValue":$=>e.enemyState[c.name]=$,result:e.enemyStateResult[c.name],"onUpdate:result":$=>e.enemyStateResult[c.name]=$,onChange:$=>e.update(c.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),c.precent?(v(),b("div",ln,"%")):X("",!0)])]))),128))]),s("div",un,[dn,s("div",cn,[s("div",{class:"btn btn-primary btn-sm",onClick:t[6]||(t[6]=(...c)=>e.addItem&&e.addItem(...c))},"\u6DFB\u52A0")])]),(v(!0),b(P,null,T(e.items,(c,$)=>(v(),ie(D,{key:c,panel:e.panel,state:e.state,enemyState:e.enemyStateResult,itemState:c,showUp:$>0,showDown:e.items&&$<e.items.length-1,"onUpdate:itemState":V=>e.updateItemState(V,$),onClose:V=>e.delItem($),onUp:V=>e.upItem($),onDown:V=>e.downItem($),onCopy:V=>e.copyItem($)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))])}const pn=N(qs,[["render",rn],["__scopeId","data-v-910b1719"]]),vn=Q({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(e,{emit:t}){return{wrapClass:E(()=>["c-action-sheet-wrapper",e.class,{show:e.show}]),onClick:(p,d)=>{t("click",{item:p,index:d}),t("close",!1)},onClose:()=>{t("update:show",!1),t("close",!1)}}}});const mn={class:"c-action-sheet-section"},_n={class:"c-action-sheet-extra"},fn={class:"c-action-sheet-list"},hn=["onClick"];function bn(e,t,n,f,m,p){return v(),ie(at,{to:"body"},[s("div",{class:ue(e.wrapClass)},[s("div",{class:"c-action-sheet-mask",onClick:t[0]||(t[0]=(...d)=>e.onClose&&e.onClose(...d))}),s("div",mn,[s("div",{class:"c-action-sheet-body",style:Be({maxHeight:e.height})},[s("div",_n,[K(e.$slots,"extra")]),s("div",fn,[(v(!0),b(P,null,T(e.list,(d,w)=>(v(),b("div",{class:"c-action-sheet-item",key:w,onClick:k=>e.onClick(d,w)},[K(e.$slots,"default",{record:d})],8,hn))),128))])],4)])],2)])}const Fe=N(vn,[["render",bn]]);Fe.install=e=>{e.component("action-sheet",Fe)};const $n={class:"hero-item"},gn=["src","alt","title"],Cn={class:"hero-item-label"},yn=Q({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(e,{emit:t}){const{heroes:n,getHeroIcon:f}=pt(),m=p=>{t("click",p)};return(p,d)=>(v(),ie(l(Fe),{class:"hero-select",show:e.show,list:l(n),height:"80vh",onClick:m,"onUpdate:show":d[0]||(d[0]=w=>p.$emit("update:show",w))},{extra:r(()=>[K(p.$slots,"extra")]),default:r(({record:w})=>[s("div",$n,[s("img",{src:l(f)(w),alt:w.name,title:w.name,width:"128",height:"128"},null,8,gn),s("div",Cn,M(w.name),1)])]),_:3},8,["show","list"]))}});const Fn=Q({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(e,{emit:t}){const n=E({get:()=>e.activeKey,set:m=>{t("update:activeKey",m)}});return{active:n,toggle:()=>{const m=!n.value;n.value=m,t("toggle",m)}}}});const Bn=e=>(pe("data-v-829ec263"),e=e(),ve(),e),wn=Bn(()=>s("div",{class:"panel-icon"},[s("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[s("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),kn={class:"panel-title"},Dn={class:"panel-body"},En={class:"panel-content"};function Sn(e,t,n,f,m,p){return v(),b("div",{class:ue(["panel",{active:e.active}])},[s("div",{class:"panel-header",onClick:t[1]||(t[1]=(...d)=>e.toggle&&e.toggle(...d))},[wn,s("div",kn,[K(e.$slots,"header",{},()=>[O(M(e.header)+"\xA0",1)],!0)]),s("div",{class:"panel-actions",onClick:t[0]||(t[0]=le(()=>{},["stop"]))},[K(e.$slots,"actions",{},void 0,!0)])]),s("div",Dn,[s("div",En,[K(e.$slots,"default",{},void 0,!0)])])],2)}const Mn=N(Fn,[["render",Sn],["__scopeId","data-v-829ec263"]]);function Un(){const e="red_team",t=lt(),n=R([]),f=async k=>await t.put(e,k).then(D=>{if(n.value.findIndex(c=>c._id===D)===-1){const c=ce.cloneDeep(k);c._id=D,n.value.push(c)}return D}),m=async k=>await t.delete(e,k._id).then(()=>{n.value=n.value.filter(D=>D._id!==k._id)}),p=async k=>{const D=JSON.parse(await k.text());if(!Te(D)||D.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const c=D.data;for(const $ of c)await f($)},d=async()=>{const k={type:"red_team",data:n.value},D=new Blob([JSON.stringify(k)],{type:"application/json"});ye(D,"red_team.json")};return(async()=>{const k=await t.getAll(e).catch(()=>[]);console.log(k),n.value=k})(),{put:f,del:m,list:n,importData:p,exportData:d}}function An(){const e=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,xQixue:0,xPatt:0,xPdef:0,xMatt:0,xMdef:0,xHuixin:0,cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),t=R(e()),n=E(()=>{const p={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},d=Ne.find(k=>t.value.stoneName===k.name);d&&(p.qixue=d.t[0]+d.d[0]+d.h[0],p.patt=d.t[1]+d.d[1]+d.h[1],p.matt=d.t[2]+d.d[2]+d.h[2],p.pdef=d.t[3]+d.d[3]+d.h[3],p.mdef=d.t[4]+d.d[4]+d.h[4]);const w={qixue:t.value.hsQixue/100,patt:t.value.hsPatt/100,pdef:t.value.hsPdef/100,matt:t.value.hsMatt/100,mdef:t.value.hsMdef/100,huixin:t.value.hsHuixin/100};return{qixue:Math.round(t.value.qixue*w.qixue+p.qixue+t.value.xQixue),patt:Math.round(t.value.patt*w.patt+p.patt+t.value.xPatt),pdef:Math.round(t.value.pdef*w.pdef+p.pdef+t.value.xPdef),matt:Math.round(t.value.matt*w.matt+p.matt+t.value.xMatt),mdef:Math.round(t.value.mdef*w.mdef+p.mdef+t.value.xMdef),huixin:Math.round(t.value.huixin*w.huixin+p.huixin+t.value.xHuixin)}}),f=E(()=>{const p=n.value,d={qixue:(100+t.value.rQixue)/100,patt:(100+t.value.rPatt)/100,pdef:(100+t.value.rPdef)/100,matt:(100+t.value.rMatt)/100,mdef:(100+t.value.rMdef)/100,huixin:(100+t.value.rHuixin)/100};return{qixue:Math.round((t.value.qixue+p.qixue)*d.qixue),patt:Math.round((t.value.patt+p.patt)*d.patt),pdef:Math.round((t.value.pdef+p.pdef)*d.pdef),matt:Math.round((t.value.matt+p.matt)*d.matt),mdef:Math.round((t.value.mdef+p.mdef)*d.mdef),huixin:Math.round((t.value.huixin+p.huixin)*d.huixin)}});return{state:t,pValue:n,ckValue:f,reset:()=>{t.value=e()},defState:e}}const In={},Vn={class:"c-upload"};function Hn(e,t){return v(),b("div",Vn,[K(e.$slots,"default",{},void 0,!0),s("input",ut({type:"file",class:"c-upload-input",accept:"application/json"},e.$attrs),null,16)])}const Pn=N(In,[["render",Hn],["__scopeId","data-v-b3879154"]]),S=e=>(pe("data-v-2ca0f66a"),e=e(),ve(),e),qn={class:"transform-tools-popover"},Tn={class:"transform-tools-popover-toolbar"},Nn=["value"],Rn=["value"],On=S(()=>s("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),jn={class:"transform-tools-popover-content"},Kn={class:"grid-group"},Gn={class:"grid-group-item"},Ln={class:"input-group-title"},Qn=S(()=>s("span",null,"\u57FA\u7840",-1)),zn={class:"grids"},Jn=S(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),Wn=S(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),Xn=S(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),Zn=S(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),Yn=S(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),xn=S(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),eo={class:"grid-group-item"},to={class:"input-group-title"},so=S(()=>s("span",null,"\u9B42\u77F3",-1)),no=S(()=>s("option",{value:""},"\u65E0",-1)),oo=["value"],ao={class:"grids"},lo=S(()=>s("label",{class:"input-label"},"\u6C14\u8840%",-1)),uo=S(()=>s("label",{class:"input-label"},"\u7269\u653B%",-1)),io=S(()=>s("label",{class:"input-label"},"\u7269\u9632%",-1)),co=S(()=>s("label",{class:"input-label"},"\u6CD5\u653B%",-1)),ro=S(()=>s("label",{class:"input-label"},"\u6CD5\u9632%",-1)),po={class:"grid-group-item"},vo={class:"input-group-title"},mo=O(" \u661F\u4E4B\u6676 "),_o=S(()=>s("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C70\u9632",-1)),fo=S(()=>s("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C70\u9632\uFF0C88\u653B",-1)),ho=S(()=>s("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),bo={class:"grids"},$o=S(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),go=S(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),Co=S(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),yo=S(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),Fo=S(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),Bo=S(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),wo={class:"grid-group-item"},ko=S(()=>s("div",{class:"input-group-title"},"\u9762\u677F",-1)),Do={class:"grids"},Eo={class:"input-label"},So={class:"input-group"},Mo={class:"input green"},Uo={class:"grid-group-item"},Ao=S(()=>s("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Io={class:"grids"},Vo={class:"input-label"},Ho={class:"grid-group-item"},Po=S(()=>s("div",{class:"input-group-title"},"\u53C2\u8003",-1)),qo={class:"grids"},To={class:"input-label"},No=["value"],Ro=Q({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(e,{emit:t}){const{state:n,pValue:f,ckValue:m,reset:p,defState:d}=An(),{list:w,put:k,del:D,importData:c,exportData:$}=Un(),V=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],j=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],_=()=>{const h=ce.cloneDeep(n.value);k(h).then(u=>{n.value._id=u}).catch(()=>{alert("\u4FDD\u5B58\u5931\u8D25")})},I=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||D(n.value).then(()=>{p()}).catch(()=>{alert("\u5220\u9664\u5931\u8D25")})},G=h=>{const u=h.currentTarget,B=Array.prototype.slice.call(u.files);u.value="",B[0]&&c(B[0])},L=()=>{$()},C=(h,u)=>{n.value=ce.cloneDeep(n.value),delete n.value._id,n.value.name=h,n.value.qixue=u.qixue,n.value.patt=u.patt,n.value.pdef=u.pdef,n.value.matt=u.matt,n.value.mdef=u.mdef,n.value.huixin=u.huixin},g=()=>{t("reference")};return t("init",C),(h,u)=>{const B=U("c-space"),z=U("c-col"),Y=U("c-row");return q((v(),b("div",qn,[s("div",Tn,[o(Y,{flex:"",middle:"",gutter:0},{default:r(()=>[o(z,{flex:"1 1 auto"},{default:r(()=>[o(B,null,{default:r(()=>[s("button",{class:"btn btn-sm btn-link",onClick:g}," \u53C2\u8003 "),q(s("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":u[0]||(u[0]=i=>dt(n)?n.value=i:null)},[s("option",{value:l(d)()},"\u7A7A\u6A21\u7248",8,Nn),(v(!0),b(P,null,T(l(w),i=>(v(),b("option",{key:i._id,value:i},M(i.name),9,Rn))),128))],512),[[Ue,l(n)]]),s("button",{class:"btn btn-sm btn-primary",onClick:_},"\u4FDD\u5B58"),l(n)._id?(v(),b("button",{key:0,class:"btn btn-sm btn-danger",onClick:I}," \u5220\u9664 ")):X("",!0),o(Pn,{onInput:G},{default:r(()=>[On]),_:1}),s("button",{class:"btn btn-sm btn-success",onClick:L}," \u5BFC\u51FA ")]),_:1})]),_:1}),o(z,null,{default:r(()=>[s("span",{class:"transform-tools-popover-close",onClick:u[1]||(u[1]=i=>t("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),s("div",jn,[s("div",Kn,[s("div",Gn,[s("div",Ln,[o(B,null,{default:r(()=>[Qn,q(s("input",{type:"text",class:"input input-text","onUpdate:modelValue":u[2]||(u[2]=i=>l(n).name=i)},null,512),[[se,l(n).name]])]),_:1})]),s("div",zn,[o(B,null,{default:r(()=>[Jn,o(l(H),{value:l(n).qixue,"onUpdate:value":u[3]||(u[3]=i=>l(n).qixue=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Wn,o(l(H),{value:l(n).patt,"onUpdate:value":u[4]||(u[4]=i=>l(n).patt=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Xn,o(l(H),{value:l(n).pdef,"onUpdate:value":u[5]||(u[5]=i=>l(n).pdef=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Zn,o(l(H),{value:l(n).matt,"onUpdate:value":u[6]||(u[6]=i=>l(n).matt=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Yn,o(l(H),{value:l(n).mdef,"onUpdate:value":u[7]||(u[7]=i=>l(n).mdef=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[xn,o(l(H),{value:l(n).huixin,"onUpdate:value":u[8]||(u[8]=i=>l(n).huixin=i)},null,8,["value"])]),_:1})])]),s("div",eo,[s("div",to,[o(B,null,{default:r(()=>[so,q(s("select",{class:"input input-select","onUpdate:modelValue":u[9]||(u[9]=i=>l(n).stoneName=i)},[no,(v(!0),b(P,null,T(l(Ne),(i,x)=>(v(),b("option",{key:x,value:i.name},M(i.name),9,oo))),128))],512),[[Ue,l(n).stoneName]])]),_:1})]),s("div",ao,[o(B,null,{default:r(()=>[lo,o(l(H),{value:l(n).hsQixue,"onUpdate:value":u[10]||(u[10]=i=>l(n).hsQixue=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[uo,o(l(H),{value:l(n).hsPatt,"onUpdate:value":u[11]||(u[11]=i=>l(n).hsPatt=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[io,o(l(H),{value:l(n).hsPdef,"onUpdate:value":u[12]||(u[12]=i=>l(n).hsPdef=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[co,o(l(H),{value:l(n).hsMatt,"onUpdate:value":u[13]||(u[13]=i=>l(n).hsMatt=i)},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[ro,o(l(H),{value:l(n).hsMdef,"onUpdate:value":u[14]||(u[14]=i=>l(n).hsMdef=i)},null,8,["value"])]),_:1})])]),s("div",po,[s("div",vo,[mo,o(l(ke),{label:"?",inline:"",dir:"right"},{default:r(()=>[_o,fo,ho]),_:1})]),s("div",bo,[o(B,null,{default:r(()=>[$o,o(l(H),{value:l(n).xQixue,"onUpdate:value":u[15]||(u[15]=i=>l(n).xQixue=i),min:0,max:456,placeholder:"0~456"},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[go,o(l(H),{value:l(n).xPatt,"onUpdate:value":u[16]||(u[16]=i=>l(n).xPatt=i),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Co,o(l(H),{value:l(n).xPdef,"onUpdate:value":u[17]||(u[17]=i=>l(n).xPdef=i),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[yo,o(l(H),{value:l(n).xMatt,"onUpdate:value":u[18]||(u[18]=i=>l(n).xMatt=i),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Fo,o(l(H),{value:l(n).xMdef,"onUpdate:value":u[19]||(u[19]=i=>l(n).xMdef=i),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),o(B,null,{default:r(()=>[Bo,o(l(H),{value:l(n).xHuixin,"onUpdate:value":u[20]||(u[20]=i=>l(n).xHuixin=i),min:0,max:104,placeholder:"0~104"},null,8,["value"])]),_:1})])]),s("div",wo,[ko,s("div",Do,[(v(),b(P,null,T(V,i=>o(B,{key:i.n},{default:r(()=>[s("label",Eo,M(i.t),1),s("div",So,[o(l(H),{readonly:"",value:l(n)[i.n]},null,8,["value"]),s("div",Mo,"+"+M(l(f)[i.n]),1)])]),_:2},1024)),64))])]),s("div",Uo,[Ao,s("div",Io,[(v(),b(P,null,T(j,(i,x)=>o(B,{key:x},{default:r(()=>[s("label",Vo,M(i.t),1),o(l(we),{modelValue:l(n)[i.c],"onUpdate:modelValue":ee=>l(n)[i.c]=ee,result:l(n)[i.r],"onUpdate:result":ee=>l(n)[i.r]=ee},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),s("div",Ho,[Po,s("div",qo,[(v(),b(P,null,T(V,i=>o(B,{key:i.n},{default:r(()=>[s("label",To,M(i.t),1),s("input",{class:"input",readonly:"",value:l(m)[i.n]},null,8,No)]),_:2},1024)),64))])])])])],512)),[[it,e.show]])}}});const Oo=N(Ro,[["__scopeId","data-v-2ca0f66a"]]),jo=Q({components:{Calculator:pn,CollapsePanel:Mn,InputNumber:vt,HeroSelect:yn,IconCopy:Re,IconEdit:Nt,TransformToolsModal:Oo},setup(){const e=W({index:-1,title:"",selecteds:[]}),t=R([]),n=async()=>{const a={id:Ie(),title:"\u6A21\u677F",basic:Gt(),state:Qt(),enemyState:Wt(),items:Jt()};await Kt(a),t.value.push(a)},f=async F=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const y=t.value[F];await Ve(y.id),t.value.splice(F,1)},m=async F=>{const a=t.value[F];if(!a)return;const y=e.title;if(!y){p();return}a.title=y,p(),await de(a)},p=()=>{e.index=-1,e.title=""},d=F=>{const a={type:"calculator",data:[F]},y=new Blob([JSON.stringify(a)],{type:"application/json"});ye(y,`${F.title}.json`)},w=async F=>{t.value=F},k=R(""),D=F=>new Promise((a,y)=>{const A=new FileReader;A.onload=()=>{a(A.result)},A.onerror=()=>{y(A.error)},A.readAsText(F)}),c=async()=>{if(!!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F")){if(e.selecteds.length>0){const a=e.selecteds.map(y=>t.value[y]);for(const y of a)await Ve(y.id)}else await jt();_e()}},$=async F=>{const a=F.currentTarget,y=Array.prototype.slice.call(a.files);if(a.value="",!y||!y[0])return;const A=y[0],J=await D(A),te=JSON.parse(J);let oe=[];if(_t(te))oe=te;else if(Te(te)&&te.type==="calculator")oe=te.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}for(const ae of oe){await de(ae);const fe=t.value.findIndex(ge=>ge.id===ae.id);fe===-1?t.value.push(ae):t.value[fe]=ae}},V=async()=>{let F="calculator.json",a=t.value;e.selecteds.length>0&&(a=e.selecteds.map(J=>t.value[J]),F="calculator-selected.json");const y={type:"calculator",data:a},A=new Blob([JSON.stringify(y)],{type:"application/json"});ye(A,F)};async function j(F,a){!t.value[a]||(t.value[a]=F,await de(F))}const _=R(-1),I=W({input:"2283/1.35*1.39",result:0}),{translate:G,xinhun:L,xinyao:C,huazhen:g}=mt(),h=F=>Math.ceil(F),u=W({show:!1}),B=F=>{const a=G(F);z.value&&z.value(F.name,a)},z=R(),Y=R(!1),i=R(-1),x=R(null),ee=F=>{Y.value=!0,i.value=F},be=({item:F})=>{Y.value=!1;const a=i.value;if(a===-1)B(F);else{const A=t.value[a],J=G(F);A.title==="\u6A21\u677F"&&(A.title=F.name),A.basic.w=Math.max(J.patt,J.matt),de(A)}},$e=F=>{const a=ce.cloneDeep(F);a.id=Ie(),console.log(a),t.value.push(a),de(a)};async function _e(){const F=await Ot();e.selecteds=[],w(F)}return ct(()=>{_e()}),{vars:e,activeKey:_,quick:I,list:t,add:n,rename:m,renameClose:p,remove:f,itemExport:d,download:k,onUpdateData:j,clearAll:c,importData:$,exportData:V,heroes:rt,max:Math.max,modal:u,ceilResult:h,selectTpl:B,updateBasic:z,selectShow:Y,selectIndex:i,selectValue:x,openSelect:ee,selectHero:be,copyItem:$e,xinhun:L,xinyao:C,huazhen:g}}});const me=e=>(pe("data-v-147ec3e5"),e=e(),ve(),e),Ko={class:"wrapper"},Go={class:"toolbar"},Lo={style:{padding:"6px 16px"}},Qo=O("\u4F24\u5BB3\u8BA1\u7B97\u5668"),zo={class:"c-upload"},Jo=me(()=>s("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Wo={style:{padding:"6px 16px"}},Xo={class:"input-group"},Zo=me(()=>s("div",{class:"input-ext"},"=",-1)),Yo={class:"content"},xo={class:"container"},ea=["value"],ta=O(" \u2007 "),sa=["onKeypress"],na={key:1},oa=["onClick"],aa=["onClick"],la=["onClick"],ua=O(" \u91CD\u547D\u540D "),ia=["onClick"],da=O(" \u590D\u5236 "),ca=["onClick"],ra=["onClick"],pa={style:{"text-align":"center"}},va=me(()=>s("span",null,"\u661F\u8000",-1)),ma=me(()=>s("span",null,"\u5316\u81FB",-1)),_a=me(()=>s("span",null,"\u661F\u9B42",-1));function fa(e,t,n,f,m,p){const d=U("c-col"),w=U("c-row"),k=U("transform-tools-modal"),D=U("calc-input"),c=U("input-number"),$=U("IconEdit"),V=U("IconCopy"),j=U("Calculator",!0),_=U("CollapsePanel"),I=U("c-space"),G=U("HeroSelect"),L=qe("autofocus");return v(),b("div",Ko,[s("div",Go,[s("div",Lo,[o(w,{flex:"",middle:"",gutter:16},{default:r(()=>[o(d,{flex:"0 0 auto"},{default:r(()=>[Qo]),_:1}),o(d,{flex:"0 0 auto"},{default:r(()=>[s("button",{class:"btn btn-sm btn-link",onClick:t[0]||(t[0]=C=>e.modal.show=!e.modal.show)}," \u9762\u677F "),e.vars.selecteds.length>0?(v(),b("button",{key:0,class:"btn btn-success",onClick:t[1]||(t[1]=C=>e.vars.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):X("",!0)]),_:1}),o(d,{flex:"1 1 0"}),o(d,{flex:"0 0 auto"},{default:r(()=>[s("button",{class:"btn btn-danger",onClick:t[2]||(t[2]=(...C)=>e.clearAll&&e.clearAll(...C))},M(e.vars.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),s("div",zo,[Jo,s("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:t[3]||(t[3]=(...C)=>e.importData&&e.importData(...C))},null,32)]),s("button",{class:"btn btn-success",onClick:t[4]||(t[4]=(...C)=>e.exportData&&e.exportData(...C))},M(e.vars.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),s("button",{class:"btn btn-primary",onClick:t[5]||(t[5]=C=>e.add())},"\u6DFB\u52A0")]),_:1})]),_:1}),o(k,{show:e.modal.show,"onUpdate:show":t[6]||(t[6]=C=>e.modal.show=C),onReference:t[7]||(t[7]=C=>e.openSelect(-1)),onInit:t[8]||(t[8]=C=>e.updateBasic=C)},null,8,["show"])]),s("div",Wo,[s("div",Xo,[o(D,{modelValue:e.quick.input,"onUpdate:modelValue":t[9]||(t[9]=C=>e.quick.input=C),result:e.quick.result,"onUpdate:result":t[10]||(t[10]=C=>e.quick.result=C),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Zo,o(c,{readonly:"",value:e.ceilResult(e.quick.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),s("div",Yo,[s("div",xo,[(v(!0),b(P,null,T(e.list,(C,g)=>(v(),ie(_,{key:C.id,activeKey:g===e.activeKey,onToggle:h=>e.activeKey=h?g:-1},{header:r(()=>[o(w,{flex:"",middle:""},{default:r(()=>[o(d,null,{default:r(()=>[q(s("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":t[11]||(t[11]=h=>e.vars.selecteds=h),value:g,onClick:t[12]||(t[12]=le(()=>{},["stop"]))},null,8,ea),[[he,e.vars.selecteds]]),ta]),_:2},1024),o(d,null,{default:r(()=>[e.vars.index===g?q((v(),b("input",{key:0,type:"text",class:"input","onUpdate:modelValue":t[13]||(t[13]=h=>e.vars.title=h),onClick:t[14]||(t[14]=le(()=>{},["stop"])),onKeypress:Pe(h=>e.rename(g),["enter"])},null,40,sa)),[[se,e.vars.title],[L]]):(v(),b("span",na,M(C.title),1))]),_:2},1024),o(d,{class:"ml-4",onClick:t[15]||(t[15]=le(()=>{},["stop"]))},{default:r(()=>[e.vars.index===g?(v(),b("button",{key:0,class:"btn btn-sm btn-link",onClick:h=>e.rename(g)}," \u786E\u8BA4 ",8,oa)):(v(),b(P,{key:1},[s("button",{class:"btn btn-sm btn-link",onClick:h=>e.openSelect(g)}," \u9009\u62E9 ",8,aa),s("button",{class:"btn btn-sm btn-link",onClick:h=>{e.vars.index=g,e.vars.title=C.title}},[o($,{class:"svg-icon"}),ua],8,la),s("button",{class:"btn btn-sm btn-link",onClick:h=>e.copyItem(C)},[o(V,{class:"svg-icon"}),da],8,ia)],64))]),_:2},1024)]),_:2},1024)]),actions:r(()=>[s("button",{class:"btn btn-sm btn-success-outline",onClick:h=>e.itemExport(C)}," \u5BFC\u51FA ",8,ca),s("button",{class:"btn btn-sm btn-danger-outline",onClick:h=>e.remove(g)}," \u5220\u9664 ",8,ra)]),default:r(()=>[g===e.activeKey?(v(),ie(j,{key:0,data:C,"onUpdate:data":h=>e.onUpdateData(h,g)},null,8,["data","onUpdate:data"])):X("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),o(G,{show:e.selectShow,"onUpdate:show":t[19]||(t[19]=C=>e.selectShow=C),onClick:e.selectHero},{extra:r(()=>[s("div",pa,[o(I,null,{default:r(()=>[s("label",null,[va,q(s("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=C=>e.xinyao=C)},null,512),[[he,e.xinyao]])]),s("label",null,[ma,q(s("input",{type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=C=>e.huazhen=C)},null,512),[[he,e.huazhen]])]),s("label",null,[_a,q(s("input",{type:"checkbox","onUpdate:modelValue":t[18]||(t[18]=C=>e.xinhun=C)},null,512),[[he,e.xinhun]])])]),_:1})])]),_:1},8,["show","onClick"])])}const Fa=N(jo,[["render",fa],["__scopeId","data-v-147ec3e5"]]);export{Fa as default};
