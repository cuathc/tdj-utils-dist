import{_ as j,E as ee,o as _,c as b,e,G as se,H as ne,I as oe,J as le,K as mt,d as Y,s as K,L as Tt,M as L,f as S,j as it,n as Dt,N as ae,O as Et,q as st,a as E,g as a,h as p,i as nt,w as T,B as Z,P as Bt,F as N,r as q,A as O,k as H,Q as Nt,p as ft,l as ht,R as ue,S as ut,b as dt,T as ie,U as o,V as de,z as ce,W as re,X as _t,v as Vt,Y as x,Z as pe,C as pt}from"./index.js";import{_ as Ft}from"./lodash.js";import{u as ve}from"./useHeroes.js";import _e from"./InputNumber.js";import{b as Rt,d as wt,a as me,i as fe}from"./shared.js";import{s as qt}from"./data.js";const he=["width","height"],be=e("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),$e=[be];function Fe(t,s,n,m,f,h){return _(),b("svg",{width:t.width,height:t.height,viewBox:"0 0 32 32"},$e,8,he)}const ge=j(ee,[["render",Fe]]),ye=["width","height"],Ce=e("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),Be=[Ce];function we(t,s,n,m,f,h){return _(),b("svg",{width:t.width,height:t.height,viewBox:"0 0 32 32"},Be,8,ye)}const ke=j(se,[["render",we]]),De=["width","height"],Ee=e("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Se=[Ee];function Me(t,s,n,m,f,h){return _(),b("svg",{width:t.width,height:t.height,viewBox:"0 0 32 32"},Se,8,De)}const Ue=j(ne,[["render",Me]]),Ae=["width","height"],Ie=e("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),Ve=[Ie];function xe(t,s,n,m,f,h){return _(),b("svg",{width:t.width,height:t.height,viewBox:"0 0 24 24"},Ve,8,Ae)}const Ot=j(oe,[["render",xe]]),He=["width","height"],Pe=e("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Te=[Pe];function Ne(t,s,n,m,f,h){return _(),b("svg",{width:t.width,height:t.height,viewBox:"0 0 24 24"},Te,8,He)}const Re=j(le,[["render",Ne]]);let Ct=0,xt=0;const qe=500;function Ht(){const t=Math.floor(new Date().getTime()/1e3);xt===t?Ct++:Ct=0,xt=t;const s=t.toString(16);return`${(qe<<16|Ct&255).toString(16)}.${s}`}async function Oe(){try{return await mt.getAll("calculator")}catch{return[]}}async function je(){try{await mt.clear("calculator")}catch(t){alert(t.message)}}async function Ge(t){try{await mt.add("calculator",JSON.parse(JSON.stringify(t)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function vt(t){try{await mt.put("calculator",JSON.parse(JSON.stringify(t)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function Pt(t){try{await mt.delete("calculator",t)}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}function Ke(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Le(){return{a:0}}function Qe(){return{att:0,k:0}}function jt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0"}}function Je(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function ze(){return[jt()]}function We(){return{hp:"10000",def:"1872",defGain:"15+5",ra:"0",rb:"4+10"}}const Xe=Y({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(t,{emit:s}){const n=K(),m=K({}),f=K(t.active),h=()=>{const c=n.value.getBoundingClientRect();switch(f.value=!0,s("update:active",f.value),t.dir){case"left":m.value={top:`${c.top+c.height/2}px`,right:`${window.innerWidth-c.left-4}px`,maxWidth:"100%"};break;case"right":m.value={top:`${c.top+c.height/2}px`,left:`${c.right+4}px`,maxWidth:"100%"};break;case"top":m.value={bottom:`${window.innerHeight-c.top-4}px`,left:`${c.left+c.width/2}px`,maxWidth:"100%"};break;default:m.value={top:`${c.bottom+4}px`,left:`${c.left+c.width/2}px`,maxWidth:"100%"}}};let r;const B=()=>{r=setTimeout(h,t.wait)},D=()=>{clearTimeout(r),f.value=!1,s("update:active",f.value)};return Tt(()=>t.active,U=>{f.value=U}),{el:n,style:m,tActive:f,onEnter:B,onOut:D}}});const Ze={class:"c-tooltip-label"};function Ye(t,s,n,m,f,h){return _(),b("div",{ref:"el",class:it(["c-tooltip",{active:t.tActive,inline:t.inline}]),onMouseenter:s[0]||(s[0]=(...r)=>t.onEnter&&t.onEnter(...r)),onMouseout:s[1]||(s[1]=(...r)=>t.onOut&&t.onOut(...r))},[L(t.$slots,"label",{},()=>[e("div",Ze,S(t.label),1)]),e("div",{class:it(["c-tooltip-inner",t.dir?`c-tooltip-${t.dir}`:"c-tooltip-bottom",t.color?`c-tooltip-${t.color}`:""]),style:Dt(t.style)},[L(t.$slots,"default")],6)],34)}const St=j(Xe,[["render",Ye]]),ts=Y({components:{Divider:ae,Tooltip:St,CalcInput:Et,IconUp:ke,IconDown:Ue,IconClose:ge,IconCopy:Ot},props:{panel:{type:Object,required:!0},state:{type:Object,required:!0},enemyState:{type:Object,required:!0},itemState:{type:Object,required:!0},showUp:Boolean,showDown:Boolean},emits:["update:itemState","close","up","down","copy"],setup(t,{emit:s}){const n=st({editor:!1,name:"",desc:{f:!1,v:""}}),m=(l,$)=>{if(l==="name")return;const A=t.itemState;switch(l){case"a1":case"a2":typeof $=="number"&&(A[l]=$);break;default:typeof $=="string"&&(A[l]=$)}s("update:itemState",A)},f=st(Je()),h=E({set:l=>m("a1",l),get:()=>t.itemState.a1}),r=E({set:l=>m("a2",l),get:()=>t.itemState.a2}),B=E({set:l=>m("att",l),get:()=>t.itemState.att}),D=E({set:l=>m("id",l),get:()=>t.itemState.id}),U=E({set:l=>m("da",l),get:()=>t.itemState.da}),c=E({set:l=>m("db",l),get:()=>t.itemState.db}),F=E({set:l=>m("dc",l),get:()=>t.itemState.dc}),P=E({set:l=>m("dx",l),get:()=>t.itemState.dx}),Q=E({set:l=>m("cd",l),get:()=>t.itemState.cd}),v=E({set:l=>m("att2",l),get:()=>t.itemState.att2}),I=E({set:l=>m("da2",l),get:()=>t.itemState.da2}),G=E({set:l=>m("dx2",l),get:()=>t.itemState.dx2}),tt=E({set:l=>m("defGain",l),get:()=>t.itemState.defGain}),W=st({a1:h,a2:r,att:B,da:U,db:c,dc:F,dx:P,id:D,cd:Q,att2:v,da2:I,dx2:G,defGain:tt}),w=E(()=>{const{state:l}=t,$=(100+f.att)/100;return Math.ceil(l.att*$)}),C=E(()=>{const{state:l}=t,$=(100+f.att+f.att2)/100;return Math.ceil(l.att*$)}),u=()=>{const{state:l,enemyState:$}=t,A=(100+l.k)/100,X=(100+f.da-$.ra)/100,lt=(100+f.da+f.da2-$.ra)/100,g=(100+f.db-$.rb)/100,z=(100+f.dc)/100,V=(100+f.dx)/100,Lt=(100+f.dx+f.dx2)/100,Mt=(100+f.cd)/100,Ut=(100-f.id)/100,Qt=(100+$.defGain)/100,Jt=(100+$.defGain+f.defGain)/100,zt=Math.max(0,Math.max(0,$.def*Qt)*Ut),Wt=Math.max(0,Math.max(0,$.def*Jt)*Ut),Xt=Math.max(1,w.value*A-zt),Zt=Math.max(1,C.value*A-Wt),At=Xt*h.value*X*g*V,Yt=Math.ceil(At*Mt),It=Zt*r.value*lt*g*z*Lt,te=Math.ceil(It*Mt);return{r01:Math.ceil(At),r01c:Yt,r02:Math.ceil(It),r02c:te}},R=E(()=>u().r01),k=E(()=>u().r01c),rt=E(()=>u().r02),d=E(()=>u().r02c);u();function J(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${t.itemState.name}"\u5417\uFF1F`)&&s("close")}function et(){n.editor=!0,n.name=t.itemState.name}function bt(){const l=n.name;if(n.editor=!1,n.name="",!l)return;const $=t.itemState;$.name=l,s("update:itemState",$)}function gt(){n.desc.f=!0,n.desc.v=t.itemState.desc}function yt(){const l=n.desc.v;if(n.desc.f=!1,n.desc.v="",!l)return;const $=t.itemState;$.desc=l,s("update:itemState",$)}function $t(){s("up")}function y(){s("down")}function i(){s("copy")}return{vars:n,values:W,result:f,satt:w,r01:R,r01c:k,r02:rt,r02c:d,onClose:J,onRename:et,onNameEnter:bt,onEditDesc:gt,onDescEnter:yt,onUp:$t,onDown:y,onCopy:i}}});const ot=t=>(ft("data-v-42477edf"),t=t(),ht(),t),es={class:"row"},ss={class:"col-item"},ns=ot(()=>e("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),os=O(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),ls={class:"input-group"},as=["step"],us=ot(()=>e("div",{class:"input-ext"},"\u500D",-1)),is={class:"label"},ds={class:"input-group"},cs=ot(()=>e("div",{style:{clear:"both"}},null,-1)),rs={class:"col-item"},ps=ot(()=>e("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),vs=O(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),_s={class:"input-group"},ms=["step"],fs=ot(()=>e("div",{class:"input-ext"},"\u500D",-1)),hs={class:"label"},bs={class:"input-group"},$s={class:"col-item"},Fs=ot(()=>e("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),gs={class:"static-control text-center"},ys={class:"darkgold"},Cs=ot(()=>e("div",{style:{clear:"both"}},null,-1)),Bs={class:"label"},ws={class:"bold darkgold"},ks=ot(()=>e("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),Ds={class:"static-control text-center"},Es={class:"bold darkgold"},Ss={class:"bold red"},Ms={class:"label bold"},Us={class:"static-control text-center"},As={class:"bold darkgold"},Is={key:0,class:"bold red"};function Vs(t,s,n,m,f,h){const r=H("IconCopy"),B=H("IconUp"),D=H("IconDown"),U=H("IconClose"),c=H("Divider"),F=H("Tooltip"),P=H("CalcInput"),Q=Nt("autofocus");return _(),b(N,null,[a(c,{orientation:"left"},{action:p(()=>[e("span",{onClick:s[8]||(s[8]=(...v)=>t.onCopy&&t.onCopy(...v))},[a(r,{class:"close"})]),t.showUp?(_(),b("span",{key:0,onClick:s[9]||(s[9]=(...v)=>t.onUp&&t.onUp(...v))},[a(B,{class:"close"})])):nt("",!0),t.showDown?(_(),b("span",{key:1,onClick:s[10]||(s[10]=(...v)=>t.onDown&&t.onDown(...v))},[a(D,{class:"close"})])):nt("",!0),e("span",{onClick:s[11]||(s[11]=(...v)=>t.onClose&&t.onClose(...v))},[a(U,{class:"close"})])]),default:p(()=>[t.vars.editor?T((_(),b("input",{key:0,class:"input",type:"text","onUpdate:modelValue":s[0]||(s[0]=v=>t.vars.name=v),onKeypress:s[1]||(s[1]=Bt((...v)=>t.onNameEnter&&t.onNameEnter(...v),["enter"])),onBlur:s[2]||(s[2]=(...v)=>t.onNameEnter&&t.onNameEnter(...v))},null,544)),[[Z,t.vars.name],[Q]]):(_(),b("span",{key:1,class:"calc-item-title",onClick:s[3]||(s[3]=(...v)=>t.onRename&&t.onRename(...v))},S(t.itemState.name||"\u6A21\u677F"),1)),t.vars.desc.f?T((_(),b("input",{key:2,class:"input",type:"text","onUpdate:modelValue":s[4]||(s[4]=v=>t.vars.desc.v=v),onKeypress:s[5]||(s[5]=Bt((...v)=>t.onDescEnter&&t.onDescEnter(...v),["enter"])),onBlur:s[6]||(s[6]=(...v)=>t.onDescEnter&&t.onDescEnter(...v))},null,544)),[[Z,t.vars.desc.v],[Q]]):(_(),b("span",{key:3,class:"calc-item-desc",onClick:s[7]||(s[7]=(...v)=>t.onEditDesc&&t.onEditDesc(...v))},S(t.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1))]),_:1}),e("div",es,[e("div",ss,[a(F,{dir:"top"},{label:p(()=>[ns]),default:p(()=>[os]),_:1}),e("div",ls,[T(e("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":s[12]||(s[12]=v=>t.values.a1=v)},null,8,as),[[Z,t.values.a1,void 0,{number:!0}]]),us])]),(_(),b(N,null,q([{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],v=>e("div",{class:"col-item",key:v.name},[a(F,{dir:"top"},{label:p(()=>[e("div",is,S(v.label),1)]),default:p(()=>[O(" "+S(v.tip),1)]),_:2},1024),e("div",ds,[a(P,{class:"input",modelValue:t.values[v.name],"onUpdate:modelValue":I=>t.values[v.name]=I,result:t.result[v.name],"onUpdate:result":I=>t.result[v.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),cs,e("div",rs,[a(F,{dir:"top"},{label:p(()=>[ps]),default:p(()=>[vs]),_:1}),e("div",_s,[T(e("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":s[13]||(s[13]=v=>t.values.a2=v)},null,8,ms),[[Z,t.values.a2,void 0,{number:!0}]]),fs])]),(_(),b(N,null,q([{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],v=>e("div",{class:"col-item",key:v.name},[a(F,{dir:"top"},{label:p(()=>[e("div",hs,S(v.label),1)]),default:p(()=>[O(" "+S(v.tip),1)]),_:2},1024),e("div",bs,[a(P,{class:"input",modelValue:t.values[v.name],"onUpdate:modelValue":I=>t.values[v.name]=I,result:t.result[v.name],"onUpdate:result":I=>t.result[v.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),e("div",$s,[Fs,e("div",gs,[e("span",ys,S(t.satt),1)])]),Cs,(_(!0),b(N,null,q([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:t.r01,v2:t.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:t.r02,v2:t.r02c}],(v,I)=>(_(),b("div",{class:"col-item",key:I},[e("div",Bs,[e("span",ws,S(v.label),1),ks]),e("div",Ds,[e("span",Es,S(v.v),1),e("span",Ss,"("+S(v.v2)+")",1)])]))),128)),(_(!0),b(N,null,q([{label:"\u4E0D\u66B4\u51FB",value:t.r01+t.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:t.r01c+t.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:t.r01+t.r02c},{label:"\u5168\u66B4\u51FB",value:t.r01c+t.r02c}],(v,I)=>(_(),b("div",{class:"col-item",key:I},[e("div",Ms,S(v.label),1),e("div",Us,[e("span",As,S(v.value),1),(+t.enemyState.hp||0)<=v.value?(_(),b("span",Is," \u51FB\u6740 ")):nt("",!0)])]))),128))])],64)}const xs=j(ts,[["render",Vs],["__scopeId","data-v-42477edf"]]),Hs=["onClick"],Ps=Y({__name:"dropdown",props:{pos:{default:"lt"}},setup(t){const s=K(!1),n=()=>{s.value=!0},m=()=>{s.value=!1};return window.addEventListener("click",m,!1),ue(()=>{window.removeEventListener("click",m,!1)}),(f,h)=>(_(),b("div",{class:it(["dropdown",[{active:s.value}]]),onClick:ut(n,["stop"])},[L(f.$slots,"default",{},void 0,!0),e("div",{class:it(["dropdown-popover",["dropdown-"+t.pos]]),onClick:h[0]||(h[0]=ut(()=>{},["stop"]))},[L(f.$slots,"popover",{onClose:m},void 0,!0)],2)],10,Hs))}});const Gt=j(Ps,[["__scopeId","data-v-3bf2fdb0"]]);Gt.install=t=>{t.component("dropdown",Kt)};const Kt=Gt,Ts=Y({components:{CalcItem:xs,CalcInput:Et,Tooltip:St,Dropdown:Kt},props:{data:{type:Object,required:!0}},emits:["update:data"],setup(t,{emit:s}){const n=E(()=>t.data.basic),m=E(()=>t.data.state),f=E(()=>t.data.enemyState),h=E(()=>t.data.items),r=st(Le()),B=st({hp:0,def:0,defGain:0,ra:0,rb:0}),D=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],U=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],c=()=>{const w=n.value.c/100;n.value.g=Math.ceil(r.a+n.value.w*w+n.value.x),m.value.att=n.value.w+n.value.g},F=async()=>{s("update:data",t.data)},P=(w,C)=>{C==="panel"&&c(),F()},Q=(w,C)=>{const u=t.data.items;!u||(u[C]=w,F())},v=()=>{const w=t.data.items;!w||(w.push(jt()),F())},I=w=>{const C=t.data.items;!C||(C.splice(w,1),F())},G=w=>{const C=t.data.items;if(!C)return;const u=C[w],R=C[w-1];C[w-1]=u,C[w]=R,F()},tt=w=>{const C=t.data.items;if(!C)return;const u=C[w],R=C[w+1];C[w+1]=u,C[w]=R,F()},W=w=>{const C=t.data.items;if(!C)return;const u=C[w];C.push(Ft.cloneDeep(u)),F()};return Tt(()=>[t.data.basic.w],()=>{c()}),{panel:n,state:m,enemyState:f,panelResult:r,enemyStateResult:B,panelModels:D,enemyModels:U,update:P,items:h,updateItemState:Q,addItem:v,delItem:I,upItem:G,downItem:tt,copyItem:W}}});const at=t=>(ft("data-v-910b1719"),t=t(),ht(),t),Ns=at(()=>e("div",{class:"heading"},[e("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Rs={class:"row"},qs={class:"label"},Os={class:"input-group"},js=["step","onUpdate:modelValue","onChange"],Gs=["value"],Ks={class:"col-item"},Ls=at(()=>e("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Qs={class:"static-control text-center"},Js={class:"darkgold"},zs={class:"col-item"},Ws=at(()=>e("div",{class:"label"},"\u514B\u5236%",-1)),Xs=O(" \u514B\u523630%"),Zs=at(()=>e("br",null,null,-1)),Ys=O("\u88AB\u514B\u5236-25%"),tn=at(()=>e("br",null,null,-1)),en=O("\u6FC0\u836150% "),sn=["onClick"],nn=at(()=>e("div",{class:"heading"},[e("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),on={class:"row"},ln={class:"label"},an={class:"input-group"},un={key:0,class:"input-ext"},dn={class:"heading"},cn=at(()=>e("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),rn={class:"heading-actions"};function pn(t,s,n,m,f,h){const r=H("CalcInput"),B=H("Tooltip"),D=H("Dropdown"),U=H("CalcItem");return _(),b("div",null,[Ns,e("div",Rs,[(_(!0),b(N,null,q(t.panelModels,c=>(_(),b("div",{class:"col-item",key:c.name},[e("div",qs,S(c.label),1),e("div",Os,[c.name in t.panelResult?(_(),dt(r,{key:0,modelValue:t.panel[c.name],"onUpdate:modelValue":F=>t.panel[c.name]=F,result:t.panelResult[c.name],"onUpdate:result":F=>t.panelResult[c.name]=F,onChange:F=>t.update(c.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):T((_(),b("input",{key:1,type:"number",class:"input",style:Dt({textAlign:c.align}),min:"0",step:c.step,"onUpdate:modelValue":F=>t.panel[c.name]=F,onChange:F=>t.update(c.name,"panel")},null,44,js)),[[Z,t.panel[c.name],void 0,{number:!0}]]),c.name==="w"?(_(),b("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${t.panel.g}`},null,8,Gs)):nt("",!0)])]))),128)),e("div",Ks,[Ls,e("div",Qs,[e("span",Js,S(t.state.att),1)])]),e("div",zs,[a(B,{dir:"top"},{label:p(()=>[Ws]),default:p(()=>[Xs,Zs,Ys,tn,en]),_:1}),e("div",null,[a(D,null,{popover:p(({onClose:c})=>[e("div",{class:"list",onClick:()=>{c(),t.update("k","state")}},[e("div",{class:"list-item",onClick:s[2]||(s[2]=F=>t.state.k=0)},"\u666E\u901A"),e("div",{class:"list-item",onClick:s[3]||(s[3]=F=>t.state.k=30)},"\u514B\u5236"),e("div",{class:"list-item",onClick:s[4]||(s[4]=F=>t.state.k=-25)},"\u88AB\u514B\u5236"),e("div",{class:"list-item",onClick:s[5]||(s[5]=F=>t.state.k=50)},"\u6FC0\u8361")],8,sn)]),default:p(()=>[T(e("input",{class:"input",type:"number","onUpdate:modelValue":s[0]||(s[0]=c=>t.state.k=c),onChange:s[1]||(s[1]=c=>t.update("k","state")),list:"d1"},null,544),[[Z,t.state.k,void 0,{number:!0}]])]),_:1})])])]),nn,e("div",on,[(_(!0),b(N,null,q(t.enemyModels,c=>(_(),b("div",{class:"col-item",key:c.name},[e("div",ln,S(c.label),1),e("div",an,[a(r,{modelValue:t.enemyState[c.name],"onUpdate:modelValue":F=>t.enemyState[c.name]=F,result:t.enemyStateResult[c.name],"onUpdate:result":F=>t.enemyStateResult[c.name]=F,onChange:F=>t.update(c.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),c.precent?(_(),b("div",un,"%")):nt("",!0)])]))),128))]),e("div",dn,[cn,e("div",rn,[e("div",{class:"btn btn-primary btn-sm",onClick:s[6]||(s[6]=(...c)=>t.addItem&&t.addItem(...c))},"\u6DFB\u52A0")])]),(_(!0),b(N,null,q(t.items,(c,F)=>(_(),dt(U,{key:c,panel:t.panel,state:t.state,enemyState:t.enemyStateResult,itemState:c,showUp:F>0,showDown:t.items&&F<t.items.length-1,"onUpdate:itemState":P=>t.updateItemState(P,F),onClose:P=>t.delItem(F),onUp:P=>t.upItem(F),onDown:P=>t.downItem(F),onCopy:P=>t.copyItem(F)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))])}const vn=j(Ts,[["render",pn],["__scopeId","data-v-910b1719"]]),_n=Y({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(t,{emit:s}){return{wrapClass:E(()=>["c-action-sheet-wrapper",t.class,{show:t.show}]),onClick:(h,r)=>{s("click",{item:h,index:r}),s("close",!1)},onClose:()=>{s("update:show",!1),s("close",!1)}}}});const mn={class:"c-action-sheet-section"},fn={class:"c-action-sheet-extra"},hn={class:"c-action-sheet-list"},bn=["onClick"];function $n(t,s,n,m,f,h){return _(),dt(ie,{to:"body"},[e("div",{class:it(t.wrapClass)},[e("div",{class:"c-action-sheet-mask",onClick:s[0]||(s[0]=(...r)=>t.onClose&&t.onClose(...r))}),e("div",mn,[e("div",{class:"c-action-sheet-body",style:Dt({maxHeight:t.height})},[e("div",fn,[L(t.$slots,"extra")]),e("div",hn,[(_(!0),b(N,null,q(t.list,(r,B)=>(_(),b("div",{class:"c-action-sheet-item",key:B,onClick:D=>t.onClick(r,B)},[L(t.$slots,"default",{record:r})],8,bn))),128))])],4)])],2)])}const kt=j(_n,[["render",$n]]);kt.install=t=>{t.component("action-sheet",kt)};const Fn={class:"hero-item"},gn=["src","alt","title"],yn={class:"hero-item-label"},Cn=Y({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(t,{emit:s}){const{heroes:n,getHeroIcon:m}=ve(),f=h=>{s("click",h)};return(h,r)=>(_(),dt(o(kt),{class:"hero-select",show:t.show,list:o(n),height:"80vh",onClick:f,"onUpdate:show":r[0]||(r[0]=B=>h.$emit("update:show",B))},{extra:p(()=>[L(h.$slots,"extra")]),default:p(({record:B})=>[e("div",Fn,[e("img",{src:o(m)(B),alt:B.name,title:B.name,width:"128",height:"128"},null,8,gn),e("div",yn,S(B.name),1)])]),_:3},8,["show","list"]))}});const Bn=Y({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(t,{emit:s}){const n=E({get:()=>t.activeKey,set:f=>{s("update:activeKey",f)}});return{active:n,toggle:()=>{const f=!n.value;n.value=f,s("toggle",f)}}}});const wn=t=>(ft("data-v-829ec263"),t=t(),ht(),t),kn=wn(()=>e("div",{class:"panel-icon"},[e("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[e("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Dn={class:"panel-title"},En={class:"panel-body"},Sn={class:"panel-content"};function Mn(t,s,n,m,f,h){return _(),b("div",{class:it(["panel",{active:t.active}])},[e("div",{class:"panel-header",onClick:s[1]||(s[1]=(...r)=>t.toggle&&t.toggle(...r))},[kn,e("div",Dn,[L(t.$slots,"header",{},()=>[O(S(t.header)+"\xA0",1)],!0)]),e("div",{class:"panel-actions",onClick:s[0]||(s[0]=ut(()=>{},["stop"]))},[L(t.$slots,"actions",{},void 0,!0)])]),e("div",En,[e("div",Sn,[L(t.$slots,"default",{},void 0,!0)])])],2)}const Un=j(Bn,[["render",Mn],["__scopeId","data-v-829ec263"]]);function An(){const t="red_team",s=de(),n=K([]),m=async D=>await s.put(t,D).then(U=>{if(n.value.findIndex(c=>c._id===U)===-1){const c=Ft.cloneDeep(D);c._id=U,n.value.push(c)}return U}),f=async D=>await s.delete(t,D._id).then(()=>{n.value=n.value.filter(U=>U._id!==D._id)}),h=async D=>{const U=JSON.parse(await D.text());if(!Rt(U)||U.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const c=U.data;for(const F of c)await m(F)},r=async()=>{const D={type:"red_team",data:n.value},U=new Blob([JSON.stringify(D)],{type:"application/json"});wt(U,"red_team.json")};return(async()=>{const D=await s.getAll(t).catch(()=>[]);console.log(D),n.value=D})(),{put:m,del:f,list:n,importData:h,exportData:r}}function In(){const t=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,xQixue:0,xPatt:0,xPdef:0,xMatt:0,xMdef:0,xHuixin:0,cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),s=K(t()),n=E(()=>{const h={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},r=qt.find(D=>s.value.stoneName===D.name);r&&(h.qixue=r.t[0]+r.d[0]+r.h[0],h.patt=r.t[1]+r.d[1]+r.h[1],h.matt=r.t[2]+r.d[2]+r.h[2],h.pdef=r.t[3]+r.d[3]+r.h[3],h.mdef=r.t[4]+r.d[4]+r.h[4]);const B={qixue:s.value.hsQixue/100,patt:s.value.hsPatt/100,pdef:s.value.hsPdef/100,matt:s.value.hsMatt/100,mdef:s.value.hsMdef/100,huixin:s.value.hsHuixin/100};return{qixue:Math.round(s.value.qixue*B.qixue+h.qixue+s.value.xQixue),patt:Math.round(s.value.patt*B.patt+h.patt+s.value.xPatt),pdef:Math.round(s.value.pdef*B.pdef+h.pdef+s.value.xPdef),matt:Math.round(s.value.matt*B.matt+h.matt+s.value.xMatt),mdef:Math.round(s.value.mdef*B.mdef+h.mdef+s.value.xMdef),huixin:Math.round(s.value.huixin*B.huixin+h.huixin+s.value.xHuixin)}}),m=E(()=>{const h=n.value,r={qixue:(100+s.value.rQixue)/100,patt:(100+s.value.rPatt)/100,pdef:(100+s.value.rPdef)/100,matt:(100+s.value.rMatt)/100,mdef:(100+s.value.rMdef)/100,huixin:(100+s.value.rHuixin)/100};return{qixue:Math.round((s.value.qixue+h.qixue)*r.qixue),patt:Math.round((s.value.patt+h.patt)*r.patt),pdef:Math.round((s.value.pdef+h.pdef)*r.pdef),matt:Math.round((s.value.matt+h.matt)*r.matt),mdef:Math.round((s.value.mdef+h.mdef)*r.mdef),huixin:Math.round((s.value.huixin+h.huixin)*r.huixin)}});return{state:s,pValue:n,ckValue:m,reset:()=>{s.value=t()},defState:t}}const Vn={},xn={class:"c-upload"};function Hn(t,s){return _(),b("div",xn,[L(t.$slots,"default",{},void 0,!0),e("input",ce({type:"file",class:"c-upload-input",accept:"application/json"},t.$attrs),null,16)])}const Pn=j(Vn,[["render",Hn],["__scopeId","data-v-b3879154"]]),M=t=>(ft("data-v-65f1a23b"),t=t(),ht(),t),Tn={class:"transform-tools-popover"},Nn={class:"transform-tools-popover-toolbar"},Rn=["value"],qn=["value"],On=M(()=>e("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),jn={class:"transform-tools-popover-content"},Gn={class:"grid-group"},Kn={class:"grid-group-item"},Ln={class:"input-group-title"},Qn=M(()=>e("span",null,"\u57FA\u7840",-1)),Jn={class:"grids"},zn=M(()=>e("label",{class:"input-label"},"\u6C14\u8840",-1)),Wn=M(()=>e("label",{class:"input-label"},"\u7269\u653B",-1)),Xn=M(()=>e("label",{class:"input-label"},"\u7269\u9632",-1)),Zn=M(()=>e("label",{class:"input-label"},"\u6CD5\u653B",-1)),Yn=M(()=>e("label",{class:"input-label"},"\u6CD5\u9632",-1)),to=M(()=>e("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),eo={class:"grid-group-item"},so={class:"input-group-title"},no=M(()=>e("span",null,"\u9B42\u77F3",-1)),oo=M(()=>e("option",{value:""},"\u65E0",-1)),lo=["value"],ao={class:"grids"},uo=M(()=>e("label",{class:"input-label"},"\u6C14\u8840%",-1)),io=M(()=>e("label",{class:"input-label"},"\u7269\u653B%",-1)),co=M(()=>e("label",{class:"input-label"},"\u7269\u9632%",-1)),ro=M(()=>e("label",{class:"input-label"},"\u6CD5\u653B%",-1)),po=M(()=>e("label",{class:"input-label"},"\u6CD5\u9632%",-1)),vo={class:"grid-group-item"},_o={class:"input-group-title"},mo=O(" \u661F\u4E4B\u6676 "),fo=M(()=>e("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C70\u9632",-1)),ho=M(()=>e("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C70\u9632\uFF0C88\u653B",-1)),bo=M(()=>e("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),$o={class:"grids"},Fo=M(()=>e("label",{class:"input-label"},"\u6C14\u8840",-1)),go=M(()=>e("label",{class:"input-label"},"\u7269\u653B",-1)),yo=M(()=>e("label",{class:"input-label"},"\u7269\u9632",-1)),Co=M(()=>e("label",{class:"input-label"},"\u6CD5\u653B",-1)),Bo=M(()=>e("label",{class:"input-label"},"\u6CD5\u9632",-1)),wo=M(()=>e("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),ko={class:"grid-group-item"},Do=M(()=>e("div",{class:"input-group-title"},"\u9762\u677F",-1)),Eo={class:"grids"},So={class:"input-label"},Mo={class:"input-group"},Uo={class:"input green"},Ao={class:"grid-group-item"},Io=M(()=>e("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Vo={class:"grids"},xo={class:"input-label"},Ho={class:"grid-group-item"},Po=M(()=>e("div",{class:"input-group-title"},"\u53C2\u8003",-1)),To={class:"grids"},No={class:"input-label"},Ro=["value"],qo=Y({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(t,{emit:s}){const{state:n,pValue:m,ckValue:f,reset:h,defState:r}=In(),{list:B,put:D,del:U,importData:c,exportData:F}=An(),P=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],Q=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],v=()=>{const C=Ft.cloneDeep(n.value);D(C).then(u=>{n.value._id=u,alert("\u5DF2\u4FDD\u5B58")}).catch(()=>{alert("\u4FDD\u5B58\u5931\u8D25")})},I=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||U(n.value).then(()=>{h()}).catch(()=>{alert("\u5220\u9664\u5931\u8D25")})},G=C=>{const u=C.currentTarget,R=Array.prototype.slice.call(u.files);u.value="",R[0]&&c(R[0])},tt=()=>{F()},W=(C,u)=>{n.value.name=C,n.value.qixue=u.qixue,n.value.patt=u.patt,n.value.pdef=u.pdef,n.value.matt=u.matt,n.value.mdef=u.mdef,n.value.huixin=u.huixin},w=()=>{s("reference")};return s("init",W),(C,u)=>{const R=H("c-col"),k=H("c-space"),rt=H("c-row");return T((_(),b("div",Tn,[e("div",Nn,[a(rt,{flex:"",middle:"",gutter:8},{default:p(()=>[a(R,null,{default:p(()=>[e("button",{class:"btn btn-sm btn-link",onClick:w}," \u53C2\u8003 ")]),_:1}),a(R,null,{default:p(()=>[O("ID: "+S(o(n)._id),1)]),_:1}),a(R,{flex:"1 1 auto"},{default:p(()=>[a(k,null,{default:p(()=>[T(e("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":u[0]||(u[0]=d=>_t(n)?n.value=d:null)},[e("option",{value:o(r)()},"\u7A7A\u6A21\u7248",8,Rn),(_(!0),b(N,null,q(o(B),d=>(_(),b("option",{key:d._id,value:d},S(d.name),9,qn))),128))],512),[[Vt,o(n)]]),e("button",{class:"btn btn-sm btn-primary",onClick:v},"\u4FDD\u5B58"),o(n)._id?(_(),b("button",{key:0,class:"btn btn-sm btn-danger",onClick:I}," \u5220\u9664 ")):nt("",!0),a(Pn,{onInput:G},{default:p(()=>[On]),_:1}),e("button",{class:"btn btn-sm btn-success",onClick:tt}," \u5BFC\u51FA ")]),_:1})]),_:1}),a(R,null,{default:p(()=>[e("span",{class:"transform-tools-popover-close",onClick:u[1]||(u[1]=d=>s("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),e("div",jn,[e("div",Gn,[e("div",Kn,[e("div",Ln,[a(k,null,{default:p(()=>[Qn,T(e("input",{type:"text",class:"input input-text","onUpdate:modelValue":u[2]||(u[2]=d=>o(n).name=d)},null,512),[[Z,o(n).name]])]),_:1})]),e("div",Jn,[a(k,null,{default:p(()=>[zn,a(o(x),{value:o(n).qixue,"onUpdate:value":u[3]||(u[3]=d=>o(n).qixue=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Wn,a(o(x),{value:o(n).patt,"onUpdate:value":u[4]||(u[4]=d=>o(n).patt=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Xn,a(o(x),{value:o(n).pdef,"onUpdate:value":u[5]||(u[5]=d=>o(n).pdef=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Zn,a(o(x),{value:o(n).matt,"onUpdate:value":u[6]||(u[6]=d=>o(n).matt=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Yn,a(o(x),{value:o(n).mdef,"onUpdate:value":u[7]||(u[7]=d=>o(n).mdef=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[to,a(o(x),{value:o(n).huixin,"onUpdate:value":u[8]||(u[8]=d=>o(n).huixin=d)},null,8,["value"])]),_:1})])]),e("div",eo,[e("div",so,[a(k,null,{default:p(()=>[no,T(e("select",{class:"input input-select","onUpdate:modelValue":u[9]||(u[9]=d=>o(n).stoneName=d)},[oo,(_(!0),b(N,null,q(o(qt),(d,J)=>(_(),b("option",{key:J,value:d.name},S(d.name),9,lo))),128))],512),[[Vt,o(n).stoneName]])]),_:1})]),e("div",ao,[a(k,null,{default:p(()=>[uo,a(o(x),{value:o(n).hsQixue,"onUpdate:value":u[10]||(u[10]=d=>o(n).hsQixue=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[io,a(o(x),{value:o(n).hsPatt,"onUpdate:value":u[11]||(u[11]=d=>o(n).hsPatt=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[co,a(o(x),{value:o(n).hsPdef,"onUpdate:value":u[12]||(u[12]=d=>o(n).hsPdef=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[ro,a(o(x),{value:o(n).hsMatt,"onUpdate:value":u[13]||(u[13]=d=>o(n).hsMatt=d)},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[po,a(o(x),{value:o(n).hsMdef,"onUpdate:value":u[14]||(u[14]=d=>o(n).hsMdef=d)},null,8,["value"])]),_:1})])]),e("div",vo,[e("div",_o,[mo,a(o(St),{label:"?",inline:"",dir:"right"},{default:p(()=>[fo,ho,bo]),_:1})]),e("div",$o,[a(k,null,{default:p(()=>[Fo,a(o(x),{value:o(n).xQixue,"onUpdate:value":u[15]||(u[15]=d=>o(n).xQixue=d),min:0,max:456,placeholder:"0~456"},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[go,a(o(x),{value:o(n).xPatt,"onUpdate:value":u[16]||(u[16]=d=>o(n).xPatt=d),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[yo,a(o(x),{value:o(n).xPdef,"onUpdate:value":u[17]||(u[17]=d=>o(n).xPdef=d),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Co,a(o(x),{value:o(n).xMatt,"onUpdate:value":u[18]||(u[18]=d=>o(n).xMatt=d),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[Bo,a(o(x),{value:o(n).xMdef,"onUpdate:value":u[19]||(u[19]=d=>o(n).xMdef=d),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),a(k,null,{default:p(()=>[wo,a(o(x),{value:o(n).xHuixin,"onUpdate:value":u[20]||(u[20]=d=>o(n).xHuixin=d),min:0,max:104,placeholder:"0~104"},null,8,["value"])]),_:1})])]),e("div",ko,[Do,e("div",Eo,[(_(),b(N,null,q(P,d=>a(k,{key:d.n},{default:p(()=>[e("label",So,S(d.t),1),e("div",Mo,[a(o(x),{readonly:"",value:o(n)[d.n]},null,8,["value"]),e("div",Uo,"+"+S(o(m)[d.n]),1)])]),_:2},1024)),64))])]),e("div",Ao,[Io,e("div",Vo,[(_(),b(N,null,q(Q,(d,J)=>a(k,{key:J},{default:p(()=>[e("label",xo,S(d.t),1),a(o(Et),{modelValue:o(n)[d.c],"onUpdate:modelValue":et=>o(n)[d.c]=et,result:o(n)[d.r],"onUpdate:result":et=>o(n)[d.r]=et},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),e("div",Ho,[Po,e("div",To,[(_(),b(N,null,q(P,d=>a(k,{key:d.n},{default:p(()=>[e("label",No,S(d.t),1),e("input",{class:"input",readonly:"",value:o(f)[d.n]},null,8,Ro)]),_:2},1024)),64))])])])])],512)),[[re,t.show]])}}});const Oo=j(qo,[["__scopeId","data-v-65f1a23b"]]),ct=t=>(ft("data-v-1fa4ab8b"),t=t(),ht(),t),jo={class:"wrapper"},Go={class:"toolbar"},Ko={style:{padding:"6px 16px"}},Lo=O("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Qo={class:"c-upload"},Jo=ct(()=>e("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),zo={style:{padding:"6px 16px"}},Wo={class:"input-group"},Xo=ct(()=>e("div",{class:"input-ext"},"=",-1)),Zo={class:"content"},Yo={class:"container"},tl=["value"],el=O(" \u2007 "),sl=["onKeypress"],nl={key:1},ol=["onClick"],ll=["onClick"],al=["onClick"],ul=O(" \u91CD\u547D\u540D "),il=["onClick"],dl=O(" \u590D\u5236 "),cl=["onClick"],rl=["onClick"],pl={style:{"text-align":"center"}},vl=ct(()=>e("span",null,"\u661F\u8000",-1)),_l=ct(()=>e("span",null,"\u5316\u81FB",-1)),ml=ct(()=>e("span",null,"\u661F\u9B42",-1)),fl=ct(()=>e("span",null,"\u661F\u8F89",-1)),hl=Y({__name:"Calculator",setup(t){const s=st({id:"",title:"",selecteds:[],search:""}),n=K([]),m=E(()=>n.value.filter(y=>y.title.indexOf(s.search)>-1)),f=async()=>{const i={id:Ht(),title:"\u6A21\u677F",basic:Ke(),state:Qe(),enemyState:We(),items:ze()};await Ge(i),n.value.push(i)},h=async y=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const l=n.value.findIndex($=>$.id===y);l!==-1&&(await Pt(n.value[l].id),n.value.splice(l,1))},r=async y=>{const i=s.title;if(!i){B();return}const l=n.value.findIndex(A=>A.id===y);if(l===-1)return;const $=n.value[l];$.title=i,B(),await vt($)},B=()=>{s.id="",s.title=""},D=y=>{const i={type:"calculator",data:[y]},l=new Blob([JSON.stringify(i)],{type:"application/json"});wt(l,`${y.title}.json`)},U=async y=>{n.value=y},c=y=>new Promise((i,l)=>{const $=new FileReader;$.onload=()=>{i($.result)},$.onerror=()=>{l($.error)},$.readAsText(y)}),F=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let i=[];if(s.selecteds.length>0){i=s.selecteds.map(l=>m.value[l]).filter(l=>l);for(const l of i)await Pt(l.id)}else await je();$t()},P=async y=>{const i=y.currentTarget,l=Array.prototype.slice.call(i.files);if(i.value="",!l||!l[0])return;const $=l[0],A=await c($),X=JSON.parse(A);let lt=[];if(fe(X))lt=X;else if(Rt(X)&&X.type==="calculator")lt=X.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}for(const g of lt){await vt(g);const z=n.value.findIndex(V=>V.id===g.id);z===-1?n.value.push(g):n.value[z]=g}},Q=async()=>{let y="calculator.json",i=m.value;s.selecteds.length>0&&(i=s.selecteds.map(A=>m.value[A]).filter(A=>A),y="calculator-selected.json");const l={type:"calculator",data:i},$=new Blob([JSON.stringify(l)],{type:"application/json"});wt($,y)};async function v(y,i){const l=n.value.findIndex(A=>A.id===i);l===-1||!n.value[l]||(n.value[l]=y,await vt(y))}const I=K(-1),G=st({input:"2283/1.35*1.39",result:0}),{translate:tt,xingyao:W,huazhen:w,xinghun:C,xinghui:u}=me(),R=y=>Math.ceil(y),k=st({show:!1}),rt=y=>{const i=tt(y);d.value&&d.value(y.name,i)},d=K(),J=K(!1),et=K(-1),bt=y=>{J.value=!0,et.value=y},gt=({item:y})=>{J.value=!1;const i=et.value;if(i===-1)rt(y);else{const $=n.value[i],A=tt(y);$.title==="\u6A21\u677F"&&($.title=y.name),$.basic.w=Math.max(A.patt,A.matt),vt($)}},yt=y=>{const i=Ft.cloneDeep(y);i.id=Ht(),console.log(i),n.value.push(i),vt(i)};async function $t(){const y=await Oe();s.selecteds=[],U(y)}return pe(()=>{$t()}),(y,i)=>{const l=H("c-col"),$=H("c-row"),A=H("calc-input"),X=H("c-space"),lt=Nt("autofocus");return _(),b("div",jo,[e("div",Go,[e("div",Ko,[a($,{flex:"",middle:"",gutter:16},{default:p(()=>[a(l,{flex:"0 0 auto"},{default:p(()=>[Lo]),_:1}),a(l,{flex:"0 0 auto"},{default:p(()=>[e("button",{class:"btn btn-sm btn-link",onClick:i[0]||(i[0]=g=>k.show=!k.show)}," \u9762\u677F "),s.selecteds.length>0?(_(),b("button",{key:0,class:"btn btn-success",onClick:i[1]||(i[1]=g=>s.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):nt("",!0)]),_:1}),a(l,{flex:"1 1 0"},{default:p(()=>[T(e("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":i[2]||(i[2]=g=>s.search=g)},null,512),[[Z,s.search]])]),_:1}),a(l,{flex:"0 0 auto"},{default:p(()=>[e("button",{class:"btn btn-danger",onClick:F},S(s.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),e("div",Qo,[Jo,e("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:P},null,32)]),e("button",{class:"btn btn-success",onClick:Q},S(s.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),e("button",{class:"btn btn-primary",onClick:i[3]||(i[3]=g=>f())},"\u6DFB\u52A0")]),_:1})]),_:1}),a(Oo,{show:k.show,"onUpdate:show":i[4]||(i[4]=g=>k.show=g),onReference:i[5]||(i[5]=g=>bt(-1)),onInit:i[6]||(i[6]=g=>d.value=g)},null,8,["show"])]),e("div",zo,[e("div",Wo,[a(A,{modelValue:G.input,"onUpdate:modelValue":i[7]||(i[7]=g=>G.input=g),result:G.result,"onUpdate:result":i[8]||(i[8]=g=>G.result=g),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Xo,a(_e,{readonly:"",value:R(G.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),e("div",Zo,[e("div",Yo,[(_(!0),b(N,null,q(o(m),(g,z)=>(_(),dt(o(Un),{key:g.id,activeKey:z===I.value,onToggle:V=>I.value=V?z:-1},{header:p(()=>[a($,{flex:"",middle:""},{default:p(()=>[a(l,null,{default:p(()=>[T(e("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":i[9]||(i[9]=V=>s.selecteds=V),value:z,onClick:i[10]||(i[10]=ut(()=>{},["stop"]))},null,8,tl),[[pt,s.selecteds]]),el]),_:2},1024),a(l,null,{default:p(()=>[s.id===g.id?T((_(),b("input",{key:0,type:"text",class:"input","onUpdate:modelValue":i[11]||(i[11]=V=>s.title=V),onClick:i[12]||(i[12]=ut(()=>{},["stop"])),onKeypress:Bt(V=>r(g.id),["enter"])},null,40,sl)),[[Z,s.title],[lt]]):(_(),b("span",nl,S(g.title),1))]),_:2},1024),a(l,{class:"ml-4",onClick:i[13]||(i[13]=ut(()=>{},["stop"]))},{default:p(()=>[s.id===g.id?(_(),b("button",{key:0,class:"btn btn-sm btn-link",onClick:V=>r(g.id)}," \u786E\u8BA4 ",8,ol)):(_(),b(N,{key:1},[e("button",{class:"btn btn-sm btn-link",onClick:V=>bt(z)}," \u9009\u62E9 ",8,ll),e("button",{class:"btn btn-sm btn-link",onClick:V=>{s.id=g.id,s.title=g.title}},[a(o(Re),{class:"svg-icon"}),ul],8,al),e("button",{class:"btn btn-sm btn-link",onClick:V=>yt(g)},[a(o(Ot),{class:"svg-icon"}),dl],8,il)],64))]),_:2},1024)]),_:2},1024)]),actions:p(()=>[e("button",{class:"btn btn-sm btn-success-outline",onClick:V=>D(g)}," \u5BFC\u51FA ",8,cl),e("button",{class:"btn btn-sm btn-danger-outline",onClick:V=>h(g.id)}," \u5220\u9664 ",8,rl)]),default:p(()=>[z===I.value?(_(),dt(o(vn),{key:0,data:g,"onUpdate:data":V=>v(V,g.id)},null,8,["data","onUpdate:data"])):nt("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),a(o(Cn),{show:J.value,"onUpdate:show":i[18]||(i[18]=g=>J.value=g),onClick:gt},{extra:p(()=>[e("div",pl,[a(X,null,{default:p(()=>[e("label",null,[vl,T(e("input",{type:"checkbox","onUpdate:modelValue":i[14]||(i[14]=g=>_t(W)?W.value=g:null)},null,512),[[pt,o(W)]])]),e("label",null,[_l,T(e("input",{type:"checkbox","onUpdate:modelValue":i[15]||(i[15]=g=>_t(w)?w.value=g:null)},null,512),[[pt,o(w)]])]),e("label",null,[ml,T(e("input",{type:"checkbox","onUpdate:modelValue":i[16]||(i[16]=g=>_t(C)?C.value=g:null)},null,512),[[pt,o(C)]])]),e("label",null,[fl,T(e("input",{type:"checkbox","onUpdate:modelValue":i[17]||(i[17]=g=>_t(u)?u.value=g:null)},null,512),[[pt,o(u)]])])]),_:1})])]),_:1},8,["show"])])}}});const Bl=j(hl,[["__scopeId","data-v-1fa4ab8b"]]);export{Bl as default};
