import{d as Q,_ as lt,o as _,c as $,u as pt,a as it,b as t,e as l,r as et,f as st,n as ht,g as vt,t as ft,h as K,i as ct,j as ot,w as E,T as nt,k as f,F as S,l as C,m as F,v as J,p as R,q as P,s as N,x as dt,y as rt,z as g,A as mt,B as O,C as x,D as $t,I as bt,E as yt,G as Ct}from"./index.js";import{u as wt,a as Ft,i as Et,b as Bt,d as xt}from"./shared.js";import{_ as ut}from"./lodash.js";const kt=Q({props:{type:String},setup(){return{}}});const Dt={key:0,class:"c-sort-desc"},gt={key:1,class:"c-sort-asc"},At={key:2,class:"c-sort-none"};function St(p,c,h,U,n,k){return p.type==="DESC"?(_(),$("span",Dt)):p.type==="ASC"?(_(),$("span",gt)):(_(),$("span",At))}const q=lt(kt,[["render",St]]),Ut={key:0,class:"modal-header"},Vt={class:"modal-body"},Mt={key:1,class:"modal-footer"},It=Q({__name:"Modal",props:{show:{type:Boolean},width:null,height:null},emits:["close","update:show"],setup(p,{emit:c}){const h=p,U=pt(),n=it(()=>{const w=h.width||600,D=h.height||400;return{width:Number(w)?`${w}px`:w,height:Number(D)?`${D}px`:D}}),k=()=>{c("update:show",!1),c("close")};return(w,D)=>(_(),$("div",{class:vt(["modal",{show:p.show}])},[t("div",{class:"modal-mask",onClick:k}),t("div",{class:"modal-dialog",style:ht(l(n))},[l(U).header?(_(),$("div",Ut,[et(w.$slots,"header")])):st("",!0),t("div",Vt,[et(w.$slots,"default")]),l(U).footer?(_(),$("div",Mt,[et(w.$slots,"footer")])):st("",!0)],4)],2))}});const at=It,d=p=>(dt("data-v-701f87e6"),p=p(),rt(),p),qt={class:"models-container"},Nt={class:"models"},Ht={class:"model-item"},Tt=d(()=>t("label",null,"ID",-1)),zt={class:"input"},jt={class:"model-item"},Ot=d(()=>t("label",null,"\u540D\u79F0",-1)),Rt={class:"model-item"},Jt=d(()=>t("label",null,"\u5C5E\u76F8",-1)),Pt=d(()=>t("option",{value:"\u708E"},"\u708E",-1)),Gt=d(()=>t("option",{value:"\u96F7"},"\u96F7",-1)),Lt=d(()=>t("option",{value:"\u51B0"},"\u51B0",-1)),Kt=d(()=>t("option",{value:"\u5149"},"\u5149",-1)),Qt=d(()=>t("option",{value:"\u6697"},"\u6697",-1)),Wt=[Pt,Gt,Lt,Kt,Qt],Xt={class:"model-item"},Yt=d(()=>t("label",null,"\u804C\u4E1A",-1)),Zt=d(()=>t("option",{value:"\u94C1\u536B"},"\u94C1\u536B",-1)),te=d(()=>t("option",{value:"\u4FA0\u5BA2"},"\u4FA0\u5BA2",-1)),ee=d(()=>t("option",{value:"\u5492\u5E08"},"\u5492\u5E08",-1)),oe=d(()=>t("option",{value:"\u795D\u7531"},"\u795D\u7531",-1)),se=d(()=>t("option",{value:"\u5FA1\u98CE"},"\u5FA1\u98CE",-1)),le=d(()=>t("option",{value:"\u7FBD\u58EB"},"\u7FBD\u58EB",-1)),ne=[Zt,te,ee,oe,se,le],ue={class:"model-item"},ae=d(()=>t("label",null,"\u54C1\u7EA7",-1)),ie=d(()=>t("option",{value:"SSR"},"\u7EDD",-1)),ce=d(()=>t("option",{value:"SR"},"\u6781",-1)),de=d(()=>t("option",{value:"R"},"\u5353",-1)),re=d(()=>t("option",{value:"N"},"\u51E1",-1)),_e=[ie,ce,de,re],pe={class:"model-item"},he=d(()=>t("label",null,"\u56FA\u5B9A\u9762\u677F",-1)),ve={class:"models"},fe=Q({__name:"HeroModel",props:{record:null,width:null,height:null},emits:["save","update:record"],setup(p,{emit:c}){const h=p,U=[["qixue","\u6C14\u8840"],["patt","\u7269\u653B"],["pdef","\u7269\u9632"],["matt","\u6CD5\u653B"],["mdef","\u6CD5\u9632"],["huixin","\u4F1A\u5FC3"]],n=ft(h,"record"),k=V=>{!V||(c("save",V),c("update:record",void 0))},w=()=>{c("update:record",void 0)},D=(V,r)=>U.map(([H,v])=>[V.replace("$&",H),r.replace("$&",v)]),I=K(!1),m=ct({qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0}),G=()=>I.value=!0,L=()=>I.value=!1,W=()=>{n.value.qixue=Math.floor(m.qixue*100/1.47)/100,n.value.patt=Math.floor(m.patt*100/(m.patt>m.matt?1.37:1.35))/100,n.value.pdef=Math.floor(m.pdef*100/1.55)/100,n.value.matt=Math.floor(m.matt*100/(m.matt>m.patt?1.37:1.35))/100,n.value.mdef=Math.floor(m.mdef*100/1.55)/100,n.value.huixin=Math.floor(m.huixin*100)/100,n.value.real=!0,I.value=!1};return(V,r)=>{const H=N("c-input-text"),v=N("c-input-number"),b=N("c-space");return _(),$(S,null,[(_(),ot(nt,{to:"body"},[l(n)?(_(),ot(l(at),{key:0,show:"",width:p.width,height:p.height,onClose:r[7]||(r[7]=a=>w())},{footer:E(()=>[f(b,null,{default:E(()=>[t("button",{class:"btn btn-sm btn-primary-outline",onClick:r[5]||(r[5]=a=>k(l(n)))},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-danger-outline",onClick:r[6]||(r[6]=a=>w())},"\u53D6\u6D88")]),_:1})]),default:E(()=>[t("div",qt,[t("div",Nt,[t("div",Ht,[Tt,t("div",zt,C(l(n).id),1)]),t("div",jt,[Ot,f(H,{value:l(n).name,"onUpdate:value":r[0]||(r[0]=a=>l(n).name=a)},null,8,["value"])]),t("div",Rt,[Jt,F(t("select",{class:"input","onUpdate:modelValue":r[1]||(r[1]=a=>l(n).prop=a)},Wt,512),[[J,l(n).prop]])]),t("div",Xt,[Yt,F(t("select",{class:"input","onUpdate:modelValue":r[2]||(r[2]=a=>l(n).career=a)},ne,512),[[J,l(n).career]])]),t("div",ue,[ae,F(t("select",{class:"input","onUpdate:modelValue":r[3]||(r[3]=a=>l(n).rarity=a)},_e,512),[[J,l(n).rarity]])]),t("div",pe,[he,F(t("input",{type:"checkbox",class:"checkbox","onUpdate:modelValue":r[4]||(r[4]=a=>l(n).real=a)},null,512),[[R,l(n).real]]),t("button",{class:"btn btn-link",onClick:G},"\u5361\u6C60\u8F6C\u6362")])]),(_(),$(S,null,P([["$&","0\u7EA7$&"],["$&_cz","$&\u6210\u957F"],["wp_$&","\u5175\u5203$&"],["eq1_$&","\u5934\u90E8$&"],["eq2_$&","\u8EAB\u4F53$&"],["eq3_$&","\u8170\u90E8$&"],["eq4_$&","\u624B\u90E8$&"],["wn0_$&","\u4E3B\u7EBF$&"],["wn1_$&","\u4E0A\u7EBF$&"],["wn2_$&","\u4E0B\u7EBF$&"],["hz_$&","\u5316\u81FB$&"],["hz_$&p","\u5316\u81FB$&%"],["xh_$&","\u661F\u8F89$&"],["xh_$&p","\u661F\u8F89$&%"]],([a,T])=>t("div",{class:"models",key:a},[(_(!0),$(S,null,P(D(a,T),([M,z])=>(_(),$("div",{class:"model-item",key:M},[t("label",null,C(z),1),f(v,{value:l(n)[M],"onUpdate:value":j=>l(n)[M]=j},null,8,["value","onUpdate:value"])]))),128))])),64))])]),_:1},8,["width","height"])):st("",!0)])),(_(),ot(nt,{to:"body"},[f(l(at),{show:I.value,onClose:L},{footer:E(()=>[f(b,null,{default:E(()=>[t("button",{class:"btn btn-sm btn-primary-outline",onClick:W},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-danger-outline",onClick:L},"\u53D6\u6D88")]),_:1})]),default:E(()=>[t("div",ve,[(_(!0),$(S,null,P(D("$&","\u5361\u6C60$&"),([a,T])=>(_(),$("div",{class:"model-item",key:a},[t("label",null,C(T),1),f(v,{value:m[a],"onUpdate:value":M=>m[a]=M},null,8,["value","onUpdate:value"])]))),128))])]),_:1},8,["show"])]))],64)}}});const me=lt(fe,[["__scopeId","data-v-701f87e6"]]),i=p=>(dt("data-v-adc1c686"),p=p(),rt(),p),$e={class:"toolbar"},be=i(()=>t("span",{class:"title"},"\u4EBA\u7269\u5217\u8868",-1)),ye={class:"label-control-inline"},Ce=i(()=>t("span",null,"\u540D\u5B57",-1)),we={class:"label-control-inline"},Fe=i(()=>t("span",null,"\u5C5E\u6027",-1)),Ee=i(()=>t("option",{value:""},"\u5168\u90E8",-1)),Be=i(()=>t("option",{value:"\u708E"},"\u708E",-1)),xe=i(()=>t("option",{value:"\u96F7"},"\u96F7",-1)),ke=i(()=>t("option",{value:"\u51B0"},"\u51B0",-1)),De=i(()=>t("option",{value:"\u5149"},"\u5149",-1)),ge=i(()=>t("option",{value:"\u6697"},"\u6697",-1)),Ae=[Ee,Be,xe,ke,De,ge],Se={class:"label-control-inline"},Ue=i(()=>t("span",null,"\u804C\u4E1A",-1)),Ve=i(()=>t("option",{value:""},"\u5168\u90E8",-1)),Me=i(()=>t("option",{value:"\u94C1\u536B"},"\u94C1\u536B",-1)),Ie=i(()=>t("option",{value:"\u4FA0\u5BA2"},"\u4FA0\u5BA2",-1)),qe=i(()=>t("option",{value:"\u5492\u5E08"},"\u5492\u5E08",-1)),Ne=i(()=>t("option",{value:"\u795D\u7531"},"\u795D\u7531",-1)),He=i(()=>t("option",{value:"\u5FA1\u98CE"},"\u5FA1\u98CE",-1)),Te=i(()=>t("option",{value:"\u7FBD\u58EB"},"\u7FBD\u58EB",-1)),ze=[Ve,Me,Ie,qe,Ne,He,Te],je={class:"c-label"},Oe=x(" \u661F\u8000 "),Re={class:"c-label"},Je=x(" \u5316\u81FB "),Pe={class:"c-label"},Ge=x(" \u661F\u9B42 "),Le={class:"c-label"},Ke=x(" \u661F\u8F89 "),Qe={class:"c-upload"},We=i(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Xe={class:"content"},Ye={class:"table-wrap"},Ze={class:"table table-bordered",style:{"min-width":"100%"}},to=i(()=>t("colgroup",null,[t("col",{width:"60"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"80"}),t("col",{width:"100"})],-1)),eo={style:{position:"sticky",top:"100px"}},oo=i(()=>t("th",null,"#",-1)),so=i(()=>t("th",null,"\u540D\u5B57",-1)),lo=x(" \u6C14\u8840 "),no=x(" \u7269\u653B "),uo=x(" \u7269\u9632 "),ao=x(" \u6CD5\u653B "),io=x(" \u6CD5\u9632 "),co=x(" \u4F1A\u5FC3 "),ro=i(()=>t("th",null,"\u5C5E\u6027",-1)),_o=i(()=>t("th",null,"\u804C\u4E1A",-1)),po=i(()=>t("th",null,"\u64CD\u4F5C",-1)),ho={class:"cell-static text-center"},vo={class:"cell-static text-center"},fo={class:"cell-static text-center"},mo={class:"cell-static text-center"},$o={class:"cell-static text-center"},bo={class:"cell-static text-center"},yo={class:"cell-static text-center"},Co={class:"cell-static text-center"},wo={class:"cell-static text-center"},Fo={class:"cell-static text-center"},Eo={class:"cell-static"},Bo=["onClick"],xo=["onClick"],ko=Q({__name:"Heroes",setup(p){const c=bt(),h=ct({name:"",prop:"",career:""}),U=it(()=>T(g.value)),n=K(-1),{editor:k,defaultHeroState:w}=wt(),D=s=>{const e=g.value.find(u=>u.id===s);!e||(n.value=s,k.value=ut.cloneDeep(e))},I=async s=>{n.value=-1;const e=g.value.find(u=>u.id===s.id);if(!!e){Object.assign(e,s);try{if(!c)return;await c.connect(),await c.put("heroes",ut.cloneDeep(e))}catch(u){console.log(u)}}};function m(s){if(s instanceof Error)switch(s.name){case"ConstraintError":alert("\u6570\u636E\u5DF2\u7ECF\u5B58\u5728");break;default:alert(s.message)}else alert(s)}async function G(){try{await $t()}catch(s){m(s)}}async function L(){try{if(!c)return;const s=w();await c.connect(),delete s.id;const e=await c.add("heroes",s),u=await c.get("heroes",e);if(!u)return;g.value.push(u)}catch(s){m(s)}}async function W(s){try{if(!c||!s.id||!confirm("\u786E\u5B9A\u8981\u5220\u9664\u5417\uFF1F"))return;await c.connect(),await c.delete("heroes",s.id),g.value=g.value.filter(e=>e.id!==s.id)}catch(e){m(e)}}function V(s){return new Promise((e,u)=>{const y=new FileReader;y.onload=()=>{e(JSON.parse(y.result))},y.onerror=()=>{u(y.error)},y.readAsText(s)})}async function r(s){try{const e=s.currentTarget,u=e.files;if(!u||!c)return;await c.connect(),console.log("\u6570\u636E\u5BFC\u5165\u5F00\u59CB");for(let y=0;y<u.length;y++){const B=await V(u[y]);let o=[];if(Et(B))o=B;else if(Bt(B)&&B.type==="heroes")o=B.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}for(const tt of o)await c.put("heroes",tt);console.log("\u6570\u636E\u5BFC\u5165\u7ED3\u675F")}e.value="",G()}catch(e){m(e)}}function H(){const s=new Blob([JSON.stringify({type:"heroes",data:g.value})]);xt(s,"heroes.json")}const v=K("name"),b=K("");function a(s){if(v.value===s)switch(b.value){case"DESC":b.value="ASC";break;case"ASC":b.value="";break;default:b.value="DESC"}else v.value=s,b.value="DESC"}function T(s){let e=s.slice();return h.name&&(e=e.filter(u=>u.name.includes(h.name))),h.prop&&(e=e.filter(u=>u.prop===h.prop)),h.career&&(e=e.filter(u=>u.career===h.career)),e.sort((u,y)=>{switch(v.value){case"qixue":case"patt":case"pdef":case"matt":case"mdef":case"huixin":{const B=z(u),o=z(y);return b.value==="DESC"?o[v.value]-B[v.value]:b.value==="ASC"?B[v.value]-o[v.value]:y.weight-u.weight}default:return y.weight-u.weight}}),e}function M(){Ct()}(!g.value||g.value.length===0)&&G();const{translate:z,xingyao:j,huazhen:X,xinghun:Y,xinghui:Z}=Ft();return(s,e)=>{const u=N("c-col"),y=N("c-space"),B=N("c-row");return _(),$(S,null,[t("div",mt({class:"wrapper"},s.$attrs),[t("div",$e,[f(B,{flex:"",middle:"",style:{padding:"4px 16px"}},{default:E(()=>[f(u,{flex:"1 1 0"},{default:E(()=>[be,t("label",ye,[Ce,F(t("input",{class:"input",type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>h.name=o)},null,512),[[yt,h.name]])]),t("label",we,[Fe,F(t("select",{class:"select","onUpdate:modelValue":e[1]||(e[1]=o=>h.prop=o)},Ae,512),[[J,h.prop]])]),t("label",Se,[Ue,F(t("select",{class:"select","onUpdate:modelValue":e[2]||(e[2]=o=>h.career=o)},ze,512),[[J,h.career]])])]),_:1}),f(u,{flex:"0 0 auto"},{default:E(()=>[f(y,{size:"8"},{default:E(()=>[t("label",je,[F(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>O(j)?j.value=o:null)},null,512),[[R,l(j)]]),Oe]),t("label",Re,[F(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>O(X)?X.value=o:null)},null,512),[[R,l(X)]]),Je]),t("label",Pe,[F(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>O(Y)?Y.value=o:null)},null,512),[[R,l(Y)]]),Ge]),t("label",Le,[F(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[6]||(e[6]=o=>O(Z)?Z.value=o:null)},null,512),[[R,l(Z)]]),Ke])]),_:1}),t("div",{class:"c-upload"},[t("button",{class:"btn btn-danger",onClick:M},"\u8F7D\u5165\u9ED8\u8BA4")]),t("div",Qe,[We,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:e[7]||(e[7]=o=>r(o))},null,32)]),t("button",{class:"btn btn-success",onClick:H},"\u5BFC\u51FA"),t("button",{class:"btn btn-primary",onClick:e[8]||(e[8]=o=>L())},"\u6DFB\u52A0")]),_:1})]),_:1})]),t("div",Xe,[t("div",Ye,[t("table",Ze,[to,t("thead",eo,[t("tr",null,[oo,so,t("th",null,[lo,f(l(q),{type:v.value==="qixue"?b.value:"",onClick:e[9]||(e[9]=o=>a("qixue"))},null,8,["type"])]),t("th",null,[no,f(l(q),{type:v.value==="patt"?b.value:"",onClick:e[10]||(e[10]=o=>a("patt"))},null,8,["type"])]),t("th",null,[uo,f(l(q),{type:v.value==="pdef"?b.value:"",onClick:e[11]||(e[11]=o=>a("pdef"))},null,8,["type"])]),t("th",null,[ao,f(l(q),{type:v.value==="matt"?b.value:"",onClick:e[12]||(e[12]=o=>a("matt"))},null,8,["type"])]),t("th",null,[io,f(l(q),{type:v.value==="mdef"?b.value:"",onClick:e[13]||(e[13]=o=>a("mdef"))},null,8,["type"])]),t("th",null,[co,f(l(q),{type:v.value==="huixin"?b.value:"",onClick:e[14]||(e[14]=o=>a("huixin"))},null,8,["type"])]),ro,_o,po])]),t("tbody",null,[(_(!0),$(S,null,P(l(U),(o,tt)=>(_(),$("tr",{key:o.id,class:"c-user-row"},[t("td",ho,C(tt+1),1),t("td",vo,C(o.name),1),(_(!0),$(S,null,P([l(z)(o)],(A,_t)=>(_(),$(S,{key:_t},[t("td",fo,C(A.qixue),1),t("td",mo,C(A.patt),1),t("td",$o,C(A.pdef),1),t("td",bo,C(A.matt),1),t("td",yo,C(A.mdef),1),t("td",Co,C(A.huixin),1)],64))),128)),t("td",wo,C(o.prop),1),t("td",Fo,C(o.career),1),t("td",Eo,[f(y,null,{default:E(()=>[t("button",{class:"btn btn-sm btn-primary-outline",onClick:A=>D(o.id)}," \u7F16\u8F91 ",8,Bo),t("button",{class:"btn btn-sm btn-danger-outline",onClick:A=>W(o)},"\u5220\u9664",8,xo)]),_:2},1024)])]))),128))])])])])],16),f(me,{record:l(k),"onUpdate:record":e[15]||(e[15]=o=>O(k)?k.value=o:null),width:"800",height:"600",onSave:I},null,8,["record"])],64)}}});const So=lt(ko,[["__scopeId","data-v-adc1c686"]]);export{So as default};
