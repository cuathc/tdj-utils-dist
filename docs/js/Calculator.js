import{_ as W,E as ue,o as i,c as r,e as t,G as le,H as ie,J as ce,K as de,L as ct,d as lt,q as Q,M as qt,N as et,f as k,j as vt,n as St,m as it,a as A,g as p,h as m,u as o,i as O,w as j,B as at,O as xt,P as re,F as q,r as G,z,Q as Ct,R as Rt,p as gt,l as Bt,S as pe,U as _t,b as ut,T as jt,I as _e,x as ve,V as fe,k as rt,y as yt,v as Ht,W as ht,X as he,C as Ft}from"./index.js";import{_ as At}from"./lodash.js";import{u as me}from"./useHeroes.js";import be from"./InputNumber.js";import{b as Lt,d as Et,a as $e,i as Fe}from"./shared.js";import{S as J,a as ye}from"./star-crystals.js";import{s as Kt}from"./data.js";const Ce=["width","height"],ge=t("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),Be=[ge];function we(e,s,n,u,c,b){return i(),r("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},Be,8,Ce)}const ke=W(ue,[["render",we]]),xe=["width","height"],Ee=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),De=[Ee];function Se(e,s,n,u,c,b){return i(),r("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},De,8,xe)}const Ae=W(le,[["render",Se]]),Me=["width","height"],Ue=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Ve=[Ue];function Ie(e,s,n,u,c,b){return i(),r("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},Ve,8,Me)}const Te=W(ie,[["render",Ie]]),He=["width","height"],Pe=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),Ne=[Pe];function qe(e,s,n,u,c,b){return i(),r("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},Ne,8,He)}const Ot=W(ce,[["render",qe]]),Re=["width","height"],je=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Le=[je];function Ke(e,s,n,u,c,b){return i(),r("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},Le,8,Re)}const Oe=W(de,[["render",Ke]]);let kt=0,Pt=0;const Ge=500;function Nt(){const e=Math.floor(new Date().getTime()/1e3);Pt===e?kt++:kt=0,Pt=e;const s=e.toString(16);return`${(Ge<<16|kt&255).toString(16)}.${s}`}async function Je(){try{return await ct.getAll("calculator")}catch{return[]}}async function Qe(e){try{await ct.add("calculator",JSON.parse(JSON.stringify(e)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function wt(e){try{await ct.put("calculator",JSON.parse(JSON.stringify(e)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function ze(e){try{await ct.delete("calculator",e)}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function Xe(e){try{const u=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const c of e)await ct.wrap(u.put(c))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function We(e){try{const u=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const c of e)await ct.wrap(u.delete(c))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}function Ze(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Ye(){return{a:0}}function ts(){return{att:0,k:0}}function Gt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0"}}function es(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function ss(){return[Gt()]}function ns(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const os=lt({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(e,{emit:s}){const n=Q(),u=Q({}),c=Q(e.active),b=()=>{const D=n.value.getBoundingClientRect();switch(c.value=!0,s("update:active",c.value),e.dir){case"left":u.value={top:`${D.top+D.height/2}px`,right:`${window.innerWidth-D.left-4}px`,maxWidth:"100%"};break;case"right":u.value={top:`${D.top+D.height/2}px`,left:`${D.right+4}px`,maxWidth:"100%"};break;case"top":u.value={bottom:`${window.innerHeight-D.top-4}px`,left:`${D.left+D.width/2}px`,maxWidth:"100%"};break;default:u.value={top:`${D.bottom+4}px`,left:`${D.left+D.width/2}px`,maxWidth:"100%"}}};let d;const _=()=>{d=window.setTimeout(b,e.wait)},E=()=>{clearTimeout(d),c.value=!1,s("update:active",c.value)};return qt(()=>e.active,I=>{c.value=I}),{el:n,style:u,tActive:c,onEnter:_,onOut:E}}});const as={class:"c-tooltip-label"};function us(e,s,n,u,c,b){return i(),r("div",{ref:"el",class:vt(["c-tooltip",{active:e.tActive,inline:e.inline}]),onMouseenter:s[0]||(s[0]=(...d)=>e.onEnter&&e.onEnter(...d)),onMouseout:s[1]||(s[1]=(...d)=>e.onOut&&e.onOut(...d))},[et(e.$slots,"label",{},()=>[t("div",as,k(e.label),1)]),t("div",{class:vt(["c-tooltip-inner",e.dir?`c-tooltip-${e.dir}`:"c-tooltip-bottom",e.color?`c-tooltip-${e.color}`:""]),style:St(e.style)},[et(e.$slots,"default")],6)],34)}const pt=W(os,[["render",us]]),dt=e=>(gt("data-v-7e0f8f09"),e=e(),Bt(),e),ls=["onKeypress"],is=["onKeypress"],cs={class:"row"},ds={class:"col-item"},rs=dt(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ps=z(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),_s={class:"input-group"},vs=["step"],fs=dt(()=>t("div",{class:"input-ext"},"\u500D",-1)),hs={class:"label"},ms={class:"input-group"},bs=dt(()=>t("div",{style:{clear:"both"}},null,-1)),$s={class:"col-item"},Fs=dt(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),ys=z(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),Cs={class:"input-group"},gs=["step"],Bs=dt(()=>t("div",{class:"input-ext"},"\u500D",-1)),ws={class:"label"},ks={class:"input-group"},xs={class:"col-item"},Es=dt(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Ds={class:"static-control text-center"},Ss={class:"darkgold"},As=dt(()=>t("div",{style:{clear:"both"}},null,-1)),Ms={class:"label"},Us={class:"bold darkgold"},Vs=dt(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),Is={class:"static-control text-center"},Ts={class:"bold darkgold"},Hs={class:"bold red"},Ps={class:"label bold"},Ns={class:"static-control text-center"},qs={class:"bold darkgold"},Rs={key:0,class:"bold red"},js=lt({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(e,{emit:s}){const n=e,u=it({editor:!1,name:"",desc:{f:!1,v:""}}),c=(f,B)=>{if(f==="name")return;const h=n.itemState;switch(f){case"a1":case"a2":typeof B=="number"&&(h[f]=B);break;default:typeof B=="string"&&(h[f]=B)}s("update:itemState",h)},b=it(es()),d=A({set:f=>c("a1",f),get:()=>n.itemState.a1}),_=A({set:f=>c("a2",f),get:()=>n.itemState.a2}),E=A({set:f=>c("att",f),get:()=>n.itemState.att}),I=A({set:f=>c("id",f),get:()=>n.itemState.id}),D=A({set:f=>c("da",f),get:()=>n.itemState.da}),tt=A({set:f=>c("db",f),get:()=>n.itemState.db}),S=A({set:f=>c("dc",f),get:()=>n.itemState.dc}),U=A({set:f=>c("dx",f),get:()=>n.itemState.dx}),P=A({set:f=>c("cd",f),get:()=>n.itemState.cd}),V=A({set:f=>c("att2",f),get:()=>n.itemState.att2}),R=A({set:f=>c("da2",f),get:()=>n.itemState.da2}),st=A({set:f=>c("dx2",f),get:()=>n.itemState.dx2}),nt=A({set:f=>c("defGain",f),get:()=>n.itemState.defGain}),N=it({a1:d,a2:_,att:E,da:D,db:tt,dc:S,dx:U,id:I,cd:P,att2:V,da2:R,dx2:st,defGain:nt}),ot=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],x=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],y=A(()=>{const{state:f}=n,B=(100+b.att)/100;return Math.ceil(f.att*B)}),v=A(()=>{const{state:f}=n,B=(100+b.att+b.att2)/100;return Math.ceil(f.att*B)}),C=()=>{const{state:f,enemyState:B}=n,h=(100+f.k)/100,w=(100+b.da-B.ra)/100,M=(100+b.da+b.da2-B.ra)/100,Mt=(100+b.db-B.rb)/100,zt=(100+b.dc)/100,Xt=(100+b.dx)/100,Wt=(100+b.dx+b.dx2)/100,Ut=(100+b.cd)/100,Vt=(100-b.id)/100,Zt=(100+B.defGain)/100,Yt=(100+B.defGain+b.defGain)/100,te=Math.max(0,Math.max(0,B.def*Zt+B.defExt)*Vt),ee=Math.max(0,Math.max(0,B.def*Yt+B.defExt)*Vt),se=Math.max(1,y.value*h-te),ne=Math.max(1,v.value*h-ee),It=se*N.a1*w*Mt*Xt,oe=Math.ceil(It*Ut),Tt=ne*N.a2*M*Mt*zt*Wt,ae=Math.ceil(Tt*Ut);return{r01:Math.ceil(It),r01c:oe,r02:Math.ceil(Tt),r02c:ae}},L=A(()=>C().r01),T=A(()=>C().r01c),$=A(()=>C().r02),X=A(()=>C().r02c);C();function K(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${n.itemState.name}"\u5417\uFF1F`)&&s("close")}function $t(){u.editor=!0,u.name=n.itemState.name}function l(){const f=u.name;if(u.editor=!1,u.name="",!f)return;const B=n.itemState;B.name=f,s("update:itemState",B)}function F(){u.desc.f=!0,u.desc.v=n.itemState.desc}function a(){const f=u.desc.v;if(u.desc.f=!1,u.desc.v="",!f)return;const B=n.itemState;B.desc=f,s("update:itemState",B)}function g(){s("up")}function H(){s("down")}function Y(){s("copy")}return(f,B)=>{const h=Rt("autofocus");return i(),r(q,null,[p(o(re),{orientation:"left"},{action:m(()=>[t("span",{onClick:Y},[p(o(Ot),{class:"close"})]),e.showUp?(i(),r("span",{key:0,onClick:g},[p(o(Ae),{class:"close"})])):O("",!0),e.showDown?(i(),r("span",{key:1,onClick:H},[p(o(Te),{class:"close"})])):O("",!0),t("span",{onClick:K},[p(o(ke),{class:"close"})])]),default:m(()=>[u.editor?j((i(),r("input",{key:0,class:"input",type:"text","onUpdate:modelValue":B[0]||(B[0]=w=>u.name=w),onKeypress:xt(l,["enter"]),onBlur:l},null,40,ls)),[[at,u.name],[h]]):(i(),r("span",{key:1,class:"calc-item-title",onClick:$t},k(e.itemState.name||"\u6A21\u677F"),1)),u.desc.f?j((i(),r("input",{key:2,class:"input",type:"text","onUpdate:modelValue":B[1]||(B[1]=w=>u.desc.v=w),onKeypress:xt(a,["enter"]),onBlur:a},null,40,is)),[[at,u.desc.v],[h]]):(i(),r("span",{key:3,class:"calc-item-desc",onClick:F},k(e.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1))]),_:1}),t("div",cs,[t("div",ds,[p(o(pt),{dir:"top"},{label:m(()=>[rs]),default:m(()=>[ps]),_:1}),t("div",_s,[j(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":B[2]||(B[2]=w=>N.a1=w)},null,8,vs),[[at,N.a1,void 0,{number:!0}]]),fs])]),(i(),r(q,null,G(ot,w=>t("div",{class:"col-item",key:w.name},[p(o(pt),{dir:"top"},{label:m(()=>[t("div",hs,k(w.label),1)]),default:m(()=>[z(" "+k(w.tip),1)]),_:2},1024),t("div",ms,[p(o(Ct),{class:"input",modelValue:N[w.name],"onUpdate:modelValue":M=>N[w.name]=M,result:b[w.name],"onUpdate:result":M=>b[w.name]=M},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),bs,t("div",$s,[p(o(pt),{dir:"top"},{label:m(()=>[Fs]),default:m(()=>[ys]),_:1}),t("div",Cs,[j(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":B[3]||(B[3]=w=>N.a2=w)},null,8,gs),[[at,N.a2,void 0,{number:!0}]]),Bs])]),(i(),r(q,null,G(x,w=>t("div",{class:"col-item",key:w.name},[p(o(pt),{dir:"top"},{label:m(()=>[t("div",ws,k(w.label),1)]),default:m(()=>[z(" "+k(w.tip),1)]),_:2},1024),t("div",ks,[p(o(Ct),{class:"input",modelValue:N[w.name],"onUpdate:modelValue":M=>N[w.name]=M,result:b[w.name],"onUpdate:result":M=>b[w.name]=M},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",xs,[Es,t("div",Ds,[t("span",Ss,k(o(y)),1)])]),As,(i(!0),r(q,null,G([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:o(L),v2:o(T)},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:o($),v2:o(X)}],(w,M)=>(i(),r("div",{class:"col-item",key:M},[t("div",Ms,[t("span",Us,k(w.label),1),Vs]),t("div",Is,[t("span",Ts,k(w.v),1),t("span",Hs,"("+k(w.v2)+")",1)])]))),128)),(i(!0),r(q,null,G([{label:"\u4E0D\u66B4\u51FB",value:o(L)+o($)},{label:"\u4E00\u6BB5\u66B4\u51FB",value:o(T)+o($)},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:o(L)+o(X)},{label:"\u5168\u66B4\u51FB",value:o(T)+o(X)}],(w,M)=>(i(),r("div",{class:"col-item",key:M},[t("div",Ps,k(w.label),1),t("div",Ns,[t("span",qs,k(w.value),1),(+e.enemyState.hp||0)<=w.value?(i(),r("span",Rs," \u51FB\u6740 ")):O("",!0)])]))),128))])],64)}}});const Ls=W(js,[["__scopeId","data-v-7e0f8f09"]]),Ks=["onClick"],Os=lt({__name:"dropdown",props:{pos:{default:"lt"}},setup(e){const s=Q(!1),n=()=>{s.value=!0},u=()=>{s.value=!1};return window.addEventListener("click",u,!1),pe(()=>{window.removeEventListener("click",u,!1)}),(c,b)=>(i(),r("div",{class:vt(["dropdown",[{active:s.value}]]),onClick:_t(n,["stop"])},[et(c.$slots,"default",{},void 0,!0),t("div",{class:vt(["dropdown-popover",["dropdown-"+e.pos]]),onClick:b[0]||(b[0]=_t(()=>{},["stop"]))},[et(c.$slots,"popover",{onClose:u},void 0,!0)],2)],10,Ks))}});const Jt=W(Os,[["__scopeId","data-v-e27f2ee9"]]);Jt.install=e=>{e.component("dropdown",Qt)};const Qt=Jt,ft=e=>(gt("data-v-99433d9d"),e=e(),Bt(),e),Gs=ft(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Js={class:"row"},Qs={class:"label"},zs={class:"input-group"},Xs=["step","onUpdate:modelValue","onChange"],Ws=["value"],Zs={class:"col-item"},Ys=ft(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),tn={class:"static-control text-center"},en={class:"darkgold"},sn={class:"col-item"},nn=ft(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),on=z(" \u514B\u523630%"),an=ft(()=>t("br",null,null,-1)),un=z("\u88AB\u514B\u5236-25%"),ln=ft(()=>t("br",null,null,-1)),cn=z("\u6FC0\u836150% "),dn=["onClick"],rn=ft(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),pn={class:"row"},_n={class:"label"},vn={key:1,class:"label"},fn={class:"input-group"},hn={key:0,class:"input-ext"},mn=ft(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),bn=lt({__name:"Calculator",props:{data:null},emits:["update:data"],setup(e,{emit:s}){const n=e,u=A(()=>n.data.basic),c=A(()=>n.data.state),b=A(()=>n.data.enemyState),d=A(()=>n.data.items),_=it(Ye()),E=it({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),I=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],D=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],tt=()=>{const x=u.value.c/100;u.value.g=Math.ceil(_.a+u.value.w*x+u.value.x),c.value.att=u.value.w+u.value.g},S=async()=>{s("update:data",n.data)},U=(x,y)=>{y==="panel"&&tt(),S()},P=x=>{x(),U("k","state")},V=(x,y)=>{const v=n.data.items;!v||(v[y]=x,S())},R=()=>{const x=n.data.items;!x||(x.push(Gt()),S())},st=x=>{const y=n.data.items;!y||(y.splice(x,1),S())},nt=x=>{const y=n.data.items;if(!y)return;const v=y[x],C=y[x-1];y[x-1]=v,y[x]=C,S()},N=x=>{const y=n.data.items;if(!y)return;const v=y[x],C=y[x+1];y[x+1]=v,y[x]=C,S()},ot=x=>{const y=n.data.items;if(!y)return;const v=y[x];y.push(At.cloneDeep(v)),S()};return qt(()=>[n.data.basic.w],()=>{tt()}),(x,y)=>(i(),r("div",null,[Gs,t("div",Js,[(i(),r(q,null,G(I,v=>t("div",{class:"col-item",key:v.name},[t("div",Qs,k(v.label),1),t("div",zs,[v.name in _?(i(),ut(o(Ct),{key:0,modelValue:o(u)[v.name],"onUpdate:modelValue":C=>o(u)[v.name]=C,result:_[v.name],"onUpdate:result":C=>_[v.name]=C,onChange:C=>U(v.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):j((i(),r("input",{key:1,type:"number",class:"input",style:St({textAlign:v.align}),min:"0",step:v.step,"onUpdate:modelValue":C=>o(u)[v.name]=C,onChange:C=>U(v.name,"panel")},null,44,Xs)),[[at,o(u)[v.name],void 0,{number:!0}]]),v.name==="w"?(i(),r("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${o(u).g}`},null,8,Ws)):O("",!0)])])),64)),t("div",Zs,[Ys,t("div",tn,[t("span",en,k(o(c).att),1)])]),t("div",sn,[p(o(pt),{dir:"top"},{label:m(()=>[nn]),default:m(()=>[on,an,un,ln,cn]),_:1}),t("div",null,[p(o(Qt),null,{popover:m(({onClose:v})=>[t("div",{class:"list",onClick:C=>P(v)},[t("div",{class:"list-item",onClick:y[2]||(y[2]=C=>o(c).k=0)},"\u666E\u901A"),t("div",{class:"list-item",onClick:y[3]||(y[3]=C=>o(c).k=30)},"\u514B\u5236"),t("div",{class:"list-item",onClick:y[4]||(y[4]=C=>o(c).k=-25)},"\u88AB\u514B\u5236"),t("div",{class:"list-item",onClick:y[5]||(y[5]=C=>o(c).k=50)},"\u6FC0\u8361")],8,dn)]),default:m(()=>[j(t("input",{class:"input",type:"number","onUpdate:modelValue":y[0]||(y[0]=v=>o(c).k=v),onChange:y[1]||(y[1]=v=>U("k","state")),list:"d1"},null,544),[[at,o(c).k,void 0,{number:!0}]])]),_:1})])])]),rn,t("div",pn,[(i(),r(q,null,G(D,v=>t("div",{class:"col-item",key:v.name},[v.tips?(i(),ut(o(pt),{key:0,dir:"top"},{label:m(()=>[t("div",_n,k(v.label),1)]),default:m(()=>[z(" "+k(v.tips),1)]),_:2},1024)):(i(),r("div",vn,k(v.label),1)),t("div",fn,[p(o(Ct),{modelValue:o(b)[v.name],"onUpdate:modelValue":C=>o(b)[v.name]=C,result:E[v.name],"onUpdate:result":C=>E[v.name]=C,onChange:C=>U(v.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),v.precent?(i(),r("div",hn,"%")):O("",!0)])])),64))]),t("div",{class:"heading"},[mn,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:R},"\u6DFB\u52A0")])]),(i(!0),r(q,null,G(o(d),(v,C)=>(i(),ut(Ls,{key:v,panel:o(u),state:o(c),enemyState:E,itemState:v,showUp:C>0,showDown:o(d)&&C<o(d).length-1,"onUpdate:itemState":L=>V(L,C),onClose:L=>st(C),onUp:L=>nt(C),onDown:L=>N(C),onCopy:L=>ot(C)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const $n=W(bn,[["__scopeId","data-v-99433d9d"]]),Fn=lt({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(e,{emit:s}){return{wrapClass:A(()=>["c-action-sheet-wrapper",e.class,{show:e.show}]),onClick:(b,d)=>{s("click",{item:b,index:d}),s("close",!1)},onClose:()=>{s("update:show",!1),s("close",!1)}}}});const yn={class:"c-action-sheet-section"},Cn={class:"c-action-sheet-extra"},gn={class:"c-action-sheet-list"},Bn=["onClick"];function wn(e,s,n,u,c,b){return i(),ut(jt,{to:"body"},[t("div",{class:vt(e.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:s[0]||(s[0]=(...d)=>e.onClose&&e.onClose(...d))}),t("div",yn,[t("div",{class:"c-action-sheet-body",style:St({maxHeight:e.height})},[t("div",Cn,[et(e.$slots,"extra")]),t("div",gn,[(i(!0),r(q,null,G(e.list,(d,_)=>(i(),r("div",{class:"c-action-sheet-item",key:_,onClick:E=>e.onClick(d,_)},[et(e.$slots,"default",{record:d})],8,Bn))),128))])],4)])],2)])}const Dt=W(Fn,[["render",wn]]);Dt.install=e=>{e.component("action-sheet",Dt)};const kn={class:"hero-item"},xn=["src","alt","title"],En={class:"hero-item-label"},Dn=lt({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(e,{emit:s}){const{heroes:n,getHeroIcon:u}=me(),c=b=>{s("click",b)};return(b,d)=>(i(),ut(o(Dt),{class:"hero-select",show:e.show,list:o(n),height:"80vh",onClick:c,"onUpdate:show":d[0]||(d[0]=_=>b.$emit("update:show",_))},{extra:m(()=>[et(b.$slots,"extra")]),default:m(({record:_})=>[t("div",kn,[t("img",{src:o(u)(_),alt:_.name,title:_.name,width:"128",height:"128"},null,8,xn),t("div",En,k(_.name),1)])]),_:3},8,["show","list"]))}});const Sn=lt({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(e,{emit:s}){const n=A({get:()=>e.activeKey,set:c=>{s("update:activeKey",c)}});return{active:n,toggle:()=>{const c=!n.value;n.value=c,s("toggle",c)}}}});const An=e=>(gt("data-v-829ec263"),e=e(),Bt(),e),Mn=An(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Un={class:"panel-title"},Vn={class:"panel-body"},In={class:"panel-content"};function Tn(e,s,n,u,c,b){return i(),r("div",{class:vt(["panel",{active:e.active}])},[t("div",{class:"panel-header",onClick:s[1]||(s[1]=(...d)=>e.toggle&&e.toggle(...d))},[Mn,t("div",Un,[et(e.$slots,"header",{},()=>[z(k(e.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:s[0]||(s[0]=_t(()=>{},["stop"]))},[et(e.$slots,"actions",{},void 0,!0)])]),t("div",Vn,[t("div",In,[et(e.$slots,"default",{},void 0,!0)])])],2)}const Hn=W(Sn,[["render",Tn],["__scopeId","data-v-829ec263"]]);function Pn(){const e="red_team",s=_e(),n=Q([]),u=Q(!1),c=Q(),b=async S=>{const P=(await s.transaction(e,"readwrite")).objectStore(e),V=await s.wrap(P.put(S));return n.value.find(st=>st._id===S._id)||(S._id=V,n.value.push(S)),V},d=async S=>{const P=(await s.transaction(e,"readwrite")).objectStore(e);await s.wrap(P.delete(S._id)),n.value=n.value.filter(V=>V._id!==S._id)},_=async S=>{const U=await s.transaction(e,"readwrite"),P=U.objectStore(e);for(const V of S)await s.wrap(P.put(V));await s.twrap(U),await I()},E=async()=>{const U=(await s.transaction(e,"readwrite")).objectStore(e);await s.wrap(U.clear()),n.value=[]},I=async()=>{const U=(await s.transaction(e,"readonly")).objectStore(e),P=await s.wrap(U.getAll()).catch(()=>[]);P.forEach(V=>{V.scList||(V.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}])}),n.value=P},D=async S=>{const U=JSON.parse(await S.text());if(!Lt(U)||U.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const P=U.data;P.forEach(V=>delete V._id),await _(P)},tt=async()=>{const S={type:"red_team",data:n.value},U=new Blob([JSON.stringify(S)],{type:"application/json"});Et(U,"red_team.json")};return I(),{scShow:u,scSelected:c,put:b,del:d,puts:_,clear:E,all:I,list:n,importData:D,exportData:tt}}const mt=e=>e%1>.5?Math.ceil(e):Math.floor(e);function Nn(){const e=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),s=Q(e()),n=A(()=>{const d=[0,0,0,0,0,0];return s.value.scList.forEach(_=>{!_.v||(d[0]+=_.v.qixue,d[1]+=_.v.patt,d[2]+=_.v.pdef,d[3]+=_.v.matt,d[4]+=_.v.mdef,d[5]+=_.v.huixin)}),d}),u=A(()=>{const d=s.value,_={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},E=Kt.find(tt=>d.stoneName===tt.name);E&&(_.qixue=E.t[0]+E.d[0]+E.h[0],_.patt=E.t[1]+E.d[1]+E.h[1],_.matt=E.t[2]+E.d[2]+E.h[2],_.pdef=E.t[3]+E.d[3]+E.h[3],_.mdef=E.t[4]+E.d[4]+E.h[4]);const I={qixue:d.hsQixue/100,patt:d.hsPatt/100,pdef:d.hsPdef/100,matt:d.hsMatt/100,mdef:d.hsMdef/100,huixin:d.hsHuixin/100},D=n.value;return{qixue:mt(d.qixue*I.qixue+_.qixue+D[0]),patt:mt(d.patt*I.patt+_.patt+D[1]),pdef:mt(d.pdef*I.pdef+_.pdef+D[2]),matt:mt(d.matt*I.matt+_.matt+D[3]),mdef:mt(d.mdef*I.mdef+_.mdef+D[4]),huixin:mt(d.huixin*I.huixin+_.huixin+D[5])}}),c=A(()=>{const d=u.value,_={qixue:(100+s.value.rQixue)/100,patt:(100+s.value.rPatt)/100,pdef:(100+s.value.rPdef)/100,matt:(100+s.value.rMatt)/100,mdef:(100+s.value.rMdef)/100,huixin:(100+s.value.rHuixin)/100};return{qixue:Math.round((s.value.qixue+d.qixue)*_.qixue),patt:Math.round((s.value.patt+d.patt)*_.patt),pdef:Math.round((s.value.pdef+d.pdef)*_.pdef),matt:Math.round((s.value.matt+d.matt)*_.matt),mdef:Math.round((s.value.mdef+d.mdef)*_.mdef),huixin:Math.round((s.value.huixin+d.huixin)*_.huixin)}});return{state:s,pValue:u,ckValue:c,reset:()=>{s.value=e()},defState:e}}const qn={},Rn={class:"c-upload"};function jn(e,s){return i(),r("div",Rn,[et(e.$slots,"default",{},void 0,!0),t("input",ve({type:"file",class:"c-upload-input",accept:"application/json"},e.$attrs),null,16)])}const Ln=W(qn,[["render",jn],["__scopeId","data-v-b3879154"]]),Z=e=>(gt("data-v-66a01228"),e=e(),Bt(),e),Kn={class:"transform-tools-popover"},On={class:"transform-tools-popover-toolbar"},Gn=["value"],Jn=["value"],Qn=Z(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),zn={class:"transform-tools-popover-content"},Xn={class:"grid-group"},Wn={class:"grid-group-item"},Zn={class:"input-group-title"},Yn=Z(()=>t("span",null,"\u57FA\u7840",-1)),to={class:"grids"},eo={class:"input-label"},so={class:"input-group"},no={class:"input green"},oo={class:"grid-group-item"},ao={class:"input-group-title"},uo=Z(()=>t("span",null,"\u9B42\u77F3",-1)),lo=Z(()=>t("option",{value:""},"\u65E0",-1)),io=["value"],co={class:"grids"},ro=Z(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),po=Z(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),_o=Z(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),vo=Z(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),fo=Z(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),ho={class:"grid-group-item"},mo={class:"input-group-title"},bo=z(" \u661F\u4E4B\u6676 "),$o=Z(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C70\u9632",-1)),Fo=Z(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C70\u9632\uFF0C88\u653B",-1)),yo=Z(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),Co={class:"grids"},go=["onClick","onContextmenu"],Bo={key:0},wo={key:1},ko={key:2},xo={key:3},Eo={key:4},Do={key:5},So={key:1},Ao={class:"grid-group-item"},Mo=Z(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Uo={class:"grids"},Vo={class:"input-label"},Io={class:"grid-group-item"},To=Z(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Ho={class:"grids"},Po={class:"input-label"},No=["value"],qo=lt({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(e,{emit:s}){const{state:n,pValue:u,ckValue:c,reset:b,defState:d}=Nn(),{list:_,put:E,del:I,clear:D,importData:tt,exportData:S}=Pn(),U=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],P=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],V=Q(!1),R=Q(),st=T=>{R.value=T,V.value=!0},nt=T=>{!R.value||(R.value.v=T)},N=()=>{const T=At.cloneDeep(n.value);E(T).then($=>{n.value._id=$,alert("\u5DF2\u4FDD\u5B58")}).catch($=>{console.log($),alert("\u4FDD\u5B58\u5931\u8D25")})},ot=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||I(n.value).then(()=>{b()}).catch($=>{console.log($),alert("\u5220\u9664\u5931\u8D25")})},x=T=>{const $=T.currentTarget;if(!$.files)return;const X=Array.prototype.slice.call($.files);$.value="",X[0]&&tt(X[0])},y=()=>{S()},v=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||D().catch($=>{console.log($),alert("\u6E05\u7A7A\u5931\u8D25")})},C=(T,$)=>{n.value.name=T,n.value.qixue=$.qixue,n.value.patt=$.patt,n.value.pdef=$.pdef,n.value.matt=$.matt,n.value.mdef=$.mdef,n.value.huixin=$.huixin},L=()=>{s("reference")};return s("init",C),(T,$)=>{const X=rt("c-col"),K=rt("c-space"),$t=rt("c-row");return j((i(),r("div",Kn,[t("div",On,[p($t,{flex:"",middle:"",gutter:8},{default:m(()=>[p(X,null,{default:m(()=>[t("button",{class:"btn btn-sm btn-link",onClick:L}," \u53C2\u8003 ")]),_:1}),p(X,null,{default:m(()=>[z("ID: "+k(o(n)._id),1)]),_:1}),p(X,{flex:"1 1 auto"},{default:m(()=>[p(K,null,{default:m(()=>[j(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":$[0]||($[0]=l=>yt(n)?n.value=l:null)},[t("option",{value:o(d)()},"\u7A7A\u6A21\u7248",8,Gn),(i(!0),r(q,null,G(o(_),l=>(i(),r("option",{key:l._id,value:l},k(l.name),9,Jn))),128))],512),[[Ht,o(n)]]),t("button",{class:"btn btn-sm btn-primary",onClick:N},"\u4FDD\u5B58"),o(n)._id?(i(),r("button",{key:0,class:"btn btn-sm btn-danger",onClick:ot}," \u5220\u9664 ")):O("",!0),p(Ln,{onChange:x},{default:m(()=>[Qn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:y}," \u5BFC\u51FA "),t("button",{class:"btn btn-sm btn-danger",onClick:v},"\u6E05\u7A7A")]),_:1})]),_:1}),p(X,null,{default:m(()=>[t("span",{class:"transform-tools-popover-close",onClick:$[1]||($[1]=l=>s("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",zn,[t("div",Xn,[t("div",Wn,[t("div",Zn,[p(K,null,{default:m(()=>[Yn,j(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":$[2]||($[2]=l=>o(n).name=l)},null,512),[[at,o(n).name]])]),_:1})]),t("div",to,[(i(),r(q,null,G(U,l=>p(K,{key:l.n},{default:m(()=>[t("label",eo,k(l.t),1),t("div",so,[p(o(ht),{readonly:"",value:o(n)[l.n]},null,8,["value"]),t("div",no,"+"+k(o(u)[l.n]),1)])]),_:2},1024)),64))])]),t("div",oo,[t("div",ao,[p(K,null,{default:m(()=>[uo,j(t("select",{class:"input input-select","onUpdate:modelValue":$[3]||($[3]=l=>o(n).stoneName=l)},[lo,(i(!0),r(q,null,G(o(Kt),(l,F)=>(i(),r("option",{key:F,value:l.name},k(l.name),9,io))),128))],512),[[Ht,o(n).stoneName]])]),_:1})]),t("div",co,[p(K,null,{default:m(()=>[ro,p(o(ht),{value:o(n).hsQixue,"onUpdate:value":$[4]||($[4]=l=>o(n).hsQixue=l)},null,8,["value"])]),_:1}),p(K,null,{default:m(()=>[po,p(o(ht),{value:o(n).hsPatt,"onUpdate:value":$[5]||($[5]=l=>o(n).hsPatt=l)},null,8,["value"])]),_:1}),p(K,null,{default:m(()=>[_o,p(o(ht),{value:o(n).hsPdef,"onUpdate:value":$[6]||($[6]=l=>o(n).hsPdef=l)},null,8,["value"])]),_:1}),p(K,null,{default:m(()=>[vo,p(o(ht),{value:o(n).hsMatt,"onUpdate:value":$[7]||($[7]=l=>o(n).hsMatt=l)},null,8,["value"])]),_:1}),p(K,null,{default:m(()=>[fo,p(o(ht),{value:o(n).hsMdef,"onUpdate:value":$[8]||($[8]=l=>o(n).hsMdef=l)},null,8,["value"])]),_:1})])]),t("div",ho,[t("div",mo,[bo,p(o(pt),{label:"?",inline:"",dir:"right"},{default:m(()=>[$o,Fo,yo]),_:1})]),t("div",Co,[(i(!0),r(q,null,G(o(n).scList,(l,F)=>(i(),r("div",{key:F,class:vt(["sc-props",{selected:R.value===l,s1:o(J).ATT===l.pos,s2:o(J).XUE===l.pos,s3:o(J).DEF===l.pos}]),onClick:a=>st(l),onContextmenu:_t(a=>l.v=void 0,["prevent"])},[l.v?(i(),r(q,{key:0},[l.v.qixue>0?(i(),r("span",Bo,"\u6C14\u8840+"+k(l.v.qixue),1)):O("",!0),l.v.patt>0?(i(),r("span",wo,"\u7269\u653B+"+k(l.v.patt),1)):O("",!0),l.v.pdef>0?(i(),r("span",ko,"\u7269\u9632+"+k(l.v.pdef),1)):O("",!0),l.v.matt>0?(i(),r("span",xo,"\u6CD5\u653B+"+k(l.v.matt),1)):O("",!0),l.v.mdef>0?(i(),r("span",Eo,"\u6CD5\u9632+"+k(l.v.mdef),1)):O("",!0),l.v.huixin>0?(i(),r("span",Do,"\u4F1A\u5FC3+"+k(l.v.huixin),1)):O("",!0)],64)):(i(),r("span",So,k(l.n),1))],42,go))),128))]),(i(),ut(jt,{to:"body"},[R.value?(i(),ut(o(ye),{key:0,show:V.value,"onUpdate:show":$[9]||($[9]=l=>V.value=l),position:R.value.pos,dir:"left",overlayStyle:"width:480px",onSelect:nt},null,8,["show","position"])):O("",!0)]))]),t("div",Ao,[Mo,t("div",Uo,[(i(),r(q,null,G(P,(l,F)=>p(K,{key:F},{default:m(()=>[t("label",Vo,k(l.t),1),p(o(Ct),{modelValue:o(n)[l.c],"onUpdate:modelValue":a=>o(n)[l.c]=a,result:o(n)[l.r],"onUpdate:result":a=>o(n)[l.r]=a},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",Io,[To,t("div",Ho,[(i(),r(q,null,G(U,l=>p(K,{key:l.n},{default:m(()=>[t("label",Po,k(l.t),1),t("input",{class:"input",readonly:"",value:o(c)[l.n]},null,8,No)]),_:2},1024)),64))])])])])],512)),[[fe,e.show]])}}});const Ro=W(qo,[["__scopeId","data-v-66a01228"]]),bt=e=>(gt("data-v-fd976cab"),e=e(),Bt(),e),jo={class:"wrapper"},Lo={class:"toolbar"},Ko={style:{padding:"6px 16px"}},Oo=z("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Go={class:"c-upload"},Jo=bt(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Qo={style:{padding:"6px 16px"}},zo={class:"input-group"},Xo=bt(()=>t("div",{class:"input-ext"},"=",-1)),Wo={class:"content"},Zo={class:"container"},Yo=["value"],ta=z(" \u2007 "),ea=["onKeypress"],sa={key:1},na=["onClick"],oa=["onClick"],aa=["onClick"],ua=z(" \u91CD\u547D\u540D "),la=["onClick"],ia=z(" \u590D\u5236 "),ca=["onClick"],da=["onClick"],ra={style:{"text-align":"center"}},pa=bt(()=>t("span",null,"\u661F\u8000",-1)),_a=bt(()=>t("span",null,"\u5316\u81FB",-1)),va=bt(()=>t("span",null,"\u661F\u9B42",-1)),fa=bt(()=>t("span",null,"\u661F\u8F89",-1)),ha=lt({__name:"Calculator",setup(e){const s=it({id:"",title:"",selecteds:[],search:""}),n=Q([]),u=A(()=>n.value.filter(F=>F.title.indexOf(s.search)>-1)),c=async()=>{const a={id:Nt(),title:"\u6A21\u677F",basic:Ze(),state:ts(),enemyState:ns(),items:ss()};await Qe(a),n.value.push(a)},b=async F=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const g=n.value.findIndex(H=>H.id===F);g!==-1&&(await ze(n.value[g].id),n.value.splice(g,1))},d=async F=>{const a=s.title;if(!a){_();return}const g=n.value.findIndex(Y=>Y.id===F);if(g===-1)return;const H=n.value[g];H.title=a,_(),await wt(H)},_=()=>{s.id="",s.title=""},E=F=>{const a={type:"calculator",data:[F]},g=new Blob([JSON.stringify(a)],{type:"application/json"});Et(g,`${F.title}.json`)},I=async F=>{n.value=F},D=F=>new Promise((a,g)=>{const H=new FileReader;H.onload=()=>{a(H.result)},H.onerror=()=>{g(H.error)},H.readAsText(F)}),tt=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let a=u.value;s.selecteds.length>0&&(a=s.selecteds.map(g=>u.value[g]).filter(g=>g)),await We(a.map(g=>g.id)),l()},S=async F=>{const a=F.currentTarget,g=Array.prototype.slice.call(a.files);if(a.value="",!g||!g[0])return;const H=g[0],Y=await D(H),f=JSON.parse(Y);let B=[];if(Fe(f))B=f;else if(Lt(f)&&f.type==="calculator")B=f.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Xe(B),l()},U=async()=>{let F="calculator.json",a=u.value;s.selecteds.length>0&&(a=s.selecteds.map(Y=>u.value[Y]).filter(Y=>Y),F="calculator-selected.json");const g={type:"calculator",data:a},H=new Blob([JSON.stringify(g)],{type:"application/json"});Et(H,F)};async function P(F,a){const g=n.value.findIndex(Y=>Y.id===a);g===-1||!n.value[g]||(n.value[g]=F,await wt(F))}const V=Q(-1),R=it({input:"2283/1.35*1.39",result:0}),{translate:st,xingyao:nt,huazhen:N,xinghun:ot,xinghui:x}=$e(),y=F=>Math.ceil(F),v=it({show:!1}),C=F=>{const a=st(F);L.value&&L.value(F.name,a)},L=Q(),T=Q(!1),$=Q(),X=F=>{T.value=!0,$.value=F},K=({item:F})=>{if(T.value=!1,$.value){const a=$.value,g=st(F);a.title==="\u6A21\u677F"&&(a.title=F.name),a.basic.w=Math.max(g.patt,g.matt),wt(a)}else C(F)},$t=F=>{const a=At.cloneDeep(F);a.id=Nt(),console.log(a),n.value.push(a),wt(a)};async function l(){const F=await Je();s.selecteds=[],I(F)}return he(()=>{l()}),(F,a)=>{const g=rt("c-col"),H=rt("c-row"),Y=rt("calc-input"),f=rt("c-space"),B=Rt("autofocus");return i(),r("div",jo,[t("div",Lo,[t("div",Ko,[p(H,{flex:"",middle:"",gutter:16},{default:m(()=>[p(g,{flex:"0 0 auto"},{default:m(()=>[Oo]),_:1}),p(g,{flex:"0 0 auto"},{default:m(()=>[t("button",{class:"btn btn-sm btn-link",onClick:a[0]||(a[0]=h=>v.show=!v.show)}," \u9762\u677F "),s.selecteds.length>0?(i(),r("button",{key:0,class:"btn btn-success",onClick:a[1]||(a[1]=h=>s.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):O("",!0)]),_:1}),p(g,{flex:"1 1 0"},{default:m(()=>[j(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":a[2]||(a[2]=h=>s.search=h)},null,512),[[at,s.search]])]),_:1}),p(g,{flex:"0 0 auto"},{default:m(()=>[t("button",{class:"btn btn-danger",onClick:tt},k(s.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Go,[Jo,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:S},null,32)]),t("button",{class:"btn btn-success",onClick:U},k(s.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:a[3]||(a[3]=h=>c())},"\u6DFB\u52A0")]),_:1})]),_:1}),p(Ro,{show:v.show,"onUpdate:show":a[4]||(a[4]=h=>v.show=h),onReference:a[5]||(a[5]=h=>X()),onInit:a[6]||(a[6]=h=>L.value=h)},null,8,["show"])]),t("div",Qo,[t("div",zo,[p(Y,{modelValue:R.input,"onUpdate:modelValue":a[7]||(a[7]=h=>R.input=h),result:R.result,"onUpdate:result":a[8]||(a[8]=h=>R.result=h),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Xo,p(be,{readonly:"",value:y(R.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",Wo,[t("div",Zo,[(i(!0),r(q,null,G(o(u),(h,w)=>(i(),ut(o(Hn),{key:h.id,activeKey:w===V.value,onToggle:M=>V.value=M?w:-1},{header:m(()=>[p(H,{flex:"",middle:""},{default:m(()=>[p(g,null,{default:m(()=>[j(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":a[9]||(a[9]=M=>s.selecteds=M),value:w,onClick:a[10]||(a[10]=_t(()=>{},["stop"]))},null,8,Yo),[[Ft,s.selecteds]]),ta]),_:2},1024),p(g,null,{default:m(()=>[s.id===h.id?j((i(),r("input",{key:0,type:"text",class:"input","onUpdate:modelValue":a[11]||(a[11]=M=>s.title=M),onClick:a[12]||(a[12]=_t(()=>{},["stop"])),onKeypress:xt(M=>d(h.id),["enter"])},null,40,ea)),[[at,s.title],[B]]):(i(),r("span",sa,k(h.title),1))]),_:2},1024),p(g,{class:"ml-4",onClick:a[13]||(a[13]=_t(()=>{},["stop"]))},{default:m(()=>[s.id===h.id?(i(),r("button",{key:0,class:"btn btn-sm btn-link",onClick:M=>d(h.id)}," \u786E\u8BA4 ",8,na)):(i(),r(q,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:M=>X(h)}," \u9009\u62E9 ",8,oa),t("button",{class:"btn btn-sm btn-link",onClick:M=>{s.id=h.id,s.title=h.title}},[p(o(Oe),{class:"svg-icon"}),ua],8,aa),t("button",{class:"btn btn-sm btn-link",onClick:M=>$t(h)},[p(o(Ot),{class:"svg-icon"}),ia],8,la)],64))]),_:2},1024)]),_:2},1024)]),actions:m(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:M=>E(h)}," \u5BFC\u51FA ",8,ca),t("button",{class:"btn btn-sm btn-danger-outline",onClick:M=>b(h.id)}," \u5220\u9664 ",8,da)]),default:m(()=>[w===V.value?(i(),ut(o($n),{key:0,data:h,"onUpdate:data":M=>P(M,h.id)},null,8,["data","onUpdate:data"])):O("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),p(o(Dn),{show:T.value,"onUpdate:show":a[18]||(a[18]=h=>T.value=h),onClick:K},{extra:m(()=>[t("div",ra,[p(f,null,{default:m(()=>[t("label",null,[pa,j(t("input",{type:"checkbox","onUpdate:modelValue":a[14]||(a[14]=h=>yt(nt)?nt.value=h:null)},null,512),[[Ft,o(nt)]])]),t("label",null,[_a,j(t("input",{type:"checkbox","onUpdate:modelValue":a[15]||(a[15]=h=>yt(N)?N.value=h:null)},null,512),[[Ft,o(N)]])]),t("label",null,[va,j(t("input",{type:"checkbox","onUpdate:modelValue":a[16]||(a[16]=h=>yt(ot)?ot.value=h:null)},null,512),[[Ft,o(ot)]])]),t("label",null,[fa,j(t("input",{type:"checkbox","onUpdate:modelValue":a[17]||(a[17]=h=>yt(x)?x.value=h:null)},null,512),[[Ft,o(x)]])])]),_:1})])]),_:1},8,["show"])])}}});const Ba=W(ha,[["__scopeId","data-v-fd976cab"]]);export{Ba as default};
