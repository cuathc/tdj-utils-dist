import{d as io,s as T,a as po,q,P as go,S as Co,V as vo,_ as fo,o as M,c as F,e as a,n as V,b as So,w as g,U as eo,Q as I,B as k,T as ho,p as bo,l as mo,v as J,g as D,i as to,j as Bo,F as no,h as lo,r as ao,k as so,f as ro,W as ko}from"./index.js";import{_ as Vo}from"./lodash.js";const uo=(o,t,p)=>{let c=0,s=0,u=0;o%=360;const l=Math.floor(o/60),i=o/60-l,r=p*(1-t),f=p*(1-t*i),v=p*(1-t*(1-i));switch(l){case 0:c=p,s=v,u=r;break;case 1:c=f,s=p,u=r;break;case 2:c=r,s=p,u=v;break;case 3:c=r,s=f,u=p;break;case 4:c=v,s=r,u=p;break;case 5:c=p,s=r,u=f;break}c=Math.floor(c*255),s=Math.floor(s*255),u=Math.floor(u*255);const $=("00"+c.toString(16)).slice(-2),P=("00"+s.toString(16)).slice(-2),B=("00"+u.toString(16)).slice(-2);return[o,t,p,c,s,u,"#"+$+P+B]},co=o=>{let t=0,p=0,c=0,s=0,u=0,l=0;if(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i.test(o))t=window.parseInt(RegExp.$1,16),p=window.parseInt(RegExp.$2,16),c=window.parseInt(RegExp.$3,16);else if(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i.test(o))t=window.parseInt(RegExp.$1,10),p=window.parseInt(RegExp.$2,10),c=window.parseInt(RegExp.$3,10);else return[0,0,0,0,0,0,"#000000"];s=t/255,u=p/255,l=c/255;let i=s;u>i&&(i=u),l>i&&(i=l);let r=s;u<r&&(r=u),l<r&&(r=l);let f=0,v=0,$=0;i===r?f=0:i===s&&u>=l?f=60*(u-l)/(i-r)+0:i===s&&u<l?f=60*(u-l)/(i-r)+360:i===u?f=60*(l-s)/(i-r)+120:i===l&&(f=60*(s-u)/(i-r)+240),i===0?v=0:v=1-r/i,$=i;const P=("00"+t.toString(16)).slice(-2),B=("00"+p.toString(16)).slice(-2),A=("00"+c.toString(16)).slice(-2);return[Math.floor(f),v,$,t,p,c,"#"+P+B+A]};const Po=io({name:"ColorPicker",emits:["update:modelValue"],props:{modelValue:{type:String,required:!0}},setup(o,{emit:t}){const p=T(!1),c=po({set:d=>{t("update:modelValue",d)},get:()=>o.modelValue}),s=q({h:0,s:0,v:0,r:0,g:0,b:0}),u=q({rect_down:!1,rect_left:0,rect_bottom:0,ver_down:!1,ver_bottom:0}),l={rect:{left:0,bottom:0,x:0,y:0},ver:{bottom:0,y:0}},i=T(!1),r=()=>{i.value=!0},f=Vo.debounce(()=>{i.value=!1},300),v=()=>{r();const d=uo(s.h,s.s,s.v);s.r=d[3],s.g=d[4],s.b=d[5],c.value=d[6],u.ver_bottom=s.h,u.rect_left=s.s*360,u.rect_bottom=s.v*360,f()},$=()=>{r();const d=co(`${s.r},${s.g},${s.b}`);s.h=d[0],s.s=d[1],s.v=d[2],c.value=d[6],u.ver_bottom=s.h,u.rect_left=s.s*360,u.rect_bottom=s.v*360,f()},P=d=>{d=d||"#000000";const w=co(d);s.h=w[0],s.s=w[1],s.v=w[2],s.r=w[3],s.g=w[4],s.b=w[5],u.ver_bottom=s.h,u.rect_left=s.s*360,u.rect_bottom=s.v*360},B=()=>{const d=uo(u.ver_bottom,u.rect_left/360,u.rect_bottom/360);s.h=d[0],s.s=d[1],s.v=d[2],s.r=d[3],s.g=d[4],s.b=d[5],c.value=d[6]},A=d=>{u.rect_down=!0,l.rect.x=d.clientX,l.rect.y=d.clientY;const w=d.currentTarget,S=w.getBoundingClientRect().left,O=w.getBoundingClientRect().top;l.rect.left=u.rect_left=d.clientX-S,l.rect.bottom=u.rect_bottom=360-(d.clientY-O),B()},L=d=>{if(!u.rect_down)return;const w=d.clientX-l.rect.x,S=d.clientY-l.rect.y;u.rect_left=Math.max(0,Math.min(360,l.rect.left+w)),u.rect_bottom=Math.max(0,Math.min(360,l.rect.bottom-S)),B()},G=()=>{!u.rect_down||(u.rect_down=!1)},E=d=>{u.ver_down=!0,l.ver.y=d.clientY;const S=d.currentTarget.getBoundingClientRect().top;l.ver.bottom=u.ver_bottom=360-(d.clientY-S),B()},x=d=>{if(!u.ver_down)return;const w=d.clientY-l.ver.y;u.ver_bottom=Math.max(0,Math.min(360,l.ver.bottom-w)),B()},U=()=>{!u.ver_down||(u.ver_down=!1)},X=()=>{p.value=!0},z=()=>{p.value=!1};return go(()=>o.modelValue,d=>{u.ver_down||u.rect_down||i.value||(console.log("watch"),P(d))}),P(o.modelValue),Co(()=>{window.addEventListener("mousemove",L,!1),window.addEventListener("mouseup",G,!1),window.addEventListener("mousemove",x,!1),window.addEventListener("mouseup",U,!1)}),vo(()=>{window.removeEventListener("mousemove",L,!1),window.removeEventListener("mouseup",G,!1),window.removeEventListener("mousemove",x,!1),window.removeEventListener("mouseup",U,!1)}),{show:p,color:c,vars:s,state:u,colorRectPointerStart:A,colorVerPointerStart:E,updateHSV:v,updateRGB:$,updateHex:P,onOpen:X,onComfirm:z}}}),H=o=>(bo("data-v-5a88cd3c"),o=o(),mo(),o),Ro={class:"color-control"},$o={class:"colorPanel_posLayer"},Eo=H(()=>a("div",{class:"colorPanel_colorVerBg"},null,-1)),Mo={class:"colorPanel_viewbox"},Fo=H(()=>a("div",{class:"colorPanel_view__label"},"HSV",-1)),Do=H(()=>a("div",{class:"colorPanel_view__label"},"RGB",-1)),Ao=H(()=>a("div",{class:"colorPanel_view__label"},"Hex",-1));function Go(o,t,p,c,s,u){return M(),F("div",Ro,[a("div",{class:"color-preview",style:V({backgroundColor:o.color}),onClick:t[0]||(t[0]=(...l)=>o.onOpen&&o.onOpen(...l))},null,4),(M(),So(ho,{to:"body"},[g(a("div",{class:"colorPanel_posMask",onWheel:t[1]||(t[1]=I(()=>{},["prevent"])),onTouchstart:t[2]||(t[2]=I(()=>{},["prevent"])),onClick:t[3]||(t[3]=(...l)=>o.onComfirm&&o.onComfirm(...l))},null,544),[[eo,o.show]]),g(a("div",$o,[a("div",{style:V(`background-color: hsl(${o.vars.h}deg, 100%, 50%)`),class:"colorPanel_colorRectBg"},[a("div",{class:"colorPanel_colorRect",onMousedown:t[4]||(t[4]=I((...l)=>o.colorRectPointerStart&&o.colorRectPointerStart(...l),["prevent","stop"]))},[a("div",{class:"colorPanel_colorRectPointer",style:V({left:`${o.state.rect_left}px`,bottom:`${o.state.rect_bottom}px`})},null,4)],32)],4),a("div",{class:"colorPanel_colorVer",onMousedown:t[5]||(t[5]=I((...l)=>o.colorVerPointerStart&&o.colorVerPointerStart(...l),["prevent","stop"]))},[Eo,a("div",{class:"colorPanel_colorVerPointer",style:V({bottom:`${o.state.ver_bottom}px`})},null,4)],32),a("div",Mo,[a("div",{class:"colorPanel_viewcolor",style:V({background:o.color})},null,4),Fo,g(a("input",{type:"number",max:"360",min:"0",step:"1","onUpdate:modelValue":t[6]||(t[6]=l=>o.vars.h=l),class:"colorPanel_view__input",onInput:t[7]||(t[7]=(...l)=>o.updateHSV&&o.updateHSV(...l))},null,544),[[k,o.vars.h]]),g(a("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":t[8]||(t[8]=l=>o.vars.s=l),class:"colorPanel_view__input",onInput:t[9]||(t[9]=(...l)=>o.updateHSV&&o.updateHSV(...l))},null,544),[[k,o.vars.s]]),g(a("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":t[10]||(t[10]=l=>o.vars.v=l),class:"colorPanel_view__input",onInput:t[11]||(t[11]=(...l)=>o.updateHSV&&o.updateHSV(...l))},null,544),[[k,o.vars.v]]),Do,g(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[12]||(t[12]=l=>o.vars.r=l),class:"colorPanel_view__input",onInput:t[13]||(t[13]=(...l)=>o.updateRGB&&o.updateRGB(...l))},null,544),[[k,o.vars.r]]),g(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[14]||(t[14]=l=>o.vars.g=l),class:"colorPanel_view__input",onInput:t[15]||(t[15]=(...l)=>o.updateRGB&&o.updateRGB(...l))},null,544),[[k,o.vars.g]]),g(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[16]||(t[16]=l=>o.vars.b=l),class:"colorPanel_view__input",onInput:t[17]||(t[17]=(...l)=>o.updateRGB&&o.updateRGB(...l))},null,544),[[k,o.vars.b]]),Ao,g(a("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=l=>o.color=l),class:"colorPanel_view__input"},null,512),[[k,o.color]]),a("div",{class:"colorPanel_enter",onClick:t[19]||(t[19]=(...l)=>o.onComfirm&&o.onComfirm(...l))},"\u786E\u8BA4")])],512),[[eo,o.show]])]))])}var Y=fo(Po,[["render",Go],["__scopeId","data-v-5a88cd3c"]]);Y.install=function(o){o.component(Y.name,Y)};const Uo=io({components:{ColorPicker:Y},setup(){const o=[{color:"#202020",bgcolor:"#ffffff"},{color:"#202020",bgcolor:"#FF3C41"},{color:"#202020",bgcolor:"#48CF74"},{color:"#202020",bgcolor:"#0EBEFF"},{color:"#202020",bgcolor:"#FCD000"}],t=q({editor:1,selectRange:5,shape:1,sortType:1,color:o[0].color,bgcolor:o[0].bgcolor});function p(e){t.color=e.color,t.bgcolor=e.bgcolor}const c=T([]),s=T([]),u=15,l=15,i=po(()=>({gridTemplateColumns:"repeat("+u+", 48px)",gridTemplateRows:"repeat("+l+", 48px)"}));function r(){for(let e=0;e<l;e++)for(let n=0;n<u;n++){const y={x:n+1,y:l-e,data:{d:0,d1:0,d2:0,q:0,color:o[0].color,bgcolor:o[0].bgcolor,size:14,txt:""}};c.value.push(y)}}function f(e,n,y,_,R,h,C){c.value.forEach(b=>{const W=e-b.x,j=n-b.y,Q=Math.abs(W)+Math.abs(j),oo=Math.max(Math.abs(W),Math.abs(j));switch(_){case 1:Q<=y&&(b.data.d=Q,b.data.q=oo,b.data.color=h,b.data.bgcolor=C,s.value.push(b));break;case 2:Math.abs(W)<=y&&Math.abs(j)<=y&&(b.data.d=Q,b.data.q=oo,b.data.color=h,b.data.bgcolor=C,s.value.push(b));break}}),R===1&&(_===1?s.value.sort(v):_===2&&s.value.sort(P)),R===2&&(_===1?s.value.sort($):_===2&&s.value.sort(B)),R===3&&s.value.sort(A),R===4&&s.value.sort(L);for(let b=0;b<s.value.length;b++)s.value[b].data.txt=String(b+1)}function v(e,n){return e.data.d!==n.data.d?e.data.d-n.data.d:e.x!==n.x?e.x-n.x:e.y!==n.y?e.y-n.y:0}function $(e,n){return e.data.d!==n.data.d?e.data.d-n.data.d:e.y!==n.y?e.y-n.y:e.x!==n.x?e.x-n.x:0}function P(e,n){return e.data.q!==n.data.q?e.data.q-n.data.q:e.data.d!==n.data.d?e.data.d-n.data.d:e.x!==n.x?e.x-n.x:e.y!==n.y?e.y-n.y:0}function B(e,n){return e.data.q!==n.data.q?e.data.q-n.data.q:e.data.d!==n.data.d?e.data.d-n.data.d:e.y!==n.y?e.y-n.y:e.x!==n.x?e.x-n.x:0}function A(e,n){return e.x!==n.x?e.x-n.x:e.y!==n.y?e.y-n.y:0}function L(e,n){return e.y!==n.y?e.y-n.y:e.x!==n.x?e.x-n.x:0}function G(){c.value.forEach(e=>{e.data.q=0,e.data.d=0,e.data.d1=0,e.data.d2=0,e.data.color=o[0].color,e.data.bgcolor=o[0].bgcolor,e.data.txt="",e.data.guard=!1}),s.value=[]}const E=q({enabled:!1});function x(){G()}function U(){E.enabled=!1}function X(e,n){t.editor===1&&(E.current=n)}function z(e,n){if(e.button===0)switch(t.editor){case 2:{E.enabled=!0,n.data.color=t.color,n.data.bgcolor=t.bgcolor;break}case 3:{G(),f(n.x,n.y,t.selectRange,t.shape,t.sortType,t.color,t.bgcolor);break}}}function d(e,n){e.button===0&&E.enabled&&(n.data.color=t.color,n.data.bgcolor=t.bgcolor)}function w(){E.current=void 0}const S=q({}),O=(e,n)=>{switch(t.editor){case 4:case 5:S.grid=n;break;default:e.preventDefault()}},wo=(e,n)=>{if(e.preventDefault(),!S.grid)return;const y=S.grid.data;S.grid.data=n.data,n.data=y,S.grid=void 0,t.editor===5&&N()};function K(e,n){let y=e[0].data[n];for(let _=1;_<e.length;_++)e[_].data[n]<y&&(y=e[_].data[n]);return y}function Z(e,n){return Math.abs(e.x-n.x)+Math.abs(e.y-n.y)}function yo(e,n,y){e.sort((C,b)=>+C.data.txt-+b.data.txt),e.forEach(C=>{C.data.d1=Z(C,y),C.data.d2=Z(C,n),C.data.guard=!1});const _=K(e,"d1");e=e.filter(C=>C.data.d1===_);const R=e[0];if(e.length===1)return e[0];const h=K(e,"d2");return e=e.filter(C=>C.data.d2===h),R!==e[0]?e[e.length-1]:R}function _o(){let e=0;for(let n=0;n<4;n++)c.value[e].data.txt=`${n+1}`,c.value[e].data.bgcolor="#0ebeff",e++;c.value[e].data.txt="A",c.value[e].data.bgcolor="#FF3C41",e++,c.value[e].data.txt="B",c.value[e].data.bgcolor="#FCD000",e++,t.editor=5}const N=()=>{const e=c.value.filter(h=>h.data.txt),n=e.filter(h=>h.data.txt.toUpperCase()==="A")[0],y=e.filter(h=>h.data.txt.toUpperCase()==="B")[0],_=e.filter(h=>+h.data.txt>0);if(!n||!y||_.length===0){alert("\u7F3A\u5C11\u89D2\u8272\uFF0C\u5C06\u81EA\u52A8\u751F\u6210"),_o(),N();return}const R=yo(_,n,y);R.data.guard=!0};return window.addEventListener("mouseup",U,!1),vo(()=>{window.removeEventListener("mouseup",U,!1)}),r(),{state:t,colors:o,grids:c,selects:s,gridsStyle:i,selectState:E,onSelectColor:p,onResetClick:x,onGridClick:X,onGridMouseDown:z,onGridMouseEnter:d,onGridEditorDone:w,dragState:S,onDragStart:O,onDrop:wo,onCalcGuard:N}}}),m=o=>(bo("data-v-012dae94"),o=o(),mo(),o),Io={class:"wrapper"},qo={class:"toolbar"},Lo={class:"setting"},xo={class:"label-control"},Yo=m(()=>a("span",null,"\u7F16\u8F91\u6A21\u5F0F\xA0",-1)),To=ko('<option value="1" data-v-012dae94>\u7F16\u8F91</option><option value="2" data-v-012dae94>\u4E0A\u8272</option><option value="3" data-v-012dae94>\u9009\u62E9</option><option value="4" data-v-012dae94>\u62D6\u62FD</option><option value="5" data-v-012dae94>\u62A4\u536B\u8BA1\u7B97</option>',5),Ho=[To],Xo={class:"label-control"},zo=m(()=>a("span",null,"\u8303\u56F4\xA0",-1)),Oo={class:"label-control"},No=m(()=>a("span",null,"\u5F62\u72B6\xA0",-1)),Wo=m(()=>a("option",{value:1},"\u83F1\u5F62",-1)),jo=m(()=>a("option",{value:2},"\u5708\u6570",-1)),Qo=[Wo,jo],Jo={class:"label-control"},Ko=m(()=>a("span",null,"\u6392\u5E8F\xA0",-1)),Zo=m(()=>a("option",{value:1},"\u8DDD\u79BBX",-1)),oe=m(()=>a("option",{value:2},"\u8DDD\u79BBY",-1)),ee=m(()=>a("option",{value:3},"X\u4F18\u5148",-1)),te=m(()=>a("option",{value:4},"Y\u4F18\u5148",-1)),ne=[Zo,oe,ee,te],le={class:"color-container"},ae={class:"label-control"},se=m(()=>a("span",null,"\u9884\u89C8\xA0",-1)),re={class:"label-control"},ue=m(()=>a("span",null,"\u6587\u5B57\xA0",-1)),de={class:"label-control"},ce=m(()=>a("span",null,"\u80CC\u666F\xA0",-1)),ie=m(()=>a("label",{class:"label-control"},[a("span",null,"\u9884\u8BBE\xA0")],-1)),pe={class:"color-tpls"},ve=["onClick"],fe={class:"props-container"},be={key:0,class:"props-content"},me={class:"label-control"},we=m(()=>a("span",null,"\u9884\u89C8\xA0",-1)),ye={class:"label-control"},_e=m(()=>a("span",null,"\u6587\u5B57\xA0",-1)),ge={class:"label-control"},Ce=m(()=>a("span",null,"\u80CC\u666F\xA0",-1)),Se={class:"label-control"},he=m(()=>a("span",null,"\u5927\u5C0F\xA0",-1)),Be={class:"label-control"},ke=m(()=>a("span",null,"\u5185\u5BB9\xA0",-1)),Ve={class:"content"},Pe=["onDragstart","onDrop","onClick","onMousedown","onMouseenter"];function Re(o,t,p,c,s,u){const l=ao("ColorPicker"),i=ao("c-space");return M(),F("div",Io,[a("div",qo,[a("div",Lo,[a("label",xo,[Yo,g(a("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.state.editor=r)},Ho,512),[[J,o.state.editor,void 0,{number:!0}]])]),a("label",Xo,[zo,g(a("input",{type:"number",min:"0","onUpdate:modelValue":t[1]||(t[1]=r=>o.state.selectRange=r),style:{width:"5em"}},null,512),[[k,o.state.selectRange]])]),a("label",Oo,[No,g(a("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.state.shape=r)},Qo,512),[[J,o.state.shape]])]),a("label",Jo,[Ko,g(a("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.state.sortType=r)},ne,512),[[J,o.state.sortType]])]),a("button",{class:"btn",onClick:t[4]||(t[4]=(...r)=>o.onResetClick&&o.onResetClick(...r))},"\u6E05\u7A7A"),a("button",{class:"btn",onClick:t[5]||(t[5]=(...r)=>o.onCalcGuard&&o.onCalcGuard(...r))},"\u8BA1\u7B97\u62A4\u536B")]),a("div",le,[D(i,null,{default:to(()=>[a("label",ae,[se,a("div",{class:"color-unit",style:V([`--color:${o.state.color};--bgcolor:${o.state.bgcolor}`])}," E ",4)]),a("label",re,[ue,D(l,{modelValue:o.state.color,"onUpdate:modelValue":t[6]||(t[6]=r=>o.state.color=r)},null,8,["modelValue"])]),a("label",de,[ce,D(l,{modelValue:o.state.bgcolor,"onUpdate:modelValue":t[7]||(t[7]=r=>o.state.bgcolor=r)},null,8,["modelValue"])]),ie,a("div",pe,[(M(!0),F(no,null,lo(o.colors,(r,f)=>(M(),F("div",{key:f,class:so(["color-unit",{selected:o.state.bgcolor===r.bgcolor}]),style:V([`--color:${r.color};--bgcolor:${r.bgcolor}`]),onClick:v=>o.onSelectColor(r)}," E ",14,ve))),128))])]),_:1})]),a("div",fe,[o.selectState.current?(M(),F("div",be,[D(i,null,{default:to(()=>[a("label",me,[we,a("div",{class:"color-unit",style:V([`--color:${o.selectState.current.data.color};--bgcolor:${o.selectState.current.data.bgcolor}`])},ro(o.selectState.current.data.txt),5)]),a("label",ye,[_e,D(l,{modelValue:o.selectState.current.data.color,"onUpdate:modelValue":t[8]||(t[8]=r=>o.selectState.current.data.color=r)},null,8,["modelValue"])]),a("label",ge,[Ce,D(l,{modelValue:o.selectState.current.data.bgcolor,"onUpdate:modelValue":t[9]||(t[9]=r=>o.selectState.current.data.bgcolor=r)},null,8,["modelValue"])]),a("label",Se,[he,g(a("input",{type:"number",style:{width:"4em"},min:"12",step:"1","onUpdate:modelValue":t[10]||(t[10]=r=>o.selectState.current.data.size=r)},null,512),[[k,o.selectState.current.data.size]])]),a("label",Be,[ke,g(a("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=r=>o.selectState.current.data.txt=r)},null,512),[[k,o.selectState.current.data.txt]])]),a("button",{class:"btn",onClick:t[12]||(t[12]=(...r)=>o.onGridEditorDone&&o.onGridEditorDone(...r))},"\u5B8C\u6210")]),_:1})])):Bo("",!0)])]),a("div",Ve,[a("div",{class:"grids",style:V(o.gridsStyle)},[(M(!0),F(no,null,lo(o.grids,(r,f)=>(M(),F("div",{key:f,class:so({selected:r===o.selectState.current,guard:r.data.guard}),style:V({fontSize:`${r.data.size}px`,color:r.data.color,backgroundColor:r.data.bgcolor}),draggable:!0,onDragstart:v=>o.onDragStart(v,r),onDragover:t[13]||(t[13]=I(()=>{},["prevent"])),onDrop:v=>o.onDrop(v,r),onClick:v=>o.onGridClick(v,r),onMousedown:v=>o.onGridMouseDown(v,r),onMouseenter:v=>o.onGridMouseEnter(v,r)},ro(r.data.txt),47,Pe))),128))],4)])])}var Me=fo(Uo,[["render",Re],["__scopeId","data-v-012dae94"]]);export{Me as default};
