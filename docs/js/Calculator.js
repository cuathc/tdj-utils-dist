import{_ as tt,H as ue,o as d,c as v,b as t,J as le,K as ce,L as ie,M as dt,d as ct,h as X,N as zt,r as nt,l as E,g as ht,n as It,O as de,P as vt,i as it,a as I,k as h,w as F,e as u,f as J,Q as re,m as O,E as ut,R as Mt,S as pe,U as _e,F as G,q as K,C as W,V as xt,W as Lt,x as wt,y as kt,j as lt,T as qt,I as fe,A as ve,X as he,s as _t,B as Ct,v as Gt,Y as bt,Z as L,$ as me,p as gt}from"./index.js";import{_ as Dt}from"./lodash.js";import{u as be}from"./useHeroes.js";import Fe from"./InputNumber.js";import{b as jt,d as Ut,a as Be,i as $e}from"./shared.js";import{S as Q,a as ye}from"./star-crystals.js";import{s as Ot}from"./data.js";const ge=["width","height"],Ce=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),xe=[Ce];function we(s,o,e,a,l,m){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},xe,8,ge)}const ke=tt(ue,[["render",we]]),Ee=["width","height"],De=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Se=[De];function Ae(s,o,e,a,l,m){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Se,8,Ee)}const Me=tt(le,[["render",Ae]]),Ue=["width","height"],Ve=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),Ie=[Ve];function Te(s,o,e,a,l,m){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},Ie,8,Ue)}const Kt=tt(ce,[["render",Te]]),He=["width","height"],Pe=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Ge=[Pe];function Re(s,o,e,a,l,m){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},Ge,8,He)}const Ne=tt(ie,[["render",Re]]);let At=0,Rt=0;const ze=500;function Nt(){const s=Math.floor(new Date().getTime()/1e3);Rt===s?At++:At=0,Rt=s;const o=s.toString(16);return`${(ze<<16|At&255).toString(16)}.${o}`}async function Le(){try{return await dt.getAll("calculator")}catch{return[]}}async function qe(s){try{await dt.add("calculator",JSON.parse(JSON.stringify(s)))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Et(s){try{await dt.put("calculator",JSON.parse(JSON.stringify(s)))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function je(s){try{await dt.delete("calculator",s)}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Oe(s){try{const a=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await dt.wrap(a.put(l))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Ke(s){try{const a=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await dt.wrap(a.delete(l))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}function Je(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Qe(){return{a:0}}function Xe(){return{att:0}}function Jt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function We(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ze(){return[Jt()]}function Ye(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const ts=ct({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(s,{emit:o}){const e=X(),a=X({}),l=X(s.active),m=()=>{const C=e.value.getBoundingClientRect();switch(l.value=!0,o("update:active",l.value),s.dir){case"left":a.value={top:`${C.top+C.height/2}px`,right:`${window.innerWidth-C.left-4}px`,maxWidth:"100%"};break;case"right":a.value={top:`${C.top+C.height/2}px`,left:`${C.right+4}px`,maxWidth:"100%"};break;case"top":a.value={bottom:`${window.innerHeight-C.top-4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"};break;default:a.value={top:`${C.bottom+4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"}}};let _;const i=()=>{_=window.setTimeout(m,s.wait)},x=()=>{clearTimeout(_),l.value=!1,o("update:active",l.value)};return zt(()=>s.active,S=>{l.value=S}),{el:e,style:a,tActive:l,onEnter:i,onOut:x}}});const es={class:"c-tooltip-label"};function ss(s,o,e,a,l,m){return d(),v("div",{ref:"el",class:ht(["c-tooltip",{active:s.tActive,inline:s.inline}]),onMouseenter:o[0]||(o[0]=(..._)=>s.onEnter&&s.onEnter(..._)),onMouseout:o[1]||(o[1]=(..._)=>s.onOut&&s.onOut(..._))},[nt(s.$slots,"label",{},()=>[t("div",es,E(s.label),1)]),t("div",{class:ht(["c-tooltip-inner",s.dir?`c-tooltip-${s.dir}`:"c-tooltip-bottom",s.color?`c-tooltip-${s.color}`:""]),style:It(s.style)},[nt(s.$slots,"default")],6)],34)}const pt=tt(ts,[["render",ss]]),ns=["onClick"],os=ct({__name:"dropdown",props:{pos:{default:"lt"}},setup(s){const o=X(!1),e=()=>{o.value=!0},a=()=>{o.value=!1};return window.addEventListener("click",a,!1),de(()=>{window.removeEventListener("click",a,!1)}),(l,m)=>(d(),v("div",{class:ht(["dropdown",[{active:o.value}]]),onClick:vt(e,["stop"])},[nt(l.$slots,"default",{},void 0,!0),t("div",{class:ht(["dropdown-popover",["dropdown-"+s.pos]]),onClick:m[0]||(m[0]=vt(()=>{},["stop"]))},[nt(l.$slots,"popover",{onClose:a},void 0,!0)],2)],10,ns))}});const Qt=tt(os,[["__scopeId","data-v-e27f2ee9"]]);Qt.install=s=>{s.component("dropdown",Xt)};const Xt=Qt,ot=s=>(wt("data-v-be238d13"),s=s(),kt(),s),as=["onKeypress"],us=["onKeypress"],ls=ot(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),cs=W(" \u514B\u523630%"),is=ot(()=>t("br",null,null,-1)),ds=W("\u88AB\u514B\u5236-25%"),rs=ot(()=>t("br",null,null,-1)),ps=W("\u6FC0\u836150% "),_s=["onClick"],fs={class:"row"},vs={class:"col-item"},hs=ot(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ms=W(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),bs={class:"input-group"},Fs=["step"],Bs=ot(()=>t("div",{class:"input-ext"},"\u500D",-1)),$s={class:"label"},ys={class:"input-group"},gs=ot(()=>t("div",{style:{clear:"both"}},null,-1)),Cs={class:"col-item"},xs=ot(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),ws=W(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),ks={class:"input-group"},Es=["step"],Ds=ot(()=>t("div",{class:"input-ext"},"\u500D",-1)),Ss={class:"label"},As={class:"input-group"},Ms={class:"col-item"},Us=ot(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Vs={class:"static-control text-center"},Is={class:"darkgold"},Ts=ot(()=>t("div",{style:{clear:"both"}},null,-1)),Hs={class:"label"},Ps={class:"bold darkgold"},Gs=ot(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),Rs={class:"static-control text-center"},Ns={class:"bold darkgold"},zs={class:"bold red"},Ls={class:"label bold"},qs={class:"static-control text-center"},js={class:"bold darkgold"},Os={key:0,class:"bold red"},Ks=ct({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(s,{emit:o}){const e=s,a=it({editor:!1,name:"",desc:{f:!1,v:""}}),l=(n,c)=>{if(n==="name")return;const V=e.itemState;switch(n){case"a1":case"a2":case"kz":typeof c=="number"&&(V[n]=c);break;default:typeof c=="string"&&(V[n]=c)}o("update:itemState",V)},m=it(We()),_=I({set:n=>l("a1",n),get:()=>e.itemState.a1}),i=I({set:n=>l("a2",n),get:()=>e.itemState.a2}),x=I({set:n=>l("att",n),get:()=>e.itemState.att}),S=I({set:n=>l("id",n),get:()=>e.itemState.id}),C=I({set:n=>l("da",n),get:()=>e.itemState.da}),R=I({set:n=>l("db",n),get:()=>e.itemState.db}),f=I({set:n=>l("dc",n),get:()=>e.itemState.dc}),p=I({set:n=>l("dx",n),get:()=>e.itemState.dx}),k=I({set:n=>l("cd",n),get:()=>e.itemState.cd}),D=I({set:n=>l("att2",n),get:()=>e.itemState.att2}),N=I({set:n=>l("da2",n),get:()=>e.itemState.da2}),P=I({set:n=>l("dx2",n),get:()=>e.itemState.dx2}),T=I({set:n=>l("defGain",n),get:()=>e.itemState.defGain}),q=I({set:n=>l("kz",n),get:()=>e.itemState.kz||0}),$=it({a1:_,a2:i,att:x,da:C,db:R,dc:f,dx:p,id:S,cd:k,att2:D,da2:N,dx2:P,defGain:T,kz:q}),A=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],g=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],M=I(()=>{const{state:n}=e,c=(100+m.att)/100;return Math.ceil(n.att*c)}),Y=I(()=>{const{state:n}=e,c=(100+m.att+m.att2)/100;return Math.ceil(n.att*c)}),at=()=>{const{enemyState:n}=e,c=(100+$.kz)/100,V=(100+m.da-n.ra)/100,b=(100+m.da+m.da2-n.ra)/100,U=(100+m.db-n.rb)/100,st=(100+m.dc)/100,w=(100+m.dx)/100,mt=(100+m.dx+m.dx2)/100,z=(100+m.cd)/100,Tt=(100-m.id)/100,Zt=(100+n.defGain)/100,Yt=(100+n.defGain+m.defGain)/100,te=Math.max(0,Math.max(0,n.def*Zt+n.defExt)*Tt),ee=Math.max(0,Math.max(0,n.def*Yt+n.defExt)*Tt),se=Math.max(1,M.value*c-te),ne=Math.max(1,Y.value*c-ee),Ht=se*$.a1*V*U*w,oe=Math.ceil(Ht*z),Pt=ne*$.a2*b*U*st*mt,ae=Math.ceil(Pt*z);return{r01:Math.ceil(Ht),r01c:oe,r02:Math.ceil(Pt),r02c:ae}},$t=I(()=>at());function rt(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&o("close")}function H(){a.editor=!0,a.name=e.itemState.name}function y(){const n=a.name;if(a.editor=!1,a.name="",!n)return;const c=e.itemState;c.name=n,o("update:itemState",c)}function et(){a.desc.f=!0,a.desc.v=e.itemState.desc}function j(){const n=a.desc.v;if(a.desc.f=!1,a.desc.v="",!n)return;const c=e.itemState;c.desc=n,o("update:itemState",c)}function yt(){o("up")}function r(){o("down")}function B(){o("copy")}return(n,c)=>{const V=Lt("autofocus");return d(),v(G,null,[h(u(_e),{orientation:"left"},{action:F(()=>[t("span",{onClick:B},[h(u(Kt),{class:"close"})]),s.showUp?(d(),v("span",{key:0,onClick:yt},[h(u(ke),{class:"close"})])):J("",!0),s.showDown?(d(),v("span",{key:1,onClick:r},[h(u(Me),{class:"close"})])):J("",!0),t("span",{onClick:rt},[h(u(re),{class:"close"})])]),default:F(()=>[a.editor?O((d(),v("input",{key:0,class:"input",type:"text","onUpdate:modelValue":c[0]||(c[0]=b=>a.name=b),onKeypress:Mt(y,["enter"]),onBlur:y},null,40,as)),[[ut,a.name],[V]]):(d(),v("span",{key:1,class:"calc-item-title",onClick:H},E(s.itemState.name||"\u6A21\u677F"),1)),a.desc.f?O((d(),v("input",{key:2,class:"input",type:"text","onUpdate:modelValue":c[1]||(c[1]=b=>a.desc.v=b),onKeypress:Mt(j,["enter"]),onBlur:j},null,40,us)),[[ut,a.desc.v],[V]]):(d(),v("span",{key:3,class:"calc-item-desc",onClick:et},E(s.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),h(u(pe),{style:{width:"120px"}},{default:F(()=>[h(u(pt),{dir:"top"},{label:F(()=>[ls]),default:F(()=>[cs,is,ds,rs,ps]),_:1}),t("div",null,[h(u(Xt),null,{popover:F(({onClose:b})=>[t("div",{class:"list",onClick:U=>b()},[t("div",{class:"list-item",onClick:c[3]||(c[3]=U=>$.kz=0)},"\u666E\u901A"),t("div",{class:"list-item",onClick:c[4]||(c[4]=U=>$.kz=30)},"\u514B\u5236"),t("div",{class:"list-item",onClick:c[5]||(c[5]=U=>$.kz=-25)},"\u88AB\u514B\u5236"),t("div",{class:"list-item",onClick:c[6]||(c[6]=U=>$.kz=50)},"\u6FC0\u8361")],8,_s)]),default:F(()=>[O(t("input",{class:"input",type:"number","onUpdate:modelValue":c[2]||(c[2]=b=>$.kz=b)},null,512),[[ut,$.kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",fs,[t("div",vs,[h(u(pt),{dir:"top"},{label:F(()=>[hs]),default:F(()=>[ms]),_:1}),t("div",bs,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[7]||(c[7]=b=>$.a1=b)},null,8,Fs),[[ut,$.a1,void 0,{number:!0}]]),Bs])]),(d(),v(G,null,K(A,b=>t("div",{class:"col-item",key:b.name},[h(u(pt),{dir:"top"},{label:F(()=>[t("div",$s,E(b.label),1)]),default:F(()=>[W(" "+E(b.tip),1)]),_:2},1024),t("div",ys,[h(u(xt),{class:"input",modelValue:$[b.name],"onUpdate:modelValue":U=>$[b.name]=U,result:m[b.name],"onUpdate:result":U=>m[b.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),gs,t("div",Cs,[h(u(pt),{dir:"top"},{label:F(()=>[xs]),default:F(()=>[ws]),_:1}),t("div",ks,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[8]||(c[8]=b=>$.a2=b)},null,8,Es),[[ut,$.a2,void 0,{number:!0}]]),Ds])]),(d(),v(G,null,K(g,b=>t("div",{class:"col-item",key:b.name},[h(u(pt),{dir:"top"},{label:F(()=>[t("div",Ss,E(b.label),1)]),default:F(()=>[W(" "+E(b.tip),1)]),_:2},1024),t("div",As,[h(u(xt),{class:"input",modelValue:$[b.name],"onUpdate:modelValue":U=>$[b.name]=U,result:m[b.name],"onUpdate:result":U=>m[b.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Ms,[Us,t("div",Vs,[t("span",Is,E(u(M)),1)])]),Ts,(d(!0),v(G,null,K([u($t)],b=>(d(),v(G,null,[(d(!0),v(G,null,K([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:b.r01,v2:b.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:b.r02,v2:b.r02c}],(U,st)=>(d(),v("div",{class:"col-item",key:st},[t("div",Hs,[t("span",Ps,E(U.label),1),Gs]),t("div",Rs,[t("span",Ns,E(U.v),1),t("span",zs,"("+E(U.v2)+")",1)])]))),128)),(d(!0),v(G,null,K([{label:"\u4E0D\u66B4\u51FB",value:b.r01+b.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:b.r01c+b.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:b.r01+b.r02c},{label:"\u5168\u66B4\u51FB",value:b.r01c+b.r02c}],(U,st)=>(d(),v("div",{class:"col-item",key:st},[t("div",Ls,E(U.label),1),t("div",qs,[t("span",js,E(U.value),1),(+s.enemyState.hp||0)<=U.value?(d(),v("span",Os," \u51FB\u6740 ")):J("",!0)])]))),128))],64))),256))])],64)}}});const Js=tt(Ks,[["__scopeId","data-v-be238d13"]]),St=s=>(wt("data-v-bd82d11d"),s=s(),kt(),s),Qs=St(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Xs={class:"row"},Ws={class:"label"},Zs={class:"input-group"},Ys=["step","onUpdate:modelValue","onChange"],tn=["value"],en={class:"col-item"},sn=St(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),nn={class:"static-control text-center"},on={class:"darkgold"},an=St(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),un={class:"row"},ln={class:"label"},cn={key:1,class:"label"},dn={class:"input-group"},rn={key:0,class:"input-ext"},pn=St(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),_n=ct({__name:"Calculator",props:{data:null},emits:["update:data"],setup(s,{emit:o}){const e=s,a=I(()=>e.data.basic),l=I(()=>e.data.state),m=I(()=>e.data.enemyState),_=I(()=>e.data.items),i=it(Qe()),x=it({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),S=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],C=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],R=()=>{const $=a.value.c/100;a.value.g=Math.ceil(i.a+a.value.w*$+a.value.x),l.value.att=a.value.w+a.value.g},f=async()=>{o("update:data",e.data)},p=($,A)=>{A==="panel"&&R(),f()},k=($,A)=>{const g=e.data.items;!g||(g[A]=$,f())},D=()=>{const $=e.data.items;!$||($.push(Jt()),f())},N=$=>{const A=e.data.items;!A||(A.splice($,1),f())},P=$=>{const A=e.data.items;if(!A)return;const g=A[$],M=A[$-1];A[$-1]=g,A[$]=M,f()},T=$=>{const A=e.data.items;if(!A)return;const g=A[$],M=A[$+1];A[$+1]=g,A[$]=M,f()},q=$=>{const A=e.data.items;if(!A)return;const g=A[$];A.push(Dt.cloneDeep(g)),f()};return zt(()=>[e.data.basic.w],()=>{R()}),($,A)=>(d(),v("div",null,[Qs,t("div",Xs,[(d(),v(G,null,K(S,g=>t("div",{class:"col-item",key:g.name},[t("div",Ws,E(g.label),1),t("div",Zs,[g.name in i?(d(),lt(u(xt),{key:0,modelValue:u(a)[g.name],"onUpdate:modelValue":M=>u(a)[g.name]=M,result:i[g.name],"onUpdate:result":M=>i[g.name]=M,onChange:M=>p(g.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):O((d(),v("input",{key:1,type:"number",class:"input",style:It({textAlign:g.align}),min:"0",step:g.step,"onUpdate:modelValue":M=>u(a)[g.name]=M,onChange:M=>p(g.name,"panel")},null,44,Ys)),[[ut,u(a)[g.name],void 0,{number:!0}]]),g.name==="w"?(d(),v("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${u(a).g}`},null,8,tn)):J("",!0)])])),64)),t("div",en,[sn,t("div",nn,[t("span",on,E(u(l).att),1)])])]),an,t("div",un,[(d(),v(G,null,K(C,g=>t("div",{class:"col-item",key:g.name},[g.tips?(d(),lt(u(pt),{key:0,dir:"top"},{label:F(()=>[t("div",ln,E(g.label),1)]),default:F(()=>[W(" "+E(g.tips),1)]),_:2},1024)):(d(),v("div",cn,E(g.label),1)),t("div",dn,[h(u(xt),{modelValue:u(m)[g.name],"onUpdate:modelValue":M=>u(m)[g.name]=M,result:x[g.name],"onUpdate:result":M=>x[g.name]=M,onChange:M=>p(g.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),g.precent?(d(),v("div",rn,"%")):J("",!0)])])),64))]),t("div",{class:"heading"},[pn,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:D},"\u6DFB\u52A0")])]),(d(!0),v(G,null,K(u(_),(g,M)=>(d(),lt(Js,{key:g,panel:u(a),state:u(l),enemyState:x,itemState:g,showUp:M>0,showDown:u(_)&&M<u(_).length-1,"onUpdate:itemState":Y=>k(Y,M),onClose:Y=>N(M),onUp:Y=>P(M),onDown:Y=>T(M),onCopy:Y=>q(M)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const fn=tt(_n,[["__scopeId","data-v-bd82d11d"]]),vn=ct({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(s,{emit:o}){return{wrapClass:I(()=>["c-action-sheet-wrapper",s.class,{show:s.show}]),onClick:(m,_)=>{o("click",{item:m,index:_}),o("close",!1)},onClose:()=>{o("update:show",!1),o("close",!1)}}}});const hn={class:"c-action-sheet-section"},mn={class:"c-action-sheet-extra"},bn={class:"c-action-sheet-list"},Fn=["onClick"];function Bn(s,o,e,a,l,m){return d(),lt(qt,{to:"body"},[t("div",{class:ht(s.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:o[0]||(o[0]=(..._)=>s.onClose&&s.onClose(..._))}),t("div",hn,[t("div",{class:"c-action-sheet-body",style:It({maxHeight:s.height})},[t("div",mn,[nt(s.$slots,"extra")]),t("div",bn,[(d(!0),v(G,null,K(s.list,(_,i)=>(d(),v("div",{class:"c-action-sheet-item",key:i,onClick:x=>s.onClick(_,i)},[nt(s.$slots,"default",{record:_})],8,Fn))),128))])],4)])],2)])}const Vt=tt(vn,[["render",Bn]]);Vt.install=s=>{s.component("action-sheet",Vt)};const $n={class:"hero-item"},yn={class:"hero-item__inner"},gn=["src"],Cn=["src","alt","title"],xn={class:"hero-item__label"},wn=ct({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(s,{emit:o}){const{heroes:e,getHeroIcon:a,getHeroIconBg:l}=be(),m=_=>{o("click",_)};return(_,i)=>(d(),lt(u(Vt),{class:"hero-select",show:s.show,list:u(e),height:"80vh",onClick:m,"onUpdate:show":i[0]||(i[0]=x=>_.$emit("update:show",x))},{extra:F(()=>[nt(_.$slots,"extra")]),default:F(({record:x})=>[t("div",$n,[t("div",yn,[t("img",{src:u(l)(x)},null,8,gn),t("img",{src:u(a)(x),alt:x.name,title:x.name},null,8,Cn),t("div",xn,E(x.name),1)])])]),_:3},8,["show","list"]))}});const kn=ct({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(s,{emit:o}){const e=I({get:()=>s.activeKey,set:l=>{o("update:activeKey",l)}});return{active:e,toggle:()=>{const l=!e.value;e.value=l,o("toggle",l)}}}});const En=s=>(wt("data-v-829ec263"),s=s(),kt(),s),Dn=En(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Sn={class:"panel-title"},An={class:"panel-body"},Mn={class:"panel-content"};function Un(s,o,e,a,l,m){return d(),v("div",{class:ht(["panel",{active:s.active}])},[t("div",{class:"panel-header",onClick:o[1]||(o[1]=(..._)=>s.toggle&&s.toggle(..._))},[Dn,t("div",Sn,[nt(s.$slots,"header",{},()=>[W(E(s.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:o[0]||(o[0]=vt(()=>{},["stop"]))},[nt(s.$slots,"actions",{},void 0,!0)])]),t("div",An,[t("div",Mn,[nt(s.$slots,"default",{},void 0,!0)])])],2)}const Vn=tt(kn,[["render",Un],["__scopeId","data-v-829ec263"]]);function In(){const s="red_team",o=fe(),e=X([]),a=X(!1),l=X(),m=async f=>{const k=(await o.transaction(s,"readwrite")).objectStore(s),D=await o.wrap(k.put(f));return e.value.find(P=>P._id===f._id)||(f._id=D,e.value.push(f)),D},_=async f=>{const k=(await o.transaction(s,"readwrite")).objectStore(s);await o.wrap(k.delete(f._id)),e.value=e.value.filter(D=>D._id!==f._id)},i=async f=>{const p=await o.transaction(s,"readwrite"),k=p.objectStore(s);for(const D of f)await o.wrap(k.put(D));await o.twrap(p),await S()},x=async()=>{const p=(await o.transaction(s,"readwrite")).objectStore(s);await o.wrap(p.clear()),e.value=[]},S=async()=>{const p=(await o.transaction(s,"readonly")).objectStore(s),k=await o.wrap(p.getAll()).catch(()=>[]);k.forEach(D=>{D.scList||(D.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF}])}),e.value=k},C=async f=>{const p=JSON.parse(await f.text());if(!jt(p)||p.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const k=p.data;k.forEach(D=>delete D._id),await i(k)},R=async()=>{const f={type:"red_team",data:e.value},p=new Blob([JSON.stringify(f)],{type:"application/json"});Ut(p,"red_team.json")};return S(),{scShow:a,scSelected:l,put:m,del:_,puts:i,clear:x,all:S,list:e,importData:C,exportData:R}}const Ft=s=>s%1>.5?Math.ceil(s):Math.floor(s);function Tn(){const s=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),o=X(s()),e=I(()=>{const _=[0,0,0,0,0,0];return o.value.scList.forEach(i=>{!i.v||(_[0]+=i.v.qixue,_[1]+=i.v.patt,_[2]+=i.v.pdef,_[3]+=i.v.matt,_[4]+=i.v.mdef,_[5]+=i.v.huixin)}),_}),a=I(()=>{const _=o.value,i={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},x=Ot.find(R=>_.stoneName===R.name);x&&(i.qixue=x.t[0]+x.d[0]+x.h[0],i.patt=x.t[1]+x.d[1]+x.h[1],i.matt=x.t[2]+x.d[2]+x.h[2],i.pdef=x.t[3]+x.d[3]+x.h[3],i.mdef=x.t[4]+x.d[4]+x.h[4]);const S={qixue:_.hsQixue/100,patt:_.hsPatt/100,pdef:_.hsPdef/100,matt:_.hsMatt/100,mdef:_.hsMdef/100,huixin:_.hsHuixin/100},C=e.value;return{qixue:Ft(_.qixue*S.qixue+i.qixue+C[0]),patt:Ft(_.patt*S.patt+i.patt+C[1]),pdef:Ft(_.pdef*S.pdef+i.pdef+C[2]),matt:Ft(_.matt*S.matt+i.matt+C[3]),mdef:Ft(_.mdef*S.mdef+i.mdef+C[4]),huixin:Ft(_.huixin*S.huixin+i.huixin+C[5])}}),l=I(()=>{const _=a.value,i={qixue:(100+o.value.rQixue)/100,patt:(100+o.value.rPatt)/100,pdef:(100+o.value.rPdef)/100,matt:(100+o.value.rMatt)/100,mdef:(100+o.value.rMdef)/100,huixin:(100+o.value.rHuixin)/100};return{qixue:Math.round((o.value.qixue+_.qixue)*i.qixue),patt:Math.round((o.value.patt+_.patt)*i.patt),pdef:Math.round((o.value.pdef+_.pdef)*i.pdef),matt:Math.round((o.value.matt+_.matt)*i.matt),mdef:Math.round((o.value.mdef+_.mdef)*i.mdef),huixin:Math.round((o.value.huixin+_.huixin)*i.huixin)}});return{state:o,pValue:a,ckValue:l,scSum:e,reset:()=>{o.value=s()},defState:s}}const Hn={},Pn={class:"c-upload"};function Gn(s,o){return d(),v("div",Pn,[nt(s.$slots,"default",{},void 0,!0),t("input",ve({type:"file",class:"c-upload-input",accept:"application/json"},s.$attrs),null,16)])}const Rn=tt(Hn,[["render",Gn],["__scopeId","data-v-b3879154"]]),Z=s=>(wt("data-v-fc55a9ed"),s=s(),kt(),s),Nn={class:"transform-tools-popover"},zn={class:"transform-tools-popover-toolbar"},Ln=["value"],qn=["value"],jn=Z(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),On={class:"transform-tools-popover-content"},Kn={class:"grid-group"},Jn={class:"grid-group-item"},Qn={class:"input-group-title"},Xn=Z(()=>t("span",null,"\u57FA\u7840",-1)),Wn={class:"grids"},Zn={class:"input-label"},Yn={class:"input-group"},to={class:"input green"},eo={class:"grid-group-item"},so={class:"input-group-title"},no=Z(()=>t("span",null,"\u9B42\u77F3",-1)),oo=Z(()=>t("option",{value:""},"\u65E0",-1)),ao=["value"],uo={class:"grids"},lo=Z(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),co=Z(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),io=Z(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),ro=Z(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),po=Z(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),_o={class:"grid-group-item"},fo={class:"input-group-title"},vo=W(" \u661F\u4E4B\u6676 "),ho=Z(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),mo=Z(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),bo=Z(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),Fo={class:"grids"},Bo=["onClick","onContextmenu"],$o={key:0},yo={key:1},go={key:2},Co={key:3},xo={key:4},wo={key:5},ko={key:1},Eo={class:"grid-group-item"},Do=Z(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),So={class:"grids"},Ao={class:"input-label"},Mo={class:"input"},Uo={class:"grid-group-item"},Vo=Z(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Io={class:"grids"},To={class:"input-label"},Ho={class:"grid-group-item"},Po=Z(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Go={class:"grids"},Ro={class:"input-label"},No={class:"input"},zo=ct({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(s,{emit:o}){const{state:e,pValue:a,ckValue:l,scSum:m,reset:_,defState:i}=Tn(),{list:x,put:S,del:C,clear:R,importData:f,exportData:p}=In(),k=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],D=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],N=X(!1),P=X(),T=H=>{P.value=H,N.value=!0},q=H=>{!P.value||(P.value.v=H)},$=()=>{const H=Dt.cloneDeep(e.value);S(H).then(y=>{e.value._id=y,alert("\u5DF2\u4FDD\u5B58")}).catch(y=>{console.log(y),alert("\u4FDD\u5B58\u5931\u8D25")})},A=()=>{const H=Dt.cloneDeep(e.value);delete H._id,H.name+=" copy",S(H).then(y=>{H._id=y,e.value=H}).catch(y=>{console.log(y),alert("\u590D\u5236\u5931\u8D25")})},g=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||C(e.value).then(()=>{_()}).catch(y=>{console.log(y),alert("\u5220\u9664\u5931\u8D25")})},M=H=>{const y=H.currentTarget;if(!y.files)return;const et=Array.prototype.slice.call(y.files);y.value="",et[0]&&f(et[0])},Y=()=>{p()},at=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||R().catch(y=>{console.log(y),alert("\u6E05\u7A7A\u5931\u8D25")})},$t=(H,y)=>{e.value.name=H,e.value.qixue=y.qixue,e.value.patt=y.patt,e.value.pdef=y.pdef,e.value.matt=y.matt,e.value.mdef=y.mdef,e.value.huixin=y.huixin},rt=()=>{o("reference")};return o("init",$t),(H,y)=>{const et=_t("c-col"),j=_t("c-space"),yt=_t("c-row");return O((d(),v("div",Nn,[t("div",zn,[h(yt,{flex:"",middle:"",gutter:8},{default:F(()=>[h(et,null,{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:rt},"\u53C2\u8003")]),_:1}),h(et,null,{default:F(()=>[W("ID: "+E(u(e)._id),1)]),_:1}),h(et,{flex:"1 1 auto"},{default:F(()=>[h(j,null,{default:F(()=>[O(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":y[0]||(y[0]=r=>Ct(e)?e.value=r:null)},[t("option",{value:u(i)()},"\u7A7A\u6A21\u7248",8,Ln),(d(!0),v(G,null,K(u(x),r=>(d(),v("option",{key:r._id,value:r},E(r.name),9,qn))),128))],512),[[Gt,u(e)]]),t("button",{class:"btn btn-sm btn-primary",onClick:$},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:A},"\u590D\u5236"),u(e)._id?(d(),v("button",{key:0,class:"btn btn-sm btn-danger",onClick:g},"\u5220\u9664")):J("",!0),h(Rn,{onChange:M},{default:F(()=>[jn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:Y},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:at},"\u6E05\u7A7A")]),_:1})]),_:1}),h(et,null,{default:F(()=>[t("span",{class:"transform-tools-popover-close",onClick:y[1]||(y[1]=r=>o("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",On,[t("div",Kn,[t("div",Jn,[t("div",Qn,[h(j,null,{default:F(()=>[Xn,O(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":y[2]||(y[2]=r=>u(e).name=r)},null,512),[[ut,u(e).name]])]),_:1})]),t("div",Wn,[(d(),v(G,null,K(k,r=>h(j,{key:r.n},{default:F(()=>[t("label",Zn,E(r.t),1),t("div",Yn,[h(u(bt),{readonly:"",value:u(e)[r.n]},null,8,["value"]),t("div",to,"+"+E(u(a)[r.n]),1)])]),_:2},1024)),64))])]),t("div",eo,[t("div",so,[h(j,null,{default:F(()=>[no,O(t("select",{class:"input input-select","onUpdate:modelValue":y[3]||(y[3]=r=>u(e).stoneName=r)},[oo,(d(!0),v(G,null,K(u(Ot),(r,B)=>(d(),v("option",{key:B,value:r.name},E(r.name),9,ao))),128))],512),[[Gt,u(e).stoneName]])]),_:1})]),t("div",uo,[h(j,null,{default:F(()=>[lo,h(u(bt),{value:u(e).hsQixue,"onUpdate:value":y[4]||(y[4]=r=>u(e).hsQixue=r)},null,8,["value"])]),_:1}),h(j,null,{default:F(()=>[co,h(u(bt),{value:u(e).hsPatt,"onUpdate:value":y[5]||(y[5]=r=>u(e).hsPatt=r)},null,8,["value"])]),_:1}),h(j,null,{default:F(()=>[io,h(u(bt),{value:u(e).hsPdef,"onUpdate:value":y[6]||(y[6]=r=>u(e).hsPdef=r)},null,8,["value"])]),_:1}),h(j,null,{default:F(()=>[ro,h(u(bt),{value:u(e).hsMatt,"onUpdate:value":y[7]||(y[7]=r=>u(e).hsMatt=r)},null,8,["value"])]),_:1}),h(j,null,{default:F(()=>[po,h(u(bt),{value:u(e).hsMdef,"onUpdate:value":y[8]||(y[8]=r=>u(e).hsMdef=r)},null,8,["value"])]),_:1})])]),t("div",_o,[t("div",fo,[vo,h(u(pt),{label:"?",inline:"",dir:"right"},{default:F(()=>[ho,mo,bo]),_:1})]),t("div",Fo,[(d(!0),v(G,null,K(u(e).scList,(r,B)=>(d(),v("div",{key:B,class:ht(["sc-props",{selected:P.value===r,s1:u(Q).ATT===r.pos,s2:u(Q).XUE===r.pos,s3:u(Q).DEF===r.pos}]),onClick:n=>T(r),onContextmenu:vt(n=>r.v=void 0,["prevent"])},[r.v?(d(),v(G,{key:0},[r.v.qixue>0?(d(),v("span",$o,"\u6C14\u8840+"+E(r.v.qixue),1)):J("",!0),r.v.patt>0?(d(),v("span",yo,"\u7269\u653B+"+E(r.v.patt),1)):J("",!0),r.v.pdef>0?(d(),v("span",go,"\u7269\u9632+"+E(r.v.pdef),1)):J("",!0),r.v.matt>0?(d(),v("span",Co,"\u6CD5\u653B+"+E(r.v.matt),1)):J("",!0),r.v.mdef>0?(d(),v("span",xo,"\u6CD5\u9632+"+E(r.v.mdef),1)):J("",!0),r.v.huixin>0?(d(),v("span",wo,"\u4F1A\u5FC3+"+E(r.v.huixin),1)):J("",!0)],64)):(d(),v("span",ko,E(r.n),1))],42,Bo))),128))]),(d(),lt(qt,{to:"body"},[P.value?(d(),lt(u(ye),{key:0,show:N.value,"onUpdate:show":y[9]||(y[9]=r=>N.value=r),position:P.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:q},null,8,["show","position"])):J("",!0)]))]),t("div",Eo,[Do,t("div",So,[(d(),v(G,null,K(k,(r,B)=>h(j,{key:B},{default:F(()=>[t("label",Ao,E(r.t),1),t("div",Mo,"+"+E(u(m)[B]),1)]),_:2},1024)),64))])]),t("div",Uo,[Vo,t("div",Io,[(d(),v(G,null,K(D,(r,B)=>h(j,{key:B},{default:F(()=>[t("label",To,E(r.t),1),h(u(xt),{modelValue:u(e)[r.c],"onUpdate:modelValue":n=>u(e)[r.c]=n,result:u(e)[r.r],"onUpdate:result":n=>u(e)[r.r]=n},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",Ho,[Po,t("div",Go,[(d(),v(G,null,K(k,r=>h(j,{key:r.n},{default:F(()=>[t("label",Ro,E(r.t),1),t("div",No,E(u(l)[r.n]),1)]),_:2},1024)),64))])])])])],512)),[[he,s.show]])}}});const Lo=tt(zo,[["__scopeId","data-v-fc55a9ed"]]);function ft(s){return(s%1>.5?Math.ceil:Math.floor)(s)}function Wt(s){const{basic:o,enemyState:e}=s,a={w:o.w,a:L(o.a),c:o.c,x:o.x,g:0,att:0};a.g=ft(o.w*o.c/100+a.a+a.x),a.att=o.w+a.g;const l={hp:L(e.hp),ra:L(e.ra),rb:L(e.rb),def:L(e.def),defExt:L(e.defExt),defGain:L(e.defGain)};return{b:a,e:l}}function qo(s,o){const{b:e,e:a}=Wt(s),l={a1:o.a1,a2:o.a2,att:L(o.att),att2:L(o.att2),da:L(o.da),da2:L(o.da2),db:L(o.db),dc:L(o.dc),dx:L(o.dx),dx2:L(o.dx2),id:L(o.id),cd:L(o.cd),defGain:L(o.defGain),kz:o.kz||0},m=e.att*(100+l.att)/100,_=e.att*(100+l.att+l.att2)/100,i=(100+l.kz)/100,x=(100+l.da-a.ra)/100,S=(100+l.da+l.da2-a.ra)/100,C=(100+l.db-a.rb)/100,R=(100+l.dc)/100,f=(100+l.dx)/100,p=(100+l.dx+l.dx2)/100,k=(100+l.cd)/100,D=(100-l.id)/100,N=(100+a.defGain)/100,P=(100+a.defGain+l.defGain)/100,T=Math.max(0,Math.max(0,a.def*N+a.defExt)*D),q=Math.max(0,Math.max(0,a.def*P+a.defExt)*D),$=Math.max(1,m*i-T),A=Math.max(1,_*i-q),g=$*l.a1*x*C*f,M=ft(g*k),Y=A*l.a2*S*C*R*p,at=ft(Y*k);return{satt:m,satt2:_,r01:ft(g),r01c:M,r02:ft(Y),r02c:at}}function jo(s){const o=s.items||[],e=document.createElement("canvas");e.width=800,e.height=8+160+o.reduce((p,k)=>{let D=30;return D+=50,k.a1>0&&(D+=30),k.a2>0&&(D+=50),(k.a1>0||k.a2>0)&&(D+=20),k.a1>0&&k.a2>0&&(D+=20),D+=20,p+D},0)+8;const a=e.getContext("2d");if(!a)return;const l=s.basic,m=s.enemyState,{b:_}=Wt(s),i={x:0,y:0},x=(p,k,D)=>{D?(i.x+=p,i.y+=k):(i.x=p,i.y=k)},S=(p=0)=>{i.x=8+p*16},C=(p=0)=>{i.x=8,i.y+=p},R=(p,k="#222222")=>{a.save(),a.fillStyle=k;const{width:D}=a.measureText(p);a.fillText(p,i.x,i.y),i.x+=D+16,a.restore()},f=(p,...k)=>{a.save();const D=typeof p=="string"?p:p[0],N=typeof p=="string"?"#222222":p[1];a.fillStyle=N,a.font="bold 16px sans-serif";const{width:P}=a.measureText(D);a.fillText(D,i.x,i.y),i.x+=P+8,a.restore(),a.save(),a.font="16px sans-serif";for(const T of k){const q=typeof T=="string"?T:T[0],$=typeof T=="string"?"#ff4446":T[1];a.fillStyle=$;const{width:A}=a.measureText(q);a.fillText(q,i.x,i.y),i.x+=A+8}i.x+=8,a.restore()};a.fillStyle="#FBFFF0",a.fillRect(0,0,e.width,e.height),x(8,28),a.textBaseline="bottom",a.font="bold 20px sans-serif",R(s.title),C(40),a.font="bold 18px sans-serif",R("\u653B\u65B9:"),a.font="16px sans-serif",C(30),S(2),f("\u653B\u51FB:",`${l.w}`,[`+${_.g}`,"#55a14f"]),f("\u9B42\u77F3\u653B\u51FB:",`${l.a}`),f("\u9B42\u77F3\u653B\u51FB%:",`${l.c}`),f("\u661F\u4E4B\u6676\u653B\u51FB:",`${l.x}`),C(30),a.font="bold 18px sans-serif",R("\u5B88\u65B9:"),C(30),S(2),f("\u6C14\u8840:",`${m.hp}`),f("\u9632\u5FA1:",`${m.def}`),f("\u9632\u5FA1%:",`${m.defGain}`),f("\u9644\u52A0\u9632\u5FA1:",`${m.defExt}`),C(20),S(2),f("\u514D\u4F24A%:",`${m.ra}`),f("\u514D\u4F24B%:",`${m.rb}`),C(30);for(const p of o){const{satt:k,satt2:D,r01:N,r01c:P,r02:T,r02c:q}=qo(s,p);a.font="bold 18px sans-serif",R(p.name,"#a30000"),a.font="14px sans-serif",R(p.desc||"\u65E0\u63CF\u8FF0","#a30000"),a.font="16px sans-serif",f("\u514B\u5236:",`${p.kz||0}%`),C(30),S(2),f("\u653B\u51FB%:",`${p.att}`),f("\u7A7F\u900F%:",`${p.id}`),f("\u66B4\u4F24%:",`${p.cd}`),C(20),S(2),f("\u589E\u4F24A%:",`${p.da}`),f("\u589E\u4F24B%:",`${p.db}`),f("\u589E\u4F24X%:",`${p.dx}`),C(30),p.a1>0&&(S(2),f("\u6280\u80FD\u3001\u666E\u653B:",`${p.a1}\u500D`),f("\u653B\u51FB:",[`${ft(k)}`,"#b8860b"]),C(30)),p.a2>0&&(S(2),f("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${p.a2}\u500D`),f("\u653B\u51FB\u4FEE\u6B63%:",p.att2),f("\u9632\u5FA1\u4FEE\u6B63%:",p.defGain),f("\u653B\u51FB:",[`${ft(D)}`,"#b8860b"]),C(20),S(2),f("\u589E\u4F24C%:",p.dc),f("\u589E\u4F24A\u4FEE\u6B63%:",p.da2),f("\u589E\u4F24X\u4FEE\u6B63%:",p.dx2),C(30)),S(2),N>0&&f(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${N}`,"#b8860b"],[`${P}`,"#ff4446"]),T>0&&f(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${T}`,"#b8860b"],[`${q}`,"#ff4446"]),C(20),N>0&&T>0&&(S(2),f(["\u4E0D\u66B4\u51FB","#b8860b"],[`${N+T}`,"#ff4446"]),f(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${P+T}`,"#ff4446"]),f(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${N+q}`,"#ff4446"]),f(["\u5168\u66B4\u51FB","#b8860b"],[`${P+q}`,"#ff4446"]),C(20)),C(20)}e.toBlob(p=>{!p||window.open(URL.createObjectURL(p))})}function Oo(){return{exportImage:jo}}const Bt=s=>(wt("data-v-2cc2cbb6"),s=s(),kt(),s),Ko={class:"wrapper"},Jo={class:"toolbar"},Qo={style:{padding:"6px 16px"}},Xo=W("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Wo={class:"c-upload"},Zo=Bt(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Yo={style:{padding:"6px 16px"}},ta={class:"input-group"},ea=Bt(()=>t("div",{class:"input-ext"},"=",-1)),sa={class:"content"},na={class:"container"},oa=["value"],aa=W(" \u2007 "),ua=["onKeypress"],la={key:1},ca=["onClick"],ia=["onClick"],da=["onClick"],ra=W(" \u91CD\u547D\u540D "),pa=["onClick"],_a=W(" \u590D\u5236 "),fa=["onClick"],va=["onClick"],ha=["onClick"],ma={style:{"text-align":"center"}},ba=Bt(()=>t("span",null,"\u661F\u8000",-1)),Fa=Bt(()=>t("span",null,"\u5316\u81FB",-1)),Ba=Bt(()=>t("span",null,"\u661F\u9B42",-1)),$a=Bt(()=>t("span",null,"\u661F\u8F89",-1)),ya=ct({__name:"Calculator",setup(s){const{exportImage:o}=Oo(),e=it({id:"",title:"",selecteds:[],search:""}),a=X([]),l=I(()=>a.value.filter(B=>B.title.indexOf(e.search)>-1)),m=async()=>{const n={id:Nt(),title:"\u6A21\u677F",basic:Je(),state:Xe(),enemyState:Ye(),items:Ze()};await qe(n),a.value.push(n)},_=async B=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const c=a.value.findIndex(V=>V.id===B);c!==-1&&(await je(a.value[c].id),a.value.splice(c,1))},i=async B=>{const n=e.title;if(!n){x();return}const c=a.value.findIndex(b=>b.id===B);if(c===-1)return;const V=a.value[c];V.title=n,x(),await Et(V)},x=()=>{e.id="",e.title=""},S=B=>{try{o(B)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},C=B=>{const n={type:"calculator",data:[B]},c=new Blob([JSON.stringify(n)],{type:"application/json"});Ut(c,`${B.title}.json`)},R=async B=>{a.value=B},f=B=>new Promise((n,c)=>{const V=new FileReader;V.onload=()=>{n(V.result)},V.onerror=()=>{c(V.error)},V.readAsText(B)}),p=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let n=l.value;e.selecteds.length>0&&(n=e.selecteds.map(c=>l.value[c]).filter(c=>c)),await Ke(n.map(c=>c.id)),r()},k=async B=>{const n=B.currentTarget,c=Array.prototype.slice.call(n.files);if(n.value="",!c||!c[0])return;const V=c[0],b=await f(V),U=JSON.parse(b);let st=[];if($e(U))st=U;else if(jt(U)&&U.type==="calculator")st=U.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Oe(st),r()},D=async()=>{let B="calculator.json",n=l.value;e.selecteds.length>0&&(n=e.selecteds.map(b=>l.value[b]).filter(b=>b),B="calculator-selected.json");const c={type:"calculator",data:n},V=new Blob([JSON.stringify(c)],{type:"application/json"});Ut(V,B)};async function N(B,n){const c=a.value.findIndex(b=>b.id===n);c===-1||!a.value[c]||(a.value[c]=B,await Et(B))}const P=X(-1),T=it({input:"2283/1.35*1.39",result:0}),{translate:q,xingyao:$,huazhen:A,xinghun:g,xinghui:M}=Be(),Y=B=>Math.ceil(B),at=it({show:!1}),$t=B=>{const n=q(B);rt.value&&rt.value(B.name,n)},rt=X(),H=X(!1),y=X(),et=B=>{H.value=!0,y.value=B},j=({item:B})=>{if(H.value=!1,y.value){const n=y.value,c=q(B);n.title==="\u6A21\u677F"&&(n.title=B.name),n.basic.w=Math.max(c.patt,c.matt),Et(n)}else $t(B)},yt=B=>{const n=Dt.cloneDeep(B);n.id=Nt(),console.log(n),a.value.push(n),Et(n)};async function r(){const B=await Le();e.selecteds=[],R(B)}return me(()=>{r()}),(B,n)=>{const c=_t("c-col"),V=_t("c-row"),b=_t("calc-input"),U=_t("c-space"),st=Lt("autofocus");return d(),v("div",Ko,[t("div",Jo,[t("div",Qo,[h(V,{flex:"",middle:"",gutter:16},{default:F(()=>[h(c,{flex:"0 0 auto"},{default:F(()=>[Xo]),_:1}),h(c,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:n[0]||(n[0]=w=>at.show=!at.show)},"\u9762\u677F"),e.selecteds.length>0?(d(),v("button",{key:0,class:"btn btn-success",onClick:n[1]||(n[1]=w=>e.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):J("",!0)]),_:1}),h(c,{flex:"1 1 0"},{default:F(()=>[O(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":n[2]||(n[2]=w=>e.search=w)},null,512),[[ut,e.search]])]),_:1}),h(c,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-danger",onClick:p},E(e.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Wo,[Zo,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:k},null,32)]),t("button",{class:"btn btn-success",onClick:D},E(e.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:n[3]||(n[3]=w=>m())},"\u6DFB\u52A0")]),_:1})]),_:1}),h(Lo,{show:at.show,"onUpdate:show":n[4]||(n[4]=w=>at.show=w),onReference:n[5]||(n[5]=w=>et()),onInit:n[6]||(n[6]=w=>rt.value=w)},null,8,["show"])]),t("div",Yo,[t("div",ta,[h(b,{modelValue:T.input,"onUpdate:modelValue":n[7]||(n[7]=w=>T.input=w),result:T.result,"onUpdate:result":n[8]||(n[8]=w=>T.result=w),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),ea,h(Fe,{readonly:"",value:Y(T.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",sa,[t("div",na,[(d(!0),v(G,null,K(u(l),(w,mt)=>(d(),lt(u(Vn),{key:w.id,activeKey:mt===P.value,onToggle:z=>P.value=z?mt:-1},{header:F(()=>[h(V,{flex:"",middle:""},{default:F(()=>[h(c,null,{default:F(()=>[O(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":n[9]||(n[9]=z=>e.selecteds=z),value:mt,onClick:n[10]||(n[10]=vt(()=>{},["stop"]))},null,8,oa),[[gt,e.selecteds]]),aa]),_:2},1024),h(c,null,{default:F(()=>[e.id===w.id?O((d(),v("input",{key:0,type:"text",class:"input","onUpdate:modelValue":n[11]||(n[11]=z=>e.title=z),onClick:n[12]||(n[12]=vt(()=>{},["stop"])),onKeypress:Mt(z=>i(w.id),["enter"])},null,40,ua)),[[ut,e.title],[st]]):(d(),v("span",la,E(w.title),1))]),_:2},1024),h(c,{class:"ml-4",onClick:n[13]||(n[13]=vt(()=>{},["stop"]))},{default:F(()=>[e.id===w.id?(d(),v("button",{key:0,class:"btn btn-sm btn-link",onClick:z=>i(w.id)},"\u786E\u8BA4",8,ca)):(d(),v(G,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:z=>et(w)},"\u9009\u62E9",8,ia),t("button",{class:"btn btn-sm btn-link",onClick:z=>{e.id=w.id,e.title=w.title}},[h(u(Ne),{class:"svg-icon"}),ra],8,da),t("button",{class:"btn btn-sm btn-link",onClick:z=>yt(w)},[h(u(Kt),{class:"svg-icon"}),_a],8,pa)],64))]),_:2},1024)]),_:2},1024)]),actions:F(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:z=>S(w)},"\u5BFC\u51FA\u56FE\u50CF",8,fa),t("button",{class:"btn btn-sm btn-success-outline",onClick:z=>C(w)},"\u5BFC\u51FA",8,va),t("button",{class:"btn btn-sm btn-danger-outline",onClick:z=>_(w.id)},"\u5220\u9664",8,ha)]),default:F(()=>[mt===P.value?(d(),lt(u(fn),{key:0,data:w,"onUpdate:data":z=>N(z,w.id)},null,8,["data","onUpdate:data"])):J("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),h(u(wn),{show:H.value,"onUpdate:show":n[18]||(n[18]=w=>H.value=w),onClick:j},{extra:F(()=>[t("div",ma,[h(U,null,{default:F(()=>[t("label",null,[ba,O(t("input",{type:"checkbox","onUpdate:modelValue":n[14]||(n[14]=w=>Ct($)?$.value=w:null)},null,512),[[gt,u($)]])]),t("label",null,[Fa,O(t("input",{type:"checkbox","onUpdate:modelValue":n[15]||(n[15]=w=>Ct(A)?A.value=w:null)},null,512),[[gt,u(A)]])]),t("label",null,[Ba,O(t("input",{type:"checkbox","onUpdate:modelValue":n[16]||(n[16]=w=>Ct(g)?g.value=w:null)},null,512),[[gt,u(g)]])]),t("label",null,[$a,O(t("input",{type:"checkbox","onUpdate:modelValue":n[17]||(n[17]=w=>Ct(M)?M.value=w:null)},null,512),[[gt,u(M)]])])]),_:1})])]),_:1},8,["show"])])}}});const Sa=tt(ya,[["__scopeId","data-v-2cc2cbb6"]]);export{Sa as default};
