import{d as io,s as z,a as po,q as I,P as So,S as ho,V as vo,_ as fo,o as M,c as D,e as a,n as k,b as Bo,w as C,U as eo,Q as G,B,T as ko,p as bo,l as mo,v as J,g as A,i as to,j as Vo,F as lo,h as no,r as ao,k as so,f as ro,W as Eo}from"./index.js";import{_ as Po}from"./lodash.js";const uo=(o,t,p)=>{let c=0,s=0,d=0;o%=360;const n=Math.floor(o/60),i=o/60-n,r=p*(1-t),f=p*(1-t*i),v=p*(1-t*(1-i));switch(n){case 0:c=p,s=v,d=r;break;case 1:c=f,s=p,d=r;break;case 2:c=r,s=p,d=v;break;case 3:c=r,s=f,d=p;break;case 4:c=v,s=r,d=p;break;case 5:c=p,s=r,d=f;break}c=Math.floor(c*255),s=Math.floor(s*255),d=Math.floor(d*255);const $=("00"+c.toString(16)).slice(-2),V=("00"+s.toString(16)).slice(-2),h=("00"+d.toString(16)).slice(-2);return[o,t,p,c,s,d,"#"+$+V+h]},co=o=>{let t=0,p=0,c=0,s=0,d=0,n=0;if(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i.test(o))t=window.parseInt(RegExp.$1,16),p=window.parseInt(RegExp.$2,16),c=window.parseInt(RegExp.$3,16);else if(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i.test(o))t=window.parseInt(RegExp.$1,10),p=window.parseInt(RegExp.$2,10),c=window.parseInt(RegExp.$3,10);else return[0,0,0,0,0,0,"#000000"];s=t/255,d=p/255,n=c/255;let i=s;d>i&&(i=d),n>i&&(i=n);let r=s;d<r&&(r=d),n<r&&(r=n);let f=0,v=0,$=0;i===r?f=0:i===s&&d>=n?f=60*(d-n)/(i-r)+0:i===s&&d<n?f=60*(d-n)/(i-r)+360:i===d?f=60*(n-s)/(i-r)+120:i===n&&(f=60*(s-d)/(i-r)+240),i===0?v=0:v=1-r/i,$=i;const V=("00"+t.toString(16)).slice(-2),h=("00"+p.toString(16)).slice(-2),U=("00"+c.toString(16)).slice(-2);return[Math.floor(f),v,$,t,p,c,"#"+V+h+U]};const $o=io({name:"ColorPicker",emits:["update:modelValue"],props:{modelValue:{type:String,required:!0}},setup(o,{emit:t}){const p=z(!1),c=po({set:u=>{t("update:modelValue",u)},get:()=>o.modelValue}),s=I({h:0,s:0,v:0,r:0,g:0,b:0}),d=I({rect_down:!1,rect_left:0,rect_bottom:0,ver_down:!1,ver_bottom:0}),n={rect:{left:0,bottom:0,x:0,y:0},ver:{bottom:0,y:0}},i=z(!1),r=()=>{i.value=!0},f=Po.debounce(()=>{i.value=!1},300),v=()=>{r();const u=uo(s.h,s.s,s.v);s.r=u[3],s.g=u[4],s.b=u[5],c.value=u[6],d.ver_bottom=s.h,d.rect_left=s.s*360,d.rect_bottom=s.v*360,f()},$=()=>{r();const u=co(`${s.r},${s.g},${s.b}`);s.h=u[0],s.s=u[1],s.v=u[2],c.value=u[6],d.ver_bottom=s.h,d.rect_left=s.s*360,d.rect_bottom=s.v*360,f()},V=u=>{u=u||"#000000";const w=co(u);s.h=w[0],s.s=w[1],s.v=w[2],s.r=w[3],s.g=w[4],s.b=w[5],d.ver_bottom=s.h,d.rect_left=s.s*360,d.rect_bottom=s.v*360},h=()=>{const u=uo(d.ver_bottom,d.rect_left/360,d.rect_bottom/360);s.h=u[0],s.s=u[1],s.v=u[2],s.r=u[3],s.g=u[4],s.b=u[5],c.value=u[6]},U=u=>{d.rect_down=!0,n.rect.x=u.clientX,n.rect.y=u.clientY;const w=u.currentTarget,F=w.getBoundingClientRect().left,R=w.getBoundingClientRect().top;n.rect.left=d.rect_left=u.clientX-F,n.rect.bottom=d.rect_bottom=360-(u.clientY-R),h()},q=u=>{if(!d.rect_down)return;const w=u.clientX-n.rect.x,F=u.clientY-n.rect.y;d.rect_left=Math.max(0,Math.min(360,n.rect.left+w)),d.rect_bottom=Math.max(0,Math.min(360,n.rect.bottom-F)),h()},x=()=>{!d.rect_down||(d.rect_down=!1)},L=u=>{d.ver_down=!0,n.ver.y=u.clientY;const F=u.currentTarget.getBoundingClientRect().top;n.ver.bottom=d.ver_bottom=360-(u.clientY-F),h()},E=u=>{if(!d.ver_down)return;const w=u.clientY-n.ver.y;d.ver_bottom=Math.max(0,Math.min(360,n.ver.bottom-w)),h()},Y=()=>{!d.ver_down||(d.ver_down=!1)},T=()=>{p.value=!0},N=()=>{p.value=!1};return So(()=>o.modelValue,u=>{d.ver_down||d.rect_down||i.value||(console.log("watch"),V(u))}),V(o.modelValue),ho(()=>{window.addEventListener("mousemove",q,!1),window.addEventListener("mouseup",x,!1),window.addEventListener("mousemove",E,!1),window.addEventListener("mouseup",Y,!1)}),vo(()=>{window.removeEventListener("mousemove",q,!1),window.removeEventListener("mouseup",x,!1),window.removeEventListener("mousemove",E,!1),window.removeEventListener("mouseup",Y,!1)}),{show:p,color:c,vars:s,state:d,colorRectPointerStart:U,colorVerPointerStart:L,updateHSV:v,updateRGB:$,updateHex:V,onOpen:T,onComfirm:N}}}),O=o=>(bo("data-v-5a88cd3c"),o=o(),mo(),o),Ro={class:"color-control"},Mo={class:"colorPanel_posLayer"},Fo=O(()=>a("div",{class:"colorPanel_colorVerBg"},null,-1)),Do={class:"colorPanel_viewbox"},Ao=O(()=>a("div",{class:"colorPanel_view__label"},"HSV",-1)),Go=O(()=>a("div",{class:"colorPanel_view__label"},"RGB",-1)),Uo=O(()=>a("div",{class:"colorPanel_view__label"},"Hex",-1));function Io(o,t,p,c,s,d){return M(),D("div",Ro,[a("div",{class:"color-preview",style:k({backgroundColor:o.color}),onClick:t[0]||(t[0]=(...n)=>o.onOpen&&o.onOpen(...n))},null,4),(M(),Bo(ko,{to:"body"},[C(a("div",{class:"colorPanel_posMask",onWheel:t[1]||(t[1]=G(()=>{},["prevent"])),onTouchstart:t[2]||(t[2]=G(()=>{},["prevent"])),onClick:t[3]||(t[3]=(...n)=>o.onComfirm&&o.onComfirm(...n))},null,544),[[eo,o.show]]),C(a("div",Mo,[a("div",{style:k(`background-color: hsl(${o.vars.h}deg, 100%, 50%)`),class:"colorPanel_colorRectBg"},[a("div",{class:"colorPanel_colorRect",onMousedown:t[4]||(t[4]=G((...n)=>o.colorRectPointerStart&&o.colorRectPointerStart(...n),["prevent","stop"]))},[a("div",{class:"colorPanel_colorRectPointer",style:k({left:`${o.state.rect_left}px`,bottom:`${o.state.rect_bottom}px`})},null,4)],32)],4),a("div",{class:"colorPanel_colorVer",onMousedown:t[5]||(t[5]=G((...n)=>o.colorVerPointerStart&&o.colorVerPointerStart(...n),["prevent","stop"]))},[Fo,a("div",{class:"colorPanel_colorVerPointer",style:k({bottom:`${o.state.ver_bottom}px`})},null,4)],32),a("div",Do,[a("div",{class:"colorPanel_viewcolor",style:k({background:o.color})},null,4),Ao,C(a("input",{type:"number",max:"360",min:"0",step:"1","onUpdate:modelValue":t[6]||(t[6]=n=>o.vars.h=n),class:"colorPanel_view__input",onInput:t[7]||(t[7]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[B,o.vars.h]]),C(a("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":t[8]||(t[8]=n=>o.vars.s=n),class:"colorPanel_view__input",onInput:t[9]||(t[9]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[B,o.vars.s]]),C(a("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":t[10]||(t[10]=n=>o.vars.v=n),class:"colorPanel_view__input",onInput:t[11]||(t[11]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[B,o.vars.v]]),Go,C(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[12]||(t[12]=n=>o.vars.r=n),class:"colorPanel_view__input",onInput:t[13]||(t[13]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[B,o.vars.r]]),C(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[14]||(t[14]=n=>o.vars.g=n),class:"colorPanel_view__input",onInput:t[15]||(t[15]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[B,o.vars.g]]),C(a("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":t[16]||(t[16]=n=>o.vars.b=n),class:"colorPanel_view__input",onInput:t[17]||(t[17]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[B,o.vars.b]]),Uo,C(a("input",{type:"text","onUpdate:modelValue":t[18]||(t[18]=n=>o.color=n),class:"colorPanel_view__input"},null,512),[[B,o.color]]),a("div",{class:"colorPanel_enter",onClick:t[19]||(t[19]=(...n)=>o.onComfirm&&o.onComfirm(...n))},"\u786E\u8BA4")])],512),[[eo,o.show]])]))])}var X=fo($o,[["render",Io],["__scopeId","data-v-5a88cd3c"]]);X.install=function(o){o.component(X.name,X)};const qo=io({components:{ColorPicker:X},setup(){const o=[{color:"#202020",bgcolor:"#ffffff"},{color:"#202020",bgcolor:"#FF3C41"},{color:"#202020",bgcolor:"#48CF74"},{color:"#202020",bgcolor:"#0EBEFF"},{color:"#202020",bgcolor:"#FCD000"}],t=I({editor:1,selectRange:5,shape:1,sortType:1,color:o[0].color,bgcolor:o[0].bgcolor});function p(e){t.color=e.color,t.bgcolor=e.bgcolor}const c=z([]),s=z([]),d=15,n=15,i=po(()=>({gridTemplateColumns:"repeat("+d+", 48px)",gridTemplateRows:"repeat("+n+", 48px)"}));function r(){for(let e=0;e<n;e++)for(let l=0;l<d;l++){const y={x:l+1,y:n-e,data:{d:0,d1:0,d2:0,q:0,color:o[0].color,bgcolor:o[0].bgcolor,size:14,txt:"",disabled:!1}};c.value.push(y)}}function f(e,l,y,_,P,g,S){c.value.forEach(b=>{const W=e-b.x,j=l-b.y,Q=Math.abs(W)+Math.abs(j),oo=Math.max(Math.abs(W),Math.abs(j));switch(_){case 1:Q<=y&&(b.data.d=Q,b.data.q=oo,b.data.color=g,b.data.bgcolor=S,s.value.push(b));break;case 2:Math.abs(W)<=y&&Math.abs(j)<=y&&(b.data.d=Q,b.data.q=oo,b.data.color=g,b.data.bgcolor=S,s.value.push(b));break}}),P===1&&(_===1?s.value.sort(v):_===2&&s.value.sort(V)),P===2&&(_===1?s.value.sort($):_===2&&s.value.sort(h)),P===3&&s.value.sort(U),P===4&&s.value.sort(q);for(let b=0;b<s.value.length;b++)s.value[b].data.txt=String(b+1)}function v(e,l){return e.data.d!==l.data.d?e.data.d-l.data.d:e.x!==l.x?e.x-l.x:e.y!==l.y?e.y-l.y:0}function $(e,l){return e.data.d!==l.data.d?e.data.d-l.data.d:e.y!==l.y?e.y-l.y:e.x!==l.x?e.x-l.x:0}function V(e,l){return e.data.q!==l.data.q?e.data.q-l.data.q:e.data.d!==l.data.d?e.data.d-l.data.d:e.x!==l.x?e.x-l.x:e.y!==l.y?e.y-l.y:0}function h(e,l){return e.data.q!==l.data.q?e.data.q-l.data.q:e.data.d!==l.data.d?e.data.d-l.data.d:e.y!==l.y?e.y-l.y:e.x!==l.x?e.x-l.x:0}function U(e,l){return e.x!==l.x?e.x-l.x:e.y!==l.y?e.y-l.y:0}function q(e,l){return e.y!==l.y?e.y-l.y:e.x!==l.x?e.x-l.x:0}function x(e){e.data.q=0,e.data.d=0,e.data.d1=0,e.data.d2=0,e.data.color=o[0].color,e.data.bgcolor=o[0].bgcolor,e.data.txt="",e.data.guard=!1,e.data.disabled=!1}function L(){c.value.forEach(e=>{x(e)}),s.value=[]}const E=I({enabled:!1});function Y(){L()}function T(){E.enabled=!1}function N(e,l){t.editor===1&&(E.current=l)}function u(e,l){if(e.button===0)switch(t.editor){case 2:{E.enabled=!0,l.data.color=t.color,l.data.bgcolor=t.bgcolor;break}case 3:{L(),f(l.x,l.y,t.selectRange,t.shape,t.sortType,t.color,t.bgcolor);break}}}function w(e,l){e.button===0&&E.enabled&&(l.data.color=t.color,l.data.bgcolor=t.bgcolor)}function F(){E.current=void 0}const R=I({}),wo=(e,l)=>{switch(t.editor){case 4:case 5:R.grid=l;break;default:e.preventDefault()}},yo=(e,l)=>{if(e.preventDefault(),!R.grid)return;const y=R.grid.data;R.grid.data=l.data,l.data=y,R.grid=void 0,t.editor===5&&H()};function K(e,l){let y=e[0].data[l];for(let _=1;_<e.length;_++)e[_].data[l]<y&&(y=e[_].data[l]);return y}function Z(e,l){return Math.abs(e.x-l.x)+Math.abs(e.y-l.y)}function _o(e,l,y){e.sort((S,b)=>+S.data.txt-+b.data.txt),e.forEach(S=>{S.data.d1=Z(S,y),S.data.d2=Z(S,l),S.data.guard=!1});const _=K(e,"d1");e=e.filter(S=>S.data.d1===_);const P=e[0];if(e.length===1)return e[0];const g=K(e,"d2");return e=e.filter(S=>S.data.d2===g),P!==e[0]?e[e.length-1]:P}function Co(){let e=0;for(let l=0;l<4;l++)c.value[e].data.txt=`${l+1}`,c.value[e].data.bgcolor="#0ebeff",c.value[e].data.disabled=!1,e++;c.value[e].data.txt="A",c.value[e].data.bgcolor="#FF3C41",c.value[e].data.disabled=!1,e++,c.value[e].data.txt="B",c.value[e].data.bgcolor="#FCD000",c.value[e].data.disabled=!1,e++,t.editor=5}const H=()=>{const e=c.value.filter(g=>!g.data.disabled).filter(g=>g.data.txt),l=e.filter(g=>g.data.txt.toUpperCase()==="A")[0],y=e.filter(g=>g.data.txt.toUpperCase()==="B")[0],_=e.filter(g=>+g.data.txt>0);if(!l||!y||_.length===0){alert("\u7F3A\u5C11\u89D2\u8272\uFF0C\u5C06\u81EA\u52A8\u751F\u6210"),Co(),H();return}const P=_o(_,l,y);P.data.guard=!0},go=e=>{if(e.data.disabled=!e.data.disabled,t.editor===5){switch(e.data.txt.toUpperCase()){case"A":case"B":e.data.disabled=!1;break}H()}};return window.addEventListener("mouseup",T,!1),vo(()=>{window.removeEventListener("mouseup",T,!1)}),r(),{state:t,colors:o,grids:c,selects:s,gridsStyle:i,selectState:E,onSelectColor:p,onResetClick:Y,onGridClick:N,onGridMouseDown:u,onGridMouseEnter:w,onGridEditorDone:F,dragState:R,onDragStart:wo,onDrop:yo,onCalcGuard:H,onSwitchEnable:go}}}),m=o=>(bo("data-v-68dcb5c8"),o=o(),mo(),o),xo={class:"wrapper"},Lo={class:"toolbar"},Yo={class:"setting"},To={class:"label-control"},Ho=m(()=>a("span",null,"\u7F16\u8F91\u6A21\u5F0F\xA0",-1)),Xo=Eo('<option value="1" data-v-68dcb5c8>\u7F16\u8F91</option><option value="2" data-v-68dcb5c8>\u4E0A\u8272</option><option value="3" data-v-68dcb5c8>\u9009\u62E9</option><option value="4" data-v-68dcb5c8>\u62D6\u62FD</option><option value="5" data-v-68dcb5c8>\u62A4\u536B\u8BA1\u7B97</option>',5),zo=[Xo],Oo={class:"label-control"},No=m(()=>a("span",null,"\u8303\u56F4\xA0",-1)),Wo={class:"label-control"},jo=m(()=>a("span",null,"\u5F62\u72B6\xA0",-1)),Qo=m(()=>a("option",{value:1},"\u83F1\u5F62",-1)),Jo=m(()=>a("option",{value:2},"\u5708\u6570",-1)),Ko=[Qo,Jo],Zo={class:"label-control"},oe=m(()=>a("span",null,"\u6392\u5E8F\xA0",-1)),ee=m(()=>a("option",{value:1},"\u8DDD\u79BBX",-1)),te=m(()=>a("option",{value:2},"\u8DDD\u79BBY",-1)),le=m(()=>a("option",{value:3},"X\u4F18\u5148",-1)),ne=m(()=>a("option",{value:4},"Y\u4F18\u5148",-1)),ae=[ee,te,le,ne],se={class:"color-container"},re={class:"label-control"},de=m(()=>a("span",null,"\u9884\u89C8\xA0",-1)),ue={class:"label-control"},ce=m(()=>a("span",null,"\u6587\u5B57\xA0",-1)),ie={class:"label-control"},pe=m(()=>a("span",null,"\u80CC\u666F\xA0",-1)),ve=m(()=>a("label",{class:"label-control"},[a("span",null,"\u9884\u8BBE\xA0")],-1)),fe={class:"color-tpls"},be=["onClick"],me={class:"props-container"},we={key:0,class:"props-content"},ye={class:"label-control"},_e=m(()=>a("span",null,"\u9884\u89C8\xA0",-1)),Ce={class:"label-control"},ge=m(()=>a("span",null,"\u6587\u5B57\xA0",-1)),Se={class:"label-control"},he=m(()=>a("span",null,"\u80CC\u666F\xA0",-1)),Be={class:"label-control"},ke=m(()=>a("span",null,"\u5927\u5C0F\xA0",-1)),Ve={class:"label-control"},Ee=m(()=>a("span",null,"\u5185\u5BB9\xA0",-1)),Pe={class:"content"},$e=["onDragstart","onDrop","onContextmenu","onClick","onMousedown","onMouseenter"];function Re(o,t,p,c,s,d){const n=ao("ColorPicker"),i=ao("c-space");return M(),D("div",xo,[a("div",Lo,[a("div",Yo,[a("label",To,[Ho,C(a("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>o.state.editor=r)},zo,512),[[J,o.state.editor,void 0,{number:!0}]])]),a("label",Oo,[No,C(a("input",{type:"number",min:"0","onUpdate:modelValue":t[1]||(t[1]=r=>o.state.selectRange=r),style:{width:"5em"}},null,512),[[B,o.state.selectRange]])]),a("label",Wo,[jo,C(a("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>o.state.shape=r)},Ko,512),[[J,o.state.shape]])]),a("label",Zo,[oe,C(a("select",{"onUpdate:modelValue":t[3]||(t[3]=r=>o.state.sortType=r)},ae,512),[[J,o.state.sortType]])]),a("button",{class:"btn",onClick:t[4]||(t[4]=(...r)=>o.onResetClick&&o.onResetClick(...r))},"\u6E05\u7A7A"),a("button",{class:"btn",onClick:t[5]||(t[5]=(...r)=>o.onCalcGuard&&o.onCalcGuard(...r))},"\u8BA1\u7B97\u62A4\u536B")]),a("div",se,[A(i,null,{default:to(()=>[a("label",re,[de,a("div",{class:"color-unit",style:k([`--color:${o.state.color};--bgcolor:${o.state.bgcolor}`])}," E ",4)]),a("label",ue,[ce,A(n,{modelValue:o.state.color,"onUpdate:modelValue":t[6]||(t[6]=r=>o.state.color=r)},null,8,["modelValue"])]),a("label",ie,[pe,A(n,{modelValue:o.state.bgcolor,"onUpdate:modelValue":t[7]||(t[7]=r=>o.state.bgcolor=r)},null,8,["modelValue"])]),ve,a("div",fe,[(M(!0),D(lo,null,no(o.colors,(r,f)=>(M(),D("div",{key:f,class:so(["color-unit",{selected:o.state.bgcolor===r.bgcolor}]),style:k([`--color:${r.color};--bgcolor:${r.bgcolor}`]),onClick:v=>o.onSelectColor(r)}," E ",14,be))),128))])]),_:1})]),a("div",me,[o.selectState.current?(M(),D("div",we,[A(i,null,{default:to(()=>[a("label",ye,[_e,a("div",{class:"color-unit",style:k([`--color:${o.selectState.current.data.color};--bgcolor:${o.selectState.current.data.bgcolor}`])},ro(o.selectState.current.data.txt),5)]),a("label",Ce,[ge,A(n,{modelValue:o.selectState.current.data.color,"onUpdate:modelValue":t[8]||(t[8]=r=>o.selectState.current.data.color=r)},null,8,["modelValue"])]),a("label",Se,[he,A(n,{modelValue:o.selectState.current.data.bgcolor,"onUpdate:modelValue":t[9]||(t[9]=r=>o.selectState.current.data.bgcolor=r)},null,8,["modelValue"])]),a("label",Be,[ke,C(a("input",{type:"number",style:{width:"4em"},min:"12",step:"1","onUpdate:modelValue":t[10]||(t[10]=r=>o.selectState.current.data.size=r)},null,512),[[B,o.selectState.current.data.size]])]),a("label",Ve,[Ee,C(a("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=r=>o.selectState.current.data.txt=r)},null,512),[[B,o.selectState.current.data.txt]])]),a("button",{class:"btn",onClick:t[12]||(t[12]=(...r)=>o.onGridEditorDone&&o.onGridEditorDone(...r))},"\u5B8C\u6210")]),_:1})])):Vo("",!0)])]),a("div",Pe,[a("div",{class:"grids",style:k(o.gridsStyle)},[(M(!0),D(lo,null,no(o.grids,(r,f)=>(M(),D("div",{key:f,class:so({selected:r===o.selectState.current,guard:r.data.guard,disabled:r.data.disabled}),style:k({fontSize:`${r.data.size}px`,color:r.data.color,backgroundColor:r.data.bgcolor}),draggable:!0,onDragstart:v=>o.onDragStart(v,r),onDragover:t[13]||(t[13]=G(()=>{},["prevent"])),onDrop:v=>o.onDrop(v,r),onContextmenu:G(v=>o.onSwitchEnable(r),["prevent"]),onClick:v=>o.onGridClick(v,r),onMousedown:v=>o.onGridMouseDown(v,r),onMouseenter:v=>o.onGridMouseEnter(v,r)},ro(r.data.txt),47,$e))),128))],4)])])}var De=fo(qo,[["render",Re],["__scopeId","data-v-68dcb5c8"]]);export{De as default};
