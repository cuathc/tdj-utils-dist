import{_ as tt,E as ue,o as d,c as v,e as t,G as le,H as ce,J as ie,K as de,L as dt,d as ct,q as X,M as Nt,N as nt,f as k,j as ht,n as It,O as re,P as vt,m as it,a as I,g as m,h as F,u,i as J,w as O,B as ut,Q as Mt,S as pe,R as _e,F as P,r as K,z as W,U as xt,V as Lt,p as wt,l as kt,b as lt,T as qt,I as fe,x as ve,W as he,k as _t,y as Ct,v as Pt,X as bt,Y as L,Z as me,C as gt}from"./index.js";import{_ as Dt}from"./lodash.js";import{u as be}from"./useHeroes.js";import Fe from"./InputNumber.js";import{b as jt,d as Ut,a as Be,i as $e}from"./shared.js";import{S as Q,a as ye}from"./star-crystals.js";import{s as Ot}from"./data.js";const ge=["width","height"],Ce=t("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),xe=[Ce];function we(s,o,e,a,l,h){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},xe,8,ge)}const ke=tt(ue,[["render",we]]),Ee=["width","height"],De=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),Se=[De];function Ae(s,o,e,a,l,h){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Se,8,Ee)}const Me=tt(le,[["render",Ae]]),Ue=["width","height"],Ve=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Ie=[Ve];function Te(s,o,e,a,l,h){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Ie,8,Ue)}const He=tt(ce,[["render",Te]]),Ge=["width","height"],Pe=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),ze=[Pe];function Re(s,o,e,a,l,h){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},ze,8,Ge)}const Kt=tt(ie,[["render",Re]]),Ne=["width","height"],Le=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),qe=[Le];function je(s,o,e,a,l,h){return d(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},qe,8,Ne)}const Oe=tt(de,[["render",je]]);let At=0,zt=0;const Ke=500;function Rt(){const s=Math.floor(new Date().getTime()/1e3);zt===s?At++:At=0,zt=s;const o=s.toString(16);return`${(Ke<<16|At&255).toString(16)}.${o}`}async function Je(){try{return await dt.getAll("calculator")}catch{return[]}}async function Qe(s){try{await dt.add("calculator",JSON.parse(JSON.stringify(s)))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Et(s){try{await dt.put("calculator",JSON.parse(JSON.stringify(s)))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Xe(s){try{await dt.delete("calculator",s)}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function We(s){try{const a=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await dt.wrap(a.put(l))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}async function Ze(s){try{const a=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await dt.wrap(a.delete(l))}catch(o){o instanceof Error?console.log(o.message):console.log(o)}}function Ye(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function ts(){return{a:0}}function es(){return{att:0}}function Jt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function ss(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function ns(){return[Jt()]}function os(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const as=ct({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(s,{emit:o}){const e=X(),a=X({}),l=X(s.active),h=()=>{const C=e.value.getBoundingClientRect();switch(l.value=!0,o("update:active",l.value),s.dir){case"left":a.value={top:`${C.top+C.height/2}px`,right:`${window.innerWidth-C.left-4}px`,maxWidth:"100%"};break;case"right":a.value={top:`${C.top+C.height/2}px`,left:`${C.right+4}px`,maxWidth:"100%"};break;case"top":a.value={bottom:`${window.innerHeight-C.top-4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"};break;default:a.value={top:`${C.bottom+4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"}}};let _;const c=()=>{_=window.setTimeout(h,s.wait)},D=()=>{clearTimeout(_),l.value=!1,o("update:active",l.value)};return Nt(()=>s.active,S=>{l.value=S}),{el:e,style:a,tActive:l,onEnter:c,onOut:D}}});const us={class:"c-tooltip-label"};function ls(s,o,e,a,l,h){return d(),v("div",{ref:"el",class:ht(["c-tooltip",{active:s.tActive,inline:s.inline}]),onMouseenter:o[0]||(o[0]=(..._)=>s.onEnter&&s.onEnter(..._)),onMouseout:o[1]||(o[1]=(..._)=>s.onOut&&s.onOut(..._))},[nt(s.$slots,"label",{},()=>[t("div",us,k(s.label),1)]),t("div",{class:ht(["c-tooltip-inner",s.dir?`c-tooltip-${s.dir}`:"c-tooltip-bottom",s.color?`c-tooltip-${s.color}`:""]),style:It(s.style)},[nt(s.$slots,"default")],6)],34)}const pt=tt(as,[["render",ls]]),cs=["onClick"],is=ct({__name:"dropdown",props:{pos:{default:"lt"}},setup(s){const o=X(!1),e=()=>{o.value=!0},a=()=>{o.value=!1};return window.addEventListener("click",a,!1),re(()=>{window.removeEventListener("click",a,!1)}),(l,h)=>(d(),v("div",{class:ht(["dropdown",[{active:o.value}]]),onClick:vt(e,["stop"])},[nt(l.$slots,"default",{},void 0,!0),t("div",{class:ht(["dropdown-popover",["dropdown-"+s.pos]]),onClick:h[0]||(h[0]=vt(()=>{},["stop"]))},[nt(l.$slots,"popover",{onClose:a},void 0,!0)],2)],10,cs))}});const Qt=tt(is,[["__scopeId","data-v-e27f2ee9"]]);Qt.install=s=>{s.component("dropdown",Xt)};const Xt=Qt,ot=s=>(wt("data-v-be238d13"),s=s(),kt(),s),ds=["onKeypress"],rs=["onKeypress"],ps=ot(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),_s=W(" \u514B\u523630%"),fs=ot(()=>t("br",null,null,-1)),vs=W("\u88AB\u514B\u5236-25%"),hs=ot(()=>t("br",null,null,-1)),ms=W("\u6FC0\u836150% "),bs=["onClick"],Fs={class:"row"},Bs={class:"col-item"},$s=ot(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ys=W(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),gs={class:"input-group"},Cs=["step"],xs=ot(()=>t("div",{class:"input-ext"},"\u500D",-1)),ws={class:"label"},ks={class:"input-group"},Es=ot(()=>t("div",{style:{clear:"both"}},null,-1)),Ds={class:"col-item"},Ss=ot(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),As=W(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),Ms={class:"input-group"},Us=["step"],Vs=ot(()=>t("div",{class:"input-ext"},"\u500D",-1)),Is={class:"label"},Ts={class:"input-group"},Hs={class:"col-item"},Gs=ot(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Ps={class:"static-control text-center"},zs={class:"darkgold"},Rs=ot(()=>t("div",{style:{clear:"both"}},null,-1)),Ns={class:"label"},Ls={class:"bold darkgold"},qs=ot(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),js={class:"static-control text-center"},Os={class:"bold darkgold"},Ks={class:"bold red"},Js={class:"label bold"},Qs={class:"static-control text-center"},Xs={class:"bold darkgold"},Ws={key:0,class:"bold red"},Zs=ct({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(s,{emit:o}){const e=s,a=it({editor:!1,name:"",desc:{f:!1,v:""}}),l=(n,i)=>{if(n==="name")return;const V=e.itemState;switch(n){case"a1":case"a2":case"kz":typeof i=="number"&&(V[n]=i);break;default:typeof i=="string"&&(V[n]=i)}o("update:itemState",V)},h=it(ss()),_=I({set:n=>l("a1",n),get:()=>e.itemState.a1}),c=I({set:n=>l("a2",n),get:()=>e.itemState.a2}),D=I({set:n=>l("att",n),get:()=>e.itemState.att}),S=I({set:n=>l("id",n),get:()=>e.itemState.id}),C=I({set:n=>l("da",n),get:()=>e.itemState.da}),z=I({set:n=>l("db",n),get:()=>e.itemState.db}),f=I({set:n=>l("dc",n),get:()=>e.itemState.dc}),p=I({set:n=>l("dx",n),get:()=>e.itemState.dx}),w=I({set:n=>l("cd",n),get:()=>e.itemState.cd}),E=I({set:n=>l("att2",n),get:()=>e.itemState.att2}),R=I({set:n=>l("da2",n),get:()=>e.itemState.da2}),G=I({set:n=>l("dx2",n),get:()=>e.itemState.dx2}),T=I({set:n=>l("defGain",n),get:()=>e.itemState.defGain}),q=I({set:n=>l("kz",n),get:()=>e.itemState.kz||0}),$=it({a1:_,a2:c,att:D,da:C,db:z,dc:f,dx:p,id:S,cd:w,att2:E,da2:R,dx2:G,defGain:T,kz:q}),A=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],g=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],M=I(()=>{const{state:n}=e,i=(100+h.att)/100;return Math.ceil(n.att*i)}),Y=I(()=>{const{state:n}=e,i=(100+h.att+h.att2)/100;return Math.ceil(n.att*i)}),at=()=>{const{enemyState:n}=e,i=(100+$.kz)/100,V=(100+h.da-n.ra)/100,b=(100+h.da+h.da2-n.ra)/100,U=(100+h.db-n.rb)/100,st=(100+h.dc)/100,x=(100+h.dx)/100,mt=(100+h.dx+h.dx2)/100,N=(100+h.cd)/100,Tt=(100-h.id)/100,Zt=(100+n.defGain)/100,Yt=(100+n.defGain+h.defGain)/100,te=Math.max(0,Math.max(0,n.def*Zt+n.defExt)*Tt),ee=Math.max(0,Math.max(0,n.def*Yt+n.defExt)*Tt),se=Math.max(1,M.value*i-te),ne=Math.max(1,Y.value*i-ee),Ht=se*$.a1*V*U*x,oe=Math.ceil(Ht*N),Gt=ne*$.a2*b*U*st*mt,ae=Math.ceil(Gt*N);return{r01:Math.ceil(Ht),r01c:oe,r02:Math.ceil(Gt),r02c:ae}},$t=I(()=>at());function rt(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&o("close")}function H(){a.editor=!0,a.name=e.itemState.name}function y(){const n=a.name;if(a.editor=!1,a.name="",!n)return;const i=e.itemState;i.name=n,o("update:itemState",i)}function et(){a.desc.f=!0,a.desc.v=e.itemState.desc}function j(){const n=a.desc.v;if(a.desc.f=!1,a.desc.v="",!n)return;const i=e.itemState;i.desc=n,o("update:itemState",i)}function yt(){o("up")}function r(){o("down")}function B(){o("copy")}return(n,i)=>{const V=Lt("autofocus");return d(),v(P,null,[m(u(_e),{orientation:"left"},{action:F(()=>[t("span",{onClick:B},[m(u(Kt),{class:"close"})]),s.showUp?(d(),v("span",{key:0,onClick:yt},[m(u(Me),{class:"close"})])):J("",!0),s.showDown?(d(),v("span",{key:1,onClick:r},[m(u(He),{class:"close"})])):J("",!0),t("span",{onClick:rt},[m(u(ke),{class:"close"})])]),default:F(()=>[a.editor?O((d(),v("input",{key:0,class:"input",type:"text","onUpdate:modelValue":i[0]||(i[0]=b=>a.name=b),onKeypress:Mt(y,["enter"]),onBlur:y},null,40,ds)),[[ut,a.name],[V]]):(d(),v("span",{key:1,class:"calc-item-title",onClick:H},k(s.itemState.name||"\u6A21\u677F"),1)),a.desc.f?O((d(),v("input",{key:2,class:"input",type:"text","onUpdate:modelValue":i[1]||(i[1]=b=>a.desc.v=b),onKeypress:Mt(j,["enter"]),onBlur:j},null,40,rs)),[[ut,a.desc.v],[V]]):(d(),v("span",{key:3,class:"calc-item-desc",onClick:et},k(s.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),m(u(pe),{style:{width:"120px"}},{default:F(()=>[m(u(pt),{dir:"top"},{label:F(()=>[ps]),default:F(()=>[_s,fs,vs,hs,ms]),_:1}),t("div",null,[m(u(Xt),null,{popover:F(({onClose:b})=>[t("div",{class:"list",onClick:U=>b()},[t("div",{class:"list-item",onClick:i[3]||(i[3]=U=>$.kz=0)},"\u666E\u901A"),t("div",{class:"list-item",onClick:i[4]||(i[4]=U=>$.kz=30)},"\u514B\u5236"),t("div",{class:"list-item",onClick:i[5]||(i[5]=U=>$.kz=-25)},"\u88AB\u514B\u5236"),t("div",{class:"list-item",onClick:i[6]||(i[6]=U=>$.kz=50)},"\u6FC0\u8361")],8,bs)]),default:F(()=>[O(t("input",{class:"input",type:"number","onUpdate:modelValue":i[2]||(i[2]=b=>$.kz=b)},null,512),[[ut,$.kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",Fs,[t("div",Bs,[m(u(pt),{dir:"top"},{label:F(()=>[$s]),default:F(()=>[ys]),_:1}),t("div",gs,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":i[7]||(i[7]=b=>$.a1=b)},null,8,Cs),[[ut,$.a1,void 0,{number:!0}]]),xs])]),(d(),v(P,null,K(A,b=>t("div",{class:"col-item",key:b.name},[m(u(pt),{dir:"top"},{label:F(()=>[t("div",ws,k(b.label),1)]),default:F(()=>[W(" "+k(b.tip),1)]),_:2},1024),t("div",ks,[m(u(xt),{class:"input",modelValue:$[b.name],"onUpdate:modelValue":U=>$[b.name]=U,result:h[b.name],"onUpdate:result":U=>h[b.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),Es,t("div",Ds,[m(u(pt),{dir:"top"},{label:F(()=>[Ss]),default:F(()=>[As]),_:1}),t("div",Ms,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":i[8]||(i[8]=b=>$.a2=b)},null,8,Us),[[ut,$.a2,void 0,{number:!0}]]),Vs])]),(d(),v(P,null,K(g,b=>t("div",{class:"col-item",key:b.name},[m(u(pt),{dir:"top"},{label:F(()=>[t("div",Is,k(b.label),1)]),default:F(()=>[W(" "+k(b.tip),1)]),_:2},1024),t("div",Ts,[m(u(xt),{class:"input",modelValue:$[b.name],"onUpdate:modelValue":U=>$[b.name]=U,result:h[b.name],"onUpdate:result":U=>h[b.name]=U},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Hs,[Gs,t("div",Ps,[t("span",zs,k(u(M)),1)])]),Rs,(d(!0),v(P,null,K([u($t)],b=>(d(),v(P,null,[(d(!0),v(P,null,K([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:b.r01,v2:b.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:b.r02,v2:b.r02c}],(U,st)=>(d(),v("div",{class:"col-item",key:st},[t("div",Ns,[t("span",Ls,k(U.label),1),qs]),t("div",js,[t("span",Os,k(U.v),1),t("span",Ks,"("+k(U.v2)+")",1)])]))),128)),(d(!0),v(P,null,K([{label:"\u4E0D\u66B4\u51FB",value:b.r01+b.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:b.r01c+b.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:b.r01+b.r02c},{label:"\u5168\u66B4\u51FB",value:b.r01c+b.r02c}],(U,st)=>(d(),v("div",{class:"col-item",key:st},[t("div",Js,k(U.label),1),t("div",Qs,[t("span",Xs,k(U.value),1),(+s.enemyState.hp||0)<=U.value?(d(),v("span",Ws," \u51FB\u6740 ")):J("",!0)])]))),128))],64))),256))])],64)}}});const Ys=tt(Zs,[["__scopeId","data-v-be238d13"]]),St=s=>(wt("data-v-bd82d11d"),s=s(),kt(),s),tn=St(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),en={class:"row"},sn={class:"label"},nn={class:"input-group"},on=["step","onUpdate:modelValue","onChange"],an=["value"],un={class:"col-item"},ln=St(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),cn={class:"static-control text-center"},dn={class:"darkgold"},rn=St(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),pn={class:"row"},_n={class:"label"},fn={key:1,class:"label"},vn={class:"input-group"},hn={key:0,class:"input-ext"},mn=St(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),bn=ct({__name:"Calculator",props:{data:null},emits:["update:data"],setup(s,{emit:o}){const e=s,a=I(()=>e.data.basic),l=I(()=>e.data.state),h=I(()=>e.data.enemyState),_=I(()=>e.data.items),c=it(ts()),D=it({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),S=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],C=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],z=()=>{const $=a.value.c/100;a.value.g=Math.ceil(c.a+a.value.w*$+a.value.x),l.value.att=a.value.w+a.value.g},f=async()=>{o("update:data",e.data)},p=($,A)=>{A==="panel"&&z(),f()},w=($,A)=>{const g=e.data.items;!g||(g[A]=$,f())},E=()=>{const $=e.data.items;!$||($.push(Jt()),f())},R=$=>{const A=e.data.items;!A||(A.splice($,1),f())},G=$=>{const A=e.data.items;if(!A)return;const g=A[$],M=A[$-1];A[$-1]=g,A[$]=M,f()},T=$=>{const A=e.data.items;if(!A)return;const g=A[$],M=A[$+1];A[$+1]=g,A[$]=M,f()},q=$=>{const A=e.data.items;if(!A)return;const g=A[$];A.push(Dt.cloneDeep(g)),f()};return Nt(()=>[e.data.basic.w],()=>{z()}),($,A)=>(d(),v("div",null,[tn,t("div",en,[(d(),v(P,null,K(S,g=>t("div",{class:"col-item",key:g.name},[t("div",sn,k(g.label),1),t("div",nn,[g.name in c?(d(),lt(u(xt),{key:0,modelValue:u(a)[g.name],"onUpdate:modelValue":M=>u(a)[g.name]=M,result:c[g.name],"onUpdate:result":M=>c[g.name]=M,onChange:M=>p(g.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):O((d(),v("input",{key:1,type:"number",class:"input",style:It({textAlign:g.align}),min:"0",step:g.step,"onUpdate:modelValue":M=>u(a)[g.name]=M,onChange:M=>p(g.name,"panel")},null,44,on)),[[ut,u(a)[g.name],void 0,{number:!0}]]),g.name==="w"?(d(),v("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${u(a).g}`},null,8,an)):J("",!0)])])),64)),t("div",un,[ln,t("div",cn,[t("span",dn,k(u(l).att),1)])])]),rn,t("div",pn,[(d(),v(P,null,K(C,g=>t("div",{class:"col-item",key:g.name},[g.tips?(d(),lt(u(pt),{key:0,dir:"top"},{label:F(()=>[t("div",_n,k(g.label),1)]),default:F(()=>[W(" "+k(g.tips),1)]),_:2},1024)):(d(),v("div",fn,k(g.label),1)),t("div",vn,[m(u(xt),{modelValue:u(h)[g.name],"onUpdate:modelValue":M=>u(h)[g.name]=M,result:D[g.name],"onUpdate:result":M=>D[g.name]=M,onChange:M=>p(g.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),g.precent?(d(),v("div",hn,"%")):J("",!0)])])),64))]),t("div",{class:"heading"},[mn,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:E},"\u6DFB\u52A0")])]),(d(!0),v(P,null,K(u(_),(g,M)=>(d(),lt(Ys,{key:g,panel:u(a),state:u(l),enemyState:D,itemState:g,showUp:M>0,showDown:u(_)&&M<u(_).length-1,"onUpdate:itemState":Y=>w(Y,M),onClose:Y=>R(M),onUp:Y=>G(M),onDown:Y=>T(M),onCopy:Y=>q(M)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const Fn=tt(bn,[["__scopeId","data-v-bd82d11d"]]),Bn=ct({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(s,{emit:o}){return{wrapClass:I(()=>["c-action-sheet-wrapper",s.class,{show:s.show}]),onClick:(h,_)=>{o("click",{item:h,index:_}),o("close",!1)},onClose:()=>{o("update:show",!1),o("close",!1)}}}});const $n={class:"c-action-sheet-section"},yn={class:"c-action-sheet-extra"},gn={class:"c-action-sheet-list"},Cn=["onClick"];function xn(s,o,e,a,l,h){return d(),lt(qt,{to:"body"},[t("div",{class:ht(s.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:o[0]||(o[0]=(..._)=>s.onClose&&s.onClose(..._))}),t("div",$n,[t("div",{class:"c-action-sheet-body",style:It({maxHeight:s.height})},[t("div",yn,[nt(s.$slots,"extra")]),t("div",gn,[(d(!0),v(P,null,K(s.list,(_,c)=>(d(),v("div",{class:"c-action-sheet-item",key:c,onClick:D=>s.onClick(_,c)},[nt(s.$slots,"default",{record:_})],8,Cn))),128))])],4)])],2)])}const Vt=tt(Bn,[["render",xn]]);Vt.install=s=>{s.component("action-sheet",Vt)};const wn={class:"hero-item"},kn=["src","alt","title"],En={class:"hero-item-label"},Dn=ct({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(s,{emit:o}){const{heroes:e,getHeroIcon:a}=be(),l=h=>{o("click",h)};return(h,_)=>(d(),lt(u(Vt),{class:"hero-select",show:s.show,list:u(e),height:"80vh",onClick:l,"onUpdate:show":_[0]||(_[0]=c=>h.$emit("update:show",c))},{extra:F(()=>[nt(h.$slots,"extra")]),default:F(({record:c})=>[t("div",wn,[t("img",{src:u(a)(c),alt:c.name,title:c.name,width:"128",height:"128"},null,8,kn),t("div",En,k(c.name),1)])]),_:3},8,["show","list"]))}});const Sn=ct({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(s,{emit:o}){const e=I({get:()=>s.activeKey,set:l=>{o("update:activeKey",l)}});return{active:e,toggle:()=>{const l=!e.value;e.value=l,o("toggle",l)}}}});const An=s=>(wt("data-v-829ec263"),s=s(),kt(),s),Mn=An(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Un={class:"panel-title"},Vn={class:"panel-body"},In={class:"panel-content"};function Tn(s,o,e,a,l,h){return d(),v("div",{class:ht(["panel",{active:s.active}])},[t("div",{class:"panel-header",onClick:o[1]||(o[1]=(..._)=>s.toggle&&s.toggle(..._))},[Mn,t("div",Un,[nt(s.$slots,"header",{},()=>[W(k(s.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:o[0]||(o[0]=vt(()=>{},["stop"]))},[nt(s.$slots,"actions",{},void 0,!0)])]),t("div",Vn,[t("div",In,[nt(s.$slots,"default",{},void 0,!0)])])],2)}const Hn=tt(Sn,[["render",Tn],["__scopeId","data-v-829ec263"]]);function Gn(){const s="red_team",o=fe(),e=X([]),a=X(!1),l=X(),h=async f=>{const w=(await o.transaction(s,"readwrite")).objectStore(s),E=await o.wrap(w.put(f));return e.value.find(G=>G._id===f._id)||(f._id=E,e.value.push(f)),E},_=async f=>{const w=(await o.transaction(s,"readwrite")).objectStore(s);await o.wrap(w.delete(f._id)),e.value=e.value.filter(E=>E._id!==f._id)},c=async f=>{const p=await o.transaction(s,"readwrite"),w=p.objectStore(s);for(const E of f)await o.wrap(w.put(E));await o.twrap(p),await S()},D=async()=>{const p=(await o.transaction(s,"readwrite")).objectStore(s);await o.wrap(p.clear()),e.value=[]},S=async()=>{const p=(await o.transaction(s,"readonly")).objectStore(s),w=await o.wrap(p.getAll()).catch(()=>[]);w.forEach(E=>{E.scList||(E.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF}])}),e.value=w},C=async f=>{const p=JSON.parse(await f.text());if(!jt(p)||p.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const w=p.data;w.forEach(E=>delete E._id),await c(w)},z=async()=>{const f={type:"red_team",data:e.value},p=new Blob([JSON.stringify(f)],{type:"application/json"});Ut(p,"red_team.json")};return S(),{scShow:a,scSelected:l,put:h,del:_,puts:c,clear:D,all:S,list:e,importData:C,exportData:z}}const Ft=s=>s%1>.5?Math.ceil(s):Math.floor(s);function Pn(){const s=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:Q.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:Q.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:Q.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),o=X(s()),e=I(()=>{const _=[0,0,0,0,0,0];return o.value.scList.forEach(c=>{!c.v||(_[0]+=c.v.qixue,_[1]+=c.v.patt,_[2]+=c.v.pdef,_[3]+=c.v.matt,_[4]+=c.v.mdef,_[5]+=c.v.huixin)}),_}),a=I(()=>{const _=o.value,c={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},D=Ot.find(z=>_.stoneName===z.name);D&&(c.qixue=D.t[0]+D.d[0]+D.h[0],c.patt=D.t[1]+D.d[1]+D.h[1],c.matt=D.t[2]+D.d[2]+D.h[2],c.pdef=D.t[3]+D.d[3]+D.h[3],c.mdef=D.t[4]+D.d[4]+D.h[4]);const S={qixue:_.hsQixue/100,patt:_.hsPatt/100,pdef:_.hsPdef/100,matt:_.hsMatt/100,mdef:_.hsMdef/100,huixin:_.hsHuixin/100},C=e.value;return{qixue:Ft(_.qixue*S.qixue+c.qixue+C[0]),patt:Ft(_.patt*S.patt+c.patt+C[1]),pdef:Ft(_.pdef*S.pdef+c.pdef+C[2]),matt:Ft(_.matt*S.matt+c.matt+C[3]),mdef:Ft(_.mdef*S.mdef+c.mdef+C[4]),huixin:Ft(_.huixin*S.huixin+c.huixin+C[5])}}),l=I(()=>{const _=a.value,c={qixue:(100+o.value.rQixue)/100,patt:(100+o.value.rPatt)/100,pdef:(100+o.value.rPdef)/100,matt:(100+o.value.rMatt)/100,mdef:(100+o.value.rMdef)/100,huixin:(100+o.value.rHuixin)/100};return{qixue:Math.round((o.value.qixue+_.qixue)*c.qixue),patt:Math.round((o.value.patt+_.patt)*c.patt),pdef:Math.round((o.value.pdef+_.pdef)*c.pdef),matt:Math.round((o.value.matt+_.matt)*c.matt),mdef:Math.round((o.value.mdef+_.mdef)*c.mdef),huixin:Math.round((o.value.huixin+_.huixin)*c.huixin)}});return{state:o,pValue:a,ckValue:l,scSum:e,reset:()=>{o.value=s()},defState:s}}const zn={},Rn={class:"c-upload"};function Nn(s,o){return d(),v("div",Rn,[nt(s.$slots,"default",{},void 0,!0),t("input",ve({type:"file",class:"c-upload-input",accept:"application/json"},s.$attrs),null,16)])}const Ln=tt(zn,[["render",Nn],["__scopeId","data-v-b3879154"]]),Z=s=>(wt("data-v-fc55a9ed"),s=s(),kt(),s),qn={class:"transform-tools-popover"},jn={class:"transform-tools-popover-toolbar"},On=["value"],Kn=["value"],Jn=Z(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Qn={class:"transform-tools-popover-content"},Xn={class:"grid-group"},Wn={class:"grid-group-item"},Zn={class:"input-group-title"},Yn=Z(()=>t("span",null,"\u57FA\u7840",-1)),to={class:"grids"},eo={class:"input-label"},so={class:"input-group"},no={class:"input green"},oo={class:"grid-group-item"},ao={class:"input-group-title"},uo=Z(()=>t("span",null,"\u9B42\u77F3",-1)),lo=Z(()=>t("option",{value:""},"\u65E0",-1)),co=["value"],io={class:"grids"},ro=Z(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),po=Z(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),_o=Z(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),fo=Z(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),vo=Z(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),ho={class:"grid-group-item"},mo={class:"input-group-title"},bo=W(" \u661F\u4E4B\u6676 "),Fo=Z(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),Bo=Z(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),$o=Z(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),yo={class:"grids"},go=["onClick","onContextmenu"],Co={key:0},xo={key:1},wo={key:2},ko={key:3},Eo={key:4},Do={key:5},So={key:1},Ao={class:"grid-group-item"},Mo=Z(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),Uo={class:"grids"},Vo={class:"input-label"},Io={class:"input"},To={class:"grid-group-item"},Ho=Z(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Go={class:"grids"},Po={class:"input-label"},zo={class:"grid-group-item"},Ro=Z(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),No={class:"grids"},Lo={class:"input-label"},qo={class:"input"},jo=ct({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(s,{emit:o}){const{state:e,pValue:a,ckValue:l,scSum:h,reset:_,defState:c}=Pn(),{list:D,put:S,del:C,clear:z,importData:f,exportData:p}=Gn(),w=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],E=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],R=X(!1),G=X(),T=H=>{G.value=H,R.value=!0},q=H=>{!G.value||(G.value.v=H)},$=()=>{const H=Dt.cloneDeep(e.value);S(H).then(y=>{e.value._id=y,alert("\u5DF2\u4FDD\u5B58")}).catch(y=>{console.log(y),alert("\u4FDD\u5B58\u5931\u8D25")})},A=()=>{const H=Dt.cloneDeep(e.value);delete H._id,H.name+=" copy",S(H).then(y=>{H._id=y,e.value=H}).catch(y=>{console.log(y),alert("\u590D\u5236\u5931\u8D25")})},g=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||C(e.value).then(()=>{_()}).catch(y=>{console.log(y),alert("\u5220\u9664\u5931\u8D25")})},M=H=>{const y=H.currentTarget;if(!y.files)return;const et=Array.prototype.slice.call(y.files);y.value="",et[0]&&f(et[0])},Y=()=>{p()},at=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||z().catch(y=>{console.log(y),alert("\u6E05\u7A7A\u5931\u8D25")})},$t=(H,y)=>{e.value.name=H,e.value.qixue=y.qixue,e.value.patt=y.patt,e.value.pdef=y.pdef,e.value.matt=y.matt,e.value.mdef=y.mdef,e.value.huixin=y.huixin},rt=()=>{o("reference")};return o("init",$t),(H,y)=>{const et=_t("c-col"),j=_t("c-space"),yt=_t("c-row");return O((d(),v("div",qn,[t("div",jn,[m(yt,{flex:"",middle:"",gutter:8},{default:F(()=>[m(et,null,{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:rt},"\u53C2\u8003")]),_:1}),m(et,null,{default:F(()=>[W("ID: "+k(u(e)._id),1)]),_:1}),m(et,{flex:"1 1 auto"},{default:F(()=>[m(j,null,{default:F(()=>[O(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":y[0]||(y[0]=r=>Ct(e)?e.value=r:null)},[t("option",{value:u(c)()},"\u7A7A\u6A21\u7248",8,On),(d(!0),v(P,null,K(u(D),r=>(d(),v("option",{key:r._id,value:r},k(r.name),9,Kn))),128))],512),[[Pt,u(e)]]),t("button",{class:"btn btn-sm btn-primary",onClick:$},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:A},"\u590D\u5236"),u(e)._id?(d(),v("button",{key:0,class:"btn btn-sm btn-danger",onClick:g},"\u5220\u9664")):J("",!0),m(Ln,{onChange:M},{default:F(()=>[Jn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:Y},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:at},"\u6E05\u7A7A")]),_:1})]),_:1}),m(et,null,{default:F(()=>[t("span",{class:"transform-tools-popover-close",onClick:y[1]||(y[1]=r=>o("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Qn,[t("div",Xn,[t("div",Wn,[t("div",Zn,[m(j,null,{default:F(()=>[Yn,O(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":y[2]||(y[2]=r=>u(e).name=r)},null,512),[[ut,u(e).name]])]),_:1})]),t("div",to,[(d(),v(P,null,K(w,r=>m(j,{key:r.n},{default:F(()=>[t("label",eo,k(r.t),1),t("div",so,[m(u(bt),{readonly:"",value:u(e)[r.n]},null,8,["value"]),t("div",no,"+"+k(u(a)[r.n]),1)])]),_:2},1024)),64))])]),t("div",oo,[t("div",ao,[m(j,null,{default:F(()=>[uo,O(t("select",{class:"input input-select","onUpdate:modelValue":y[3]||(y[3]=r=>u(e).stoneName=r)},[lo,(d(!0),v(P,null,K(u(Ot),(r,B)=>(d(),v("option",{key:B,value:r.name},k(r.name),9,co))),128))],512),[[Pt,u(e).stoneName]])]),_:1})]),t("div",io,[m(j,null,{default:F(()=>[ro,m(u(bt),{value:u(e).hsQixue,"onUpdate:value":y[4]||(y[4]=r=>u(e).hsQixue=r)},null,8,["value"])]),_:1}),m(j,null,{default:F(()=>[po,m(u(bt),{value:u(e).hsPatt,"onUpdate:value":y[5]||(y[5]=r=>u(e).hsPatt=r)},null,8,["value"])]),_:1}),m(j,null,{default:F(()=>[_o,m(u(bt),{value:u(e).hsPdef,"onUpdate:value":y[6]||(y[6]=r=>u(e).hsPdef=r)},null,8,["value"])]),_:1}),m(j,null,{default:F(()=>[fo,m(u(bt),{value:u(e).hsMatt,"onUpdate:value":y[7]||(y[7]=r=>u(e).hsMatt=r)},null,8,["value"])]),_:1}),m(j,null,{default:F(()=>[vo,m(u(bt),{value:u(e).hsMdef,"onUpdate:value":y[8]||(y[8]=r=>u(e).hsMdef=r)},null,8,["value"])]),_:1})])]),t("div",ho,[t("div",mo,[bo,m(u(pt),{label:"?",inline:"",dir:"right"},{default:F(()=>[Fo,Bo,$o]),_:1})]),t("div",yo,[(d(!0),v(P,null,K(u(e).scList,(r,B)=>(d(),v("div",{key:B,class:ht(["sc-props",{selected:G.value===r,s1:u(Q).ATT===r.pos,s2:u(Q).XUE===r.pos,s3:u(Q).DEF===r.pos}]),onClick:n=>T(r),onContextmenu:vt(n=>r.v=void 0,["prevent"])},[r.v?(d(),v(P,{key:0},[r.v.qixue>0?(d(),v("span",Co,"\u6C14\u8840+"+k(r.v.qixue),1)):J("",!0),r.v.patt>0?(d(),v("span",xo,"\u7269\u653B+"+k(r.v.patt),1)):J("",!0),r.v.pdef>0?(d(),v("span",wo,"\u7269\u9632+"+k(r.v.pdef),1)):J("",!0),r.v.matt>0?(d(),v("span",ko,"\u6CD5\u653B+"+k(r.v.matt),1)):J("",!0),r.v.mdef>0?(d(),v("span",Eo,"\u6CD5\u9632+"+k(r.v.mdef),1)):J("",!0),r.v.huixin>0?(d(),v("span",Do,"\u4F1A\u5FC3+"+k(r.v.huixin),1)):J("",!0)],64)):(d(),v("span",So,k(r.n),1))],42,go))),128))]),(d(),lt(qt,{to:"body"},[G.value?(d(),lt(u(ye),{key:0,show:R.value,"onUpdate:show":y[9]||(y[9]=r=>R.value=r),position:G.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:q},null,8,["show","position"])):J("",!0)]))]),t("div",Ao,[Mo,t("div",Uo,[(d(),v(P,null,K(w,(r,B)=>m(j,{key:B},{default:F(()=>[t("label",Vo,k(r.t),1),t("div",Io,"+"+k(u(h)[B]),1)]),_:2},1024)),64))])]),t("div",To,[Ho,t("div",Go,[(d(),v(P,null,K(E,(r,B)=>m(j,{key:B},{default:F(()=>[t("label",Po,k(r.t),1),m(u(xt),{modelValue:u(e)[r.c],"onUpdate:modelValue":n=>u(e)[r.c]=n,result:u(e)[r.r],"onUpdate:result":n=>u(e)[r.r]=n},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",zo,[Ro,t("div",No,[(d(),v(P,null,K(w,r=>m(j,{key:r.n},{default:F(()=>[t("label",Lo,k(r.t),1),t("div",qo,k(u(l)[r.n]),1)]),_:2},1024)),64))])])])])],512)),[[he,s.show]])}}});const Oo=tt(jo,[["__scopeId","data-v-fc55a9ed"]]);function ft(s){return(s%1>.5?Math.ceil:Math.floor)(s)}function Wt(s){const{basic:o,enemyState:e}=s,a={w:o.w,a:L(o.a),c:o.c,x:o.x,g:0,att:0};a.g=ft(o.w*o.c/100+a.a+a.x),a.att=o.w+a.g;const l={hp:L(e.hp),ra:L(e.ra),rb:L(e.rb),def:L(e.def),defExt:L(e.defExt),defGain:L(e.defGain)};return{b:a,e:l}}function Ko(s,o){const{b:e,e:a}=Wt(s),l={a1:o.a1,a2:o.a2,att:L(o.att),att2:L(o.att2),da:L(o.da),da2:L(o.da2),db:L(o.db),dc:L(o.dc),dx:L(o.dx),dx2:L(o.dx2),id:L(o.id),cd:L(o.cd),defGain:L(o.defGain),kz:o.kz||0},h=e.att*(100+l.att)/100,_=e.att*(100+l.att+l.att2)/100,c=(100+l.kz)/100,D=(100+l.da-a.ra)/100,S=(100+l.da+l.da2-a.ra)/100,C=(100+l.db-a.rb)/100,z=(100+l.dc)/100,f=(100+l.dx)/100,p=(100+l.dx+l.dx2)/100,w=(100+l.cd)/100,E=(100-l.id)/100,R=(100+a.defGain)/100,G=(100+a.defGain+l.defGain)/100,T=Math.max(0,Math.max(0,a.def*R+a.defExt)*E),q=Math.max(0,Math.max(0,a.def*G+a.defExt)*E),$=Math.max(1,h*c-T),A=Math.max(1,_*c-q),g=$*l.a1*D*C*f,M=ft(g*w),Y=A*l.a2*S*C*z*p,at=ft(Y*w);return{satt:h,satt2:_,r01:ft(g),r01c:M,r02:ft(Y),r02c:at}}function Jo(s){const o=s.items||[],e=document.createElement("canvas");e.width=800,e.height=8+160+o.reduce((p,w)=>{let E=30;return E+=50,w.a1>0&&(E+=30),w.a2>0&&(E+=50),(w.a1>0||w.a2>0)&&(E+=20),w.a1>0&&w.a2>0&&(E+=20),E+=20,p+E},0)+8;const a=e.getContext("2d");if(!a)return;const l=s.basic,h=s.enemyState,{b:_}=Wt(s),c={x:0,y:0},D=(p,w,E)=>{E?(c.x+=p,c.y+=w):(c.x=p,c.y=w)},S=(p=0)=>{c.x=8+p*16},C=(p=0)=>{c.x=8,c.y+=p},z=(p,w="#222222")=>{a.save(),a.fillStyle=w;const{width:E}=a.measureText(p);a.fillText(p,c.x,c.y),c.x+=E+16,a.restore()},f=(p,...w)=>{a.save();const E=typeof p=="string"?p:p[0],R=typeof p=="string"?"#222222":p[1];a.fillStyle=R,a.font="bold 16px sans-serif";const{width:G}=a.measureText(E);a.fillText(E,c.x,c.y),c.x+=G+8,a.restore(),a.save(),a.font="16px sans-serif";for(const T of w){const q=typeof T=="string"?T:T[0],$=typeof T=="string"?"#ff4446":T[1];a.fillStyle=$;const{width:A}=a.measureText(q);a.fillText(q,c.x,c.y),c.x+=A+8}c.x+=8,a.restore()};a.fillStyle="#FBFFF0",a.fillRect(0,0,e.width,e.height),D(8,28),a.textBaseline="bottom",a.font="bold 20px sans-serif",z(s.title),C(40),a.font="bold 18px sans-serif",z("\u653B\u65B9:"),a.font="16px sans-serif",C(30),S(2),f("\u653B\u51FB:",`${l.w}`,[`+${_.g}`,"#55a14f"]),f("\u9B42\u77F3\u653B\u51FB:",`${l.a}`),f("\u9B42\u77F3\u653B\u51FB%:",`${l.c}`),f("\u661F\u4E4B\u6676\u653B\u51FB:",`${l.x}`),C(30),a.font="bold 18px sans-serif",z("\u5B88\u65B9:"),C(30),S(2),f("\u6C14\u8840:",`${h.hp}`),f("\u9632\u5FA1:",`${h.def}`),f("\u9632\u5FA1%:",`${h.defGain}`),f("\u9644\u52A0\u9632\u5FA1:",`${h.defExt}`),C(20),S(2),f("\u514D\u4F24A%:",`${h.ra}`),f("\u514D\u4F24B%:",`${h.rb}`),C(30);for(const p of o){const{satt:w,satt2:E,r01:R,r01c:G,r02:T,r02c:q}=Ko(s,p);a.font="bold 18px sans-serif",z(p.name,"#a30000"),a.font="14px sans-serif",z(p.desc||"\u65E0\u63CF\u8FF0","#a30000"),a.font="16px sans-serif",f("\u514B\u5236:",`${p.kz||0}%`),C(30),S(2),f("\u653B\u51FB%:",`${p.att}`),f("\u7A7F\u900F%:",`${p.id}`),f("\u66B4\u4F24%:",`${p.cd}`),C(20),S(2),f("\u589E\u4F24A%:",`${p.da}`),f("\u589E\u4F24B%:",`${p.db}`),f("\u589E\u4F24X%:",`${p.dx}`),C(30),p.a1>0&&(S(2),f("\u6280\u80FD\u3001\u666E\u653B:",`${p.a1}\u500D`),f("\u653B\u51FB:",[`${ft(w)}`,"#b8860b"]),C(30)),p.a2>0&&(S(2),f("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${p.a2}\u500D`),f("\u653B\u51FB\u4FEE\u6B63%:",p.att2),f("\u9632\u5FA1\u4FEE\u6B63%:",p.defGain),f("\u653B\u51FB:",[`${ft(E)}`,"#b8860b"]),C(20),S(2),f("\u589E\u4F24C%:",p.dc),f("\u589E\u4F24A\u4FEE\u6B63%:",p.da2),f("\u589E\u4F24X\u4FEE\u6B63%:",p.dx2),C(30)),S(2),R>0&&f(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${R}`,"#b8860b"],[`${G}`,"#ff4446"]),T>0&&f(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${T}`,"#b8860b"],[`${q}`,"#ff4446"]),C(20),R>0&&T>0&&(S(2),f(["\u4E0D\u66B4\u51FB","#b8860b"],[`${R+T}`,"#ff4446"]),f(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${G+T}`,"#ff4446"]),f(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${R+q}`,"#ff4446"]),f(["\u5168\u66B4\u51FB","#b8860b"],[`${G+q}`,"#ff4446"]),C(20)),C(20)}e.toBlob(p=>{!p||window.open(URL.createObjectURL(p))})}function Qo(){return{exportImage:Jo}}const Bt=s=>(wt("data-v-2cc2cbb6"),s=s(),kt(),s),Xo={class:"wrapper"},Wo={class:"toolbar"},Zo={style:{padding:"6px 16px"}},Yo=W("\u4F24\u5BB3\u8BA1\u7B97\u5668"),ta={class:"c-upload"},ea=Bt(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),sa={style:{padding:"6px 16px"}},na={class:"input-group"},oa=Bt(()=>t("div",{class:"input-ext"},"=",-1)),aa={class:"content"},ua={class:"container"},la=["value"],ca=W(" \u2007 "),ia=["onKeypress"],da={key:1},ra=["onClick"],pa=["onClick"],_a=["onClick"],fa=W(" \u91CD\u547D\u540D "),va=["onClick"],ha=W(" \u590D\u5236 "),ma=["onClick"],ba=["onClick"],Fa=["onClick"],Ba={style:{"text-align":"center"}},$a=Bt(()=>t("span",null,"\u661F\u8000",-1)),ya=Bt(()=>t("span",null,"\u5316\u81FB",-1)),ga=Bt(()=>t("span",null,"\u661F\u9B42",-1)),Ca=Bt(()=>t("span",null,"\u661F\u8F89",-1)),xa=ct({__name:"Calculator",setup(s){const{exportImage:o}=Qo(),e=it({id:"",title:"",selecteds:[],search:""}),a=X([]),l=I(()=>a.value.filter(B=>B.title.indexOf(e.search)>-1)),h=async()=>{const n={id:Rt(),title:"\u6A21\u677F",basic:Ye(),state:es(),enemyState:os(),items:ns()};await Qe(n),a.value.push(n)},_=async B=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const i=a.value.findIndex(V=>V.id===B);i!==-1&&(await Xe(a.value[i].id),a.value.splice(i,1))},c=async B=>{const n=e.title;if(!n){D();return}const i=a.value.findIndex(b=>b.id===B);if(i===-1)return;const V=a.value[i];V.title=n,D(),await Et(V)},D=()=>{e.id="",e.title=""},S=B=>{try{o(B)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},C=B=>{const n={type:"calculator",data:[B]},i=new Blob([JSON.stringify(n)],{type:"application/json"});Ut(i,`${B.title}.json`)},z=async B=>{a.value=B},f=B=>new Promise((n,i)=>{const V=new FileReader;V.onload=()=>{n(V.result)},V.onerror=()=>{i(V.error)},V.readAsText(B)}),p=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let n=l.value;e.selecteds.length>0&&(n=e.selecteds.map(i=>l.value[i]).filter(i=>i)),await Ze(n.map(i=>i.id)),r()},w=async B=>{const n=B.currentTarget,i=Array.prototype.slice.call(n.files);if(n.value="",!i||!i[0])return;const V=i[0],b=await f(V),U=JSON.parse(b);let st=[];if($e(U))st=U;else if(jt(U)&&U.type==="calculator")st=U.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await We(st),r()},E=async()=>{let B="calculator.json",n=l.value;e.selecteds.length>0&&(n=e.selecteds.map(b=>l.value[b]).filter(b=>b),B="calculator-selected.json");const i={type:"calculator",data:n},V=new Blob([JSON.stringify(i)],{type:"application/json"});Ut(V,B)};async function R(B,n){const i=a.value.findIndex(b=>b.id===n);i===-1||!a.value[i]||(a.value[i]=B,await Et(B))}const G=X(-1),T=it({input:"2283/1.35*1.39",result:0}),{translate:q,xingyao:$,huazhen:A,xinghun:g,xinghui:M}=Be(),Y=B=>Math.ceil(B),at=it({show:!1}),$t=B=>{const n=q(B);rt.value&&rt.value(B.name,n)},rt=X(),H=X(!1),y=X(),et=B=>{H.value=!0,y.value=B},j=({item:B})=>{if(H.value=!1,y.value){const n=y.value,i=q(B);n.title==="\u6A21\u677F"&&(n.title=B.name),n.basic.w=Math.max(i.patt,i.matt),Et(n)}else $t(B)},yt=B=>{const n=Dt.cloneDeep(B);n.id=Rt(),console.log(n),a.value.push(n),Et(n)};async function r(){const B=await Je();e.selecteds=[],z(B)}return me(()=>{r()}),(B,n)=>{const i=_t("c-col"),V=_t("c-row"),b=_t("calc-input"),U=_t("c-space"),st=Lt("autofocus");return d(),v("div",Xo,[t("div",Wo,[t("div",Zo,[m(V,{flex:"",middle:"",gutter:16},{default:F(()=>[m(i,{flex:"0 0 auto"},{default:F(()=>[Yo]),_:1}),m(i,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:n[0]||(n[0]=x=>at.show=!at.show)},"\u9762\u677F"),e.selecteds.length>0?(d(),v("button",{key:0,class:"btn btn-success",onClick:n[1]||(n[1]=x=>e.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):J("",!0)]),_:1}),m(i,{flex:"1 1 0"},{default:F(()=>[O(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":n[2]||(n[2]=x=>e.search=x)},null,512),[[ut,e.search]])]),_:1}),m(i,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-danger",onClick:p},k(e.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",ta,[ea,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:w},null,32)]),t("button",{class:"btn btn-success",onClick:E},k(e.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:n[3]||(n[3]=x=>h())},"\u6DFB\u52A0")]),_:1})]),_:1}),m(Oo,{show:at.show,"onUpdate:show":n[4]||(n[4]=x=>at.show=x),onReference:n[5]||(n[5]=x=>et()),onInit:n[6]||(n[6]=x=>rt.value=x)},null,8,["show"])]),t("div",sa,[t("div",na,[m(b,{modelValue:T.input,"onUpdate:modelValue":n[7]||(n[7]=x=>T.input=x),result:T.result,"onUpdate:result":n[8]||(n[8]=x=>T.result=x),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),oa,m(Fe,{readonly:"",value:Y(T.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",aa,[t("div",ua,[(d(!0),v(P,null,K(u(l),(x,mt)=>(d(),lt(u(Hn),{key:x.id,activeKey:mt===G.value,onToggle:N=>G.value=N?mt:-1},{header:F(()=>[m(V,{flex:"",middle:""},{default:F(()=>[m(i,null,{default:F(()=>[O(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":n[9]||(n[9]=N=>e.selecteds=N),value:mt,onClick:n[10]||(n[10]=vt(()=>{},["stop"]))},null,8,la),[[gt,e.selecteds]]),ca]),_:2},1024),m(i,null,{default:F(()=>[e.id===x.id?O((d(),v("input",{key:0,type:"text",class:"input","onUpdate:modelValue":n[11]||(n[11]=N=>e.title=N),onClick:n[12]||(n[12]=vt(()=>{},["stop"])),onKeypress:Mt(N=>c(x.id),["enter"])},null,40,ia)),[[ut,e.title],[st]]):(d(),v("span",da,k(x.title),1))]),_:2},1024),m(i,{class:"ml-4",onClick:n[13]||(n[13]=vt(()=>{},["stop"]))},{default:F(()=>[e.id===x.id?(d(),v("button",{key:0,class:"btn btn-sm btn-link",onClick:N=>c(x.id)},"\u786E\u8BA4",8,ra)):(d(),v(P,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:N=>et(x)},"\u9009\u62E9",8,pa),t("button",{class:"btn btn-sm btn-link",onClick:N=>{e.id=x.id,e.title=x.title}},[m(u(Oe),{class:"svg-icon"}),fa],8,_a),t("button",{class:"btn btn-sm btn-link",onClick:N=>yt(x)},[m(u(Kt),{class:"svg-icon"}),ha],8,va)],64))]),_:2},1024)]),_:2},1024)]),actions:F(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:N=>S(x)},"\u5BFC\u51FA\u56FE\u50CF",8,ma),t("button",{class:"btn btn-sm btn-success-outline",onClick:N=>C(x)},"\u5BFC\u51FA",8,ba),t("button",{class:"btn btn-sm btn-danger-outline",onClick:N=>_(x.id)},"\u5220\u9664",8,Fa)]),default:F(()=>[mt===G.value?(d(),lt(u(Fn),{key:0,data:x,"onUpdate:data":N=>R(N,x.id)},null,8,["data","onUpdate:data"])):J("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),m(u(Dn),{show:H.value,"onUpdate:show":n[18]||(n[18]=x=>H.value=x),onClick:j},{extra:F(()=>[t("div",Ba,[m(U,null,{default:F(()=>[t("label",null,[$a,O(t("input",{type:"checkbox","onUpdate:modelValue":n[14]||(n[14]=x=>Ct($)?$.value=x:null)},null,512),[[gt,u($)]])]),t("label",null,[ya,O(t("input",{type:"checkbox","onUpdate:modelValue":n[15]||(n[15]=x=>Ct(A)?A.value=x:null)},null,512),[[gt,u(A)]])]),t("label",null,[ga,O(t("input",{type:"checkbox","onUpdate:modelValue":n[16]||(n[16]=x=>Ct(g)?g.value=x:null)},null,512),[[gt,u(g)]])]),t("label",null,[Ca,O(t("input",{type:"checkbox","onUpdate:modelValue":n[17]||(n[17]=x=>Ct(M)?M.value=x:null)},null,512),[[gt,u(M)]])])]),_:1})])]),_:1},8,["show"])])}}});const Ua=tt(xa,[["__scopeId","data-v-2cc2cbb6"]]);export{Ua as default};
