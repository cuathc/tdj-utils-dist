import{_ as Q,E as ue,o as i,c as r,e as t,G as le,H as ie,J as ce,K as de,L as pt,d as dt,q as K,M as qt,N as et,f as C,j as ht,n as Mt,O as re,P as ft,m as rt,a as x,g as p,h,u as a,i as j,w as N,B as it,Q as Dt,S as pe,R as _e,F as H,r as q,z as O,U as gt,V as zt,p as Ct,l as Bt,b as ct,T as Rt,I as ve,x as fe,W as he,k as vt,y as yt,v as Ht,X as mt,Y as me,C as Ft}from"./index.js";import{_ as kt}from"./lodash.js";import{u as be}from"./useHeroes.js";import $e from"./InputNumber.js";import{b as jt,d as St,a as Fe,i as ye}from"./shared.js";import{S as L,a as ge}from"./star-crystals.js";import{s as Lt}from"./data.js";const Ce=["width","height"],Be=t("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),we=[Be];function ke(s,n,o,l,_,$){return i(),r("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},we,8,Ce)}const xe=Q(ue,[["render",ke]]),Ee=["width","height"],De=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),Se=[De];function Ae(s,n,o,l,_,$){return i(),r("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Se,8,Ee)}const Me=Q(le,[["render",Ae]]),Ue=["width","height"],Ve=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Ie=[Ve];function Te(s,n,o,l,_,$){return i(),r("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Ie,8,Ue)}const He=Q(ie,[["render",Te]]),Pe=["width","height"],Ne=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),qe=[Ne];function ze(s,n,o,l,_,$){return i(),r("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},qe,8,Pe)}const Kt=Q(ce,[["render",ze]]),Re=["width","height"],je=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Le=[je];function Ke(s,n,o,l,_,$){return i(),r("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},Le,8,Re)}const Oe=Q(de,[["render",Ke]]);let Et=0,Pt=0;const Ge=500;function Nt(){const s=Math.floor(new Date().getTime()/1e3);Pt===s?Et++:Et=0,Pt=s;const n=s.toString(16);return`${(Ge<<16|Et&255).toString(16)}.${n}`}async function Je(){try{return await pt.getAll("calculator")}catch{return[]}}async function Qe(s){try{await pt.add("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function wt(s){try{await pt.put("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Xe(s){try{await pt.delete("calculator",s)}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function We(s){try{const l=(await pt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const _ of s)await pt.wrap(l.put(_))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ze(s){try{const l=(await pt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const _ of s)await pt.wrap(l.delete(_))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}function Ye(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function ts(){return{a:0}}function es(){return{att:0}}function Ot(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function ss(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function ns(){return[Ot()]}function os(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const as=dt({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(s,{emit:n}){const o=K(),l=K({}),_=K(s.active),$=()=>{const E=o.value.getBoundingClientRect();switch(_.value=!0,n("update:active",_.value),s.dir){case"left":l.value={top:`${E.top+E.height/2}px`,right:`${window.innerWidth-E.left-4}px`,maxWidth:"100%"};break;case"right":l.value={top:`${E.top+E.height/2}px`,left:`${E.right+4}px`,maxWidth:"100%"};break;case"top":l.value={bottom:`${window.innerHeight-E.top-4}px`,left:`${E.left+E.width/2}px`,maxWidth:"100%"};break;default:l.value={top:`${E.bottom+4}px`,left:`${E.left+E.width/2}px`,maxWidth:"100%"}}};let c;const v=()=>{c=window.setTimeout($,s.wait)},w=()=>{clearTimeout(c),_.value=!1,n("update:active",_.value)};return qt(()=>s.active,U=>{_.value=U}),{el:o,style:l,tActive:_,onEnter:v,onOut:w}}});const us={class:"c-tooltip-label"};function ls(s,n,o,l,_,$){return i(),r("div",{ref:"el",class:ht(["c-tooltip",{active:s.tActive,inline:s.inline}]),onMouseenter:n[0]||(n[0]=(...c)=>s.onEnter&&s.onEnter(...c)),onMouseout:n[1]||(n[1]=(...c)=>s.onOut&&s.onOut(...c))},[et(s.$slots,"label",{},()=>[t("div",us,C(s.label),1)]),t("div",{class:ht(["c-tooltip-inner",s.dir?`c-tooltip-${s.dir}`:"c-tooltip-bottom",s.color?`c-tooltip-${s.color}`:""]),style:Mt(s.style)},[et(s.$slots,"default")],6)],34)}const _t=Q(as,[["render",ls]]),is=["onClick"],cs=dt({__name:"dropdown",props:{pos:{default:"lt"}},setup(s){const n=K(!1),o=()=>{n.value=!0},l=()=>{n.value=!1};return window.addEventListener("click",l,!1),re(()=>{window.removeEventListener("click",l,!1)}),(_,$)=>(i(),r("div",{class:ht(["dropdown",[{active:n.value}]]),onClick:ft(o,["stop"])},[et(_.$slots,"default",{},void 0,!0),t("div",{class:ht(["dropdown-popover",["dropdown-"+s.pos]]),onClick:$[0]||($[0]=ft(()=>{},["stop"]))},[et(_.$slots,"popover",{onClose:l},void 0,!0)],2)],10,is))}});const Gt=Q(cs,[["__scopeId","data-v-e27f2ee9"]]);Gt.install=s=>{s.component("dropdown",Jt)};const Jt=Gt,st=s=>(Ct("data-v-3851b4cd"),s=s(),Bt(),s),ds=["onKeypress"],rs=["onKeypress"],ps=st(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),_s=O(" \u514B\u523630%"),vs=st(()=>t("br",null,null,-1)),fs=O("\u88AB\u514B\u5236-25%"),hs=st(()=>t("br",null,null,-1)),ms=O("\u6FC0\u836150% "),bs=["onClick"],$s={class:"row"},Fs={class:"col-item"},ys=st(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),gs=O(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),Cs={class:"input-group"},Bs=["step"],ws=st(()=>t("div",{class:"input-ext"},"\u500D",-1)),ks={class:"label"},xs={class:"input-group"},Es=st(()=>t("div",{style:{clear:"both"}},null,-1)),Ds={class:"col-item"},Ss=st(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),As=O(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),Ms={class:"input-group"},Us=["step"],Vs=st(()=>t("div",{class:"input-ext"},"\u500D",-1)),Is={class:"label"},Ts={class:"input-group"},Hs={class:"col-item"},Ps=st(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Ns={class:"static-control text-center"},qs={class:"darkgold"},zs=st(()=>t("div",{style:{clear:"both"}},null,-1)),Rs={class:"label"},js={class:"bold darkgold"},Ls=st(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),Ks={class:"static-control text-center"},Os={class:"bold darkgold"},Gs={class:"bold red"},Js={class:"label bold"},Qs={class:"static-control text-center"},Xs={class:"bold darkgold"},Ws={key:0,class:"bold red"},Zs=dt({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(s,{emit:n}){const o=s,l=rt({editor:!1,name:"",desc:{f:!1,v:""}}),_=(d,u)=>{if(d==="name")return;const R=o.itemState;switch(d){case"a1":case"a2":case"kz":typeof u=="number"&&(R[d]=u);break;default:typeof u=="string"&&(R[d]=u)}n("update:itemState",R)},$=rt(ss()),c=x({set:d=>_("a1",d),get:()=>o.itemState.a1}),v=x({set:d=>_("a2",d),get:()=>o.itemState.a2}),w=x({set:d=>_("att",d),get:()=>o.itemState.att}),U=x({set:d=>_("id",d),get:()=>o.itemState.id}),E=x({set:d=>_("da",d),get:()=>o.itemState.da}),W=x({set:d=>_("db",d),get:()=>o.itemState.db}),D=x({set:d=>_("dc",d),get:()=>o.itemState.dc}),M=x({set:d=>_("dx",d),get:()=>o.itemState.dx}),V=x({set:d=>_("cd",d),get:()=>o.itemState.cd}),I=x({set:d=>_("att2",d),get:()=>o.itemState.att2}),J=x({set:d=>_("da2",d),get:()=>o.itemState.da2}),z=x({set:d=>_("dx2",d),get:()=>o.itemState.dx2}),ot=x({set:d=>_("defGain",d),get:()=>o.itemState.defGain}),at=x({set:d=>_("kz",d),get:()=>o.itemState.kz||0}),F=rt({a1:c,a2:v,att:w,da:E,db:W,dc:D,dx:M,id:U,cd:V,att2:I,da2:J,dx2:z,defGain:ot,kz:at}),k=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],y=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],B=x(()=>{const{state:d}=o,u=(100+$.att)/100;return Math.ceil(d.att*u)}),Z=x(()=>{const{state:d}=o,u=(100+$.att+$.att2)/100;return Math.ceil(d.att*u)}),Y=()=>{const{enemyState:d}=o,u=(100+F.kz)/100,R=(100+$.da-d.ra)/100,f=(100+$.da+$.da2-d.ra)/100,T=(100+$.db-d.rb)/100,Qt=(100+$.dc)/100,Xt=(100+$.dx)/100,Wt=(100+$.dx+$.dx2)/100,Ut=(100+$.cd)/100,Vt=(100-$.id)/100,Zt=(100+d.defGain)/100,Yt=(100+d.defGain+$.defGain)/100,te=Math.max(0,Math.max(0,d.def*Zt+d.defExt)*Vt),ee=Math.max(0,Math.max(0,d.def*Yt+d.defExt)*Vt),se=Math.max(1,B.value*u-te),ne=Math.max(1,Z.value*u-ee),It=se*F.a1*R*T*Xt,oe=Math.ceil(It*Ut),Tt=ne*F.a2*f*T*Qt*Wt,ae=Math.ceil(Tt*Ut);return{r01:Math.ceil(It),r01c:oe,r02:Math.ceil(Tt),r02c:ae}},nt=x(()=>Y().r01),ut=x(()=>Y().r01c),A=x(()=>Y().r02),m=x(()=>Y().r02c);Y();function tt(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${o.itemState.name}"\u5417\uFF1F`)&&n("close")}function P(){l.editor=!0,l.name=o.itemState.name}function g(){const d=l.name;if(l.editor=!1,l.name="",!d)return;const u=o.itemState;u.name=d,n("update:itemState",u)}function e(){l.desc.f=!0,l.desc.v=o.itemState.desc}function b(){const d=l.desc.v;if(l.desc.f=!1,l.desc.v="",!d)return;const u=o.itemState;u.desc=d,n("update:itemState",u)}function S(){n("up")}function X(){n("down")}function lt(){n("copy")}return(d,u)=>{const R=zt("autofocus");return i(),r(H,null,[p(a(_e),{orientation:"left"},{action:h(()=>[t("span",{onClick:lt},[p(a(Kt),{class:"close"})]),s.showUp?(i(),r("span",{key:0,onClick:S},[p(a(Me),{class:"close"})])):j("",!0),s.showDown?(i(),r("span",{key:1,onClick:X},[p(a(He),{class:"close"})])):j("",!0),t("span",{onClick:tt},[p(a(xe),{class:"close"})])]),default:h(()=>[l.editor?N((i(),r("input",{key:0,class:"input",type:"text","onUpdate:modelValue":u[0]||(u[0]=f=>l.name=f),onKeypress:Dt(g,["enter"]),onBlur:g},null,40,ds)),[[it,l.name],[R]]):(i(),r("span",{key:1,class:"calc-item-title",onClick:P},C(s.itemState.name||"\u6A21\u677F"),1)),l.desc.f?N((i(),r("input",{key:2,class:"input",type:"text","onUpdate:modelValue":u[1]||(u[1]=f=>l.desc.v=f),onKeypress:Dt(b,["enter"]),onBlur:b},null,40,rs)),[[it,l.desc.v],[R]]):(i(),r("span",{key:3,class:"calc-item-desc",onClick:e},C(s.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),p(a(pe),{style:{width:"120px"}},{default:h(()=>[p(a(_t),{dir:"top"},{label:h(()=>[ps]),default:h(()=>[_s,vs,fs,hs,ms]),_:1}),t("div",null,[p(a(Jt),null,{popover:h(({onClose:f})=>[t("div",{class:"list",onClick:T=>f()},[t("div",{class:"list-item",onClick:u[3]||(u[3]=T=>F.kz=0)},"\u666E\u901A"),t("div",{class:"list-item",onClick:u[4]||(u[4]=T=>F.kz=30)},"\u514B\u5236"),t("div",{class:"list-item",onClick:u[5]||(u[5]=T=>F.kz=-25)},"\u88AB\u514B\u5236"),t("div",{class:"list-item",onClick:u[6]||(u[6]=T=>F.kz=50)},"\u6FC0\u8361")],8,bs)]),default:h(()=>[N(t("input",{class:"input",type:"number","onUpdate:modelValue":u[2]||(u[2]=f=>F.kz=f)},null,512),[[it,F.kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",$s,[t("div",Fs,[p(a(_t),{dir:"top"},{label:h(()=>[ys]),default:h(()=>[gs]),_:1}),t("div",Cs,[N(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":u[7]||(u[7]=f=>F.a1=f)},null,8,Bs),[[it,F.a1,void 0,{number:!0}]]),ws])]),(i(),r(H,null,q(k,f=>t("div",{class:"col-item",key:f.name},[p(a(_t),{dir:"top"},{label:h(()=>[t("div",ks,C(f.label),1)]),default:h(()=>[O(" "+C(f.tip),1)]),_:2},1024),t("div",xs,[p(a(gt),{class:"input",modelValue:F[f.name],"onUpdate:modelValue":T=>F[f.name]=T,result:$[f.name],"onUpdate:result":T=>$[f.name]=T},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),Es,t("div",Ds,[p(a(_t),{dir:"top"},{label:h(()=>[Ss]),default:h(()=>[As]),_:1}),t("div",Ms,[N(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":u[8]||(u[8]=f=>F.a2=f)},null,8,Us),[[it,F.a2,void 0,{number:!0}]]),Vs])]),(i(),r(H,null,q(y,f=>t("div",{class:"col-item",key:f.name},[p(a(_t),{dir:"top"},{label:h(()=>[t("div",Is,C(f.label),1)]),default:h(()=>[O(" "+C(f.tip),1)]),_:2},1024),t("div",Ts,[p(a(gt),{class:"input",modelValue:F[f.name],"onUpdate:modelValue":T=>F[f.name]=T,result:$[f.name],"onUpdate:result":T=>$[f.name]=T},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Hs,[Ps,t("div",Ns,[t("span",qs,C(a(B)),1)])]),zs,(i(!0),r(H,null,q([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:a(nt),v2:a(ut)},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:a(A),v2:a(m)}],(f,T)=>(i(),r("div",{class:"col-item",key:T},[t("div",Rs,[t("span",js,C(f.label),1),Ls]),t("div",Ks,[t("span",Os,C(f.v),1),t("span",Gs,"("+C(f.v2)+")",1)])]))),128)),(i(!0),r(H,null,q([{label:"\u4E0D\u66B4\u51FB",value:a(nt)+a(A)},{label:"\u4E00\u6BB5\u66B4\u51FB",value:a(ut)+a(A)},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:a(nt)+a(m)},{label:"\u5168\u66B4\u51FB",value:a(ut)+a(m)}],(f,T)=>(i(),r("div",{class:"col-item",key:T},[t("div",Js,C(f.label),1),t("div",Qs,[t("span",Xs,C(f.value),1),(+s.enemyState.hp||0)<=f.value?(i(),r("span",Ws," \u51FB\u6740 ")):j("",!0)])]))),128))])],64)}}});const Ys=Q(Zs,[["__scopeId","data-v-3851b4cd"]]),xt=s=>(Ct("data-v-484711fe"),s=s(),Bt(),s),tn=xt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),en={class:"row"},sn={class:"label"},nn={class:"input-group"},on=["step","onUpdate:modelValue","onChange"],an=["value"],un={class:"col-item"},ln=xt(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),cn={class:"static-control text-center"},dn={class:"darkgold"},rn=xt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),pn={class:"row"},_n={class:"label"},vn={key:1,class:"label"},fn={class:"input-group"},hn={key:0,class:"input-ext"},mn=xt(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),bn=dt({__name:"Calculator",props:{data:null},emits:["update:data"],setup(s,{emit:n}){const o=s,l=x(()=>o.data.basic),_=x(()=>o.data.state),$=x(()=>o.data.enemyState),c=x(()=>o.data.items),v=rt(ts()),w=rt({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),U=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],E=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],W=()=>{const F=l.value.c/100;l.value.g=Math.ceil(v.a+l.value.w*F+l.value.x),_.value.att=l.value.w+l.value.g},D=async()=>{n("update:data",o.data)},M=(F,k)=>{k==="panel"&&W(),D()},V=(F,k)=>{const y=o.data.items;!y||(y[k]=F,D())},I=()=>{const F=o.data.items;!F||(F.push(Ot()),D())},J=F=>{const k=o.data.items;!k||(k.splice(F,1),D())},z=F=>{const k=o.data.items;if(!k)return;const y=k[F],B=k[F-1];k[F-1]=y,k[F]=B,D()},ot=F=>{const k=o.data.items;if(!k)return;const y=k[F],B=k[F+1];k[F+1]=y,k[F]=B,D()},at=F=>{const k=o.data.items;if(!k)return;const y=k[F];k.push(kt.cloneDeep(y)),D()};return qt(()=>[o.data.basic.w],()=>{W()}),(F,k)=>(i(),r("div",null,[tn,t("div",en,[(i(),r(H,null,q(U,y=>t("div",{class:"col-item",key:y.name},[t("div",sn,C(y.label),1),t("div",nn,[y.name in v?(i(),ct(a(gt),{key:0,modelValue:a(l)[y.name],"onUpdate:modelValue":B=>a(l)[y.name]=B,result:v[y.name],"onUpdate:result":B=>v[y.name]=B,onChange:B=>M(y.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):N((i(),r("input",{key:1,type:"number",class:"input",style:Mt({textAlign:y.align}),min:"0",step:y.step,"onUpdate:modelValue":B=>a(l)[y.name]=B,onChange:B=>M(y.name,"panel")},null,44,on)),[[it,a(l)[y.name],void 0,{number:!0}]]),y.name==="w"?(i(),r("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${a(l).g}`},null,8,an)):j("",!0)])])),64)),t("div",un,[ln,t("div",cn,[t("span",dn,C(a(_).att),1)])])]),rn,t("div",pn,[(i(),r(H,null,q(E,y=>t("div",{class:"col-item",key:y.name},[y.tips?(i(),ct(a(_t),{key:0,dir:"top"},{label:h(()=>[t("div",_n,C(y.label),1)]),default:h(()=>[O(" "+C(y.tips),1)]),_:2},1024)):(i(),r("div",vn,C(y.label),1)),t("div",fn,[p(a(gt),{modelValue:a($)[y.name],"onUpdate:modelValue":B=>a($)[y.name]=B,result:w[y.name],"onUpdate:result":B=>w[y.name]=B,onChange:B=>M(y.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),y.precent?(i(),r("div",hn,"%")):j("",!0)])])),64))]),t("div",{class:"heading"},[mn,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:I},"\u6DFB\u52A0")])]),(i(!0),r(H,null,q(a(c),(y,B)=>(i(),ct(Ys,{key:y,panel:a(l),state:a(_),enemyState:w,itemState:y,showUp:B>0,showDown:a(c)&&B<a(c).length-1,"onUpdate:itemState":Z=>V(Z,B),onClose:Z=>J(B),onUp:Z=>z(B),onDown:Z=>ot(B),onCopy:Z=>at(B)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const $n=Q(bn,[["__scopeId","data-v-484711fe"]]),Fn=dt({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(s,{emit:n}){return{wrapClass:x(()=>["c-action-sheet-wrapper",s.class,{show:s.show}]),onClick:($,c)=>{n("click",{item:$,index:c}),n("close",!1)},onClose:()=>{n("update:show",!1),n("close",!1)}}}});const yn={class:"c-action-sheet-section"},gn={class:"c-action-sheet-extra"},Cn={class:"c-action-sheet-list"},Bn=["onClick"];function wn(s,n,o,l,_,$){return i(),ct(Rt,{to:"body"},[t("div",{class:ht(s.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:n[0]||(n[0]=(...c)=>s.onClose&&s.onClose(...c))}),t("div",yn,[t("div",{class:"c-action-sheet-body",style:Mt({maxHeight:s.height})},[t("div",gn,[et(s.$slots,"extra")]),t("div",Cn,[(i(!0),r(H,null,q(s.list,(c,v)=>(i(),r("div",{class:"c-action-sheet-item",key:v,onClick:w=>s.onClick(c,v)},[et(s.$slots,"default",{record:c})],8,Bn))),128))])],4)])],2)])}const At=Q(Fn,[["render",wn]]);At.install=s=>{s.component("action-sheet",At)};const kn={class:"hero-item"},xn=["src","alt","title"],En={class:"hero-item-label"},Dn=dt({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(s,{emit:n}){const{heroes:o,getHeroIcon:l}=be(),_=$=>{n("click",$)};return($,c)=>(i(),ct(a(At),{class:"hero-select",show:s.show,list:a(o),height:"80vh",onClick:_,"onUpdate:show":c[0]||(c[0]=v=>$.$emit("update:show",v))},{extra:h(()=>[et($.$slots,"extra")]),default:h(({record:v})=>[t("div",kn,[t("img",{src:a(l)(v),alt:v.name,title:v.name,width:"128",height:"128"},null,8,xn),t("div",En,C(v.name),1)])]),_:3},8,["show","list"]))}});const Sn=dt({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(s,{emit:n}){const o=x({get:()=>s.activeKey,set:_=>{n("update:activeKey",_)}});return{active:o,toggle:()=>{const _=!o.value;o.value=_,n("toggle",_)}}}});const An=s=>(Ct("data-v-829ec263"),s=s(),Bt(),s),Mn=An(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Un={class:"panel-title"},Vn={class:"panel-body"},In={class:"panel-content"};function Tn(s,n,o,l,_,$){return i(),r("div",{class:ht(["panel",{active:s.active}])},[t("div",{class:"panel-header",onClick:n[1]||(n[1]=(...c)=>s.toggle&&s.toggle(...c))},[Mn,t("div",Un,[et(s.$slots,"header",{},()=>[O(C(s.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:n[0]||(n[0]=ft(()=>{},["stop"]))},[et(s.$slots,"actions",{},void 0,!0)])]),t("div",Vn,[t("div",In,[et(s.$slots,"default",{},void 0,!0)])])],2)}const Hn=Q(Sn,[["render",Tn],["__scopeId","data-v-829ec263"]]);function Pn(){const s="red_team",n=ve(),o=K([]),l=K(!1),_=K(),$=async D=>{const V=(await n.transaction(s,"readwrite")).objectStore(s),I=await n.wrap(V.put(D));return o.value.find(z=>z._id===D._id)||(D._id=I,o.value.push(D)),I},c=async D=>{const V=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(V.delete(D._id)),o.value=o.value.filter(I=>I._id!==D._id)},v=async D=>{const M=await n.transaction(s,"readwrite"),V=M.objectStore(s);for(const I of D)await n.wrap(V.put(I));await n.twrap(M),await U()},w=async()=>{const M=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(M.clear()),o.value=[]},U=async()=>{const M=(await n.transaction(s,"readonly")).objectStore(s),V=await n.wrap(M.getAll()).catch(()=>[]);V.forEach(I=>{I.scList||(I.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:L.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:L.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:L.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:L.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:L.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:L.DEF}])}),o.value=V},E=async D=>{const M=JSON.parse(await D.text());if(!jt(M)||M.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const V=M.data;V.forEach(I=>delete I._id),await v(V)},W=async()=>{const D={type:"red_team",data:o.value},M=new Blob([JSON.stringify(D)],{type:"application/json"});St(M,"red_team.json")};return U(),{scShow:l,scSelected:_,put:$,del:c,puts:v,clear:w,all:U,list:o,importData:E,exportData:W}}const bt=s=>s%1>.5?Math.ceil(s):Math.floor(s);function Nn(){const s=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:L.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:L.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:L.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:L.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:L.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:L.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),n=K(s()),o=x(()=>{const c=[0,0,0,0,0,0];return n.value.scList.forEach(v=>{!v.v||(c[0]+=v.v.qixue,c[1]+=v.v.patt,c[2]+=v.v.pdef,c[3]+=v.v.matt,c[4]+=v.v.mdef,c[5]+=v.v.huixin)}),c}),l=x(()=>{const c=n.value,v={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},w=Lt.find(W=>c.stoneName===W.name);w&&(v.qixue=w.t[0]+w.d[0]+w.h[0],v.patt=w.t[1]+w.d[1]+w.h[1],v.matt=w.t[2]+w.d[2]+w.h[2],v.pdef=w.t[3]+w.d[3]+w.h[3],v.mdef=w.t[4]+w.d[4]+w.h[4]);const U={qixue:c.hsQixue/100,patt:c.hsPatt/100,pdef:c.hsPdef/100,matt:c.hsMatt/100,mdef:c.hsMdef/100,huixin:c.hsHuixin/100},E=o.value;return{qixue:bt(c.qixue*U.qixue+v.qixue+E[0]),patt:bt(c.patt*U.patt+v.patt+E[1]),pdef:bt(c.pdef*U.pdef+v.pdef+E[2]),matt:bt(c.matt*U.matt+v.matt+E[3]),mdef:bt(c.mdef*U.mdef+v.mdef+E[4]),huixin:bt(c.huixin*U.huixin+v.huixin+E[5])}}),_=x(()=>{const c=l.value,v={qixue:(100+n.value.rQixue)/100,patt:(100+n.value.rPatt)/100,pdef:(100+n.value.rPdef)/100,matt:(100+n.value.rMatt)/100,mdef:(100+n.value.rMdef)/100,huixin:(100+n.value.rHuixin)/100};return{qixue:Math.round((n.value.qixue+c.qixue)*v.qixue),patt:Math.round((n.value.patt+c.patt)*v.patt),pdef:Math.round((n.value.pdef+c.pdef)*v.pdef),matt:Math.round((n.value.matt+c.matt)*v.matt),mdef:Math.round((n.value.mdef+c.mdef)*v.mdef),huixin:Math.round((n.value.huixin+c.huixin)*v.huixin)}});return{state:n,pValue:l,ckValue:_,scSum:o,reset:()=>{n.value=s()},defState:s}}const qn={},zn={class:"c-upload"};function Rn(s,n){return i(),r("div",zn,[et(s.$slots,"default",{},void 0,!0),t("input",fe({type:"file",class:"c-upload-input",accept:"application/json"},s.$attrs),null,16)])}const jn=Q(qn,[["render",Rn],["__scopeId","data-v-b3879154"]]),G=s=>(Ct("data-v-fc55a9ed"),s=s(),Bt(),s),Ln={class:"transform-tools-popover"},Kn={class:"transform-tools-popover-toolbar"},On=["value"],Gn=["value"],Jn=G(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Qn={class:"transform-tools-popover-content"},Xn={class:"grid-group"},Wn={class:"grid-group-item"},Zn={class:"input-group-title"},Yn=G(()=>t("span",null,"\u57FA\u7840",-1)),to={class:"grids"},eo={class:"input-label"},so={class:"input-group"},no={class:"input green"},oo={class:"grid-group-item"},ao={class:"input-group-title"},uo=G(()=>t("span",null,"\u9B42\u77F3",-1)),lo=G(()=>t("option",{value:""},"\u65E0",-1)),io=["value"],co={class:"grids"},ro=G(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),po=G(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),_o=G(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),vo=G(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),fo=G(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),ho={class:"grid-group-item"},mo={class:"input-group-title"},bo=O(" \u661F\u4E4B\u6676 "),$o=G(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),Fo=G(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),yo=G(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),go={class:"grids"},Co=["onClick","onContextmenu"],Bo={key:0},wo={key:1},ko={key:2},xo={key:3},Eo={key:4},Do={key:5},So={key:1},Ao={class:"grid-group-item"},Mo=G(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),Uo={class:"grids"},Vo={class:"input-label"},Io={class:"input"},To={class:"grid-group-item"},Ho=G(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Po={class:"grids"},No={class:"input-label"},qo={class:"grid-group-item"},zo=G(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Ro={class:"grids"},jo={class:"input-label"},Lo={class:"input"},Ko=dt({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(s,{emit:n}){const{state:o,pValue:l,ckValue:_,scSum:$,reset:c,defState:v}=Nn(),{list:w,put:U,del:E,clear:W,importData:D,exportData:M}=Pn(),V=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],I=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],J=K(!1),z=K(),ot=A=>{z.value=A,J.value=!0},at=A=>{!z.value||(z.value.v=A)},F=()=>{const A=kt.cloneDeep(o.value);U(A).then(m=>{o.value._id=m,alert("\u5DF2\u4FDD\u5B58")}).catch(m=>{console.log(m),alert("\u4FDD\u5B58\u5931\u8D25")})},k=()=>{const A=kt.cloneDeep(o.value);delete A._id,A.name+=" copy",U(A).then(m=>{A._id=m,o.value=A}).catch(m=>{console.log(m),alert("\u590D\u5236\u5931\u8D25")})},y=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||E(o.value).then(()=>{c()}).catch(m=>{console.log(m),alert("\u5220\u9664\u5931\u8D25")})},B=A=>{const m=A.currentTarget;if(!m.files)return;const tt=Array.prototype.slice.call(m.files);m.value="",tt[0]&&D(tt[0])},Z=()=>{M()},Y=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||W().catch(m=>{console.log(m),alert("\u6E05\u7A7A\u5931\u8D25")})},nt=(A,m)=>{o.value.name=A,o.value.qixue=m.qixue,o.value.patt=m.patt,o.value.pdef=m.pdef,o.value.matt=m.matt,o.value.mdef=m.mdef,o.value.huixin=m.huixin},ut=()=>{n("reference")};return n("init",nt),(A,m)=>{const tt=vt("c-col"),P=vt("c-space"),g=vt("c-row");return N((i(),r("div",Ln,[t("div",Kn,[p(g,{flex:"",middle:"",gutter:8},{default:h(()=>[p(tt,null,{default:h(()=>[t("button",{class:"btn btn-sm btn-link",onClick:ut},"\u53C2\u8003")]),_:1}),p(tt,null,{default:h(()=>[O("ID: "+C(a(o)._id),1)]),_:1}),p(tt,{flex:"1 1 auto"},{default:h(()=>[p(P,null,{default:h(()=>[N(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":m[0]||(m[0]=e=>yt(o)?o.value=e:null)},[t("option",{value:a(v)()},"\u7A7A\u6A21\u7248",8,On),(i(!0),r(H,null,q(a(w),e=>(i(),r("option",{key:e._id,value:e},C(e.name),9,Gn))),128))],512),[[Ht,a(o)]]),t("button",{class:"btn btn-sm btn-primary",onClick:F},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:k},"\u590D\u5236"),a(o)._id?(i(),r("button",{key:0,class:"btn btn-sm btn-danger",onClick:y},"\u5220\u9664")):j("",!0),p(jn,{onChange:B},{default:h(()=>[Jn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:Z},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:Y},"\u6E05\u7A7A")]),_:1})]),_:1}),p(tt,null,{default:h(()=>[t("span",{class:"transform-tools-popover-close",onClick:m[1]||(m[1]=e=>n("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Qn,[t("div",Xn,[t("div",Wn,[t("div",Zn,[p(P,null,{default:h(()=>[Yn,N(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":m[2]||(m[2]=e=>a(o).name=e)},null,512),[[it,a(o).name]])]),_:1})]),t("div",to,[(i(),r(H,null,q(V,e=>p(P,{key:e.n},{default:h(()=>[t("label",eo,C(e.t),1),t("div",so,[p(a(mt),{readonly:"",value:a(o)[e.n]},null,8,["value"]),t("div",no,"+"+C(a(l)[e.n]),1)])]),_:2},1024)),64))])]),t("div",oo,[t("div",ao,[p(P,null,{default:h(()=>[uo,N(t("select",{class:"input input-select","onUpdate:modelValue":m[3]||(m[3]=e=>a(o).stoneName=e)},[lo,(i(!0),r(H,null,q(a(Lt),(e,b)=>(i(),r("option",{key:b,value:e.name},C(e.name),9,io))),128))],512),[[Ht,a(o).stoneName]])]),_:1})]),t("div",co,[p(P,null,{default:h(()=>[ro,p(a(mt),{value:a(o).hsQixue,"onUpdate:value":m[4]||(m[4]=e=>a(o).hsQixue=e)},null,8,["value"])]),_:1}),p(P,null,{default:h(()=>[po,p(a(mt),{value:a(o).hsPatt,"onUpdate:value":m[5]||(m[5]=e=>a(o).hsPatt=e)},null,8,["value"])]),_:1}),p(P,null,{default:h(()=>[_o,p(a(mt),{value:a(o).hsPdef,"onUpdate:value":m[6]||(m[6]=e=>a(o).hsPdef=e)},null,8,["value"])]),_:1}),p(P,null,{default:h(()=>[vo,p(a(mt),{value:a(o).hsMatt,"onUpdate:value":m[7]||(m[7]=e=>a(o).hsMatt=e)},null,8,["value"])]),_:1}),p(P,null,{default:h(()=>[fo,p(a(mt),{value:a(o).hsMdef,"onUpdate:value":m[8]||(m[8]=e=>a(o).hsMdef=e)},null,8,["value"])]),_:1})])]),t("div",ho,[t("div",mo,[bo,p(a(_t),{label:"?",inline:"",dir:"right"},{default:h(()=>[$o,Fo,yo]),_:1})]),t("div",go,[(i(!0),r(H,null,q(a(o).scList,(e,b)=>(i(),r("div",{key:b,class:ht(["sc-props",{selected:z.value===e,s1:a(L).ATT===e.pos,s2:a(L).XUE===e.pos,s3:a(L).DEF===e.pos}]),onClick:S=>ot(e),onContextmenu:ft(S=>e.v=void 0,["prevent"])},[e.v?(i(),r(H,{key:0},[e.v.qixue>0?(i(),r("span",Bo,"\u6C14\u8840+"+C(e.v.qixue),1)):j("",!0),e.v.patt>0?(i(),r("span",wo,"\u7269\u653B+"+C(e.v.patt),1)):j("",!0),e.v.pdef>0?(i(),r("span",ko,"\u7269\u9632+"+C(e.v.pdef),1)):j("",!0),e.v.matt>0?(i(),r("span",xo,"\u6CD5\u653B+"+C(e.v.matt),1)):j("",!0),e.v.mdef>0?(i(),r("span",Eo,"\u6CD5\u9632+"+C(e.v.mdef),1)):j("",!0),e.v.huixin>0?(i(),r("span",Do,"\u4F1A\u5FC3+"+C(e.v.huixin),1)):j("",!0)],64)):(i(),r("span",So,C(e.n),1))],42,Co))),128))]),(i(),ct(Rt,{to:"body"},[z.value?(i(),ct(a(ge),{key:0,show:J.value,"onUpdate:show":m[9]||(m[9]=e=>J.value=e),position:z.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:at},null,8,["show","position"])):j("",!0)]))]),t("div",Ao,[Mo,t("div",Uo,[(i(),r(H,null,q(V,(e,b)=>p(P,{key:b},{default:h(()=>[t("label",Vo,C(e.t),1),t("div",Io,"+"+C(a($)[b]),1)]),_:2},1024)),64))])]),t("div",To,[Ho,t("div",Po,[(i(),r(H,null,q(I,(e,b)=>p(P,{key:b},{default:h(()=>[t("label",No,C(e.t),1),p(a(gt),{modelValue:a(o)[e.c],"onUpdate:modelValue":S=>a(o)[e.c]=S,result:a(o)[e.r],"onUpdate:result":S=>a(o)[e.r]=S},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",qo,[zo,t("div",Ro,[(i(),r(H,null,q(V,e=>p(P,{key:e.n},{default:h(()=>[t("label",jo,C(e.t),1),t("div",Lo,C(a(_)[e.n]),1)]),_:2},1024)),64))])])])])],512)),[[he,s.show]])}}});const Oo=Q(Ko,[["__scopeId","data-v-fc55a9ed"]]),$t=s=>(Ct("data-v-b1ef64a4"),s=s(),Bt(),s),Go={class:"wrapper"},Jo={class:"toolbar"},Qo={style:{padding:"6px 16px"}},Xo=O("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Wo={class:"c-upload"},Zo=$t(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Yo={style:{padding:"6px 16px"}},ta={class:"input-group"},ea=$t(()=>t("div",{class:"input-ext"},"=",-1)),sa={class:"content"},na={class:"container"},oa=["value"],aa=O(" \u2007 "),ua=["onKeypress"],la={key:1},ia=["onClick"],ca=["onClick"],da=["onClick"],ra=O(" \u91CD\u547D\u540D "),pa=["onClick"],_a=O(" \u590D\u5236 "),va=["onClick"],fa=["onClick"],ha={style:{"text-align":"center"}},ma=$t(()=>t("span",null,"\u661F\u8000",-1)),ba=$t(()=>t("span",null,"\u5316\u81FB",-1)),$a=$t(()=>t("span",null,"\u661F\u9B42",-1)),Fa=$t(()=>t("span",null,"\u661F\u8F89",-1)),ya=dt({__name:"Calculator",setup(s){const n=rt({id:"",title:"",selecteds:[],search:""}),o=K([]),l=x(()=>o.value.filter(g=>g.title.indexOf(n.search)>-1)),_=async()=>{const e={id:Nt(),title:"\u6A21\u677F",basic:Ye(),state:es(),enemyState:os(),items:ns()};await Qe(e),o.value.push(e)},$=async g=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const b=o.value.findIndex(S=>S.id===g);b!==-1&&(await Xe(o.value[b].id),o.value.splice(b,1))},c=async g=>{const e=n.title;if(!e){v();return}const b=o.value.findIndex(X=>X.id===g);if(b===-1)return;const S=o.value[b];S.title=e,v(),await wt(S)},v=()=>{n.id="",n.title=""},w=g=>{const e={type:"calculator",data:[g]},b=new Blob([JSON.stringify(e)],{type:"application/json"});St(b,`${g.title}.json`)},U=async g=>{o.value=g},E=g=>new Promise((e,b)=>{const S=new FileReader;S.onload=()=>{e(S.result)},S.onerror=()=>{b(S.error)},S.readAsText(g)}),W=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let e=l.value;n.selecteds.length>0&&(e=n.selecteds.map(b=>l.value[b]).filter(b=>b)),await Ze(e.map(b=>b.id)),P()},D=async g=>{const e=g.currentTarget,b=Array.prototype.slice.call(e.files);if(e.value="",!b||!b[0])return;const S=b[0],X=await E(S),lt=JSON.parse(X);let d=[];if(ye(lt))d=lt;else if(jt(lt)&&lt.type==="calculator")d=lt.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await We(d),P()},M=async()=>{let g="calculator.json",e=l.value;n.selecteds.length>0&&(e=n.selecteds.map(X=>l.value[X]).filter(X=>X),g="calculator-selected.json");const b={type:"calculator",data:e},S=new Blob([JSON.stringify(b)],{type:"application/json"});St(S,g)};async function V(g,e){const b=o.value.findIndex(X=>X.id===e);b===-1||!o.value[b]||(o.value[b]=g,await wt(g))}const I=K(-1),J=rt({input:"2283/1.35*1.39",result:0}),{translate:z,xingyao:ot,huazhen:at,xinghun:F,xinghui:k}=Fe(),y=g=>Math.ceil(g),B=rt({show:!1}),Z=g=>{const e=z(g);Y.value&&Y.value(g.name,e)},Y=K(),nt=K(!1),ut=K(),A=g=>{nt.value=!0,ut.value=g},m=({item:g})=>{if(nt.value=!1,ut.value){const e=ut.value,b=z(g);e.title==="\u6A21\u677F"&&(e.title=g.name),e.basic.w=Math.max(b.patt,b.matt),wt(e)}else Z(g)},tt=g=>{const e=kt.cloneDeep(g);e.id=Nt(),console.log(e),o.value.push(e),wt(e)};async function P(){const g=await Je();n.selecteds=[],U(g)}return me(()=>{P()}),(g,e)=>{const b=vt("c-col"),S=vt("c-row"),X=vt("calc-input"),lt=vt("c-space"),d=zt("autofocus");return i(),r("div",Go,[t("div",Jo,[t("div",Qo,[p(S,{flex:"",middle:"",gutter:16},{default:h(()=>[p(b,{flex:"0 0 auto"},{default:h(()=>[Xo]),_:1}),p(b,{flex:"0 0 auto"},{default:h(()=>[t("button",{class:"btn btn-sm btn-link",onClick:e[0]||(e[0]=u=>B.show=!B.show)},"\u9762\u677F"),n.selecteds.length>0?(i(),r("button",{key:0,class:"btn btn-success",onClick:e[1]||(e[1]=u=>n.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):j("",!0)]),_:1}),p(b,{flex:"1 1 0"},{default:h(()=>[N(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":e[2]||(e[2]=u=>n.search=u)},null,512),[[it,n.search]])]),_:1}),p(b,{flex:"0 0 auto"},{default:h(()=>[t("button",{class:"btn btn-danger",onClick:W},C(n.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Wo,[Zo,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:D},null,32)]),t("button",{class:"btn btn-success",onClick:M},C(n.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=u=>_())},"\u6DFB\u52A0")]),_:1})]),_:1}),p(Oo,{show:B.show,"onUpdate:show":e[4]||(e[4]=u=>B.show=u),onReference:e[5]||(e[5]=u=>A()),onInit:e[6]||(e[6]=u=>Y.value=u)},null,8,["show"])]),t("div",Yo,[t("div",ta,[p(X,{modelValue:J.input,"onUpdate:modelValue":e[7]||(e[7]=u=>J.input=u),result:J.result,"onUpdate:result":e[8]||(e[8]=u=>J.result=u),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),ea,p($e,{readonly:"",value:y(J.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",sa,[t("div",na,[(i(!0),r(H,null,q(a(l),(u,R)=>(i(),ct(a(Hn),{key:u.id,activeKey:R===I.value,onToggle:f=>I.value=f?R:-1},{header:h(()=>[p(S,{flex:"",middle:""},{default:h(()=>[p(b,null,{default:h(()=>[N(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=f=>n.selecteds=f),value:R,onClick:e[10]||(e[10]=ft(()=>{},["stop"]))},null,8,oa),[[Ft,n.selecteds]]),aa]),_:2},1024),p(b,null,{default:h(()=>[n.id===u.id?N((i(),r("input",{key:0,type:"text",class:"input","onUpdate:modelValue":e[11]||(e[11]=f=>n.title=f),onClick:e[12]||(e[12]=ft(()=>{},["stop"])),onKeypress:Dt(f=>c(u.id),["enter"])},null,40,ua)),[[it,n.title],[d]]):(i(),r("span",la,C(u.title),1))]),_:2},1024),p(b,{class:"ml-4",onClick:e[13]||(e[13]=ft(()=>{},["stop"]))},{default:h(()=>[n.id===u.id?(i(),r("button",{key:0,class:"btn btn-sm btn-link",onClick:f=>c(u.id)},"\u786E\u8BA4",8,ia)):(i(),r(H,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:f=>A(u)},"\u9009\u62E9",8,ca),t("button",{class:"btn btn-sm btn-link",onClick:f=>{n.id=u.id,n.title=u.title}},[p(a(Oe),{class:"svg-icon"}),ra],8,da),t("button",{class:"btn btn-sm btn-link",onClick:f=>tt(u)},[p(a(Kt),{class:"svg-icon"}),_a],8,pa)],64))]),_:2},1024)]),_:2},1024)]),actions:h(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:f=>w(u)},"\u5BFC\u51FA",8,va),t("button",{class:"btn btn-sm btn-danger-outline",onClick:f=>$(u.id)},"\u5220\u9664",8,fa)]),default:h(()=>[R===I.value?(i(),ct(a($n),{key:0,data:u,"onUpdate:data":f=>V(f,u.id)},null,8,["data","onUpdate:data"])):j("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),p(a(Dn),{show:nt.value,"onUpdate:show":e[18]||(e[18]=u=>nt.value=u),onClick:m},{extra:h(()=>[t("div",ha,[p(lt,null,{default:h(()=>[t("label",null,[ma,N(t("input",{type:"checkbox","onUpdate:modelValue":e[14]||(e[14]=u=>yt(ot)?ot.value=u:null)},null,512),[[Ft,a(ot)]])]),t("label",null,[ba,N(t("input",{type:"checkbox","onUpdate:modelValue":e[15]||(e[15]=u=>yt(at)?at.value=u:null)},null,512),[[Ft,a(at)]])]),t("label",null,[$a,N(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=u=>yt(F)?F.value=u:null)},null,512),[[Ft,a(F)]])]),t("label",null,[Fa,N(t("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=u=>yt(k)?k.value=u:null)},null,512),[[Ft,a(k)]])])]),_:1})])]),_:1},8,["show"])])}}});const Da=Q(ya,[["__scopeId","data-v-b1ef64a4"]]);export{Da as default};
