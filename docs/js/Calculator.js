import{_ as et,J as Wt,o as r,c as v,f as t,K as Zt,L as Yt,M as te,N as ct,d as mt,r as W,O as qt,H as bt,g as w,P as Et,G as Tt,b as ht,t as ee,a as tt,e as f,w as m,u as a,k as Q,Q as se,h as z,z as ut,R as Ut,S as ne,F as I,j as J,U as ue,x as Z,V as yt,W as Gt,p as Dt,m as jt,D as ot,T as Nt,I as oe,n as ae,X as le,l as ft,q as xt,v as Ht,A as pt,E as wt,Y as G,Z as ce,i as $t}from"./index.js";import{D as zt,u as ie}from"./useHeroes.js";import{_ as kt}from"./lodash.js";import{C as de}from"./CollapsePanel.js";import St from"./InputNumber.js";import{b as Lt,d as Vt,a as re,i as pe}from"./shared.js";import{S as X,a as _e}from"./star-crystals.js";import{s as Ot}from"./data.js";const fe=["width","height"],ve=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),he=[ve];function me(n,u,s,o,l,x){return r(),v("svg",{width:n.width,height:n.height,viewBox:"0 0 32 32"},he,8,fe)}const Fe=et(Wt,[["render",me]]),Be=["width","height"],be=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),$e=[be];function xe(n,u,s,o,l,x){return r(),v("svg",{width:n.width,height:n.height,viewBox:"0 0 32 32"},$e,8,Be)}const ye=et(Zt,[["render",xe]]),Ce=["width","height"],ge=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),we=[ge];function Ee(n,u,s,o,l,x){return r(),v("svg",{width:n.width,height:n.height,viewBox:"0 0 24 24"},we,8,Ce)}const Kt=et(Yt,[["render",Ee]]),ke=["width","height"],De=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),je=[De];function Ae(n,u,s,o,l,x){return r(),v("svg",{width:n.width,height:n.height,viewBox:"0 0 24 24"},je,8,ke)}const Se=et(te,[["render",Ae]]);let Mt=0,Pt=0;const Me=500;function Jt(){const n=Math.floor(new Date().getTime()/1e3);Pt===n?Mt++:Mt=0,Pt=n;const u=n.toString(16);return`${(Me<<16|Mt&255).toString(16)}.${u}`}async function Ue(){try{return await ct.getAll("calculator")}catch{return[]}}async function Ve(n){try{await ct.add("calculator",JSON.parse(JSON.stringify(n)))}catch(u){u instanceof Error?console.log(u.message):console.log(u)}}async function gt(n){try{await ct.put("calculator",JSON.parse(JSON.stringify(n)))}catch(u){u instanceof Error?console.log(u.message):console.log(u)}}async function Ie(n){try{await ct.delete("calculator",n)}catch(u){u instanceof Error?console.log(u.message):console.log(u)}}async function Te(n){try{const o=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of n)await ct.wrap(o.put(l))}catch(u){u instanceof Error?console.log(u.message):console.log(u)}}async function He(n){try{const o=(await ct.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of n)await ct.wrap(o.delete(l))}catch(u){u instanceof Error?console.log(u.message):console.log(u)}}function Pe(){return{w:2438,g:0,a:"403+363",c:20,x:0,j:0}}function Je(){return{a:0}}function Re(){return{att:0}}function Qt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function qe(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ge(){return[Qt()]}function Ne(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const ze=mt({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(n,{emit:u}){const s=W(),o=W({}),l=W(n.active),x=()=>{const $=s.value.getBoundingClientRect();switch(l.value=!0,u("update:active",l.value),n.dir){case"left":o.value={top:`${$.top+$.height/2}px`,right:`${window.innerWidth-$.left-4}px`,maxWidth:"100%"};break;case"right":o.value={top:`${$.top+$.height/2}px`,left:`${$.right+4}px`,maxWidth:"100%"};break;case"top":o.value={bottom:`${window.innerHeight-$.top-4}px`,left:`${$.left+$.width/2}px`,maxWidth:"100%"};break;default:o.value={top:`${$.bottom+4}px`,left:`${$.left+$.width/2}px`,maxWidth:"100%"}}};let d;const c=()=>{d=window.setTimeout(x,n.wait)},j=()=>{clearTimeout(d),l.value=!1,u("update:active",l.value)};return qt(()=>n.active,y=>{l.value=y}),{el:s,style:o,tActive:l,onEnter:c,onOut:j}}});const Le={class:"c-tooltip-label"};function Oe(n,u,s,o,l,x){return r(),v("div",{ref:"el",class:Et(["c-tooltip",{active:n.tActive,inline:n.inline}]),onMouseenter:u[0]||(u[0]=(...d)=>n.onEnter&&n.onEnter(...d)),onMouseout:u[1]||(u[1]=(...d)=>n.onOut&&n.onOut(...d))},[bt(n.$slots,"label",{},()=>[t("div",Le,w(n.label),1)]),t("div",{class:Et(["c-tooltip-inner",n.dir?`c-tooltip-${n.dir}`:"c-tooltip-bottom",n.color?`c-tooltip-${n.color}`:""]),style:Tt(n.style)},[bt(n.$slots,"default")],6)],34)}const _t=et(ze,[["render",Oe]]),st=n=>(Dt("data-v-8f8a534c"),n=n(),jt(),n),Ke=["onKeypress"],Qe=["onKeypress"],Xe=st(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),We=Z(" \u514B\u523630%"),Ze=st(()=>t("br",null,null,-1)),Ye=Z("\u88AB\u514B\u5236-25%"),ts=st(()=>t("br",null,null,-1)),es=Z("\u6FC0\u836150% "),ss=["onClick"],ns=["onClick"],us={class:"row"},os={class:"col-item"},as=st(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ls=Z(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),cs={class:"input-group"},is=["step"],ds=st(()=>t("div",{class:"input-ext"},"\u500D",-1)),rs={class:"label"},ps={class:"input-group"},_s=st(()=>t("div",{style:{clear:"both"}},null,-1)),fs={class:"col-item"},vs=st(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),hs=Z(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),ms={class:"input-group"},Fs=["step"],Bs=st(()=>t("div",{class:"input-ext"},"\u500D",-1)),bs={class:"label"},$s={class:"input-group"},xs={class:"col-item"},ys=st(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Cs={class:"static-control text-center"},gs={class:"darkgold"},ws=st(()=>t("div",{style:{clear:"both"}},null,-1)),Es={class:"label"},ks={class:"bold darkgold"},Ds=st(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),js={class:"static-control text-center"},As={class:"bold darkgold"},Ss={class:"bold red"},Ms={class:"label bold"},Us={class:"static-control text-center"},Vs={class:"bold darkgold"},Is={key:0,class:"bold red"},Ts=mt({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(n,{emit:u}){const s=n,o=ht({editor:!1,name:"",desc:{f:!1,v:""}}),l=ht(qe()),x=ee(s,"itemState"),d=()=>{u("update:itemState",x.value)},c=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],j=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u6700\u7EC8\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],y=tt(()=>{const{state:F}=s,i=(100+l.att)/100;return Math.ceil(F.att*i)}),$=tt(()=>{const{state:F}=s,i=(100+l.att+l.att2)/100;return Math.ceil(F.att*i)}),H=()=>{const{enemyState:F}=s,i=x.value,D=(100+i.kz)/100,h=(100+l.da-F.ra)/100,V=(100+l.da+l.da2-F.ra)/100,O=(100+l.db-F.rb)/100,Ft=(100+l.dc)/100,dt=(100+l.dx)/100,at=(100+l.dx+l.dx2)/100,lt=(100+l.cd)/100,U=(100-l.id)/100,B=(100+F.defGain)/100,q=(100+F.defGain+l.defGain)/100,P=Math.max(0,Math.max(0,F.def*B+F.defExt)*U),C=Math.max(0,Math.max(0,F.def*q+F.defExt)*U),e=Math.max(1,y.value*D-P),b=Math.max(1,$.value*D-C),M=e*i.a1*h*O*dt,Y=Math.ceil(M*lt),nt=b*i.a2*V*O*Ft*at,rt=Math.ceil(nt*lt);return{r01:Math.ceil(M),r01c:Y,r02:Math.ceil(nt),r02c:rt}},_=tt(()=>H());function p(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${s.itemState.name}"\u5417\uFF1F`)&&u("close")}function E(){o.editor=!0,o.name=s.itemState.name}function k(){const F=o.name;if(o.editor=!1,o.name="",!F)return;const i=s.itemState;i.name=F,u("update:itemState",i)}function R(){o.desc.f=!0,o.desc.v=s.itemState.desc}function T(){const F=o.desc.v;if(o.desc.f=!1,o.desc.v="",!F)return;const i=s.itemState;i.desc=F,u("update:itemState",i)}function S(){u("up")}function N(){u("down")}function A(){u("copy")}return(F,i)=>{const D=Gt("autofocus");return r(),v(I,null,[f(a(ue),{orientation:"left"},{action:m(()=>[t("span",{onClick:A},[f(a(Kt),{class:"close"})]),n.showUp?(r(),v("span",{key:0,onClick:S},[f(a(Fe),{class:"close"})])):Q("",!0),n.showDown?(r(),v("span",{key:1,onClick:N},[f(a(ye),{class:"close"})])):Q("",!0),t("span",{onClick:p},[f(a(se),{class:"close"})])]),default:m(()=>[o.editor?z((r(),v("input",{key:0,class:"input",type:"text","onUpdate:modelValue":i[0]||(i[0]=h=>o.name=h),onKeypress:Ut(k,["enter"]),onBlur:k},null,40,Ke)),[[ut,o.name],[D]]):(r(),v("span",{key:1,class:"calc-item-title",onClick:E},w(a(x).name||"\u6A21\u677F"),1)),o.desc.f?z((r(),v("input",{key:2,class:"input",type:"text","onUpdate:modelValue":i[1]||(i[1]=h=>o.desc.v=h),onKeypress:Ut(T,["enter"]),onBlur:T},null,40,Qe)),[[ut,o.desc.v],[D]]):(r(),v("span",{key:3,class:"calc-item-desc",onClick:R},w(a(x).desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),f(a(ne),{style:{width:"120px"}},{default:m(()=>[f(a(_t),{dir:"top"},{label:m(()=>[Xe]),default:m(()=>[We,Ze,Ye,ts,es]),_:1}),t("div",null,[f(a(zt),null,{popover:m(({onClose:h})=>[t("div",{class:"list",onClick:V=>h()},[(r(),v(I,null,J([{label:"\u666E\u901A",value:0},{label:"\u514B\u5236",value:30},{label:"\u88AB\u514B\u5236",value:-25},{label:"\u6FC0\u8361",value:50}],({label:V,value:O})=>t("div",{key:V,class:"list-item",onClick:Ft=>{a(x).kz=O,d()}},w(V),9,ns)),64))],8,ss)]),default:m(()=>[z(t("input",{class:"input",type:"number","onUpdate:modelValue":i[2]||(i[2]=h=>a(x).kz=h)},null,512),[[ut,a(x).kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",us,[t("div",os,[f(a(_t),{dir:"top"},{label:m(()=>[as]),default:m(()=>[ls]),_:1}),t("div",cs,[z(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":i[3]||(i[3]=h=>a(x).a1=h),onInput:d},null,40,is),[[ut,a(x).a1,void 0,{number:!0}]]),ds])]),(r(),v(I,null,J(c,h=>t("div",{class:"col-item",key:h.name},[f(a(_t),{dir:"top"},{label:m(()=>[t("div",rs,w(h.label),1)]),default:m(()=>[Z(" "+w(h.tip),1)]),_:2},1024),t("div",ps,[f(a(yt),{class:"input",modelValue:a(x)[h.name],"onUpdate:modelValue":V=>a(x)[h.name]=V,result:l[h.name],"onUpdate:result":[V=>l[h.name]=V,d]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),_s,t("div",fs,[f(a(_t),{dir:"top"},{label:m(()=>[vs]),default:m(()=>[hs]),_:1}),t("div",ms,[z(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":i[4]||(i[4]=h=>a(x).a2=h),onInput:d},null,40,Fs),[[ut,a(x).a2,void 0,{number:!0}]]),Bs])]),(r(),v(I,null,J(j,h=>t("div",{class:"col-item",key:h.name},[f(a(_t),{dir:"top"},{label:m(()=>[t("div",bs,w(h.label),1)]),default:m(()=>[Z(" "+w(h.tip),1)]),_:2},1024),t("div",$s,[f(a(yt),{class:"input",modelValue:a(x)[h.name],"onUpdate:modelValue":V=>a(x)[h.name]=V,result:l[h.name],"onUpdate:result":[V=>l[h.name]=V,d]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",xs,[ys,t("div",Cs,[t("span",gs,w(a(y)),1)])]),ws,(r(!0),v(I,null,J([a(_)],h=>(r(),v(I,null,[(r(!0),v(I,null,J([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:h.r01,v2:h.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:h.r02,v2:h.r02c}],(V,O)=>(r(),v("div",{class:"col-item",key:O},[t("div",Es,[t("span",ks,w(V.label),1),Ds]),t("div",js,[t("span",As,w(V.v),1),t("span",Ss,"("+w(V.v2)+")",1)])]))),128)),(r(!0),v(I,null,J([{label:"\u4E0D\u66B4\u51FB",value:h.r01+h.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:h.r01c+h.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:h.r01+h.r02c},{label:"\u5168\u66B4\u51FB",value:h.r01c+h.r02c}],(V,O)=>(r(),v("div",{class:"col-item",key:O},[t("div",Ms,w(V.label),1),t("div",Us,[t("span",Vs,w(V.value),1),(+n.enemyState.hp||0)<=V.value?(r(),v("span",Is," \u51FB\u6740 ")):Q("",!0)])]))),128))],64))),256))])],64)}}});const Hs=et(Ts,[["__scopeId","data-v-8f8a534c"]]),At=n=>(Dt("data-v-0a482fec"),n=n(),jt(),n),Ps=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Js={class:"row"},Rs={class:"label"},qs={class:"input-group"},Gs=["step","onUpdate:modelValue","onChange"],Ns=["value"],zs={class:"col-item"},Ls=At(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Os={class:"static-control text-center"},Ks={class:"darkgold"},Qs=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),Xs={class:"row"},Ws={class:"label"},Zs={key:1,class:"label"},Ys={class:"input-group"},tn={key:0,class:"input-ext"},en=At(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),sn=mt({__name:"Calculator",props:{data:null},emits:["update:data"],setup(n,{emit:u}){const s=n,o=tt(()=>s.data.basic),l=tt(()=>s.data.state),x=tt(()=>s.data.enemyState),d=tt(()=>s.data.items),c=ht(Je()),j=ht({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),y=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1},{label:"\u7CBE\u8FDB\u653B\u51FB",name:"j",step:1}],$=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],H=()=>{const A=o.value.c/100;o.value.g=Math.ceil(c.a+o.value.w*A+o.value.x+o.value.j),l.value.att=o.value.w+o.value.g},_=async()=>{u("update:data",s.data)},p=(A,F)=>{F==="panel"&&H(),_()},E=(A,F)=>{const i=s.data.items;!i||(i[F]=A,_())},k=()=>{const A=s.data.items;!A||(A.push(Qt()),_())},R=A=>{const F=s.data.items;!F||(F.splice(A,1),_())},T=A=>{const F=s.data.items;if(!F)return;const i=F[A],D=F[A-1];F[A-1]=i,F[A]=D,_()},S=A=>{const F=s.data.items;if(!F)return;const i=F[A],D=F[A+1];F[A+1]=i,F[A]=D,_()},N=A=>{const F=s.data.items;if(!F)return;const i=F[A];F.push(kt.cloneDeep(i)),_()};return qt(()=>[s.data.basic.w],()=>{H()}),(A,F)=>(r(),v("div",null,[Ps,t("div",Js,[(r(),v(I,null,J(y,i=>t("div",{class:"col-item",key:i.name},[t("div",Rs,w(i.label),1),t("div",qs,[i.name in c?(r(),ot(a(yt),{key:0,modelValue:a(o)[i.name],"onUpdate:modelValue":D=>a(o)[i.name]=D,result:c[i.name],"onUpdate:result":D=>c[i.name]=D,onChange:D=>p(i.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):z((r(),v("input",{key:1,type:"number",class:"input",style:Tt({textAlign:i.align}),min:"0",step:i.step,"onUpdate:modelValue":D=>a(o)[i.name]=D,onChange:D=>p(i.name,"panel")},null,44,Gs)),[[ut,a(o)[i.name],void 0,{number:!0}]]),i.name==="w"?(r(),v("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${a(o).g}`},null,8,Ns)):Q("",!0)])])),64)),t("div",zs,[Ls,t("div",Os,[t("span",Ks,w(a(l).att),1)])])]),Qs,t("div",Xs,[(r(),v(I,null,J($,i=>t("div",{class:"col-item",key:i.name},[i.tips?(r(),ot(a(_t),{key:0,dir:"top"},{label:m(()=>[t("div",Ws,w(i.label),1)]),default:m(()=>[Z(" "+w(i.tips),1)]),_:2},1024)):(r(),v("div",Zs,w(i.label),1)),t("div",Ys,[f(a(yt),{modelValue:a(x)[i.name],"onUpdate:modelValue":D=>a(x)[i.name]=D,result:j[i.name],"onUpdate:result":D=>j[i.name]=D,onChange:D=>p(i.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),i.precent?(r(),v("div",tn,"%")):Q("",!0)])])),64))]),t("div",{class:"heading"},[en,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:k},"\u6DFB\u52A0")])]),(r(!0),v(I,null,J(a(d),(i,D)=>(r(),ot(Hs,{key:i,panel:a(o),state:a(l),enemyState:j,itemState:i,showUp:D>0,showDown:a(d)&&D<a(d).length-1,"onUpdate:itemState":h=>E(h,D),onClose:h=>R(D),onUp:h=>T(D),onDown:h=>S(D),onCopy:h=>N(D)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const nn=et(sn,[["__scopeId","data-v-0a482fec"]]),un=mt({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(n,{emit:u}){return{wrapClass:tt(()=>["c-action-sheet-wrapper",n.class,{show:n.show}]),onClick:(x,d)=>{u("click",{item:x,index:d}),u("close",!1)},onClose:()=>{u("update:show",!1),u("close",!1)}}}});const on={class:"c-action-sheet-section"},an={class:"c-action-sheet-extra"},ln={class:"c-action-sheet-list"},cn=["onClick"];function dn(n,u,s,o,l,x){return r(),ot(Nt,{to:"body"},[t("div",{class:Et(n.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:u[0]||(u[0]=(...d)=>n.onClose&&n.onClose(...d))}),t("div",on,[t("div",{class:"c-action-sheet-body",style:Tt({maxHeight:n.height})},[t("div",an,[bt(n.$slots,"extra")]),t("div",ln,[(r(!0),v(I,null,J(n.list,(d,c)=>(r(),v("div",{class:"c-action-sheet-item",key:c,onClick:j=>n.onClick(d,c)},[bt(n.$slots,"default",{record:d})],8,cn))),128))])],4)])],2)])}const It=et(un,[["render",dn]]);It.install=n=>{n.component("action-sheet",It)};const rn={class:"hero-item"},pn={class:"hero-item__inner"},_n=["src"],fn=["src","alt","title"],vn={class:"hero-item__label"},hn=mt({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(n,{emit:u}){const{heroes:s,getHeroIcon:o,getHeroIconBg:l}=ie(),x=tt(()=>s.value),d=c=>{u("click",c)};return(c,j)=>(r(),ot(a(It),{class:"hero-select",show:n.show,list:a(x),height:"80vh",onClick:d,"onUpdate:show":j[0]||(j[0]=y=>c.$emit("update:show",y))},{extra:m(()=>[bt(c.$slots,"extra")]),default:m(({record:y})=>[t("div",rn,[t("div",pn,[t("img",{src:a(l)(y)},null,8,_n),t("img",{src:a(o)(y),alt:y.name,title:y.name},null,8,fn),t("div",vn,w(y.name),1)])])]),_:3},8,["show","list"]))}});function mn(){const n="red_team",u=oe(),s=W([]),o=W(!1),l=W(),x=async _=>{const E=(await u.transaction(n,"readwrite")).objectStore(n),k=await u.wrap(E.put(_));return s.value.find(T=>T._id===_._id)||(_._id=k,s.value.push(_)),k},d=async _=>{const E=(await u.transaction(n,"readwrite")).objectStore(n);await u.wrap(E.delete(_._id)),s.value=s.value.filter(k=>k._id!==_._id)},c=async _=>{const p=await u.transaction(n,"readwrite"),E=p.objectStore(n);for(const k of _)await u.wrap(E.put(k));await u.twrap(p),await y()},j=async()=>{const p=(await u.transaction(n,"readwrite")).objectStore(n);await u.wrap(p.clear()),s.value=[]},y=async()=>{const p=(await u.transaction(n,"readonly")).objectStore(n),E=await u.wrap(p.getAll()).catch(()=>[]);E.forEach(k=>{k.scList||(k.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:X.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:X.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:X.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:X.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:X.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:X.DEF}])}),s.value=E},$=async _=>{const p=JSON.parse(await _.text());if(!Lt(p)||p.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const E=p.data;E.forEach(k=>delete k._id),await c(E)},H=async()=>{const _={type:"red_team",data:s.value},p=new Blob([JSON.stringify(_)],{type:"application/json"});Vt(p,"red_team.json")};return y(),{scShow:o,scSelected:l,put:x,del:d,puts:c,clear:j,all:y,list:s,importData:$,exportData:H}}const Bt=n=>n%1>.5?Math.ceil(n):Math.floor(n);function Fn(){const n=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:X.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:X.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:X.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:X.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:X.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:X.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0,jjType:"none",jjText:"\u65E0",jjQixue:0,jjPatt:0,jjPdef:0,jjMatt:0,jjMdef:0,jjHuixin:0}),u=W(n()),s=tt(()=>{const d=[0,0,0,0,0,0];return u.value.scList.forEach(c=>{!c.v||(d[0]+=c.v.qixue,d[1]+=c.v.patt,d[2]+=c.v.pdef,d[3]+=c.v.matt,d[4]+=c.v.mdef,d[5]+=c.v.huixin)}),d}),o=tt(()=>{const d=u.value,c={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},j=Ot.find(H=>d.stoneName===H.name);j&&(c.qixue=j.t[0]+j.d[0]+j.h[0],c.patt=j.t[1]+j.d[1]+j.h[1],c.matt=j.t[2]+j.d[2]+j.h[2],c.pdef=j.t[3]+j.d[3]+j.h[3],c.mdef=j.t[4]+j.d[4]+j.h[4]);const y={qixue:d.hsQixue/100,patt:d.hsPatt/100,pdef:d.hsPdef/100,matt:d.hsMatt/100,mdef:d.hsMdef/100,huixin:d.hsHuixin/100},$=s.value;return{qixue:Bt(d.qixue*y.qixue+c.qixue+$[0]+d.jjQixue),patt:Bt(d.patt*y.patt+c.patt+$[1]+d.jjPatt),pdef:Bt(d.pdef*y.pdef+c.pdef+$[2]+d.jjPdef),matt:Bt(d.matt*y.matt+c.matt+$[3]+d.jjMatt),mdef:Bt(d.mdef*y.mdef+c.mdef+$[4]+d.jjMdef),huixin:Bt(d.huixin*y.huixin+c.huixin+$[5]+d.jjHuixin)}}),l=tt(()=>{const d=o.value,c={qixue:(100+u.value.rQixue)/100,patt:(100+u.value.rPatt)/100,pdef:(100+u.value.rPdef)/100,matt:(100+u.value.rMatt)/100,mdef:(100+u.value.rMdef)/100,huixin:(100+u.value.rHuixin)/100};return{qixue:Math.round((u.value.qixue+d.qixue)*c.qixue),patt:Math.round((u.value.patt+d.patt)*c.patt),pdef:Math.round((u.value.pdef+d.pdef)*c.pdef),matt:Math.round((u.value.matt+d.matt)*c.matt),mdef:Math.round((u.value.mdef+d.mdef)*c.mdef),huixin:Math.round((u.value.huixin+d.huixin)*c.huixin)}});return{state:u,pValue:o,ckValue:l,scSum:s,reset:()=>{u.value=n()},defState:n}}const Bn={},bn={class:"c-upload"};function $n(n,u){return r(),v("div",bn,[bt(n.$slots,"default",{},void 0,!0),t("input",ae({type:"file",class:"c-upload-input",accept:"application/json"},n.$attrs),null,16)])}const xn=et(Bn,[["render",$n],["__scopeId","data-v-b3879154"]]),yn=[1020,330,270,0,150,0],Cn=[930,360,253,0,120,0],gn=[870,390,240,0,150,0],wn=[870,0,240,390,150,0],En=[780,360,210,0,180,0],kn=[810,390,180,0,210,0],Dn=[750,360,210,0,150,0],jn=[690,0,180,390,240,0],An=[750,0,180,360,270,0],Sn=[750,0,210,330,270,0],Mn={xk:gn,xk_f:wn,ys:Dn,tw:yn,tw2:Cn,zs:jn,zs2:An,zy:Sn,yf:En,yf2:kn,none:[0,0,0,0,0,0]};function Rt(n){return Mn[n]}const L=n=>(Dt("data-v-17644d38"),n=n(),jt(),n),Un={class:"transform-tools-popover"},Vn={class:"transform-tools-popover-toolbar"},In=["value"],Tn=["value"],Hn=L(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Pn={class:"transform-tools-popover-content"},Jn={class:"grid-group"},Rn={class:"grid-group-item"},qn={class:"input-group-title"},Gn=L(()=>t("span",null,"\u57FA\u7840",-1)),Nn={class:"grids"},zn={class:"input-label"},Ln={class:"input-group"},On={class:"input green"},Kn={class:"grid-group-item"},Qn={class:"input-group-title"},Xn=L(()=>t("span",null,"\u9B42\u77F3",-1)),Wn=L(()=>t("option",{value:""},"\u65E0",-1)),Zn=["value"],Yn={class:"grids"},tu=L(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),eu=L(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),su=L(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),nu=L(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),uu=L(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),ou={class:"grid-group-item"},au={class:"input-group-title"},lu=Z(" \u661F\u4E4B\u6676 "),cu=L(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),iu=L(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),du=L(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),ru={class:"grids"},pu=["onClick","onContextmenu"],_u={key:0},fu={key:1},vu={key:2},hu={key:3},mu={key:4},Fu={key:5},Bu={key:1},bu={class:"grid-group-item"},$u=L(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),xu={class:"grids"},yu={class:"input-label"},Cu={class:"input"},gu={class:"grid-group-item"},wu={class:"input-group-title"},Eu=L(()=>t("span",null,"\u7CBE\u8FDB\u5C5E\u6027",-1)),ku=L(()=>t("button",null,"\u9009\u62E9\u7CBE\u8FDB",-1)),Du={class:"c-list"},ju=["onClick"],Au={class:"grids"},Su={class:"input-label"},Mu={class:"grid-group-item"},Uu=L(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63%",-1)),Vu={class:"grids"},Iu={class:"input-label"},Tu={class:"grid-group-item"},Hu=L(()=>t("div",{class:"input-group-title"},"\u6700\u7EC8\u53C2\u8003",-1)),Pu={class:"grids"},Ju={class:"input-label"},Ru={class:"input"},qu=mt({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(n,{emit:u}){const{state:s,pValue:o,ckValue:l,scSum:x,reset:d,defState:c}=Fn(),{list:j,put:y,del:$,clear:H,importData:_,exportData:p}=mn(),E=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],k=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],R=[{t:"\u6C14\u8840",n:"jjQixue"},{t:"\u7269\u653B",n:"jjPatt"},{t:"\u7269\u9632",n:"jjPdef"},{t:"\u6CD5\u653B",n:"jjMatt"},{t:"\u6CD5\u9632",n:"jjMdef"},{t:"\u4F1A\u5FC3",n:"jjHuixin"}],T=W(!1),S=W(),N=U=>{S.value=U,T.value=!0},A=U=>{!S.value||(S.value.v=U)},F=()=>{const U=kt.cloneDeep(s.value);y(U).then(B=>{s.value._id=B,alert("\u5DF2\u4FDD\u5B58")}).catch(B=>{console.log(B),alert("\u4FDD\u5B58\u5931\u8D25")})},i=()=>{const U=kt.cloneDeep(s.value);delete U._id,U.name+=" copy",y(U).then(B=>{U._id=B,s.value=U}).catch(B=>{console.log(B),alert("\u590D\u5236\u5931\u8D25")})},D=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||$(s.value).then(()=>{d()}).catch(B=>{console.log(B),alert("\u5220\u9664\u5931\u8D25")})},h=U=>{const B=U.currentTarget;if(!B.files)return;const q=Array.prototype.slice.call(B.files);B.value="",q[0]&&_(q[0])},V=()=>{p()},O=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||H().catch(B=>{console.log(B),alert("\u6E05\u7A7A\u5931\u8D25")})},Ft=(U,B)=>{s.value.name||(s.value.name=U.name),s.value.qixue=B.qixue,s.value.patt=B.patt,s.value.pdef=B.pdef,s.value.matt=B.matt,s.value.mdef=B.mdef,s.value.huixin=B.huixin,s.value.jjType=U.key;const q=Rt(U.key);s.value.jjQixue=q[0],s.value.jjPatt=q[1],s.value.jjPdef=q[2],s.value.jjMatt=q[3],s.value.jjMdef=q[4],s.value.jjHuixin=q[5]},dt=[{value:"xk",text:"\u4FA0\u5BA2"},{value:"xk_f",text:"\u4FA0\u5BA2\u6CD5"},{value:"tw",text:"\u94C1\u536B"},{value:"tw2",text:"\u731B\u58EB"},{value:"ys",text:"\u7FBD\u58EB"},{value:"yf",text:"\u5FA1\u98CE"},{value:"yf2",text:"\u5FA1\u98CE\u83BD"},{value:"zs",text:"\u5492\u5E08"},{value:"zs2",text:"\u5492\u5E08\u8089"},{value:"zy",text:"\u795D\u7531"},{value:"none",text:"\u65E0"}],at=U=>{s.value.jjType=U.value,s.value.jjText=U.text;const B=Rt(s.value.jjType);s.value.jjQixue=B[0],s.value.jjPatt=B[1],s.value.jjPdef=B[2],s.value.jjMatt=B[3],s.value.jjMdef=B[4],s.value.jjHuixin=B[5]},lt=()=>{u("reference")};return u("init",Ft),(U,B)=>{const q=ft("c-col"),P=ft("c-space"),C=ft("c-row");return z((r(),v("div",Un,[t("div",Vn,[f(C,{flex:"",middle:"",gutter:8},{default:m(()=>[f(q,null,{default:m(()=>[t("button",{class:"btn btn-sm btn-link",onClick:lt},"\u53C2\u8003")]),_:1}),f(q,null,{default:m(()=>[Z("ID: "+w(a(s)._id),1)]),_:1}),f(q,{flex:"1 1 auto"},{default:m(()=>[f(P,null,{default:m(()=>[z(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":B[0]||(B[0]=e=>xt(s)?s.value=e:null)},[t("option",{value:a(c)()},"\u7A7A\u6A21\u7248",8,In),(r(!0),v(I,null,J(a(j),e=>(r(),v("option",{key:e._id,value:e},w(e.name),9,Tn))),128))],512),[[Ht,a(s)]]),t("button",{class:"btn btn-sm btn-primary",onClick:F},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:i},"\u590D\u5236"),a(s)._id?(r(),v("button",{key:0,class:"btn btn-sm btn-danger",onClick:D},"\u5220\u9664")):Q("",!0),f(xn,{onChange:h},{default:m(()=>[Hn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:V},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:O},"\u6E05\u7A7A")]),_:1})]),_:1}),f(q,null,{default:m(()=>[t("span",{class:"transform-tools-popover-close",onClick:B[1]||(B[1]=e=>u("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Pn,[t("div",Jn,[t("div",Rn,[t("div",qn,[f(P,null,{default:m(()=>[Gn,z(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":B[2]||(B[2]=e=>a(s).name=e)},null,512),[[ut,a(s).name]])]),_:1})]),t("div",Nn,[(r(),v(I,null,J(E,e=>f(P,{key:e.n},{default:m(()=>[t("label",zn,w(e.t),1),t("div",Ln,[f(a(pt),{readonly:"",value:a(s)[e.n]},null,8,["value"]),t("div",On,"+"+w(a(o)[e.n]),1)])]),_:2},1024)),64))])]),t("div",Kn,[t("div",Qn,[f(P,null,{default:m(()=>[Xn,z(t("select",{class:"input input-select","onUpdate:modelValue":B[3]||(B[3]=e=>a(s).stoneName=e)},[Wn,(r(!0),v(I,null,J(a(Ot),(e,b)=>(r(),v("option",{key:b,value:e.name},w(e.name),9,Zn))),128))],512),[[Ht,a(s).stoneName]])]),_:1})]),t("div",Yn,[f(P,null,{default:m(()=>[tu,f(a(pt),{value:a(s).hsQixue,"onUpdate:value":B[4]||(B[4]=e=>a(s).hsQixue=e)},null,8,["value"])]),_:1}),f(P,null,{default:m(()=>[eu,f(a(pt),{value:a(s).hsPatt,"onUpdate:value":B[5]||(B[5]=e=>a(s).hsPatt=e)},null,8,["value"])]),_:1}),f(P,null,{default:m(()=>[su,f(a(pt),{value:a(s).hsPdef,"onUpdate:value":B[6]||(B[6]=e=>a(s).hsPdef=e)},null,8,["value"])]),_:1}),f(P,null,{default:m(()=>[nu,f(a(pt),{value:a(s).hsMatt,"onUpdate:value":B[7]||(B[7]=e=>a(s).hsMatt=e)},null,8,["value"])]),_:1}),f(P,null,{default:m(()=>[uu,f(a(pt),{value:a(s).hsMdef,"onUpdate:value":B[8]||(B[8]=e=>a(s).hsMdef=e)},null,8,["value"])]),_:1})])]),t("div",ou,[t("div",au,[lu,f(a(_t),{label:"?",inline:"",dir:"right"},{default:m(()=>[cu,iu,du]),_:1})]),t("div",ru,[(r(!0),v(I,null,J(a(s).scList,(e,b)=>(r(),v("div",{key:b,class:Et(["sc-props",{selected:S.value===e,s1:a(X).ATT===e.pos,s2:a(X).XUE===e.pos,s3:a(X).DEF===e.pos}]),onClick:M=>N(e),onContextmenu:wt(M=>e.v=void 0,["prevent"])},[e.v?(r(),v(I,{key:0},[e.v.qixue>0?(r(),v("span",_u,"\u6C14\u8840+"+w(e.v.qixue),1)):Q("",!0),e.v.patt>0?(r(),v("span",fu,"\u7269\u653B+"+w(e.v.patt),1)):Q("",!0),e.v.pdef>0?(r(),v("span",vu,"\u7269\u9632+"+w(e.v.pdef),1)):Q("",!0),e.v.matt>0?(r(),v("span",hu,"\u6CD5\u653B+"+w(e.v.matt),1)):Q("",!0),e.v.mdef>0?(r(),v("span",mu,"\u6CD5\u9632+"+w(e.v.mdef),1)):Q("",!0),e.v.huixin>0?(r(),v("span",Fu,"\u4F1A\u5FC3+"+w(e.v.huixin),1)):Q("",!0)],64)):(r(),v("span",Bu,w(e.n),1))],42,pu))),128))]),(r(),ot(Nt,{to:"body"},[S.value?(r(),ot(a(_e),{key:0,show:T.value,"onUpdate:show":B[9]||(B[9]=e=>T.value=e),position:S.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:A},null,8,["show","position"])):Q("",!0)]))]),t("div",bu,[$u,t("div",xu,[(r(),v(I,null,J(E,(e,b)=>f(P,{key:b},{default:m(()=>[t("label",yu,w(e.t),1),t("div",Cu,"+"+w(a(x)[b]),1)]),_:2},1024)),64))])]),t("div",gu,[t("div",wu,[f(P,null,{default:m(()=>[Eu,f(a(zt),null,{popover:m(({onClose:e})=>[t("ul",Du,[(r(),v(I,null,J(dt,b=>t("li",{key:b.value,onClick:M=>{at(b),e()}},w(b.text),9,ju)),64))])]),default:m(()=>[ku]),_:1})]),_:1})]),t("div",Au,[(r(),v(I,null,J(R,(e,b)=>f(P,{key:b},{default:m(()=>[t("label",Su,w(e.t),1),f(a(pt),{value:a(s)[e.n],"onUpdate:value":M=>a(s)[e.n]=M,min:"0"},null,8,["value","onUpdate:value"])]),_:2},1024)),64))])]),t("div",Mu,[Uu,t("div",Vu,[(r(),v(I,null,J(k,(e,b)=>f(P,{key:b},{default:m(()=>[t("label",Iu,w(e.t),1),f(a(yt),{modelValue:a(s)[e.c],"onUpdate:modelValue":M=>a(s)[e.c]=M,result:a(s)[e.r],"onUpdate:result":M=>a(s)[e.r]=M},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",Tu,[Hu,t("div",Pu,[(r(),v(I,null,J(E,e=>f(P,{key:e.n},{default:m(()=>[t("label",Ju,w(e.t),1),t("div",Ru,w(a(l)[e.n]),1)]),_:2},1024)),64))])])])])],512)),[[le,n.show]])}}});const Gu=et(qu,[["__scopeId","data-v-17644d38"]]);function vt(n){return(n%1>.5?Math.ceil:Math.floor)(n)}function Xt(n){const{basic:u,enemyState:s}=n,o={w:u.w,a:G(u.a),c:u.c,x:u.x,j:u.j,g:0,att:0};o.g=vt(u.w*u.c/100+o.a+o.x+o.j),o.att=u.w+o.g;const l={hp:G(s.hp),ra:G(s.ra),rb:G(s.rb),def:G(s.def),defExt:G(s.defExt),defGain:G(s.defGain)};return{b:o,e:l}}function Nu(n,u){const{b:s,e:o}=Xt(n),l={a1:u.a1,a2:u.a2,att:G(u.att),att2:G(u.att2),da:G(u.da),da2:G(u.da2),db:G(u.db),dc:G(u.dc),dx:G(u.dx),dx2:G(u.dx2),id:G(u.id),cd:G(u.cd),defGain:G(u.defGain),kz:u.kz||0},x=s.att*(100+l.att)/100,d=s.att*(100+l.att+l.att2)/100,c=(100+l.kz)/100,j=(100+l.da-o.ra)/100,y=(100+l.da+l.da2-o.ra)/100,$=(100+l.db-o.rb)/100,H=(100+l.dc)/100,_=(100+l.dx)/100,p=(100+l.dx+l.dx2)/100,E=(100+l.cd)/100,k=(100-l.id)/100,R=(100+o.defGain)/100,T=(100+o.defGain+l.defGain)/100,S=Math.max(0,Math.max(0,o.def*R+o.defExt)*k),N=Math.max(0,Math.max(0,o.def*T+o.defExt)*k),A=Math.max(1,x*c-S),F=Math.max(1,d*c-N),i=A*l.a1*j*$*_,D=vt(i*E),h=F*l.a2*y*$*H*p,V=vt(h*E);return{satt:x,satt2:d,r01:vt(i),r01c:D,r02:vt(h),r02c:V}}function zu(n){const u=n.items||[],s=document.createElement("canvas");s.width=800,s.height=8+160+u.reduce((p,E)=>{let k=30;return k+=50,E.a1>0&&(k+=30),E.a2>0&&(k+=50),(E.a1>0||E.a2>0)&&(k+=20),E.a1>0&&E.a2>0&&(k+=20),k+=20,p+k},0)+8;const o=s.getContext("2d");if(!o)return;const l=n.basic,x=n.enemyState,{b:d}=Xt(n),c={x:0,y:0},j=(p,E,k)=>{k?(c.x+=p,c.y+=E):(c.x=p,c.y=E)},y=(p=0)=>{c.x=8+p*16},$=(p=0)=>{c.x=8,c.y+=p},H=(p,E="#222222")=>{o.save(),o.fillStyle=E;const{width:k}=o.measureText(p);o.fillText(p,c.x,c.y),c.x+=k+16,o.restore()},_=(p,...E)=>{o.save();const k=typeof p=="string"?p:p[0],R=typeof p=="string"?"#222222":p[1];o.fillStyle=R,o.font="bold 16px sans-serif";const{width:T}=o.measureText(k);o.fillText(k,c.x,c.y),c.x+=T+8,o.restore(),o.save(),o.font="16px sans-serif";for(const S of E){const N=typeof S=="string"?S:S[0],A=typeof S=="string"?"#ff4446":S[1];o.fillStyle=A;const{width:F}=o.measureText(N);o.fillText(N,c.x,c.y),c.x+=F+8}c.x+=8,o.restore()};o.fillStyle="#FBFFF0",o.fillRect(0,0,s.width,s.height),j(8,28),o.textBaseline="bottom",o.font="bold 20px sans-serif",H(n.title),$(40),o.font="bold 18px sans-serif",H("\u653B\u65B9:"),o.font="16px sans-serif",$(30),y(2),_("\u653B\u51FB:",`${l.w}`,[`+${d.g}`,"#55a14f"]),_("\u9B42\u77F3\u653B\u51FB:",`${l.a}`),_("\u9B42\u77F3\u653B\u51FB%:",`${l.c}`),_("\u661F\u4E4B\u6676\u653B\u51FB:",`${l.x}`),_("\u7CBE\u8FDB\u653B\u51FB:",`${l.j}`),$(30),o.font="bold 18px sans-serif",H("\u5B88\u65B9:"),$(30),y(2),_("\u6C14\u8840:",`${x.hp}`),_("\u9632\u5FA1:",`${x.def}`),_("\u9632\u5FA1%:",`${x.defGain}`),_("\u9644\u52A0\u9632\u5FA1:",`${x.defExt}`),$(20),y(2),_("\u514D\u4F24A%:",`${x.ra}`),_("\u514D\u4F24B%:",`${x.rb}`),$(30);for(const p of u){const{satt:E,satt2:k,r01:R,r01c:T,r02:S,r02c:N}=Nu(n,p);o.font="bold 18px sans-serif",H(p.name,"#a30000"),o.font="14px sans-serif",H(p.desc||"\u65E0\u63CF\u8FF0","#a30000"),o.font="16px sans-serif",_("\u514B\u5236:",`${p.kz||0}%`),$(30),y(2),_("\u653B\u51FB%:",`${p.att}`),_("\u7A7F\u900F%:",`${p.id}`),_("\u66B4\u4F24%:",`${p.cd}`),$(20),y(2),_("\u589E\u4F24A%:",`${p.da}`),_("\u589E\u4F24B%:",`${p.db}`),_("\u589E\u4F24X%:",`${p.dx}`),$(30),p.a1>0&&(y(2),_("\u6280\u80FD\u3001\u666E\u653B:",`${p.a1}\u500D`),_("\u653B\u51FB:",[`${vt(E)}`,"#b8860b"]),$(30)),p.a2>0&&(y(2),_("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${p.a2}\u500D`),_("\u653B\u51FB\u4FEE\u6B63%:",p.att2),_("\u9632\u5FA1\u4FEE\u6B63%:",p.defGain),_("\u653B\u51FB:",[`${vt(k)}`,"#b8860b"]),$(20),y(2),_("\u589E\u4F24C%:",p.dc),_("\u589E\u4F24A\u4FEE\u6B63%:",p.da2),_("\u589E\u4F24X\u4FEE\u6B63%:",p.dx2),$(30)),y(2),R>0&&_(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${R}`,"#b8860b"],[`${T}`,"#ff4446"]),S>0&&_(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${S}`,"#b8860b"],[`${N}`,"#ff4446"]),$(20),R>0&&S>0&&(y(2),_(["\u4E0D\u66B4\u51FB","#b8860b"],[`${R+S}`,"#ff4446"]),_(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${T+S}`,"#ff4446"]),_(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${R+N}`,"#ff4446"]),_(["\u5168\u66B4\u51FB","#b8860b"],[`${T+N}`,"#ff4446"]),$(20)),$(20)}s.toBlob(p=>{!p||window.open(URL.createObjectURL(p))})}function Lu(){return{exportImage:zu}}const it=n=>(Dt("data-v-d8094890"),n=n(),jt(),n),Ou={class:"wrapper"},Ku={class:"toolbar"},Qu={style:{padding:"6px 16px"}},Xu=Z("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Wu={class:"c-upload"},Zu=it(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Yu={style:{padding:"6px 16px"}},to={class:"input-group"},eo=it(()=>t("div",{class:"input-ext"},"=",-1)),so={class:"content"},no={class:"container"},uo=["value"],oo=Z(" \u2007 "),ao=["onKeypress"],lo={key:1},co=["onClick"],io=["onClick"],ro=["onClick"],po=Z(" \u91CD\u547D\u540D "),_o=["onClick"],fo=Z(" \u590D\u5236 "),vo=["onClick"],ho=["onClick"],mo=["onClick"],Fo={style:{"text-align":"center"}},Bo=it(()=>t("span",null,"\u7B49\u7EA7",-1)),bo=it(()=>t("span",null,"\u53CA\u8EAB",-1)),$o=it(()=>t("span",null,"\u661F\u8000",-1)),xo=it(()=>t("span",null,"\u5316\u81FB",-1)),yo=it(()=>t("span",null,"\u661F\u9B42",-1)),Co=it(()=>t("span",null,"\u661F\u8F89",-1)),go=mt({__name:"Calculator",setup(n){const{exportImage:u}=Lu(),s=ht({id:"",title:"",selecteds:[],search:""}),o=W([]),l=tt(()=>o.value.filter(C=>C.title.indexOf(s.search)>-1)),x=async()=>{const e={id:Jt(),title:"\u6A21\u677F",basic:Pe(),state:Re(),enemyState:Ne(),items:Ge()};await Ve(e),o.value.push(e)},d=async C=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const b=o.value.findIndex(M=>M.id===C);b!==-1&&(await Ie(o.value[b].id),o.value.splice(b,1))},c=async C=>{const e=s.title;if(!e){j();return}const b=o.value.findIndex(Y=>Y.id===C);if(b===-1)return;const M=o.value[b];M.title=e,j(),await gt(M)},j=()=>{s.id="",s.title=""},y=C=>{try{u(C)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},$=C=>{const e={type:"calculator",data:[C]},b=new Blob([JSON.stringify(e)],{type:"application/json"});Vt(b,`${C.title}.json`)},H=async C=>{o.value=C},_=C=>new Promise((e,b)=>{const M=new FileReader;M.onload=()=>{e(M.result)},M.onerror=()=>{b(M.error)},M.readAsText(C)}),p=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let e=l.value;s.selecteds.length>0&&(e=s.selecteds.map(b=>l.value[b]).filter(b=>b)),await He(e.map(b=>b.id)),P()},E=async C=>{const e=C.currentTarget,b=Array.prototype.slice.call(e.files);if(e.value="",!b||!b[0])return;const M=b[0],Y=await _(M),nt=JSON.parse(Y);let rt=[];if(pe(nt))rt=nt;else if(Lt(nt)&&nt.type==="calculator")rt=nt.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Te(rt),P()},k=async()=>{let C="calculator.json",e=l.value;s.selecteds.length>0&&(e=s.selecteds.map(Y=>l.value[Y]).filter(Y=>Y),C="calculator-selected.json");const b={type:"calculator",data:e},M=new Blob([JSON.stringify(b)],{type:"application/json"});Vt(M,C)};async function R(C,e){const b=o.value.findIndex(Y=>Y.id===e);b===-1||!o.value[b]||(o.value[b]=C,await gt(C))}const T=W(-1),S=ht({input:"2283/1.35*1.39",result:0}),{translate:N,level:A,xingyao:F,huazhen:i,xinghun:D,xinghui:h}=re(),V=C=>Math.ceil(C),O=ht({show:!1}),Ft=C=>{const e=N(C);dt.value&&dt.value(C,e)},dt=W(),at=W(!1),lt=W(),U=C=>{at.value=!0,lt.value=C},B=({item:C})=>{if(at.value=!1,lt.value){const e=lt.value,b=N(C);e.title==="\u6A21\u677F"&&(e.title=C.name),e.basic.w=Math.max(b.patt,b.matt),gt(e)}else Ft(C)},q=C=>{const e=kt.cloneDeep(C);e.id=Jt(),console.log(e),o.value.push(e),gt(e)};async function P(){const C=await Ue();s.selecteds=[],H(C)}return ce(()=>{P()}),(C,e)=>{const b=ft("c-col"),M=ft("c-row"),Y=ft("calc-input"),nt=ft("c-space"),rt=Gt("autofocus");return r(),v("div",Ou,[t("div",Ku,[t("div",Qu,[f(M,{flex:"",middle:"",gutter:16},{default:m(()=>[f(b,{flex:"0 0 auto"},{default:m(()=>[Xu]),_:1}),f(b,{flex:"0 0 auto"},{default:m(()=>[t("button",{class:"btn btn-sm btn-link",onClick:e[0]||(e[0]=g=>O.show=!O.show)},"\u9762\u677F"),s.selecteds.length>0?(r(),v("button",{key:0,class:"btn btn-success",onClick:e[1]||(e[1]=g=>s.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):Q("",!0)]),_:1}),f(b,{flex:"1 1 0"},{default:m(()=>[z(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":e[2]||(e[2]=g=>s.search=g)},null,512),[[ut,s.search]])]),_:1}),f(b,{flex:"0 0 auto"},{default:m(()=>[t("button",{class:"btn btn-danger",onClick:p},w(s.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Wu,[Zu,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:E},null,32)]),t("button",{class:"btn btn-success",onClick:k},w(s.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:e[3]||(e[3]=g=>x())},"\u6DFB\u52A0")]),_:1})]),_:1}),f(Gu,{show:O.show,"onUpdate:show":e[4]||(e[4]=g=>O.show=g),onReference:e[5]||(e[5]=g=>U()),onInit:e[6]||(e[6]=g=>dt.value=g)},null,8,["show"])]),t("div",Yu,[t("div",to,[f(Y,{modelValue:S.input,"onUpdate:modelValue":e[7]||(e[7]=g=>S.input=g),result:S.result,"onUpdate:result":e[8]||(e[8]=g=>S.result=g),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),eo,f(St,{readonly:"",value:V(S.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",so,[t("div",no,[(r(!0),v(I,null,J(a(l),(g,Ct)=>(r(),ot(a(de),{key:g.id,activeKey:Ct===T.value,onToggle:K=>T.value=K?Ct:-1},{header:m(()=>[f(M,{flex:"",middle:""},{default:m(()=>[f(b,null,{default:m(()=>[z(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":e[9]||(e[9]=K=>s.selecteds=K),value:Ct,onClick:e[10]||(e[10]=wt(()=>{},["stop"]))},null,8,uo),[[$t,s.selecteds]]),oo]),_:2},1024),f(b,null,{default:m(()=>[s.id===g.id?z((r(),v("input",{key:0,type:"text",class:"input","onUpdate:modelValue":e[11]||(e[11]=K=>s.title=K),onClick:e[12]||(e[12]=wt(()=>{},["stop"])),onKeypress:Ut(K=>c(g.id),["enter"])},null,40,ao)),[[ut,s.title],[rt]]):(r(),v("span",lo,w(g.title),1))]),_:2},1024),f(b,{class:"ml-4",onClick:e[13]||(e[13]=wt(()=>{},["stop"]))},{default:m(()=>[s.id===g.id?(r(),v("button",{key:0,class:"btn btn-sm btn-link",onClick:K=>c(g.id)},"\u786E\u8BA4",8,co)):(r(),v(I,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:K=>U(g)},"\u9009\u62E9",8,io),t("button",{class:"btn btn-sm btn-link",onClick:K=>{s.id=g.id,s.title=g.title}},[f(a(Se),{class:"svg-icon"}),po],8,ro),t("button",{class:"btn btn-sm btn-link",onClick:K=>q(g)},[f(a(Kt),{class:"svg-icon"}),fo],8,_o)],64))]),_:2},1024)]),_:2},1024)]),actions:m(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:K=>y(g)},"\u5BFC\u51FA\u56FE\u50CF",8,vo),t("button",{class:"btn btn-sm btn-success-outline",onClick:K=>$(g)},"\u5BFC\u51FA",8,ho),t("button",{class:"btn btn-sm btn-danger-outline",onClick:K=>d(g.id)},"\u5220\u9664",8,mo)]),default:m(()=>[Ct===T.value?(r(),ot(a(nn),{key:0,data:g,"onUpdate:data":K=>R(K,g.id)},null,8,["data","onUpdate:data"])):Q("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),f(a(hn),{show:at.value,"onUpdate:show":e[20]||(e[20]=g=>at.value=g),onClick:B},{extra:m(()=>[t("div",Fo,[f(nt,null,{default:m(()=>[t("label",null,[Bo,f(St,{class:"mini-input",min:"0",max:"70",value:a(A).v,"onUpdate:value":e[14]||(e[14]=g=>a(A).v=g)},null,8,["value"])]),t("label",null,[bo,f(St,{class:"mini-input",min:"0",max:"16",value:a(A).eq,"onUpdate:value":e[15]||(e[15]=g=>a(A).eq=g)},null,8,["value"])]),t("label",null,[$o,z(t("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=g=>xt(F)?F.value=g:null)},null,512),[[$t,a(F)]])]),t("label",null,[xo,z(t("input",{type:"checkbox","onUpdate:modelValue":e[17]||(e[17]=g=>xt(i)?i.value=g:null)},null,512),[[$t,a(i)]])]),t("label",null,[yo,z(t("input",{type:"checkbox","onUpdate:modelValue":e[18]||(e[18]=g=>xt(D)?D.value=g:null)},null,512),[[$t,a(D)]])]),t("label",null,[Co,z(t("input",{type:"checkbox","onUpdate:modelValue":e[19]||(e[19]=g=>xt(h)?h.value=g:null)},null,512),[[$t,a(h)]])])]),_:1})])]),_:1},8,["show"])])}}});const Uo=et(go,[["__scopeId","data-v-d8094890"]]);export{Uo as default};
