import{_ as st,J as Ot,o as r,c as v,f as t,K as Jt,L as Qt,M as Xt,N as dt,d as rt,r as Z,O as Rt,H as ut,g as w,P as Ct,G as It,b as vt,t as Wt,a as tt,e as h,w as F,u as a,k as O,Q as Zt,h as z,z as at,R as Mt,S as Yt,F as H,j as q,U as te,x as Q,V as gt,W as Gt,p as xt,m as wt,D as lt,T as Nt,E as yt,I as ee,n as se,X as ne,l as _t,q as $t,v as Tt,A as ht,Y as N,Z as oe,i as Bt}from"./index.js";import{D as ae,u as ue}from"./useHeroes.js";import{_ as Dt}from"./lodash.js";import le from"./InputNumber.js";import{b as qt,d as Ut,a as ce,i as ie}from"./shared.js";import{S as J,a as de}from"./star-crystals.js";import{s as jt}from"./data.js";const re=["width","height"],pe=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),_e=[pe];function fe(e,n,s,o,u,y){return r(),v("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},_e,8,re)}const ve=st(Ot,[["render",fe]]),he=["width","height"],me=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),be=[me];function Fe(e,n,s,o,u,y){return r(),v("svg",{width:e.width,height:e.height,viewBox:"0 0 32 32"},be,8,he)}const Be=st(Jt,[["render",Fe]]),$e=["width","height"],ye=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),Ce=[ye];function ge(e,n,s,o,u,y){return r(),v("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},Ce,8,$e)}const Lt=st(Qt,[["render",ge]]),xe=["width","height"],we=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),Ee=[we];function ke(e,n,s,o,u,y){return r(),v("svg",{width:e.width,height:e.height,viewBox:"0 0 24 24"},Ee,8,xe)}const De=st(Xt,[["render",ke]]);let St=0,Ht=0;const Ae=500;function Pt(){const e=Math.floor(new Date().getTime()/1e3);Ht===e?St++:St=0,Ht=e;const n=e.toString(16);return`${(Ae<<16|St&255).toString(16)}.${n}`}async function Se(){try{return await dt.getAll("calculator")}catch{return[]}}async function Me(e){try{await dt.add("calculator",JSON.parse(JSON.stringify(e)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function kt(e){try{await dt.put("calculator",JSON.parse(JSON.stringify(e)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ue(e){try{await dt.delete("calculator",e)}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ve(e){try{const o=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const u of e)await dt.wrap(o.put(u))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ie(e){try{const o=(await dt.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const u of e)await dt.wrap(o.delete(u))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}function Te(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function He(){return{a:0}}function Pe(){return{att:0}}function zt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function Re(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ge(){return[zt()]}function Ne(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const qe=rt({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(e,{emit:n}){const s=Z(),o=Z({}),u=Z(e.active),y=()=>{const C=s.value.getBoundingClientRect();switch(u.value=!0,n("update:active",u.value),e.dir){case"left":o.value={top:`${C.top+C.height/2}px`,right:`${window.innerWidth-C.left-4}px`,maxWidth:"100%"};break;case"right":o.value={top:`${C.top+C.height/2}px`,left:`${C.right+4}px`,maxWidth:"100%"};break;case"top":o.value={bottom:`${window.innerHeight-C.top-4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"};break;default:o.value={top:`${C.bottom+4}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"}}};let i;const d=()=>{i=window.setTimeout(y,e.wait)},g=()=>{clearTimeout(i),u.value=!1,n("update:active",u.value)};return Rt(()=>e.active,S=>{u.value=S}),{el:s,style:o,tActive:u,onEnter:d,onOut:g}}});const je={class:"c-tooltip-label"};function Le(e,n,s,o,u,y){return r(),v("div",{ref:"el",class:Ct(["c-tooltip",{active:e.tActive,inline:e.inline}]),onMouseenter:n[0]||(n[0]=(...i)=>e.onEnter&&e.onEnter(...i)),onMouseout:n[1]||(n[1]=(...i)=>e.onOut&&e.onOut(...i))},[ut(e.$slots,"label",{},()=>[t("div",je,w(e.label),1)]),t("div",{class:Ct(["c-tooltip-inner",e.dir?`c-tooltip-${e.dir}`:"c-tooltip-bottom",e.color?`c-tooltip-${e.color}`:""]),style:It(e.style)},[ut(e.$slots,"default")],6)],34)}const pt=st(qe,[["render",Le]]),nt=e=>(xt("data-v-a6a2fd75"),e=e(),wt(),e),ze=["onKeypress"],Ke=["onKeypress"],Oe=nt(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),Je=Q(" \u514B\u523630%"),Qe=nt(()=>t("br",null,null,-1)),Xe=Q("\u88AB\u514B\u5236-25%"),We=nt(()=>t("br",null,null,-1)),Ze=Q("\u6FC0\u836150% "),Ye=["onClick"],ts=["onClick"],es={class:"row"},ss={class:"col-item"},ns=nt(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),os=Q(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),as={class:"input-group"},us=["step"],ls=nt(()=>t("div",{class:"input-ext"},"\u500D",-1)),cs={class:"label"},is={class:"input-group"},ds=nt(()=>t("div",{style:{clear:"both"}},null,-1)),rs={class:"col-item"},ps=nt(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),_s=Q(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),fs={class:"input-group"},vs=["step"],hs=nt(()=>t("div",{class:"input-ext"},"\u500D",-1)),ms={class:"label"},bs={class:"input-group"},Fs={class:"col-item"},Bs=nt(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),$s={class:"static-control text-center"},ys={class:"darkgold"},Cs=nt(()=>t("div",{style:{clear:"both"}},null,-1)),gs={class:"label"},xs={class:"bold darkgold"},ws=nt(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),Es={class:"static-control text-center"},ks={class:"bold darkgold"},Ds={class:"bold red"},As={class:"label bold"},Ss={class:"static-control text-center"},Ms={class:"bold darkgold"},Us={key:0,class:"bold red"},Vs=rt({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(e,{emit:n}){const s=e,o=vt({editor:!1,name:"",desc:{f:!1,v:""}}),u=vt(Re()),y=Wt(s,"itemState"),i=()=>{n("update:itemState",y.value)},d=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],g=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],S=tt(()=>{const{state:m}=s,c=(100+u.att)/100;return Math.ceil(m.att*c)}),C=tt(()=>{const{state:m}=s,c=(100+u.att+u.att2)/100;return Math.ceil(m.att*c)}),P=()=>{const{enemyState:m}=s,c=y.value,D=(100+c.kz)/100,b=(100+u.da-m.ra)/100,U=(100+u.da+u.da2-m.ra)/100,et=(100+u.db-m.rb)/100,ct=(100+u.dc)/100,T=(100+u.dx)/100,$=(100+u.dx+u.dx2)/100,Y=(100+u.cd)/100,L=(100-u.id)/100,Ft=(100+m.defGain)/100,p=(100+m.defGain+u.defGain)/100,B=Math.max(0,Math.max(0,m.def*Ft+m.defExt)*L),l=Math.max(0,Math.max(0,m.def*p+m.defExt)*L),A=Math.max(1,S.value*D-B),G=Math.max(1,C.value*D-l),W=A*c.a1*b*et*T,ot=Math.ceil(W*Y),it=G*c.a2*U*et*ct*$,x=Math.ceil(it*Y);return{r01:Math.ceil(W),r01c:ot,r02:Math.ceil(it),r02c:x}},f=tt(()=>P());function _(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${s.itemState.name}"\u5417\uFF1F`)&&n("close")}function E(){o.editor=!0,o.name=s.itemState.name}function k(){const m=o.name;if(o.editor=!1,o.name="",!m)return;const c=s.itemState;c.name=m,n("update:itemState",c)}function R(){o.desc.f=!0,o.desc.v=s.itemState.desc}function V(){const m=o.desc.v;if(o.desc.f=!1,o.desc.v="",!m)return;const c=s.itemState;c.desc=m,n("update:itemState",c)}function I(){n("up")}function j(){n("down")}function M(){n("copy")}return(m,c)=>{const D=Gt("autofocus");return r(),v(H,null,[h(a(te),{orientation:"left"},{action:F(()=>[t("span",{onClick:M},[h(a(Lt),{class:"close"})]),e.showUp?(r(),v("span",{key:0,onClick:I},[h(a(ve),{class:"close"})])):O("",!0),e.showDown?(r(),v("span",{key:1,onClick:j},[h(a(Be),{class:"close"})])):O("",!0),t("span",{onClick:_},[h(a(Zt),{class:"close"})])]),default:F(()=>[o.editor?z((r(),v("input",{key:0,class:"input",type:"text","onUpdate:modelValue":c[0]||(c[0]=b=>o.name=b),onKeypress:Mt(k,["enter"]),onBlur:k},null,40,ze)),[[at,o.name],[D]]):(r(),v("span",{key:1,class:"calc-item-title",onClick:E},w(a(y).name||"\u6A21\u677F"),1)),o.desc.f?z((r(),v("input",{key:2,class:"input",type:"text","onUpdate:modelValue":c[1]||(c[1]=b=>o.desc.v=b),onKeypress:Mt(V,["enter"]),onBlur:V},null,40,Ke)),[[at,o.desc.v],[D]]):(r(),v("span",{key:3,class:"calc-item-desc",onClick:R},w(a(y).desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),h(a(Yt),{style:{width:"120px"}},{default:F(()=>[h(a(pt),{dir:"top"},{label:F(()=>[Oe]),default:F(()=>[Je,Qe,Xe,We,Ze]),_:1}),t("div",null,[h(a(ae),null,{popover:F(({onClose:b})=>[t("div",{class:"list",onClick:U=>b()},[(r(),v(H,null,q([{label:"\u666E\u901A",value:0},{label:"\u514B\u5236",value:30},{label:"\u88AB\u514B\u5236",value:-25},{label:"\u6FC0\u8361",value:50}],({label:U,value:et})=>t("div",{key:U,class:"list-item",onClick:ct=>{a(y).kz=et,i()}},w(U),9,ts)),64))],8,Ye)]),default:F(()=>[z(t("input",{class:"input",type:"number","onUpdate:modelValue":c[2]||(c[2]=b=>a(y).kz=b)},null,512),[[at,a(y).kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",es,[t("div",ss,[h(a(pt),{dir:"top"},{label:F(()=>[ns]),default:F(()=>[os]),_:1}),t("div",as,[z(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[3]||(c[3]=b=>a(y).a1=b),onInput:i},null,40,us),[[at,a(y).a1,void 0,{number:!0}]]),ls])]),(r(),v(H,null,q(d,b=>t("div",{class:"col-item",key:b.name},[h(a(pt),{dir:"top"},{label:F(()=>[t("div",cs,w(b.label),1)]),default:F(()=>[Q(" "+w(b.tip),1)]),_:2},1024),t("div",is,[h(a(gt),{class:"input",modelValue:a(y)[b.name],"onUpdate:modelValue":U=>a(y)[b.name]=U,result:u[b.name],"onUpdate:result":[U=>u[b.name]=U,i]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),ds,t("div",rs,[h(a(pt),{dir:"top"},{label:F(()=>[ps]),default:F(()=>[_s]),_:1}),t("div",fs,[z(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[4]||(c[4]=b=>a(y).a2=b),onInput:i},null,40,vs),[[at,a(y).a2,void 0,{number:!0}]]),hs])]),(r(),v(H,null,q(g,b=>t("div",{class:"col-item",key:b.name},[h(a(pt),{dir:"top"},{label:F(()=>[t("div",ms,w(b.label),1)]),default:F(()=>[Q(" "+w(b.tip),1)]),_:2},1024),t("div",bs,[h(a(gt),{class:"input",modelValue:a(y)[b.name],"onUpdate:modelValue":U=>a(y)[b.name]=U,result:u[b.name],"onUpdate:result":[U=>u[b.name]=U,i]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Fs,[Bs,t("div",$s,[t("span",ys,w(a(S)),1)])]),Cs,(r(!0),v(H,null,q([a(f)],b=>(r(),v(H,null,[(r(!0),v(H,null,q([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:b.r01,v2:b.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:b.r02,v2:b.r02c}],(U,et)=>(r(),v("div",{class:"col-item",key:et},[t("div",gs,[t("span",xs,w(U.label),1),ws]),t("div",Es,[t("span",ks,w(U.v),1),t("span",Ds,"("+w(U.v2)+")",1)])]))),128)),(r(!0),v(H,null,q([{label:"\u4E0D\u66B4\u51FB",value:b.r01+b.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:b.r01c+b.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:b.r01+b.r02c},{label:"\u5168\u66B4\u51FB",value:b.r01c+b.r02c}],(U,et)=>(r(),v("div",{class:"col-item",key:et},[t("div",As,w(U.label),1),t("div",Ss,[t("span",Ms,w(U.value),1),(+e.enemyState.hp||0)<=U.value?(r(),v("span",Us," \u51FB\u6740 ")):O("",!0)])]))),128))],64))),256))])],64)}}});const Is=st(Vs,[["__scopeId","data-v-a6a2fd75"]]),At=e=>(xt("data-v-bd82d11d"),e=e(),wt(),e),Ts=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Hs={class:"row"},Ps={class:"label"},Rs={class:"input-group"},Gs=["step","onUpdate:modelValue","onChange"],Ns=["value"],qs={class:"col-item"},js=At(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Ls={class:"static-control text-center"},zs={class:"darkgold"},Ks=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),Os={class:"row"},Js={class:"label"},Qs={key:1,class:"label"},Xs={class:"input-group"},Ws={key:0,class:"input-ext"},Zs=At(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),Ys=rt({__name:"Calculator",props:{data:null},emits:["update:data"],setup(e,{emit:n}){const s=e,o=tt(()=>s.data.basic),u=tt(()=>s.data.state),y=tt(()=>s.data.enemyState),i=tt(()=>s.data.items),d=vt(He()),g=vt({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),S=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],C=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],P=()=>{const M=o.value.c/100;o.value.g=Math.ceil(d.a+o.value.w*M+o.value.x),u.value.att=o.value.w+o.value.g},f=async()=>{n("update:data",s.data)},_=(M,m)=>{m==="panel"&&P(),f()},E=(M,m)=>{const c=s.data.items;!c||(c[m]=M,f())},k=()=>{const M=s.data.items;!M||(M.push(zt()),f())},R=M=>{const m=s.data.items;!m||(m.splice(M,1),f())},V=M=>{const m=s.data.items;if(!m)return;const c=m[M],D=m[M-1];m[M-1]=c,m[M]=D,f()},I=M=>{const m=s.data.items;if(!m)return;const c=m[M],D=m[M+1];m[M+1]=c,m[M]=D,f()},j=M=>{const m=s.data.items;if(!m)return;const c=m[M];m.push(Dt.cloneDeep(c)),f()};return Rt(()=>[s.data.basic.w],()=>{P()}),(M,m)=>(r(),v("div",null,[Ts,t("div",Hs,[(r(),v(H,null,q(S,c=>t("div",{class:"col-item",key:c.name},[t("div",Ps,w(c.label),1),t("div",Rs,[c.name in d?(r(),lt(a(gt),{key:0,modelValue:a(o)[c.name],"onUpdate:modelValue":D=>a(o)[c.name]=D,result:d[c.name],"onUpdate:result":D=>d[c.name]=D,onChange:D=>_(c.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):z((r(),v("input",{key:1,type:"number",class:"input",style:It({textAlign:c.align}),min:"0",step:c.step,"onUpdate:modelValue":D=>a(o)[c.name]=D,onChange:D=>_(c.name,"panel")},null,44,Gs)),[[at,a(o)[c.name],void 0,{number:!0}]]),c.name==="w"?(r(),v("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${a(o).g}`},null,8,Ns)):O("",!0)])])),64)),t("div",qs,[js,t("div",Ls,[t("span",zs,w(a(u).att),1)])])]),Ks,t("div",Os,[(r(),v(H,null,q(C,c=>t("div",{class:"col-item",key:c.name},[c.tips?(r(),lt(a(pt),{key:0,dir:"top"},{label:F(()=>[t("div",Js,w(c.label),1)]),default:F(()=>[Q(" "+w(c.tips),1)]),_:2},1024)):(r(),v("div",Qs,w(c.label),1)),t("div",Xs,[h(a(gt),{modelValue:a(y)[c.name],"onUpdate:modelValue":D=>a(y)[c.name]=D,result:g[c.name],"onUpdate:result":D=>g[c.name]=D,onChange:D=>_(c.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),c.precent?(r(),v("div",Ws,"%")):O("",!0)])])),64))]),t("div",{class:"heading"},[Zs,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:k},"\u6DFB\u52A0")])]),(r(!0),v(H,null,q(a(i),(c,D)=>(r(),lt(Is,{key:c,panel:a(o),state:a(u),enemyState:g,itemState:c,showUp:D>0,showDown:a(i)&&D<a(i).length-1,"onUpdate:itemState":b=>E(b,D),onClose:b=>R(D),onUp:b=>V(D),onDown:b=>I(D),onCopy:b=>j(D)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const tn=st(Ys,[["__scopeId","data-v-bd82d11d"]]),en=rt({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(e,{emit:n}){return{wrapClass:tt(()=>["c-action-sheet-wrapper",e.class,{show:e.show}]),onClick:(y,i)=>{n("click",{item:y,index:i}),n("close",!1)},onClose:()=>{n("update:show",!1),n("close",!1)}}}});const sn={class:"c-action-sheet-section"},nn={class:"c-action-sheet-extra"},on={class:"c-action-sheet-list"},an=["onClick"];function un(e,n,s,o,u,y){return r(),lt(Nt,{to:"body"},[t("div",{class:Ct(e.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:n[0]||(n[0]=(...i)=>e.onClose&&e.onClose(...i))}),t("div",sn,[t("div",{class:"c-action-sheet-body",style:It({maxHeight:e.height})},[t("div",nn,[ut(e.$slots,"extra")]),t("div",on,[(r(!0),v(H,null,q(e.list,(i,d)=>(r(),v("div",{class:"c-action-sheet-item",key:d,onClick:g=>e.onClick(i,d)},[ut(e.$slots,"default",{record:i})],8,an))),128))])],4)])],2)])}const Vt=st(en,[["render",un]]);Vt.install=e=>{e.component("action-sheet",Vt)};const ln={class:"hero-item"},cn={class:"hero-item__inner"},dn=["src"],rn=["src","alt","title"],pn={class:"hero-item__label"},_n=rt({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(e,{emit:n}){const{heroes:s,getHeroIcon:o,getHeroIconBg:u}=ue(),y=i=>{n("click",i)};return(i,d)=>(r(),lt(a(Vt),{class:"hero-select",show:e.show,list:a(s),height:"80vh",onClick:y,"onUpdate:show":d[0]||(d[0]=g=>i.$emit("update:show",g))},{extra:F(()=>[ut(i.$slots,"extra")]),default:F(({record:g})=>[t("div",ln,[t("div",cn,[t("img",{src:a(u)(g)},null,8,dn),t("img",{src:a(o)(g),alt:g.name,title:g.name},null,8,rn),t("div",pn,w(g.name),1)])])]),_:3},8,["show","list"]))}});const fn=rt({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(e,{emit:n}){const s=tt({get:()=>e.activeKey,set:u=>{n("update:activeKey",u)}});return{active:s,toggle:()=>{const u=!s.value;s.value=u,n("toggle",u)}}}});const vn=e=>(xt("data-v-829ec263"),e=e(),wt(),e),hn=vn(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),mn={class:"panel-title"},bn={class:"panel-body"},Fn={class:"panel-content"};function Bn(e,n,s,o,u,y){return r(),v("div",{class:Ct(["panel",{active:e.active}])},[t("div",{class:"panel-header",onClick:n[1]||(n[1]=(...i)=>e.toggle&&e.toggle(...i))},[hn,t("div",mn,[ut(e.$slots,"header",{},()=>[Q(w(e.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:n[0]||(n[0]=yt(()=>{},["stop"]))},[ut(e.$slots,"actions",{},void 0,!0)])]),t("div",bn,[t("div",Fn,[ut(e.$slots,"default",{},void 0,!0)])])],2)}const $n=st(fn,[["render",Bn],["__scopeId","data-v-829ec263"]]);function yn(){const e="red_team",n=ee(),s=Z([]),o=Z(!1),u=Z(),y=async f=>{const E=(await n.transaction(e,"readwrite")).objectStore(e),k=await n.wrap(E.put(f));return s.value.find(V=>V._id===f._id)||(f._id=k,s.value.push(f)),k},i=async f=>{const E=(await n.transaction(e,"readwrite")).objectStore(e);await n.wrap(E.delete(f._id)),s.value=s.value.filter(k=>k._id!==f._id)},d=async f=>{const _=await n.transaction(e,"readwrite"),E=_.objectStore(e);for(const k of f)await n.wrap(E.put(k));await n.twrap(_),await S()},g=async()=>{const _=(await n.transaction(e,"readwrite")).objectStore(e);await n.wrap(_.clear()),s.value=[]},S=async()=>{const _=(await n.transaction(e,"readonly")).objectStore(e),E=await n.wrap(_.getAll()).catch(()=>[]);E.forEach(k=>{k.scList||(k.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}])}),s.value=E},C=async f=>{const _=JSON.parse(await f.text());if(!qt(_)||_.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const E=_.data;E.forEach(k=>delete k._id),await d(E)},P=async()=>{const f={type:"red_team",data:s.value},_=new Blob([JSON.stringify(f)],{type:"application/json"});Ut(_,"red_team.json")};return S(),{scShow:o,scSelected:u,put:y,del:i,puts:d,clear:g,all:S,list:s,importData:C,exportData:P}}const mt=e=>e%1>.5?Math.ceil(e):Math.floor(e);function Cn(){const e=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),n=Z(e()),s=tt(()=>{const i=[0,0,0,0,0,0];return n.value.scList.forEach(d=>{!d.v||(i[0]+=d.v.qixue,i[1]+=d.v.patt,i[2]+=d.v.pdef,i[3]+=d.v.matt,i[4]+=d.v.mdef,i[5]+=d.v.huixin)}),i}),o=tt(()=>{const i=n.value,d={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},g=jt.find(P=>i.stoneName===P.name);g&&(d.qixue=g.t[0]+g.d[0]+g.h[0],d.patt=g.t[1]+g.d[1]+g.h[1],d.matt=g.t[2]+g.d[2]+g.h[2],d.pdef=g.t[3]+g.d[3]+g.h[3],d.mdef=g.t[4]+g.d[4]+g.h[4]);const S={qixue:i.hsQixue/100,patt:i.hsPatt/100,pdef:i.hsPdef/100,matt:i.hsMatt/100,mdef:i.hsMdef/100,huixin:i.hsHuixin/100},C=s.value;return{qixue:mt(i.qixue*S.qixue+d.qixue+C[0]),patt:mt(i.patt*S.patt+d.patt+C[1]),pdef:mt(i.pdef*S.pdef+d.pdef+C[2]),matt:mt(i.matt*S.matt+d.matt+C[3]),mdef:mt(i.mdef*S.mdef+d.mdef+C[4]),huixin:mt(i.huixin*S.huixin+d.huixin+C[5])}}),u=tt(()=>{const i=o.value,d={qixue:(100+n.value.rQixue)/100,patt:(100+n.value.rPatt)/100,pdef:(100+n.value.rPdef)/100,matt:(100+n.value.rMatt)/100,mdef:(100+n.value.rMdef)/100,huixin:(100+n.value.rHuixin)/100};return{qixue:Math.round((n.value.qixue+i.qixue)*d.qixue),patt:Math.round((n.value.patt+i.patt)*d.patt),pdef:Math.round((n.value.pdef+i.pdef)*d.pdef),matt:Math.round((n.value.matt+i.matt)*d.matt),mdef:Math.round((n.value.mdef+i.mdef)*d.mdef),huixin:Math.round((n.value.huixin+i.huixin)*d.huixin)}});return{state:n,pValue:o,ckValue:u,scSum:s,reset:()=>{n.value=e()},defState:e}}const gn={},xn={class:"c-upload"};function wn(e,n){return r(),v("div",xn,[ut(e.$slots,"default",{},void 0,!0),t("input",se({type:"file",class:"c-upload-input",accept:"application/json"},e.$attrs),null,16)])}const En=st(gn,[["render",wn],["__scopeId","data-v-b3879154"]]),X=e=>(xt("data-v-fc55a9ed"),e=e(),wt(),e),kn={class:"transform-tools-popover"},Dn={class:"transform-tools-popover-toolbar"},An=["value"],Sn=["value"],Mn=X(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Un={class:"transform-tools-popover-content"},Vn={class:"grid-group"},In={class:"grid-group-item"},Tn={class:"input-group-title"},Hn=X(()=>t("span",null,"\u57FA\u7840",-1)),Pn={class:"grids"},Rn={class:"input-label"},Gn={class:"input-group"},Nn={class:"input green"},qn={class:"grid-group-item"},jn={class:"input-group-title"},Ln=X(()=>t("span",null,"\u9B42\u77F3",-1)),zn=X(()=>t("option",{value:""},"\u65E0",-1)),Kn=["value"],On={class:"grids"},Jn=X(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),Qn=X(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),Xn=X(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),Wn=X(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),Zn=X(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),Yn={class:"grid-group-item"},to={class:"input-group-title"},eo=Q(" \u661F\u4E4B\u6676 "),so=X(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),no=X(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),oo=X(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),ao={class:"grids"},uo=["onClick","onContextmenu"],lo={key:0},co={key:1},io={key:2},ro={key:3},po={key:4},_o={key:5},fo={key:1},vo={class:"grid-group-item"},ho=X(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),mo={class:"grids"},bo={class:"input-label"},Fo={class:"input"},Bo={class:"grid-group-item"},$o=X(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),yo={class:"grids"},Co={class:"input-label"},go={class:"grid-group-item"},xo=X(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),wo={class:"grids"},Eo={class:"input-label"},ko={class:"input"},Do=rt({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(e,{emit:n}){const{state:s,pValue:o,ckValue:u,scSum:y,reset:i,defState:d}=Cn(),{list:g,put:S,del:C,clear:P,importData:f,exportData:_}=yn(),E=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],k=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],R=Z(!1),V=Z(),I=T=>{V.value=T,R.value=!0},j=T=>{!V.value||(V.value.v=T)},M=()=>{const T=Dt.cloneDeep(s.value);S(T).then($=>{s.value._id=$,alert("\u5DF2\u4FDD\u5B58")}).catch($=>{console.log($),alert("\u4FDD\u5B58\u5931\u8D25")})},m=()=>{const T=Dt.cloneDeep(s.value);delete T._id,T.name+=" copy",S(T).then($=>{T._id=$,s.value=T}).catch($=>{console.log($),alert("\u590D\u5236\u5931\u8D25")})},c=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||C(s.value).then(()=>{i()}).catch($=>{console.log($),alert("\u5220\u9664\u5931\u8D25")})},D=T=>{const $=T.currentTarget;if(!$.files)return;const Y=Array.prototype.slice.call($.files);$.value="",Y[0]&&f(Y[0])},b=()=>{_()},U=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||P().catch($=>{console.log($),alert("\u6E05\u7A7A\u5931\u8D25")})},et=(T,$)=>{s.value.name=T,s.value.qixue=$.qixue,s.value.patt=$.patt,s.value.pdef=$.pdef,s.value.matt=$.matt,s.value.mdef=$.mdef,s.value.huixin=$.huixin},ct=()=>{n("reference")};return n("init",et),(T,$)=>{const Y=_t("c-col"),L=_t("c-space"),Ft=_t("c-row");return z((r(),v("div",kn,[t("div",Dn,[h(Ft,{flex:"",middle:"",gutter:8},{default:F(()=>[h(Y,null,{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:ct},"\u53C2\u8003")]),_:1}),h(Y,null,{default:F(()=>[Q("ID: "+w(a(s)._id),1)]),_:1}),h(Y,{flex:"1 1 auto"},{default:F(()=>[h(L,null,{default:F(()=>[z(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":$[0]||($[0]=p=>$t(s)?s.value=p:null)},[t("option",{value:a(d)()},"\u7A7A\u6A21\u7248",8,An),(r(!0),v(H,null,q(a(g),p=>(r(),v("option",{key:p._id,value:p},w(p.name),9,Sn))),128))],512),[[Tt,a(s)]]),t("button",{class:"btn btn-sm btn-primary",onClick:M},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:m},"\u590D\u5236"),a(s)._id?(r(),v("button",{key:0,class:"btn btn-sm btn-danger",onClick:c},"\u5220\u9664")):O("",!0),h(En,{onChange:D},{default:F(()=>[Mn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:b},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:U},"\u6E05\u7A7A")]),_:1})]),_:1}),h(Y,null,{default:F(()=>[t("span",{class:"transform-tools-popover-close",onClick:$[1]||($[1]=p=>n("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Un,[t("div",Vn,[t("div",In,[t("div",Tn,[h(L,null,{default:F(()=>[Hn,z(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":$[2]||($[2]=p=>a(s).name=p)},null,512),[[at,a(s).name]])]),_:1})]),t("div",Pn,[(r(),v(H,null,q(E,p=>h(L,{key:p.n},{default:F(()=>[t("label",Rn,w(p.t),1),t("div",Gn,[h(a(ht),{readonly:"",value:a(s)[p.n]},null,8,["value"]),t("div",Nn,"+"+w(a(o)[p.n]),1)])]),_:2},1024)),64))])]),t("div",qn,[t("div",jn,[h(L,null,{default:F(()=>[Ln,z(t("select",{class:"input input-select","onUpdate:modelValue":$[3]||($[3]=p=>a(s).stoneName=p)},[zn,(r(!0),v(H,null,q(a(jt),(p,B)=>(r(),v("option",{key:B,value:p.name},w(p.name),9,Kn))),128))],512),[[Tt,a(s).stoneName]])]),_:1})]),t("div",On,[h(L,null,{default:F(()=>[Jn,h(a(ht),{value:a(s).hsQixue,"onUpdate:value":$[4]||($[4]=p=>a(s).hsQixue=p)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[Qn,h(a(ht),{value:a(s).hsPatt,"onUpdate:value":$[5]||($[5]=p=>a(s).hsPatt=p)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[Xn,h(a(ht),{value:a(s).hsPdef,"onUpdate:value":$[6]||($[6]=p=>a(s).hsPdef=p)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[Wn,h(a(ht),{value:a(s).hsMatt,"onUpdate:value":$[7]||($[7]=p=>a(s).hsMatt=p)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[Zn,h(a(ht),{value:a(s).hsMdef,"onUpdate:value":$[8]||($[8]=p=>a(s).hsMdef=p)},null,8,["value"])]),_:1})])]),t("div",Yn,[t("div",to,[eo,h(a(pt),{label:"?",inline:"",dir:"right"},{default:F(()=>[so,no,oo]),_:1})]),t("div",ao,[(r(!0),v(H,null,q(a(s).scList,(p,B)=>(r(),v("div",{key:B,class:Ct(["sc-props",{selected:V.value===p,s1:a(J).ATT===p.pos,s2:a(J).XUE===p.pos,s3:a(J).DEF===p.pos}]),onClick:l=>I(p),onContextmenu:yt(l=>p.v=void 0,["prevent"])},[p.v?(r(),v(H,{key:0},[p.v.qixue>0?(r(),v("span",lo,"\u6C14\u8840+"+w(p.v.qixue),1)):O("",!0),p.v.patt>0?(r(),v("span",co,"\u7269\u653B+"+w(p.v.patt),1)):O("",!0),p.v.pdef>0?(r(),v("span",io,"\u7269\u9632+"+w(p.v.pdef),1)):O("",!0),p.v.matt>0?(r(),v("span",ro,"\u6CD5\u653B+"+w(p.v.matt),1)):O("",!0),p.v.mdef>0?(r(),v("span",po,"\u6CD5\u9632+"+w(p.v.mdef),1)):O("",!0),p.v.huixin>0?(r(),v("span",_o,"\u4F1A\u5FC3+"+w(p.v.huixin),1)):O("",!0)],64)):(r(),v("span",fo,w(p.n),1))],42,uo))),128))]),(r(),lt(Nt,{to:"body"},[V.value?(r(),lt(a(de),{key:0,show:R.value,"onUpdate:show":$[9]||($[9]=p=>R.value=p),position:V.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:j},null,8,["show","position"])):O("",!0)]))]),t("div",vo,[ho,t("div",mo,[(r(),v(H,null,q(E,(p,B)=>h(L,{key:B},{default:F(()=>[t("label",bo,w(p.t),1),t("div",Fo,"+"+w(a(y)[B]),1)]),_:2},1024)),64))])]),t("div",Bo,[$o,t("div",yo,[(r(),v(H,null,q(k,(p,B)=>h(L,{key:B},{default:F(()=>[t("label",Co,w(p.t),1),h(a(gt),{modelValue:a(s)[p.c],"onUpdate:modelValue":l=>a(s)[p.c]=l,result:a(s)[p.r],"onUpdate:result":l=>a(s)[p.r]=l},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",go,[xo,t("div",wo,[(r(),v(H,null,q(E,p=>h(L,{key:p.n},{default:F(()=>[t("label",Eo,w(p.t),1),t("div",ko,w(a(u)[p.n]),1)]),_:2},1024)),64))])])])])],512)),[[ne,e.show]])}}});const Ao=st(Do,[["__scopeId","data-v-fc55a9ed"]]);function ft(e){return(e%1>.5?Math.ceil:Math.floor)(e)}function Kt(e){const{basic:n,enemyState:s}=e,o={w:n.w,a:N(n.a),c:n.c,x:n.x,g:0,att:0};o.g=ft(n.w*n.c/100+o.a+o.x),o.att=n.w+o.g;const u={hp:N(s.hp),ra:N(s.ra),rb:N(s.rb),def:N(s.def),defExt:N(s.defExt),defGain:N(s.defGain)};return{b:o,e:u}}function So(e,n){const{b:s,e:o}=Kt(e),u={a1:n.a1,a2:n.a2,att:N(n.att),att2:N(n.att2),da:N(n.da),da2:N(n.da2),db:N(n.db),dc:N(n.dc),dx:N(n.dx),dx2:N(n.dx2),id:N(n.id),cd:N(n.cd),defGain:N(n.defGain),kz:n.kz||0},y=s.att*(100+u.att)/100,i=s.att*(100+u.att+u.att2)/100,d=(100+u.kz)/100,g=(100+u.da-o.ra)/100,S=(100+u.da+u.da2-o.ra)/100,C=(100+u.db-o.rb)/100,P=(100+u.dc)/100,f=(100+u.dx)/100,_=(100+u.dx+u.dx2)/100,E=(100+u.cd)/100,k=(100-u.id)/100,R=(100+o.defGain)/100,V=(100+o.defGain+u.defGain)/100,I=Math.max(0,Math.max(0,o.def*R+o.defExt)*k),j=Math.max(0,Math.max(0,o.def*V+o.defExt)*k),M=Math.max(1,y*d-I),m=Math.max(1,i*d-j),c=M*u.a1*g*C*f,D=ft(c*E),b=m*u.a2*S*C*P*_,U=ft(b*E);return{satt:y,satt2:i,r01:ft(c),r01c:D,r02:ft(b),r02c:U}}function Mo(e){const n=e.items||[],s=document.createElement("canvas");s.width=800,s.height=8+160+n.reduce((_,E)=>{let k=30;return k+=50,E.a1>0&&(k+=30),E.a2>0&&(k+=50),(E.a1>0||E.a2>0)&&(k+=20),E.a1>0&&E.a2>0&&(k+=20),k+=20,_+k},0)+8;const o=s.getContext("2d");if(!o)return;const u=e.basic,y=e.enemyState,{b:i}=Kt(e),d={x:0,y:0},g=(_,E,k)=>{k?(d.x+=_,d.y+=E):(d.x=_,d.y=E)},S=(_=0)=>{d.x=8+_*16},C=(_=0)=>{d.x=8,d.y+=_},P=(_,E="#222222")=>{o.save(),o.fillStyle=E;const{width:k}=o.measureText(_);o.fillText(_,d.x,d.y),d.x+=k+16,o.restore()},f=(_,...E)=>{o.save();const k=typeof _=="string"?_:_[0],R=typeof _=="string"?"#222222":_[1];o.fillStyle=R,o.font="bold 16px sans-serif";const{width:V}=o.measureText(k);o.fillText(k,d.x,d.y),d.x+=V+8,o.restore(),o.save(),o.font="16px sans-serif";for(const I of E){const j=typeof I=="string"?I:I[0],M=typeof I=="string"?"#ff4446":I[1];o.fillStyle=M;const{width:m}=o.measureText(j);o.fillText(j,d.x,d.y),d.x+=m+8}d.x+=8,o.restore()};o.fillStyle="#FBFFF0",o.fillRect(0,0,s.width,s.height),g(8,28),o.textBaseline="bottom",o.font="bold 20px sans-serif",P(e.title),C(40),o.font="bold 18px sans-serif",P("\u653B\u65B9:"),o.font="16px sans-serif",C(30),S(2),f("\u653B\u51FB:",`${u.w}`,[`+${i.g}`,"#55a14f"]),f("\u9B42\u77F3\u653B\u51FB:",`${u.a}`),f("\u9B42\u77F3\u653B\u51FB%:",`${u.c}`),f("\u661F\u4E4B\u6676\u653B\u51FB:",`${u.x}`),C(30),o.font="bold 18px sans-serif",P("\u5B88\u65B9:"),C(30),S(2),f("\u6C14\u8840:",`${y.hp}`),f("\u9632\u5FA1:",`${y.def}`),f("\u9632\u5FA1%:",`${y.defGain}`),f("\u9644\u52A0\u9632\u5FA1:",`${y.defExt}`),C(20),S(2),f("\u514D\u4F24A%:",`${y.ra}`),f("\u514D\u4F24B%:",`${y.rb}`),C(30);for(const _ of n){const{satt:E,satt2:k,r01:R,r01c:V,r02:I,r02c:j}=So(e,_);o.font="bold 18px sans-serif",P(_.name,"#a30000"),o.font="14px sans-serif",P(_.desc||"\u65E0\u63CF\u8FF0","#a30000"),o.font="16px sans-serif",f("\u514B\u5236:",`${_.kz||0}%`),C(30),S(2),f("\u653B\u51FB%:",`${_.att}`),f("\u7A7F\u900F%:",`${_.id}`),f("\u66B4\u4F24%:",`${_.cd}`),C(20),S(2),f("\u589E\u4F24A%:",`${_.da}`),f("\u589E\u4F24B%:",`${_.db}`),f("\u589E\u4F24X%:",`${_.dx}`),C(30),_.a1>0&&(S(2),f("\u6280\u80FD\u3001\u666E\u653B:",`${_.a1}\u500D`),f("\u653B\u51FB:",[`${ft(E)}`,"#b8860b"]),C(30)),_.a2>0&&(S(2),f("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${_.a2}\u500D`),f("\u653B\u51FB\u4FEE\u6B63%:",_.att2),f("\u9632\u5FA1\u4FEE\u6B63%:",_.defGain),f("\u653B\u51FB:",[`${ft(k)}`,"#b8860b"]),C(20),S(2),f("\u589E\u4F24C%:",_.dc),f("\u589E\u4F24A\u4FEE\u6B63%:",_.da2),f("\u589E\u4F24X\u4FEE\u6B63%:",_.dx2),C(30)),S(2),R>0&&f(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${R}`,"#b8860b"],[`${V}`,"#ff4446"]),I>0&&f(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${I}`,"#b8860b"],[`${j}`,"#ff4446"]),C(20),R>0&&I>0&&(S(2),f(["\u4E0D\u66B4\u51FB","#b8860b"],[`${R+I}`,"#ff4446"]),f(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${V+I}`,"#ff4446"]),f(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${R+j}`,"#ff4446"]),f(["\u5168\u66B4\u51FB","#b8860b"],[`${V+j}`,"#ff4446"]),C(20)),C(20)}s.toBlob(_=>{!_||window.open(URL.createObjectURL(_))})}function Uo(){return{exportImage:Mo}}const bt=e=>(xt("data-v-2cc2cbb6"),e=e(),wt(),e),Vo={class:"wrapper"},Io={class:"toolbar"},To={style:{padding:"6px 16px"}},Ho=Q("\u4F24\u5BB3\u8BA1\u7B97\u5668"),Po={class:"c-upload"},Ro=bt(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Go={style:{padding:"6px 16px"}},No={class:"input-group"},qo=bt(()=>t("div",{class:"input-ext"},"=",-1)),jo={class:"content"},Lo={class:"container"},zo=["value"],Ko=Q(" \u2007 "),Oo=["onKeypress"],Jo={key:1},Qo=["onClick"],Xo=["onClick"],Wo=["onClick"],Zo=Q(" \u91CD\u547D\u540D "),Yo=["onClick"],ta=Q(" \u590D\u5236 "),ea=["onClick"],sa=["onClick"],na=["onClick"],oa={style:{"text-align":"center"}},aa=bt(()=>t("span",null,"\u661F\u8000",-1)),ua=bt(()=>t("span",null,"\u5316\u81FB",-1)),la=bt(()=>t("span",null,"\u661F\u9B42",-1)),ca=bt(()=>t("span",null,"\u661F\u8F89",-1)),ia=rt({__name:"Calculator",setup(e){const{exportImage:n}=Uo(),s=vt({id:"",title:"",selecteds:[],search:""}),o=Z([]),u=tt(()=>o.value.filter(B=>B.title.indexOf(s.search)>-1)),y=async()=>{const l={id:Pt(),title:"\u6A21\u677F",basic:Te(),state:Pe(),enemyState:Ne(),items:Ge()};await Me(l),o.value.push(l)},i=async B=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const A=o.value.findIndex(G=>G.id===B);A!==-1&&(await Ue(o.value[A].id),o.value.splice(A,1))},d=async B=>{const l=s.title;if(!l){g();return}const A=o.value.findIndex(W=>W.id===B);if(A===-1)return;const G=o.value[A];G.title=l,g(),await kt(G)},g=()=>{s.id="",s.title=""},S=B=>{try{n(B)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},C=B=>{const l={type:"calculator",data:[B]},A=new Blob([JSON.stringify(l)],{type:"application/json"});Ut(A,`${B.title}.json`)},P=async B=>{o.value=B},f=B=>new Promise((l,A)=>{const G=new FileReader;G.onload=()=>{l(G.result)},G.onerror=()=>{A(G.error)},G.readAsText(B)}),_=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let l=u.value;s.selecteds.length>0&&(l=s.selecteds.map(A=>u.value[A]).filter(A=>A)),await Ie(l.map(A=>A.id)),p()},E=async B=>{const l=B.currentTarget,A=Array.prototype.slice.call(l.files);if(l.value="",!A||!A[0])return;const G=A[0],W=await f(G),ot=JSON.parse(W);let it=[];if(ie(ot))it=ot;else if(qt(ot)&&ot.type==="calculator")it=ot.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Ve(it),p()},k=async()=>{let B="calculator.json",l=u.value;s.selecteds.length>0&&(l=s.selecteds.map(W=>u.value[W]).filter(W=>W),B="calculator-selected.json");const A={type:"calculator",data:l},G=new Blob([JSON.stringify(A)],{type:"application/json"});Ut(G,B)};async function R(B,l){const A=o.value.findIndex(W=>W.id===l);A===-1||!o.value[A]||(o.value[A]=B,await kt(B))}const V=Z(-1),I=vt({input:"2283/1.35*1.39",result:0}),{translate:j,xingyao:M,huazhen:m,xinghun:c,xinghui:D}=ce(),b=B=>Math.ceil(B),U=vt({show:!1}),et=B=>{const l=j(B);ct.value&&ct.value(B.name,l)},ct=Z(),T=Z(!1),$=Z(),Y=B=>{T.value=!0,$.value=B},L=({item:B})=>{if(T.value=!1,$.value){const l=$.value,A=j(B);l.title==="\u6A21\u677F"&&(l.title=B.name),l.basic.w=Math.max(A.patt,A.matt),kt(l)}else et(B)},Ft=B=>{const l=Dt.cloneDeep(B);l.id=Pt(),console.log(l),o.value.push(l),kt(l)};async function p(){const B=await Se();s.selecteds=[],P(B)}return oe(()=>{p()}),(B,l)=>{const A=_t("c-col"),G=_t("c-row"),W=_t("calc-input"),ot=_t("c-space"),it=Gt("autofocus");return r(),v("div",Vo,[t("div",Io,[t("div",To,[h(G,{flex:"",middle:"",gutter:16},{default:F(()=>[h(A,{flex:"0 0 auto"},{default:F(()=>[Ho]),_:1}),h(A,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:l[0]||(l[0]=x=>U.show=!U.show)},"\u9762\u677F"),s.selecteds.length>0?(r(),v("button",{key:0,class:"btn btn-success",onClick:l[1]||(l[1]=x=>s.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):O("",!0)]),_:1}),h(A,{flex:"1 1 0"},{default:F(()=>[z(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":l[2]||(l[2]=x=>s.search=x)},null,512),[[at,s.search]])]),_:1}),h(A,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-danger",onClick:_},w(s.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",Po,[Ro,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:E},null,32)]),t("button",{class:"btn btn-success",onClick:k},w(s.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:l[3]||(l[3]=x=>y())},"\u6DFB\u52A0")]),_:1})]),_:1}),h(Ao,{show:U.show,"onUpdate:show":l[4]||(l[4]=x=>U.show=x),onReference:l[5]||(l[5]=x=>Y()),onInit:l[6]||(l[6]=x=>ct.value=x)},null,8,["show"])]),t("div",Go,[t("div",No,[h(W,{modelValue:I.input,"onUpdate:modelValue":l[7]||(l[7]=x=>I.input=x),result:I.result,"onUpdate:result":l[8]||(l[8]=x=>I.result=x),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),qo,h(le,{readonly:"",value:b(I.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",jo,[t("div",Lo,[(r(!0),v(H,null,q(a(u),(x,Et)=>(r(),lt(a($n),{key:x.id,activeKey:Et===V.value,onToggle:K=>V.value=K?Et:-1},{header:F(()=>[h(G,{flex:"",middle:""},{default:F(()=>[h(A,null,{default:F(()=>[z(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":l[9]||(l[9]=K=>s.selecteds=K),value:Et,onClick:l[10]||(l[10]=yt(()=>{},["stop"]))},null,8,zo),[[Bt,s.selecteds]]),Ko]),_:2},1024),h(A,null,{default:F(()=>[s.id===x.id?z((r(),v("input",{key:0,type:"text",class:"input","onUpdate:modelValue":l[11]||(l[11]=K=>s.title=K),onClick:l[12]||(l[12]=yt(()=>{},["stop"])),onKeypress:Mt(K=>d(x.id),["enter"])},null,40,Oo)),[[at,s.title],[it]]):(r(),v("span",Jo,w(x.title),1))]),_:2},1024),h(A,{class:"ml-4",onClick:l[13]||(l[13]=yt(()=>{},["stop"]))},{default:F(()=>[s.id===x.id?(r(),v("button",{key:0,class:"btn btn-sm btn-link",onClick:K=>d(x.id)},"\u786E\u8BA4",8,Qo)):(r(),v(H,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:K=>Y(x)},"\u9009\u62E9",8,Xo),t("button",{class:"btn btn-sm btn-link",onClick:K=>{s.id=x.id,s.title=x.title}},[h(a(De),{class:"svg-icon"}),Zo],8,Wo),t("button",{class:"btn btn-sm btn-link",onClick:K=>Ft(x)},[h(a(Lt),{class:"svg-icon"}),ta],8,Yo)],64))]),_:2},1024)]),_:2},1024)]),actions:F(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:K=>S(x)},"\u5BFC\u51FA\u56FE\u50CF",8,ea),t("button",{class:"btn btn-sm btn-success-outline",onClick:K=>C(x)},"\u5BFC\u51FA",8,sa),t("button",{class:"btn btn-sm btn-danger-outline",onClick:K=>i(x.id)},"\u5220\u9664",8,na)]),default:F(()=>[Et===V.value?(r(),lt(a(tn),{key:0,data:x,"onUpdate:data":K=>R(K,x.id)},null,8,["data","onUpdate:data"])):O("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),h(a(_n),{show:T.value,"onUpdate:show":l[18]||(l[18]=x=>T.value=x),onClick:L},{extra:F(()=>[t("div",oa,[h(ot,null,{default:F(()=>[t("label",null,[aa,z(t("input",{type:"checkbox","onUpdate:modelValue":l[14]||(l[14]=x=>$t(M)?M.value=x:null)},null,512),[[Bt,a(M)]])]),t("label",null,[ua,z(t("input",{type:"checkbox","onUpdate:modelValue":l[15]||(l[15]=x=>$t(m)?m.value=x:null)},null,512),[[Bt,a(m)]])]),t("label",null,[la,z(t("input",{type:"checkbox","onUpdate:modelValue":l[16]||(l[16]=x=>$t(c)?c.value=x:null)},null,512),[[Bt,a(c)]])]),t("label",null,[ca,z(t("input",{type:"checkbox","onUpdate:modelValue":l[17]||(l[17]=x=>$t(D)?D.value=x:null)},null,512),[[Bt,a(D)]])])]),_:1})])]),_:1},8,["show"])])}}});const ma=st(ia,[["__scopeId","data-v-2cc2cbb6"]]);export{ma as default};
