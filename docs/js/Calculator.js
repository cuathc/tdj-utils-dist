import{_ as st,J as Kt,o as r,c as v,f as t,K as Jt,L as Qt,M as Xt,N as it,d as ft,r as W,O as Rt,H as mt,g as D,P as wt,G as It,b as _t,t as Wt,a as et,e as h,w as F,u,k as K,Q as Zt,h as O,z as ut,R as Mt,S as Yt,F as H,j as q,U as te,x as Z,V as yt,W as Gt,p as kt,m as Dt,D as at,T as Nt,I as ee,n as se,X as ne,l as rt,q as $t,v as Tt,A as vt,E as gt,Y as N,Z as oe,i as Bt}from"./index.js";import{D as ue,u as ae}from"./useHeroes.js";import{_ as Et}from"./lodash.js";import{C as le}from"./CollapsePanel.js";import ce from"./InputNumber.js";import{b as qt,d as Ut,a as ie,i as de}from"./shared.js";import{S as J,a as re}from"./star-crystals.js";import{s as jt}from"./data.js";const pe=["width","height"],_e=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),fe=[_e];function ve(s,n,e,o,l,C){return r(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},fe,8,pe)}const he=st(Kt,[["render",ve]]),me=["width","height"],be=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Fe=[be];function Be(s,n,e,o,l,C){return r(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 32 32"},Fe,8,me)}const $e=st(Jt,[["render",Be]]),ye=["width","height"],Ce=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),xe=[Ce];function ge(s,n,e,o,l,C){return r(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},xe,8,ye)}const Lt=st(Qt,[["render",ge]]),we=["width","height"],Ee=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),ke=[Ee];function De(s,n,e,o,l,C){return r(),v("svg",{width:s.width,height:s.height,viewBox:"0 0 24 24"},ke,8,we)}const Ae=st(Xt,[["render",De]]);let St=0,Ht=0;const Se=500;function Pt(){const s=Math.floor(new Date().getTime()/1e3);Ht===s?St++:St=0,Ht=s;const n=s.toString(16);return`${(Se<<16|St&255).toString(16)}.${n}`}async function Me(){try{return await it.getAll("calculator")}catch{return[]}}async function Ue(s){try{await it.add("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function xt(s){try{await it.put("calculator",JSON.parse(JSON.stringify(s)))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ve(s){try{await it.delete("calculator",s)}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Ie(s){try{const o=(await it.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await it.wrap(o.put(l))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}async function Te(s){try{const o=(await it.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const l of s)await it.wrap(o.delete(l))}catch(n){n instanceof Error?console.log(n.message):console.log(n)}}function He(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function Pe(){return{a:0}}function Re(){return{att:0}}function Ot(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0",kz:0}}function Ge(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ne(){return[Ot()]}function qe(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const je=ft({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(s,{emit:n}){const e=W(),o=W({}),l=W(s.active),C=()=>{const y=e.value.getBoundingClientRect();switch(l.value=!0,n("update:active",l.value),s.dir){case"left":o.value={top:`${y.top+y.height/2}px`,right:`${window.innerWidth-y.left-4}px`,maxWidth:"100%"};break;case"right":o.value={top:`${y.top+y.height/2}px`,left:`${y.right+4}px`,maxWidth:"100%"};break;case"top":o.value={bottom:`${window.innerHeight-y.top-4}px`,left:`${y.left+y.width/2}px`,maxWidth:"100%"};break;default:o.value={top:`${y.bottom+4}px`,left:`${y.left+y.width/2}px`,maxWidth:"100%"}}};let p;const i=()=>{p=window.setTimeout(C,s.wait)},x=()=>{clearTimeout(p),l.value=!1,n("update:active",l.value)};return Rt(()=>s.active,S=>{l.value=S}),{el:e,style:o,tActive:l,onEnter:i,onOut:x}}});const Le={class:"c-tooltip-label"};function Oe(s,n,e,o,l,C){return r(),v("div",{ref:"el",class:wt(["c-tooltip",{active:s.tActive,inline:s.inline}]),onMouseenter:n[0]||(n[0]=(...p)=>s.onEnter&&s.onEnter(...p)),onMouseout:n[1]||(n[1]=(...p)=>s.onOut&&s.onOut(...p))},[mt(s.$slots,"label",{},()=>[t("div",Le,D(s.label),1)]),t("div",{class:wt(["c-tooltip-inner",s.dir?`c-tooltip-${s.dir}`:"c-tooltip-bottom",s.color?`c-tooltip-${s.color}`:""]),style:It(s.style)},[mt(s.$slots,"default")],6)],34)}const dt=st(je,[["render",Oe]]),nt=s=>(kt("data-v-a6a2fd75"),s=s(),Dt(),s),ze=["onKeypress"],Ke=["onKeypress"],Je=nt(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),Qe=Z(" \u514B\u523630%"),Xe=nt(()=>t("br",null,null,-1)),We=Z("\u88AB\u514B\u5236-25%"),Ze=nt(()=>t("br",null,null,-1)),Ye=Z("\u6FC0\u836150% "),ts=["onClick"],es=["onClick"],ss={class:"row"},ns={class:"col-item"},os=nt(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),us=Z(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),as={class:"input-group"},ls=["step"],cs=nt(()=>t("div",{class:"input-ext"},"\u500D",-1)),is={class:"label"},ds={class:"input-group"},rs=nt(()=>t("div",{style:{clear:"both"}},null,-1)),ps={class:"col-item"},_s=nt(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),fs=Z(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),vs={class:"input-group"},hs=["step"],ms=nt(()=>t("div",{class:"input-ext"},"\u500D",-1)),bs={class:"label"},Fs={class:"input-group"},Bs={class:"col-item"},$s=nt(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),ys={class:"static-control text-center"},Cs={class:"darkgold"},xs=nt(()=>t("div",{style:{clear:"both"}},null,-1)),gs={class:"label"},ws={class:"bold darkgold"},Es=nt(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),ks={class:"static-control text-center"},Ds={class:"bold darkgold"},As={class:"bold red"},Ss={class:"label bold"},Ms={class:"static-control text-center"},Us={class:"bold darkgold"},Vs={key:0,class:"bold red"},Is=ft({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(s,{emit:n}){const e=s,o=_t({editor:!1,name:"",desc:{f:!1,v:""}}),l=_t(Ge()),C=Wt(e,"itemState"),p=()=>{n("update:itemState",C.value)},i=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],x=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],S=et(()=>{const{state:m}=e,c=(100+l.att)/100;return Math.ceil(m.att*c)}),y=et(()=>{const{state:m}=e,c=(100+l.att+l.att2)/100;return Math.ceil(m.att*c)}),P=()=>{const{enemyState:m}=e,c=C.value,k=(100+c.kz)/100,b=(100+l.da-m.ra)/100,U=(100+l.da+l.da2-m.ra)/100,tt=(100+l.db-m.rb)/100,lt=(100+l.dc)/100,T=(100+l.dx)/100,$=(100+l.dx+l.dx2)/100,Y=(100+l.cd)/100,L=(100-l.id)/100,Ft=(100+m.defGain)/100,d=(100+m.defGain+l.defGain)/100,B=Math.max(0,Math.max(0,m.def*Ft+m.defExt)*L),a=Math.max(0,Math.max(0,m.def*d+m.defExt)*L),A=Math.max(1,S.value*k-B),G=Math.max(1,y.value*k-a),X=A*c.a1*b*tt*T,ot=Math.ceil(X*Y),ct=G*c.a2*U*tt*lt*$,g=Math.ceil(ct*Y);return{r01:Math.ceil(X),r01c:ot,r02:Math.ceil(ct),r02c:g}},f=et(()=>P());function _(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&n("close")}function w(){o.editor=!0,o.name=e.itemState.name}function E(){const m=o.name;if(o.editor=!1,o.name="",!m)return;const c=e.itemState;c.name=m,n("update:itemState",c)}function R(){o.desc.f=!0,o.desc.v=e.itemState.desc}function V(){const m=o.desc.v;if(o.desc.f=!1,o.desc.v="",!m)return;const c=e.itemState;c.desc=m,n("update:itemState",c)}function I(){n("up")}function j(){n("down")}function M(){n("copy")}return(m,c)=>{const k=Gt("autofocus");return r(),v(H,null,[h(u(te),{orientation:"left"},{action:F(()=>[t("span",{onClick:M},[h(u(Lt),{class:"close"})]),s.showUp?(r(),v("span",{key:0,onClick:I},[h(u(he),{class:"close"})])):K("",!0),s.showDown?(r(),v("span",{key:1,onClick:j},[h(u($e),{class:"close"})])):K("",!0),t("span",{onClick:_},[h(u(Zt),{class:"close"})])]),default:F(()=>[o.editor?O((r(),v("input",{key:0,class:"input",type:"text","onUpdate:modelValue":c[0]||(c[0]=b=>o.name=b),onKeypress:Mt(E,["enter"]),onBlur:E},null,40,ze)),[[ut,o.name],[k]]):(r(),v("span",{key:1,class:"calc-item-title",onClick:w},D(u(C).name||"\u6A21\u677F"),1)),o.desc.f?O((r(),v("input",{key:2,class:"input",type:"text","onUpdate:modelValue":c[1]||(c[1]=b=>o.desc.v=b),onKeypress:Mt(V,["enter"]),onBlur:V},null,40,Ke)),[[ut,o.desc.v],[k]]):(r(),v("span",{key:3,class:"calc-item-desc",onClick:R},D(u(C).desc||"\u6CA1\u6709\u63CF\u8FF0"),1)),h(u(Yt),{style:{width:"120px"}},{default:F(()=>[h(u(dt),{dir:"top"},{label:F(()=>[Je]),default:F(()=>[Qe,Xe,We,Ze,Ye]),_:1}),t("div",null,[h(u(ue),null,{popover:F(({onClose:b})=>[t("div",{class:"list",onClick:U=>b()},[(r(),v(H,null,q([{label:"\u666E\u901A",value:0},{label:"\u514B\u5236",value:30},{label:"\u88AB\u514B\u5236",value:-25},{label:"\u6FC0\u8361",value:50}],({label:U,value:tt})=>t("div",{key:U,class:"list-item",onClick:lt=>{u(C).kz=tt,p()}},D(U),9,es)),64))],8,ts)]),default:F(()=>[O(t("input",{class:"input",type:"number","onUpdate:modelValue":c[2]||(c[2]=b=>u(C).kz=b)},null,512),[[ut,u(C).kz,void 0,{number:!0}]])]),_:1})])]),_:1})]),_:1}),t("div",ss,[t("div",ns,[h(u(dt),{dir:"top"},{label:F(()=>[os]),default:F(()=>[us]),_:1}),t("div",as,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[3]||(c[3]=b=>u(C).a1=b),onInput:p},null,40,ls),[[ut,u(C).a1,void 0,{number:!0}]]),cs])]),(r(),v(H,null,q(i,b=>t("div",{class:"col-item",key:b.name},[h(u(dt),{dir:"top"},{label:F(()=>[t("div",is,D(b.label),1)]),default:F(()=>[Z(" "+D(b.tip),1)]),_:2},1024),t("div",ds,[h(u(yt),{class:"input",modelValue:u(C)[b.name],"onUpdate:modelValue":U=>u(C)[b.name]=U,result:l[b.name],"onUpdate:result":[U=>l[b.name]=U,p]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),rs,t("div",ps,[h(u(dt),{dir:"top"},{label:F(()=>[_s]),default:F(()=>[fs]),_:1}),t("div",vs,[O(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":c[4]||(c[4]=b=>u(C).a2=b),onInput:p},null,40,hs),[[ut,u(C).a2,void 0,{number:!0}]]),ms])]),(r(),v(H,null,q(x,b=>t("div",{class:"col-item",key:b.name},[h(u(dt),{dir:"top"},{label:F(()=>[t("div",bs,D(b.label),1)]),default:F(()=>[Z(" "+D(b.tip),1)]),_:2},1024),t("div",Fs,[h(u(yt),{class:"input",modelValue:u(C)[b.name],"onUpdate:modelValue":U=>u(C)[b.name]=U,result:l[b.name],"onUpdate:result":[U=>l[b.name]=U,p]},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Bs,[$s,t("div",ys,[t("span",Cs,D(u(S)),1)])]),xs,(r(!0),v(H,null,q([u(f)],b=>(r(),v(H,null,[(r(!0),v(H,null,q([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:b.r01,v2:b.r01c},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:b.r02,v2:b.r02c}],(U,tt)=>(r(),v("div",{class:"col-item",key:tt},[t("div",gs,[t("span",ws,D(U.label),1),Es]),t("div",ks,[t("span",Ds,D(U.v),1),t("span",As,"("+D(U.v2)+")",1)])]))),128)),(r(!0),v(H,null,q([{label:"\u4E0D\u66B4\u51FB",value:b.r01+b.r02},{label:"\u4E00\u6BB5\u66B4\u51FB",value:b.r01c+b.r02},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:b.r01+b.r02c},{label:"\u5168\u66B4\u51FB",value:b.r01c+b.r02c}],(U,tt)=>(r(),v("div",{class:"col-item",key:tt},[t("div",Ss,D(U.label),1),t("div",Ms,[t("span",Us,D(U.value),1),(+s.enemyState.hp||0)<=U.value?(r(),v("span",Vs," \u51FB\u6740 ")):K("",!0)])]))),128))],64))),256))])],64)}}});const Ts=st(Is,[["__scopeId","data-v-a6a2fd75"]]),At=s=>(kt("data-v-bd82d11d"),s=s(),Dt(),s),Hs=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Ps={class:"row"},Rs={class:"label"},Gs={class:"input-group"},Ns=["step","onUpdate:modelValue","onChange"],qs=["value"],js={class:"col-item"},Ls=At(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Os={class:"static-control text-center"},zs={class:"darkgold"},Ks=At(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),Js={class:"row"},Qs={class:"label"},Xs={key:1,class:"label"},Ws={class:"input-group"},Zs={key:0,class:"input-ext"},Ys=At(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),tn=ft({__name:"Calculator",props:{data:null},emits:["update:data"],setup(s,{emit:n}){const e=s,o=et(()=>e.data.basic),l=et(()=>e.data.state),C=et(()=>e.data.enemyState),p=et(()=>e.data.items),i=_t(Pe()),x=_t({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),S=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],y=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],P=()=>{const M=o.value.c/100;o.value.g=Math.ceil(i.a+o.value.w*M+o.value.x),l.value.att=o.value.w+o.value.g},f=async()=>{n("update:data",e.data)},_=(M,m)=>{m==="panel"&&P(),f()},w=(M,m)=>{const c=e.data.items;!c||(c[m]=M,f())},E=()=>{const M=e.data.items;!M||(M.push(Ot()),f())},R=M=>{const m=e.data.items;!m||(m.splice(M,1),f())},V=M=>{const m=e.data.items;if(!m)return;const c=m[M],k=m[M-1];m[M-1]=c,m[M]=k,f()},I=M=>{const m=e.data.items;if(!m)return;const c=m[M],k=m[M+1];m[M+1]=c,m[M]=k,f()},j=M=>{const m=e.data.items;if(!m)return;const c=m[M];m.push(Et.cloneDeep(c)),f()};return Rt(()=>[e.data.basic.w],()=>{P()}),(M,m)=>(r(),v("div",null,[Hs,t("div",Ps,[(r(),v(H,null,q(S,c=>t("div",{class:"col-item",key:c.name},[t("div",Rs,D(c.label),1),t("div",Gs,[c.name in i?(r(),at(u(yt),{key:0,modelValue:u(o)[c.name],"onUpdate:modelValue":k=>u(o)[c.name]=k,result:i[c.name],"onUpdate:result":k=>i[c.name]=k,onChange:k=>_(c.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):O((r(),v("input",{key:1,type:"number",class:"input",style:It({textAlign:c.align}),min:"0",step:c.step,"onUpdate:modelValue":k=>u(o)[c.name]=k,onChange:k=>_(c.name,"panel")},null,44,Ns)),[[ut,u(o)[c.name],void 0,{number:!0}]]),c.name==="w"?(r(),v("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${u(o).g}`},null,8,qs)):K("",!0)])])),64)),t("div",js,[Ls,t("div",Os,[t("span",zs,D(u(l).att),1)])])]),Ks,t("div",Js,[(r(),v(H,null,q(y,c=>t("div",{class:"col-item",key:c.name},[c.tips?(r(),at(u(dt),{key:0,dir:"top"},{label:F(()=>[t("div",Qs,D(c.label),1)]),default:F(()=>[Z(" "+D(c.tips),1)]),_:2},1024)):(r(),v("div",Xs,D(c.label),1)),t("div",Ws,[h(u(yt),{modelValue:u(C)[c.name],"onUpdate:modelValue":k=>u(C)[c.name]=k,result:x[c.name],"onUpdate:result":k=>x[c.name]=k,onChange:k=>_(c.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),c.precent?(r(),v("div",Zs,"%")):K("",!0)])])),64))]),t("div",{class:"heading"},[Ys,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:E},"\u6DFB\u52A0")])]),(r(!0),v(H,null,q(u(p),(c,k)=>(r(),at(Ts,{key:c,panel:u(o),state:u(l),enemyState:x,itemState:c,showUp:k>0,showDown:u(p)&&k<u(p).length-1,"onUpdate:itemState":b=>w(b,k),onClose:b=>R(k),onUp:b=>V(k),onDown:b=>I(k),onCopy:b=>j(k)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const en=st(tn,[["__scopeId","data-v-bd82d11d"]]),sn=ft({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(s,{emit:n}){return{wrapClass:et(()=>["c-action-sheet-wrapper",s.class,{show:s.show}]),onClick:(C,p)=>{n("click",{item:C,index:p}),n("close",!1)},onClose:()=>{n("update:show",!1),n("close",!1)}}}});const nn={class:"c-action-sheet-section"},on={class:"c-action-sheet-extra"},un={class:"c-action-sheet-list"},an=["onClick"];function ln(s,n,e,o,l,C){return r(),at(Nt,{to:"body"},[t("div",{class:wt(s.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:n[0]||(n[0]=(...p)=>s.onClose&&s.onClose(...p))}),t("div",nn,[t("div",{class:"c-action-sheet-body",style:It({maxHeight:s.height})},[t("div",on,[mt(s.$slots,"extra")]),t("div",un,[(r(!0),v(H,null,q(s.list,(p,i)=>(r(),v("div",{class:"c-action-sheet-item",key:i,onClick:x=>s.onClick(p,i)},[mt(s.$slots,"default",{record:p})],8,an))),128))])],4)])],2)])}const Vt=st(sn,[["render",ln]]);Vt.install=s=>{s.component("action-sheet",Vt)};const cn={class:"hero-item"},dn={class:"hero-item__inner"},rn=["src"],pn=["src","alt","title"],_n={class:"hero-item__label"},fn=ft({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(s,{emit:n}){const{heroes:e,getHeroIcon:o,getHeroIconBg:l}=ae(),C=p=>{n("click",p)};return(p,i)=>(r(),at(u(Vt),{class:"hero-select",show:s.show,list:u(e),height:"80vh",onClick:C,"onUpdate:show":i[0]||(i[0]=x=>p.$emit("update:show",x))},{extra:F(()=>[mt(p.$slots,"extra")]),default:F(({record:x})=>[t("div",cn,[t("div",dn,[t("img",{src:u(l)(x)},null,8,rn),t("img",{src:u(o)(x),alt:x.name,title:x.name},null,8,pn),t("div",_n,D(x.name),1)])])]),_:3},8,["show","list"]))}});function vn(){const s="red_team",n=ee(),e=W([]),o=W(!1),l=W(),C=async f=>{const w=(await n.transaction(s,"readwrite")).objectStore(s),E=await n.wrap(w.put(f));return e.value.find(V=>V._id===f._id)||(f._id=E,e.value.push(f)),E},p=async f=>{const w=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(w.delete(f._id)),e.value=e.value.filter(E=>E._id!==f._id)},i=async f=>{const _=await n.transaction(s,"readwrite"),w=_.objectStore(s);for(const E of f)await n.wrap(w.put(E));await n.twrap(_),await S()},x=async()=>{const _=(await n.transaction(s,"readwrite")).objectStore(s);await n.wrap(_.clear()),e.value=[]},S=async()=>{const _=(await n.transaction(s,"readonly")).objectStore(s),w=await n.wrap(_.getAll()).catch(()=>[]);w.forEach(E=>{E.scList||(E.scList=[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}])}),e.value=w},y=async f=>{const _=JSON.parse(await f.text());if(!qt(_)||_.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const w=_.data;w.forEach(E=>delete E._id),await i(w)},P=async()=>{const f={type:"red_team",data:e.value},_=new Blob([JSON.stringify(f)],{type:"application/json"});Ut(_,"red_team.json")};return S(),{scShow:o,scSelected:l,put:C,del:p,puts:i,clear:x,all:S,list:e,importData:y,exportData:P}}const ht=s=>s%1>.5?Math.ceil(s):Math.floor(s);function hn(){const s=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,scList:[{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9633",pos:J.ATT},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u9716",pos:J.XUE},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF},{n:"\u6676\u7CB9\xB7\u8679",pos:J.DEF}],cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),n=W(s()),e=et(()=>{const p=[0,0,0,0,0,0];return n.value.scList.forEach(i=>{!i.v||(p[0]+=i.v.qixue,p[1]+=i.v.patt,p[2]+=i.v.pdef,p[3]+=i.v.matt,p[4]+=i.v.mdef,p[5]+=i.v.huixin)}),p}),o=et(()=>{const p=n.value,i={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},x=jt.find(P=>p.stoneName===P.name);x&&(i.qixue=x.t[0]+x.d[0]+x.h[0],i.patt=x.t[1]+x.d[1]+x.h[1],i.matt=x.t[2]+x.d[2]+x.h[2],i.pdef=x.t[3]+x.d[3]+x.h[3],i.mdef=x.t[4]+x.d[4]+x.h[4]);const S={qixue:p.hsQixue/100,patt:p.hsPatt/100,pdef:p.hsPdef/100,matt:p.hsMatt/100,mdef:p.hsMdef/100,huixin:p.hsHuixin/100},y=e.value;return{qixue:ht(p.qixue*S.qixue+i.qixue+y[0]),patt:ht(p.patt*S.patt+i.patt+y[1]),pdef:ht(p.pdef*S.pdef+i.pdef+y[2]),matt:ht(p.matt*S.matt+i.matt+y[3]),mdef:ht(p.mdef*S.mdef+i.mdef+y[4]),huixin:ht(p.huixin*S.huixin+i.huixin+y[5])}}),l=et(()=>{const p=o.value,i={qixue:(100+n.value.rQixue)/100,patt:(100+n.value.rPatt)/100,pdef:(100+n.value.rPdef)/100,matt:(100+n.value.rMatt)/100,mdef:(100+n.value.rMdef)/100,huixin:(100+n.value.rHuixin)/100};return{qixue:Math.round((n.value.qixue+p.qixue)*i.qixue),patt:Math.round((n.value.patt+p.patt)*i.patt),pdef:Math.round((n.value.pdef+p.pdef)*i.pdef),matt:Math.round((n.value.matt+p.matt)*i.matt),mdef:Math.round((n.value.mdef+p.mdef)*i.mdef),huixin:Math.round((n.value.huixin+p.huixin)*i.huixin)}});return{state:n,pValue:o,ckValue:l,scSum:e,reset:()=>{n.value=s()},defState:s}}const mn={},bn={class:"c-upload"};function Fn(s,n){return r(),v("div",bn,[mt(s.$slots,"default",{},void 0,!0),t("input",se({type:"file",class:"c-upload-input",accept:"application/json"},s.$attrs),null,16)])}const Bn=st(mn,[["render",Fn],["__scopeId","data-v-b3879154"]]),Q=s=>(kt("data-v-fc55a9ed"),s=s(),Dt(),s),$n={class:"transform-tools-popover"},yn={class:"transform-tools-popover-toolbar"},Cn=["value"],xn=["value"],gn=Q(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),wn={class:"transform-tools-popover-content"},En={class:"grid-group"},kn={class:"grid-group-item"},Dn={class:"input-group-title"},An=Q(()=>t("span",null,"\u57FA\u7840",-1)),Sn={class:"grids"},Mn={class:"input-label"},Un={class:"input-group"},Vn={class:"input green"},In={class:"grid-group-item"},Tn={class:"input-group-title"},Hn=Q(()=>t("span",null,"\u9B42\u77F3",-1)),Pn=Q(()=>t("option",{value:""},"\u65E0",-1)),Rn=["value"],Gn={class:"grids"},Nn=Q(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),qn=Q(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),jn=Q(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),Ln=Q(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),On=Q(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),zn={class:"grid-group-item"},Kn={class:"input-group-title"},Jn=Z(" \u661F\u4E4B\u6676 "),Qn=Q(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C66\u9632",-1)),Xn=Q(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C66\u9632\uFF0C88\u653B",-1)),Wn=Q(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),Zn={class:"grids"},Yn=["onClick","onContextmenu"],to={key:0},eo={key:1},so={key:2},no={key:3},oo={key:4},uo={key:5},ao={key:1},lo={class:"grid-group-item"},co=Q(()=>t("div",{class:"input-group-title"},"\u661F\u4E4B\u6676\u5408\u8BA1",-1)),io={class:"grids"},ro={class:"input-label"},po={class:"input"},_o={class:"grid-group-item"},fo=Q(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),vo={class:"grids"},ho={class:"input-label"},mo={class:"grid-group-item"},bo=Q(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Fo={class:"grids"},Bo={class:"input-label"},$o={class:"input"},yo=ft({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(s,{emit:n}){const{state:e,pValue:o,ckValue:l,scSum:C,reset:p,defState:i}=hn(),{list:x,put:S,del:y,clear:P,importData:f,exportData:_}=vn(),w=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],E=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],R=W(!1),V=W(),I=T=>{V.value=T,R.value=!0},j=T=>{!V.value||(V.value.v=T)},M=()=>{const T=Et.cloneDeep(e.value);S(T).then($=>{e.value._id=$,alert("\u5DF2\u4FDD\u5B58")}).catch($=>{console.log($),alert("\u4FDD\u5B58\u5931\u8D25")})},m=()=>{const T=Et.cloneDeep(e.value);delete T._id,T.name+=" copy",S(T).then($=>{T._id=$,e.value=T}).catch($=>{console.log($),alert("\u590D\u5236\u5931\u8D25")})},c=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||y(e.value).then(()=>{p()}).catch($=>{console.log($),alert("\u5220\u9664\u5931\u8D25")})},k=T=>{const $=T.currentTarget;if(!$.files)return;const Y=Array.prototype.slice.call($.files);$.value="",Y[0]&&f(Y[0])},b=()=>{_()},U=()=>{!confirm("\u662F\u5426\u8981\u6E05\u7A7A\u5168\u90E8\uFF1F")||P().catch($=>{console.log($),alert("\u6E05\u7A7A\u5931\u8D25")})},tt=(T,$)=>{e.value.name=T,e.value.qixue=$.qixue,e.value.patt=$.patt,e.value.pdef=$.pdef,e.value.matt=$.matt,e.value.mdef=$.mdef,e.value.huixin=$.huixin},lt=()=>{n("reference")};return n("init",tt),(T,$)=>{const Y=rt("c-col"),L=rt("c-space"),Ft=rt("c-row");return O((r(),v("div",$n,[t("div",yn,[h(Ft,{flex:"",middle:"",gutter:8},{default:F(()=>[h(Y,null,{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:lt},"\u53C2\u8003")]),_:1}),h(Y,null,{default:F(()=>[Z("ID: "+D(u(e)._id),1)]),_:1}),h(Y,{flex:"1 1 auto"},{default:F(()=>[h(L,null,{default:F(()=>[O(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":$[0]||($[0]=d=>$t(e)?e.value=d:null)},[t("option",{value:u(i)()},"\u7A7A\u6A21\u7248",8,Cn),(r(!0),v(H,null,q(u(x),d=>(r(),v("option",{key:d._id,value:d},D(d.name),9,xn))),128))],512),[[Tt,u(e)]]),t("button",{class:"btn btn-sm btn-primary",onClick:M},"\u4FDD\u5B58"),t("button",{class:"btn btn-sm btn-primary",onClick:m},"\u590D\u5236"),u(e)._id?(r(),v("button",{key:0,class:"btn btn-sm btn-danger",onClick:c},"\u5220\u9664")):K("",!0),h(Bn,{onChange:k},{default:F(()=>[gn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:b},"\u5BFC\u51FA"),t("button",{class:"btn btn-sm btn-danger",onClick:U},"\u6E05\u7A7A")]),_:1})]),_:1}),h(Y,null,{default:F(()=>[t("span",{class:"transform-tools-popover-close",onClick:$[1]||($[1]=d=>n("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",wn,[t("div",En,[t("div",kn,[t("div",Dn,[h(L,null,{default:F(()=>[An,O(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":$[2]||($[2]=d=>u(e).name=d)},null,512),[[ut,u(e).name]])]),_:1})]),t("div",Sn,[(r(),v(H,null,q(w,d=>h(L,{key:d.n},{default:F(()=>[t("label",Mn,D(d.t),1),t("div",Un,[h(u(vt),{readonly:"",value:u(e)[d.n]},null,8,["value"]),t("div",Vn,"+"+D(u(o)[d.n]),1)])]),_:2},1024)),64))])]),t("div",In,[t("div",Tn,[h(L,null,{default:F(()=>[Hn,O(t("select",{class:"input input-select","onUpdate:modelValue":$[3]||($[3]=d=>u(e).stoneName=d)},[Pn,(r(!0),v(H,null,q(u(jt),(d,B)=>(r(),v("option",{key:B,value:d.name},D(d.name),9,Rn))),128))],512),[[Tt,u(e).stoneName]])]),_:1})]),t("div",Gn,[h(L,null,{default:F(()=>[Nn,h(u(vt),{value:u(e).hsQixue,"onUpdate:value":$[4]||($[4]=d=>u(e).hsQixue=d)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[qn,h(u(vt),{value:u(e).hsPatt,"onUpdate:value":$[5]||($[5]=d=>u(e).hsPatt=d)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[jn,h(u(vt),{value:u(e).hsPdef,"onUpdate:value":$[6]||($[6]=d=>u(e).hsPdef=d)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[Ln,h(u(vt),{value:u(e).hsMatt,"onUpdate:value":$[7]||($[7]=d=>u(e).hsMatt=d)},null,8,["value"])]),_:1}),h(L,null,{default:F(()=>[On,h(u(vt),{value:u(e).hsMdef,"onUpdate:value":$[8]||($[8]=d=>u(e).hsMdef=d)},null,8,["value"])]),_:1})])]),t("div",zn,[t("div",Kn,[Jn,h(u(dt),{label:"?",inline:"",dir:"right"},{default:F(()=>[Qn,Xn,Wn]),_:1})]),t("div",Zn,[(r(!0),v(H,null,q(u(e).scList,(d,B)=>(r(),v("div",{key:B,class:wt(["sc-props",{selected:V.value===d,s1:u(J).ATT===d.pos,s2:u(J).XUE===d.pos,s3:u(J).DEF===d.pos}]),onClick:a=>I(d),onContextmenu:gt(a=>d.v=void 0,["prevent"])},[d.v?(r(),v(H,{key:0},[d.v.qixue>0?(r(),v("span",to,"\u6C14\u8840+"+D(d.v.qixue),1)):K("",!0),d.v.patt>0?(r(),v("span",eo,"\u7269\u653B+"+D(d.v.patt),1)):K("",!0),d.v.pdef>0?(r(),v("span",so,"\u7269\u9632+"+D(d.v.pdef),1)):K("",!0),d.v.matt>0?(r(),v("span",no,"\u6CD5\u653B+"+D(d.v.matt),1)):K("",!0),d.v.mdef>0?(r(),v("span",oo,"\u6CD5\u9632+"+D(d.v.mdef),1)):K("",!0),d.v.huixin>0?(r(),v("span",uo,"\u4F1A\u5FC3+"+D(d.v.huixin),1)):K("",!0)],64)):(r(),v("span",ao,D(d.n),1))],42,Yn))),128))]),(r(),at(Nt,{to:"body"},[V.value?(r(),at(u(re),{key:0,show:R.value,"onUpdate:show":$[9]||($[9]=d=>R.value=d),position:V.value.pos,dir:"left",overlayStyle:"width:360px",onSelect:j},null,8,["show","position"])):K("",!0)]))]),t("div",lo,[co,t("div",io,[(r(),v(H,null,q(w,(d,B)=>h(L,{key:B},{default:F(()=>[t("label",ro,D(d.t),1),t("div",po,"+"+D(u(C)[B]),1)]),_:2},1024)),64))])]),t("div",_o,[fo,t("div",vo,[(r(),v(H,null,q(E,(d,B)=>h(L,{key:B},{default:F(()=>[t("label",ho,D(d.t),1),h(u(yt),{modelValue:u(e)[d.c],"onUpdate:modelValue":a=>u(e)[d.c]=a,result:u(e)[d.r],"onUpdate:result":a=>u(e)[d.r]=a},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",mo,[bo,t("div",Fo,[(r(),v(H,null,q(w,d=>h(L,{key:d.n},{default:F(()=>[t("label",Bo,D(d.t),1),t("div",$o,D(u(l)[d.n]),1)]),_:2},1024)),64))])])])])],512)),[[ne,s.show]])}}});const Co=st(yo,[["__scopeId","data-v-fc55a9ed"]]);function pt(s){return(s%1>.5?Math.ceil:Math.floor)(s)}function zt(s){const{basic:n,enemyState:e}=s,o={w:n.w,a:N(n.a),c:n.c,x:n.x,g:0,att:0};o.g=pt(n.w*n.c/100+o.a+o.x),o.att=n.w+o.g;const l={hp:N(e.hp),ra:N(e.ra),rb:N(e.rb),def:N(e.def),defExt:N(e.defExt),defGain:N(e.defGain)};return{b:o,e:l}}function xo(s,n){const{b:e,e:o}=zt(s),l={a1:n.a1,a2:n.a2,att:N(n.att),att2:N(n.att2),da:N(n.da),da2:N(n.da2),db:N(n.db),dc:N(n.dc),dx:N(n.dx),dx2:N(n.dx2),id:N(n.id),cd:N(n.cd),defGain:N(n.defGain),kz:n.kz||0},C=e.att*(100+l.att)/100,p=e.att*(100+l.att+l.att2)/100,i=(100+l.kz)/100,x=(100+l.da-o.ra)/100,S=(100+l.da+l.da2-o.ra)/100,y=(100+l.db-o.rb)/100,P=(100+l.dc)/100,f=(100+l.dx)/100,_=(100+l.dx+l.dx2)/100,w=(100+l.cd)/100,E=(100-l.id)/100,R=(100+o.defGain)/100,V=(100+o.defGain+l.defGain)/100,I=Math.max(0,Math.max(0,o.def*R+o.defExt)*E),j=Math.max(0,Math.max(0,o.def*V+o.defExt)*E),M=Math.max(1,C*i-I),m=Math.max(1,p*i-j),c=M*l.a1*x*y*f,k=pt(c*w),b=m*l.a2*S*y*P*_,U=pt(b*w);return{satt:C,satt2:p,r01:pt(c),r01c:k,r02:pt(b),r02c:U}}function go(s){const n=s.items||[],e=document.createElement("canvas");e.width=800,e.height=8+160+n.reduce((_,w)=>{let E=30;return E+=50,w.a1>0&&(E+=30),w.a2>0&&(E+=50),(w.a1>0||w.a2>0)&&(E+=20),w.a1>0&&w.a2>0&&(E+=20),E+=20,_+E},0)+8;const o=e.getContext("2d");if(!o)return;const l=s.basic,C=s.enemyState,{b:p}=zt(s),i={x:0,y:0},x=(_,w,E)=>{E?(i.x+=_,i.y+=w):(i.x=_,i.y=w)},S=(_=0)=>{i.x=8+_*16},y=(_=0)=>{i.x=8,i.y+=_},P=(_,w="#222222")=>{o.save(),o.fillStyle=w;const{width:E}=o.measureText(_);o.fillText(_,i.x,i.y),i.x+=E+16,o.restore()},f=(_,...w)=>{o.save();const E=typeof _=="string"?_:_[0],R=typeof _=="string"?"#222222":_[1];o.fillStyle=R,o.font="bold 16px sans-serif";const{width:V}=o.measureText(E);o.fillText(E,i.x,i.y),i.x+=V+8,o.restore(),o.save(),o.font="16px sans-serif";for(const I of w){const j=typeof I=="string"?I:I[0],M=typeof I=="string"?"#ff4446":I[1];o.fillStyle=M;const{width:m}=o.measureText(j);o.fillText(j,i.x,i.y),i.x+=m+8}i.x+=8,o.restore()};o.fillStyle="#FBFFF0",o.fillRect(0,0,e.width,e.height),x(8,28),o.textBaseline="bottom",o.font="bold 20px sans-serif",P(s.title),y(40),o.font="bold 18px sans-serif",P("\u653B\u65B9:"),o.font="16px sans-serif",y(30),S(2),f("\u653B\u51FB:",`${l.w}`,[`+${p.g}`,"#55a14f"]),f("\u9B42\u77F3\u653B\u51FB:",`${l.a}`),f("\u9B42\u77F3\u653B\u51FB%:",`${l.c}`),f("\u661F\u4E4B\u6676\u653B\u51FB:",`${l.x}`),y(30),o.font="bold 18px sans-serif",P("\u5B88\u65B9:"),y(30),S(2),f("\u6C14\u8840:",`${C.hp}`),f("\u9632\u5FA1:",`${C.def}`),f("\u9632\u5FA1%:",`${C.defGain}`),f("\u9644\u52A0\u9632\u5FA1:",`${C.defExt}`),y(20),S(2),f("\u514D\u4F24A%:",`${C.ra}`),f("\u514D\u4F24B%:",`${C.rb}`),y(30);for(const _ of n){const{satt:w,satt2:E,r01:R,r01c:V,r02:I,r02c:j}=xo(s,_);o.font="bold 18px sans-serif",P(_.name,"#a30000"),o.font="14px sans-serif",P(_.desc||"\u65E0\u63CF\u8FF0","#a30000"),o.font="16px sans-serif",f("\u514B\u5236:",`${_.kz||0}%`),y(30),S(2),f("\u653B\u51FB%:",`${_.att}`),f("\u7A7F\u900F%:",`${_.id}`),f("\u66B4\u4F24%:",`${_.cd}`),y(20),S(2),f("\u589E\u4F24A%:",`${_.da}`),f("\u589E\u4F24B%:",`${_.db}`),f("\u589E\u4F24X%:",`${_.dx}`),y(30),_.a1>0&&(S(2),f("\u6280\u80FD\u3001\u666E\u653B:",`${_.a1}\u500D`),f("\u653B\u51FB:",[`${pt(w)}`,"#b8860b"]),y(30)),_.a2>0&&(S(2),f("\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB:",`${_.a2}\u500D`),f("\u653B\u51FB\u4FEE\u6B63%:",_.att2),f("\u9632\u5FA1\u4FEE\u6B63%:",_.defGain),f("\u653B\u51FB:",[`${pt(E)}`,"#b8860b"]),y(20),S(2),f("\u589E\u4F24C%:",_.dc),f("\u589E\u4F24A\u4FEE\u6B63%:",_.da2),f("\u589E\u4F24X\u4FEE\u6B63%:",_.dx2),y(30)),S(2),R>0&&f(["\u6280\u80FD\u3001\u666E\u653B\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${R}`,"#b8860b"],[`${V}`,"#ff4446"]),I>0&&f(["\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u4F24\u5BB3","#b8860b"],["\u66B4\u51FB","#ff4446"],[`${I}`,"#b8860b"],[`${j}`,"#ff4446"]),y(20),R>0&&I>0&&(S(2),f(["\u4E0D\u66B4\u51FB","#b8860b"],[`${R+I}`,"#ff4446"]),f(["\u4EC5\u4E00\u6BB5\u66B4\u51FB","#b8860b"],[`${V+I}`,"#ff4446"]),f(["\u4EC5\u4E8C\u6BB5\u66B4\u51FB","#b8860b"],[`${R+j}`,"#ff4446"]),f(["\u5168\u66B4\u51FB","#b8860b"],[`${V+j}`,"#ff4446"]),y(20)),y(20)}e.toBlob(_=>{!_||window.open(URL.createObjectURL(_))})}function wo(){return{exportImage:go}}const bt=s=>(kt("data-v-2cc2cbb6"),s=s(),Dt(),s),Eo={class:"wrapper"},ko={class:"toolbar"},Do={style:{padding:"6px 16px"}},Ao=Z("\u4F24\u5BB3\u8BA1\u7B97\u5668"),So={class:"c-upload"},Mo=bt(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Uo={style:{padding:"6px 16px"}},Vo={class:"input-group"},Io=bt(()=>t("div",{class:"input-ext"},"=",-1)),To={class:"content"},Ho={class:"container"},Po=["value"],Ro=Z(" \u2007 "),Go=["onKeypress"],No={key:1},qo=["onClick"],jo=["onClick"],Lo=["onClick"],Oo=Z(" \u91CD\u547D\u540D "),zo=["onClick"],Ko=Z(" \u590D\u5236 "),Jo=["onClick"],Qo=["onClick"],Xo=["onClick"],Wo={style:{"text-align":"center"}},Zo=bt(()=>t("span",null,"\u661F\u8000",-1)),Yo=bt(()=>t("span",null,"\u5316\u81FB",-1)),tu=bt(()=>t("span",null,"\u661F\u9B42",-1)),eu=bt(()=>t("span",null,"\u661F\u8F89",-1)),su=ft({__name:"Calculator",setup(s){const{exportImage:n}=wo(),e=_t({id:"",title:"",selecteds:[],search:""}),o=W([]),l=et(()=>o.value.filter(B=>B.title.indexOf(e.search)>-1)),C=async()=>{const a={id:Pt(),title:"\u6A21\u677F",basic:He(),state:Re(),enemyState:qe(),items:Ne()};await Ue(a),o.value.push(a)},p=async B=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const A=o.value.findIndex(G=>G.id===B);A!==-1&&(await Ve(o.value[A].id),o.value.splice(A,1))},i=async B=>{const a=e.title;if(!a){x();return}const A=o.value.findIndex(X=>X.id===B);if(A===-1)return;const G=o.value[A];G.title=a,x(),await xt(G)},x=()=>{e.id="",e.title=""},S=B=>{try{n(B)}catch{alert("\u5BFC\u51FA\u5931\u8D25\uFF0C\u6570\u636E\u5B58\u5728\u9519\u8BEF")}},y=B=>{const a={type:"calculator",data:[B]},A=new Blob([JSON.stringify(a)],{type:"application/json"});Ut(A,`${B.title}.json`)},P=async B=>{o.value=B},f=B=>new Promise((a,A)=>{const G=new FileReader;G.onload=()=>{a(G.result)},G.onerror=()=>{A(G.error)},G.readAsText(B)}),_=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let a=l.value;e.selecteds.length>0&&(a=e.selecteds.map(A=>l.value[A]).filter(A=>A)),await Te(a.map(A=>A.id)),d()},w=async B=>{const a=B.currentTarget,A=Array.prototype.slice.call(a.files);if(a.value="",!A||!A[0])return;const G=A[0],X=await f(G),ot=JSON.parse(X);let ct=[];if(de(ot))ct=ot;else if(qt(ot)&&ot.type==="calculator")ct=ot.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Ie(ct),d()},E=async()=>{let B="calculator.json",a=l.value;e.selecteds.length>0&&(a=e.selecteds.map(X=>l.value[X]).filter(X=>X),B="calculator-selected.json");const A={type:"calculator",data:a},G=new Blob([JSON.stringify(A)],{type:"application/json"});Ut(G,B)};async function R(B,a){const A=o.value.findIndex(X=>X.id===a);A===-1||!o.value[A]||(o.value[A]=B,await xt(B))}const V=W(-1),I=_t({input:"2283/1.35*1.39",result:0}),{translate:j,xingyao:M,huazhen:m,xinghun:c,xinghui:k}=ie(),b=B=>Math.ceil(B),U=_t({show:!1}),tt=B=>{const a=j(B);lt.value&&lt.value(B.name,a)},lt=W(),T=W(!1),$=W(),Y=B=>{T.value=!0,$.value=B},L=({item:B})=>{if(T.value=!1,$.value){const a=$.value,A=j(B);a.title==="\u6A21\u677F"&&(a.title=B.name),a.basic.w=Math.max(A.patt,A.matt),xt(a)}else tt(B)},Ft=B=>{const a=Et.cloneDeep(B);a.id=Pt(),console.log(a),o.value.push(a),xt(a)};async function d(){const B=await Me();e.selecteds=[],P(B)}return oe(()=>{d()}),(B,a)=>{const A=rt("c-col"),G=rt("c-row"),X=rt("calc-input"),ot=rt("c-space"),ct=Gt("autofocus");return r(),v("div",Eo,[t("div",ko,[t("div",Do,[h(G,{flex:"",middle:"",gutter:16},{default:F(()=>[h(A,{flex:"0 0 auto"},{default:F(()=>[Ao]),_:1}),h(A,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-sm btn-link",onClick:a[0]||(a[0]=g=>U.show=!U.show)},"\u9762\u677F"),e.selecteds.length>0?(r(),v("button",{key:0,class:"btn btn-success",onClick:a[1]||(a[1]=g=>e.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):K("",!0)]),_:1}),h(A,{flex:"1 1 0"},{default:F(()=>[O(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":a[2]||(a[2]=g=>e.search=g)},null,512),[[ut,e.search]])]),_:1}),h(A,{flex:"0 0 auto"},{default:F(()=>[t("button",{class:"btn btn-danger",onClick:_},D(e.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",So,[Mo,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:w},null,32)]),t("button",{class:"btn btn-success",onClick:E},D(e.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:a[3]||(a[3]=g=>C())},"\u6DFB\u52A0")]),_:1})]),_:1}),h(Co,{show:U.show,"onUpdate:show":a[4]||(a[4]=g=>U.show=g),onReference:a[5]||(a[5]=g=>Y()),onInit:a[6]||(a[6]=g=>lt.value=g)},null,8,["show"])]),t("div",Uo,[t("div",Vo,[h(X,{modelValue:I.input,"onUpdate:modelValue":a[7]||(a[7]=g=>I.input=g),result:I.result,"onUpdate:result":a[8]||(a[8]=g=>I.result=g),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Io,h(ce,{readonly:"",value:b(I.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",To,[t("div",Ho,[(r(!0),v(H,null,q(u(l),(g,Ct)=>(r(),at(u(le),{key:g.id,activeKey:Ct===V.value,onToggle:z=>V.value=z?Ct:-1},{header:F(()=>[h(G,{flex:"",middle:""},{default:F(()=>[h(A,null,{default:F(()=>[O(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":a[9]||(a[9]=z=>e.selecteds=z),value:Ct,onClick:a[10]||(a[10]=gt(()=>{},["stop"]))},null,8,Po),[[Bt,e.selecteds]]),Ro]),_:2},1024),h(A,null,{default:F(()=>[e.id===g.id?O((r(),v("input",{key:0,type:"text",class:"input","onUpdate:modelValue":a[11]||(a[11]=z=>e.title=z),onClick:a[12]||(a[12]=gt(()=>{},["stop"])),onKeypress:Mt(z=>i(g.id),["enter"])},null,40,Go)),[[ut,e.title],[ct]]):(r(),v("span",No,D(g.title),1))]),_:2},1024),h(A,{class:"ml-4",onClick:a[13]||(a[13]=gt(()=>{},["stop"]))},{default:F(()=>[e.id===g.id?(r(),v("button",{key:0,class:"btn btn-sm btn-link",onClick:z=>i(g.id)},"\u786E\u8BA4",8,qo)):(r(),v(H,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:z=>Y(g)},"\u9009\u62E9",8,jo),t("button",{class:"btn btn-sm btn-link",onClick:z=>{e.id=g.id,e.title=g.title}},[h(u(Ae),{class:"svg-icon"}),Oo],8,Lo),t("button",{class:"btn btn-sm btn-link",onClick:z=>Ft(g)},[h(u(Lt),{class:"svg-icon"}),Ko],8,zo)],64))]),_:2},1024)]),_:2},1024)]),actions:F(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:z=>S(g)},"\u5BFC\u51FA\u56FE\u50CF",8,Jo),t("button",{class:"btn btn-sm btn-success-outline",onClick:z=>y(g)},"\u5BFC\u51FA",8,Qo),t("button",{class:"btn btn-sm btn-danger-outline",onClick:z=>p(g.id)},"\u5220\u9664",8,Xo)]),default:F(()=>[Ct===V.value?(r(),at(u(en),{key:0,data:g,"onUpdate:data":z=>R(z,g.id)},null,8,["data","onUpdate:data"])):K("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),h(u(fn),{show:T.value,"onUpdate:show":a[18]||(a[18]=g=>T.value=g),onClick:L},{extra:F(()=>[t("div",Wo,[h(ot,null,{default:F(()=>[t("label",null,[Zo,O(t("input",{type:"checkbox","onUpdate:modelValue":a[14]||(a[14]=g=>$t(M)?M.value=g:null)},null,512),[[Bt,u(M)]])]),t("label",null,[Yo,O(t("input",{type:"checkbox","onUpdate:modelValue":a[15]||(a[15]=g=>$t(m)?m.value=g:null)},null,512),[[Bt,u(m)]])]),t("label",null,[tu,O(t("input",{type:"checkbox","onUpdate:modelValue":a[16]||(a[16]=g=>$t(c)?c.value=g:null)},null,512),[[Bt,u(c)]])]),t("label",null,[eu,O(t("input",{type:"checkbox","onUpdate:modelValue":a[17]||(a[17]=g=>$t(k)?k.value=g:null)},null,512),[[Bt,u(k)]])])]),_:1})])]),_:1},8,["show"])])}}});const ru=st(su,[["__scopeId","data-v-2cc2cbb6"]]);export{ru as default};
