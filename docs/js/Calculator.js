import{_ as K,E as ne,o as f,c as b,e as t,G as ae,H as oe,J as le,K as ue,L as ot,d as et,q as z,M as Tt,N as W,f as k,j as vt,n as Et,m as nt,a as D,g as l,h as p,u as n,i as at,w as P,B as tt,O as wt,P as ie,F as N,r as j,z as R,Q as bt,R as Nt,p as $t,l as Ft,S as ce,U as _t,b as ct,T as de,I as re,x as pe,V as _e,k as ut,y as mt,v as It,W as H,X as ve,C as ht}from"./index.js";import{_ as Dt}from"./lodash.js";import{u as fe}from"./useHeroes.js";import he from"./InputNumber.js";import{b as qt,d as xt,a as me,i as be}from"./shared.js";import{s as Rt}from"./data.js";const $e=["width","height"],Fe=t("path",{d:"M13 16 l-10 -10 l3 -3 l10 10 l10 -10 l3 3 l-10 10 l10 10 l-3 3 l-10 -10 l-10 10 l-3 -3 z"},null,-1),ge=[Fe];function ye(a,s,e,d,_,r){return f(),b("svg",{width:a.width,height:a.height,viewBox:"0 0 32 32"},ge,8,$e)}const Ce=K(ne,[["render",ye]]),Be=["width","height"],we=t("path",{d:"M16 3 l-14 14 l0 6 l14 -14 l14 14 l0 -6 l-14 -14 z"},null,-1),xe=[we];function ke(a,s,e,d,_,r){return f(),b("svg",{width:a.width,height:a.height,viewBox:"0 0 32 32"},xe,8,Be)}const Ee=K(ae,[["render",ke]]),De=["width","height"],Se=t("path",{d:"M16 27 l-14 -14 l0 -6 l14 14 l14 -14 l0 6 l-14 14 z"},null,-1),Me=[Se];function Ae(a,s,e,d,_,r){return f(),b("svg",{width:a.width,height:a.height,viewBox:"0 0 32 32"},Me,8,De)}const Ue=K(oe,[["render",Ae]]),Ve=["width","height"],Ie=t("path",{d:"M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"},null,-1),He=[Ie];function Pe(a,s,e,d,_,r){return f(),b("svg",{width:a.width,height:a.height,viewBox:"0 0 24 24"},He,8,Ve)}const jt=K(le,[["render",Pe]]),Te=["width","height"],Ne=t("path",{d:"M18 12.13V10H20V10.3C19.78 10.42 19.57 10.56 19.39 10.74L18 12.13M9.5 11C9.22 11 9 11.22 9 11.5V13H15V11.5C15 11.22 14.78 11 14.5 11H9.5M6 10H4V21H11V19.13L11.13 19H6V10M21 9H3V3H21V9M19 5H5V7H19V5M13 19.96V22H15.04L21.17 15.88L19.13 13.83L13 19.96M22.85 13.47L21.53 12.15C21.33 11.95 21 11.95 20.81 12.15L19.83 13.13L21.87 15.17L22.85 14.19C23.05 14 23.05 13.67 22.85 13.47Z"},null,-1),qe=[Ne];function Re(a,s,e,d,_,r){return f(),b("svg",{width:a.width,height:a.height,viewBox:"0 0 24 24"},qe,8,Te)}const je=K(ue,[["render",Re]]);let Bt=0,Ht=0;const Ke=500;function Pt(){const a=Math.floor(new Date().getTime()/1e3);Ht===a?Bt++:Bt=0,Ht=a;const s=a.toString(16);return`${(Ke<<16|Bt&255).toString(16)}.${s}`}async function Oe(){try{return await ot.getAll("calculator")}catch{return[]}}async function Ge(a){try{await ot.add("calculator",JSON.parse(JSON.stringify(a)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function gt(a){try{await ot.put("calculator",JSON.parse(JSON.stringify(a)))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function Le(a){try{await ot.delete("calculator",a)}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function Qe(a){try{const d=(await ot.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const _ of a)await ot.wrap(d.put(_))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}async function Je(a){try{const d=(await ot.connect()).transaction("calculator","readwrite").objectStore("calculator");for(const _ of a)await ot.wrap(d.delete(_))}catch(s){s instanceof Error?console.log(s.message):console.log(s)}}function ze(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function We(){return{a:0}}function Xe(){return{att:0,k:0}}function Kt(){return{name:"1.5\u6280\u80FD",desc:"",a1:1.5,a2:0,att:"15+10+8",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",att2:"0",da2:"0",dx2:"0",defGain:"0"}}function Ze(){return{a1:1.5,a2:0,att:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,att2:0,da2:0,dx2:0,defGain:0}}function Ye(){return[Kt()]}function ts(){return{hp:"10000",def:"1872",defExt:"0",defGain:"15+5",ra:"0",rb:"4+10"}}const es=et({props:{active:Boolean,label:String,dir:String,inline:Boolean,color:String,wait:{type:Number,default:500}},emits:["update:active"],setup(a,{emit:s}){const e=z(),d=z({}),_=z(a.active),r=()=>{const x=e.value.getBoundingClientRect();switch(_.value=!0,s("update:active",_.value),a.dir){case"left":d.value={top:`${x.top+x.height/2}px`,right:`${window.innerWidth-x.left-4}px`,maxWidth:"100%"};break;case"right":d.value={top:`${x.top+x.height/2}px`,left:`${x.right+4}px`,maxWidth:"100%"};break;case"top":d.value={bottom:`${window.innerHeight-x.top-4}px`,left:`${x.left+x.width/2}px`,maxWidth:"100%"};break;default:d.value={top:`${x.bottom+4}px`,left:`${x.left+x.width/2}px`,maxWidth:"100%"}}};let v;const w=()=>{v=window.setTimeout(r,a.wait)},T=()=>{clearTimeout(v),_.value=!1,s("update:active",_.value)};return Tt(()=>a.active,M=>{_.value=M}),{el:e,style:d,tActive:_,onEnter:w,onOut:T}}});const ss={class:"c-tooltip-label"};function ns(a,s,e,d,_,r){return f(),b("div",{ref:"el",class:vt(["c-tooltip",{active:a.tActive,inline:a.inline}]),onMouseenter:s[0]||(s[0]=(...v)=>a.onEnter&&a.onEnter(...v)),onMouseout:s[1]||(s[1]=(...v)=>a.onOut&&a.onOut(...v))},[W(a.$slots,"label",{},()=>[t("div",ss,k(a.label),1)]),t("div",{class:vt(["c-tooltip-inner",a.dir?`c-tooltip-${a.dir}`:"c-tooltip-bottom",a.color?`c-tooltip-${a.color}`:""]),style:Et(a.style)},[W(a.$slots,"default")],6)],34)}const it=K(es,[["render",ns]]),lt=a=>($t("data-v-7e0f8f09"),a=a(),Ft(),a),as=["onKeypress"],os=["onKeypress"],ls={class:"row"},us={class:"col-item"},is=lt(()=>t("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),cs=R(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),ds={class:"input-group"},rs=["step"],ps=lt(()=>t("div",{class:"input-ext"},"\u500D",-1)),_s={class:"label"},vs={class:"input-group"},fs=lt(()=>t("div",{style:{clear:"both"}},null,-1)),hs={class:"col-item"},ms=lt(()=>t("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),bs=R(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),$s={class:"input-group"},Fs=["step"],gs=lt(()=>t("div",{class:"input-ext"},"\u500D",-1)),ys={class:"label"},Cs={class:"input-group"},Bs={class:"col-item"},ws=lt(()=>t("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),xs={class:"static-control text-center"},ks={class:"darkgold"},Es=lt(()=>t("div",{style:{clear:"both"}},null,-1)),Ds={class:"label"},Ss={class:"bold darkgold"},Ms=lt(()=>t("span",{class:"bold red"},"(\u66B4\u51FB)",-1)),As={class:"static-control text-center"},Us={class:"bold darkgold"},Vs={class:"bold red"},Is={class:"label bold"},Hs={class:"static-control text-center"},Ps={class:"bold darkgold"},Ts={key:0,class:"bold red"},Ns=et({__name:"CalcItem",props:{panel:null,state:null,enemyState:null,itemState:null,showUp:{type:Boolean},showDown:{type:Boolean}},emits:["close","up","down","copy","update:itemState"],setup(a,{emit:s}){const e=a,d=nt({editor:!1,name:"",desc:{f:!1,v:""}}),_=(h,C)=>{if(h==="name")return;const m=e.itemState;switch(h){case"a1":case"a2":typeof C=="number"&&(m[h]=C);break;default:typeof C=="string"&&(m[h]=C)}s("update:itemState",m)},r=nt(Ze()),v=D({set:h=>_("a1",h),get:()=>e.itemState.a1}),w=D({set:h=>_("a2",h),get:()=>e.itemState.a2}),T=D({set:h=>_("att",h),get:()=>e.itemState.att}),M=D({set:h=>_("id",h),get:()=>e.itemState.id}),x=D({set:h=>_("da",h),get:()=>e.itemState.da}),V=D({set:h=>_("db",h),get:()=>e.itemState.db}),A=D({set:h=>_("dc",h),get:()=>e.itemState.dc}),G=D({set:h=>_("dx",h),get:()=>e.itemState.dx}),X=D({set:h=>_("cd",h),get:()=>e.itemState.cd}),Z=D({set:h=>_("att2",h),get:()=>e.itemState.att2}),Q=D({set:h=>_("da2",h),get:()=>e.itemState.da2}),st=D({set:h=>_("dx2",h),get:()=>e.itemState.dx2}),Y=D({set:h=>_("defGain",h),get:()=>e.itemState.defGain}),I=nt({a1:v,a2:w,att:T,da:x,db:V,dc:A,dx:G,id:M,cd:X,att2:Z,da2:Q,dx2:st,defGain:Y}),q=[{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],o=[{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"att2",label:"\u653B\u51FB\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u653B\u51FB\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"da2",label:"\u4F24\u5BB3\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u4F24\u5BB3\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"},{name:"dx2",label:"X\u7C7B\u4FEE\u6B63%",tip:"\u6389\u8840\u540E\u9632\u5FA1\u4FEE\u6B63\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u8FDE\u51FB\u65F6"}],$=D(()=>{const{state:h}=e,C=(100+r.att)/100;return Math.ceil(h.att*C)}),c=D(()=>{const{state:h}=e,C=(100+r.att+r.att2)/100;return Math.ceil(h.att*C)}),g=()=>{const{state:h,enemyState:C}=e,m=(100+h.k)/100,B=(100+r.da-C.ra)/100,E=(100+r.da+r.da2-C.ra)/100,St=(100+r.db-C.rb)/100,Lt=(100+r.dc)/100,Qt=(100+r.dx)/100,Jt=(100+r.dx+r.dx2)/100,Mt=(100+r.cd)/100,At=(100-r.id)/100,zt=(100+C.defGain)/100,Wt=(100+C.defGain+r.defGain)/100,Xt=Math.max(0,Math.max(0,C.def*zt+C.defExt)*At),Zt=Math.max(0,Math.max(0,C.def*Wt+C.defExt)*At),Yt=Math.max(1,$.value*m-Xt),te=Math.max(1,c.value*m-Zt),Ut=Yt*I.a1*B*St*Qt,ee=Math.ceil(Ut*Mt),Vt=te*I.a2*E*St*Lt*Jt,se=Math.ceil(Vt*Mt);return{r01:Math.ceil(Ut),r01c:ee,r02:Math.ceil(Vt),r02c:se}},u=D(()=>g().r01),L=D(()=>g().r01c),J=D(()=>g().r02),rt=D(()=>g().r02c);g();function yt(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&s("close")}function Ct(){d.editor=!0,d.name=e.itemState.name}function pt(){const h=d.name;if(d.editor=!1,d.name="",!h)return;const C=e.itemState;C.name=h,s("update:itemState",C)}function F(){d.desc.f=!0,d.desc.v=e.itemState.desc}function i(){const h=d.desc.v;if(d.desc.f=!1,d.desc.v="",!h)return;const C=e.itemState;C.desc=h,s("update:itemState",C)}function y(){s("up")}function U(){s("down")}function O(){s("copy")}return(h,C)=>{const m=Nt("autofocus");return f(),b(N,null,[l(n(ie),{orientation:"left"},{action:p(()=>[t("span",{onClick:O},[l(n(jt),{class:"close"})]),a.showUp?(f(),b("span",{key:0,onClick:y},[l(n(Ee),{class:"close"})])):at("",!0),a.showDown?(f(),b("span",{key:1,onClick:U},[l(n(Ue),{class:"close"})])):at("",!0),t("span",{onClick:yt},[l(n(Ce),{class:"close"})])]),default:p(()=>[d.editor?P((f(),b("input",{key:0,class:"input",type:"text","onUpdate:modelValue":C[0]||(C[0]=B=>d.name=B),onKeypress:wt(pt,["enter"]),onBlur:pt},null,40,as)),[[tt,d.name],[m]]):(f(),b("span",{key:1,class:"calc-item-title",onClick:Ct},k(a.itemState.name||"\u6A21\u677F"),1)),d.desc.f?P((f(),b("input",{key:2,class:"input",type:"text","onUpdate:modelValue":C[1]||(C[1]=B=>d.desc.v=B),onKeypress:wt(i,["enter"]),onBlur:i},null,40,os)),[[tt,d.desc.v],[m]]):(f(),b("span",{key:3,class:"calc-item-desc",onClick:F},k(a.itemState.desc||"\u6CA1\u6709\u63CF\u8FF0"),1))]),_:1}),t("div",ls,[t("div",us,[l(n(it),{dir:"top"},{label:p(()=>[is]),default:p(()=>[cs]),_:1}),t("div",ds,[P(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":C[2]||(C[2]=B=>I.a1=B)},null,8,rs),[[tt,I.a1,void 0,{number:!0}]]),ps])]),(f(),b(N,null,j(q,B=>t("div",{class:"col-item",key:B.name},[l(n(it),{dir:"top"},{label:p(()=>[t("div",_s,k(B.label),1)]),default:p(()=>[R(" "+k(B.tip),1)]),_:2},1024),t("div",vs,[l(n(bt),{class:"input",modelValue:I[B.name],"onUpdate:modelValue":E=>I[B.name]=E,result:r[B.name],"onUpdate:result":E=>r[B.name]=E},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),fs,t("div",hs,[l(n(it),{dir:"top"},{label:p(()=>[ms]),default:p(()=>[bs]),_:1}),t("div",$s,[P(t("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":C[3]||(C[3]=B=>I.a2=B)},null,8,Fs),[[tt,I.a2,void 0,{number:!0}]]),gs])]),(f(),b(N,null,j(o,B=>t("div",{class:"col-item",key:B.name},[l(n(it),{dir:"top"},{label:p(()=>[t("div",ys,k(B.label),1)]),default:p(()=>[R(" "+k(B.tip),1)]),_:2},1024),t("div",Cs,[l(n(bt),{class:"input",modelValue:I[B.name],"onUpdate:modelValue":E=>I[B.name]=E,result:r[B.name],"onUpdate:result":E=>r[B.name]=E},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),t("div",Bs,[ws,t("div",xs,[t("span",ks,k(n($)),1)])]),Es,(f(!0),b(N,null,j([{label:"\u4E00\u6BB5\u4F24\u5BB3",v:n(u),v2:n(L)},{label:"\u4E8C\u6BB5\u4F24\u5BB3",v:n(J),v2:n(rt)}],(B,E)=>(f(),b("div",{class:"col-item",key:E},[t("div",Ds,[t("span",Ss,k(B.label),1),Ms]),t("div",As,[t("span",Us,k(B.v),1),t("span",Vs,"("+k(B.v2)+")",1)])]))),128)),(f(!0),b(N,null,j([{label:"\u4E0D\u66B4\u51FB",value:n(u)+n(J)},{label:"\u4E00\u6BB5\u66B4\u51FB",value:n(L)+n(J)},{label:"\u4E8C\u6BB5\u66B4\u51FB",value:n(u)+n(rt)},{label:"\u5168\u66B4\u51FB",value:n(L)+n(rt)}],(B,E)=>(f(),b("div",{class:"col-item",key:E},[t("div",Is,k(B.label),1),t("div",Hs,[t("span",Ps,k(B.value),1),(+a.enemyState.hp||0)<=B.value?(f(),b("span",Ts," \u51FB\u6740 ")):at("",!0)])]))),128))])],64)}}});const qs=K(Ns,[["__scopeId","data-v-7e0f8f09"]]),Rs=["onClick"],js=et({__name:"dropdown",props:{pos:{default:"lt"}},setup(a){const s=z(!1),e=()=>{s.value=!0},d=()=>{s.value=!1};return window.addEventListener("click",d,!1),ce(()=>{window.removeEventListener("click",d,!1)}),(_,r)=>(f(),b("div",{class:vt(["dropdown",[{active:s.value}]]),onClick:_t(e,["stop"])},[W(_.$slots,"default",{},void 0,!0),t("div",{class:vt(["dropdown-popover",["dropdown-"+a.pos]]),onClick:r[0]||(r[0]=_t(()=>{},["stop"]))},[W(_.$slots,"popover",{onClose:d},void 0,!0)],2)],10,Rs))}});const Ot=K(js,[["__scopeId","data-v-e27f2ee9"]]);Ot.install=a=>{a.component("dropdown",Gt)};const Gt=Ot,dt=a=>($t("data-v-99433d9d"),a=a(),Ft(),a),Ks=dt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),Os={class:"row"},Gs={class:"label"},Ls={class:"input-group"},Qs=["step","onUpdate:modelValue","onChange"],Js=["value"],zs={class:"col-item"},Ws=dt(()=>t("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),Xs={class:"static-control text-center"},Zs={class:"darkgold"},Ys={class:"col-item"},tn=dt(()=>t("div",{class:"label"},"\u514B\u5236%",-1)),en=R(" \u514B\u523630%"),sn=dt(()=>t("br",null,null,-1)),nn=R("\u88AB\u514B\u5236-25%"),an=dt(()=>t("br",null,null,-1)),on=R("\u6FC0\u836150% "),ln=["onClick"],un=dt(()=>t("div",{class:"heading"},[t("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),cn={class:"row"},dn={class:"label"},rn={key:1,class:"label"},pn={class:"input-group"},_n={key:0,class:"input-ext"},vn=dt(()=>t("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),fn=et({__name:"Calculator",props:{data:null},emits:["update:data"],setup(a,{emit:s}){const e=a,d=D(()=>e.data.basic),_=D(()=>e.data.state),r=D(()=>e.data.enemyState),v=D(()=>e.data.items),w=nt(We()),T=nt({hp:0,def:0,defExt:0,defGain:0,ra:0,rb:0}),M=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],x=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9644\u52A0\u9632\u5FA1",name:"defExt",step:1,tips:"\u4E00\u822C\u4E3A\u653B\u8F6C\u9632\u9644\u52A0\u7684\u56FA\u5B9A\u9632\u5FA1"},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],V=()=>{const o=d.value.c/100;d.value.g=Math.ceil(w.a+d.value.w*o+d.value.x),_.value.att=d.value.w+d.value.g},A=async()=>{s("update:data",e.data)},G=(o,$)=>{$==="panel"&&V(),A()},X=o=>{o(),G("k","state")},Z=(o,$)=>{const c=e.data.items;!c||(c[$]=o,A())},Q=()=>{const o=e.data.items;!o||(o.push(Kt()),A())},st=o=>{const $=e.data.items;!$||($.splice(o,1),A())},Y=o=>{const $=e.data.items;if(!$)return;const c=$[o],g=$[o-1];$[o-1]=c,$[o]=g,A()},I=o=>{const $=e.data.items;if(!$)return;const c=$[o],g=$[o+1];$[o+1]=c,$[o]=g,A()},q=o=>{const $=e.data.items;if(!$)return;const c=$[o];$.push(Dt.cloneDeep(c)),A()};return Tt(()=>[e.data.basic.w],()=>{V()}),(o,$)=>(f(),b("div",null,[Ks,t("div",Os,[(f(),b(N,null,j(M,c=>t("div",{class:"col-item",key:c.name},[t("div",Gs,k(c.label),1),t("div",Ls,[c.name in w?(f(),ct(n(bt),{key:0,modelValue:n(d)[c.name],"onUpdate:modelValue":g=>n(d)[c.name]=g,result:w[c.name],"onUpdate:result":g=>w[c.name]=g,onChange:g=>G(c.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):P((f(),b("input",{key:1,type:"number",class:"input",style:Et({textAlign:c.align}),min:"0",step:c.step,"onUpdate:modelValue":g=>n(d)[c.name]=g,onChange:g=>G(c.name,"panel")},null,44,Qs)),[[tt,n(d)[c.name],void 0,{number:!0}]]),c.name==="w"?(f(),b("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${n(d).g}`},null,8,Js)):at("",!0)])])),64)),t("div",zs,[Ws,t("div",Xs,[t("span",Zs,k(n(_).att),1)])]),t("div",Ys,[l(n(it),{dir:"top"},{label:p(()=>[tn]),default:p(()=>[en,sn,nn,an,on]),_:1}),t("div",null,[l(n(Gt),null,{popover:p(({onClose:c})=>[t("div",{class:"list",onClick:g=>X(c)},[t("div",{class:"list-item",onClick:$[2]||($[2]=g=>n(_).k=0)},"\u666E\u901A"),t("div",{class:"list-item",onClick:$[3]||($[3]=g=>n(_).k=30)},"\u514B\u5236"),t("div",{class:"list-item",onClick:$[4]||($[4]=g=>n(_).k=-25)},"\u88AB\u514B\u5236"),t("div",{class:"list-item",onClick:$[5]||($[5]=g=>n(_).k=50)},"\u6FC0\u8361")],8,ln)]),default:p(()=>[P(t("input",{class:"input",type:"number","onUpdate:modelValue":$[0]||($[0]=c=>n(_).k=c),onChange:$[1]||($[1]=c=>G("k","state")),list:"d1"},null,544),[[tt,n(_).k,void 0,{number:!0}]])]),_:1})])])]),un,t("div",cn,[(f(),b(N,null,j(x,c=>t("div",{class:"col-item",key:c.name},[c.tips?(f(),ct(n(it),{key:0,dir:"top"},{label:p(()=>[t("div",dn,k(c.label),1)]),default:p(()=>[R(" "+k(c.tips),1)]),_:2},1024)):(f(),b("div",rn,k(c.label),1)),t("div",pn,[l(n(bt),{modelValue:n(r)[c.name],"onUpdate:modelValue":g=>n(r)[c.name]=g,result:T[c.name],"onUpdate:result":g=>T[c.name]=g,onChange:g=>G(c.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),c.precent?(f(),b("div",_n,"%")):at("",!0)])])),64))]),t("div",{class:"heading"},[vn,t("div",{class:"heading-actions"},[t("div",{class:"btn btn-primary btn-sm",onClick:Q},"\u6DFB\u52A0")])]),(f(!0),b(N,null,j(n(v),(c,g)=>(f(),ct(qs,{key:c,panel:n(d),state:n(_),enemyState:T,itemState:c,showUp:g>0,showDown:n(v)&&g<n(v).length-1,"onUpdate:itemState":u=>Z(u,g),onClose:u=>st(g),onUp:u=>Y(g),onDown:u=>I(g),onCopy:u=>q(g)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))]))}});const hn=K(fn,[["__scopeId","data-v-99433d9d"]]),mn=et({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(a,{emit:s}){return{wrapClass:D(()=>["c-action-sheet-wrapper",a.class,{show:a.show}]),onClick:(r,v)=>{s("click",{item:r,index:v}),s("close",!1)},onClose:()=>{s("update:show",!1),s("close",!1)}}}});const bn={class:"c-action-sheet-section"},$n={class:"c-action-sheet-extra"},Fn={class:"c-action-sheet-list"},gn=["onClick"];function yn(a,s,e,d,_,r){return f(),ct(de,{to:"body"},[t("div",{class:vt(a.wrapClass)},[t("div",{class:"c-action-sheet-mask",onClick:s[0]||(s[0]=(...v)=>a.onClose&&a.onClose(...v))}),t("div",bn,[t("div",{class:"c-action-sheet-body",style:Et({maxHeight:a.height})},[t("div",$n,[W(a.$slots,"extra")]),t("div",Fn,[(f(!0),b(N,null,j(a.list,(v,w)=>(f(),b("div",{class:"c-action-sheet-item",key:w,onClick:T=>a.onClick(v,w)},[W(a.$slots,"default",{record:v})],8,gn))),128))])],4)])],2)])}const kt=K(mn,[["render",yn]]);kt.install=a=>{a.component("action-sheet",kt)};const Cn={class:"hero-item"},Bn=["src","alt","title"],wn={class:"hero-item-label"},xn=et({__name:"HeroSelect",props:{show:{type:Boolean}},emits:["click","update:show"],setup(a,{emit:s}){const{heroes:e,getHeroIcon:d}=fe(),_=r=>{s("click",r)};return(r,v)=>(f(),ct(n(kt),{class:"hero-select",show:a.show,list:n(e),height:"80vh",onClick:_,"onUpdate:show":v[0]||(v[0]=w=>r.$emit("update:show",w))},{extra:p(()=>[W(r.$slots,"extra")]),default:p(({record:w})=>[t("div",Cn,[t("img",{src:n(d)(w),alt:w.name,title:w.name,width:"128",height:"128"},null,8,Bn),t("div",wn,k(w.name),1)])]),_:3},8,["show","list"]))}});const kn=et({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(a,{emit:s}){const e=D({get:()=>a.activeKey,set:_=>{s("update:activeKey",_)}});return{active:e,toggle:()=>{const _=!e.value;e.value=_,s("toggle",_)}}}});const En=a=>($t("data-v-829ec263"),a=a(),Ft(),a),Dn=En(()=>t("div",{class:"panel-icon"},[t("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[t("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Sn={class:"panel-title"},Mn={class:"panel-body"},An={class:"panel-content"};function Un(a,s,e,d,_,r){return f(),b("div",{class:vt(["panel",{active:a.active}])},[t("div",{class:"panel-header",onClick:s[1]||(s[1]=(...v)=>a.toggle&&a.toggle(...v))},[Dn,t("div",Sn,[W(a.$slots,"header",{},()=>[R(k(a.header)+"\xA0",1)],!0)]),t("div",{class:"panel-actions",onClick:s[0]||(s[0]=_t(()=>{},["stop"]))},[W(a.$slots,"actions",{},void 0,!0)])]),t("div",Mn,[t("div",An,[W(a.$slots,"default",{},void 0,!0)])])],2)}const Vn=K(kn,[["render",Un],["__scopeId","data-v-829ec263"]]);function In(){const a="red_team",s=re(),e=z([]),d=async M=>{const V=(await s.transaction(a,"readwrite")).objectStore(a),A=await s.wrap(V.put(M));return e.value.find(X=>X._id===M._id)||(M._id=A,e.value.push(M)),A},_=async M=>{const V=(await s.transaction(a,"readwrite")).objectStore(a);await s.wrap(V.delete(M._id)),e.value=e.value.filter(A=>A._id!==M._id)},r=async M=>{const V=(await s.transaction(a,"readwrite")).objectStore(a);for(const A of M)await s.wrap(V.put(A));await v()},v=async()=>{const x=(await s.transaction(a,"readonly")).objectStore(a),V=await s.wrap(x.getAll()).catch(()=>[]);e.value=V},w=async M=>{const x=JSON.parse(await M.text());if(!qt(x)||x.type!=="red_team"){alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}const V=x.data;await r(V)},T=async()=>{const M={type:"red_team",data:e.value},x=new Blob([JSON.stringify(M)],{type:"application/json"});xt(x,"red_team.json")};return v(),{put:d,del:_,puts:r,all:v,list:e,importData:w,exportData:T}}function Hn(){const a=()=>({name:"",qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,stoneName:"",hsQixue:0,hsPatt:0,hsPdef:0,hsMatt:0,hsMdef:0,hsHuixin:0,xQixue:0,xPatt:0,xPdef:0,xMatt:0,xMdef:0,xHuixin:0,cQixue:"40+5+5+5",cPatt:"0",cPdef:"0",cMatt:"0",cMdef:"0",cHuixin:"0",rQixue:0,rPatt:0,rPdef:0,rMatt:0,rMdef:0,rHuixin:0}),s=z(a()),e=D(()=>{const r={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0},v=Rt.find(T=>s.value.stoneName===T.name);v&&(r.qixue=v.t[0]+v.d[0]+v.h[0],r.patt=v.t[1]+v.d[1]+v.h[1],r.matt=v.t[2]+v.d[2]+v.h[2],r.pdef=v.t[3]+v.d[3]+v.h[3],r.mdef=v.t[4]+v.d[4]+v.h[4]);const w={qixue:s.value.hsQixue/100,patt:s.value.hsPatt/100,pdef:s.value.hsPdef/100,matt:s.value.hsMatt/100,mdef:s.value.hsMdef/100,huixin:s.value.hsHuixin/100};return{qixue:Math.round(s.value.qixue*w.qixue+r.qixue+s.value.xQixue),patt:Math.round(s.value.patt*w.patt+r.patt+s.value.xPatt),pdef:Math.round(s.value.pdef*w.pdef+r.pdef+s.value.xPdef),matt:Math.round(s.value.matt*w.matt+r.matt+s.value.xMatt),mdef:Math.round(s.value.mdef*w.mdef+r.mdef+s.value.xMdef),huixin:Math.round(s.value.huixin*w.huixin+r.huixin+s.value.xHuixin)}}),d=D(()=>{const r=e.value,v={qixue:(100+s.value.rQixue)/100,patt:(100+s.value.rPatt)/100,pdef:(100+s.value.rPdef)/100,matt:(100+s.value.rMatt)/100,mdef:(100+s.value.rMdef)/100,huixin:(100+s.value.rHuixin)/100};return{qixue:Math.round((s.value.qixue+r.qixue)*v.qixue),patt:Math.round((s.value.patt+r.patt)*v.patt),pdef:Math.round((s.value.pdef+r.pdef)*v.pdef),matt:Math.round((s.value.matt+r.matt)*v.matt),mdef:Math.round((s.value.mdef+r.mdef)*v.mdef),huixin:Math.round((s.value.huixin+r.huixin)*v.huixin)}});return{state:s,pValue:e,ckValue:d,reset:()=>{s.value=a()},defState:a}}const Pn={},Tn={class:"c-upload"};function Nn(a,s){return f(),b("div",Tn,[W(a.$slots,"default",{},void 0,!0),t("input",pe({type:"file",class:"c-upload-input",accept:"application/json"},a.$attrs),null,16)])}const qn=K(Pn,[["render",Nn],["__scopeId","data-v-b3879154"]]),S=a=>($t("data-v-a18f361c"),a=a(),Ft(),a),Rn={class:"transform-tools-popover"},jn={class:"transform-tools-popover-toolbar"},Kn=["value"],On=["value"],Gn=S(()=>t("button",{class:"btn btn-sm btn-success"},"\u5BFC\u5165",-1)),Ln={class:"transform-tools-popover-content"},Qn={class:"grid-group"},Jn={class:"grid-group-item"},zn={class:"input-group-title"},Wn=S(()=>t("span",null,"\u57FA\u7840",-1)),Xn={class:"grids"},Zn=S(()=>t("label",{class:"input-label"},"\u6C14\u8840",-1)),Yn=S(()=>t("label",{class:"input-label"},"\u7269\u653B",-1)),ta=S(()=>t("label",{class:"input-label"},"\u7269\u9632",-1)),ea=S(()=>t("label",{class:"input-label"},"\u6CD5\u653B",-1)),sa=S(()=>t("label",{class:"input-label"},"\u6CD5\u9632",-1)),na=S(()=>t("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),aa={class:"grid-group-item"},oa={class:"input-group-title"},la=S(()=>t("span",null,"\u9B42\u77F3",-1)),ua=S(()=>t("option",{value:""},"\u65E0",-1)),ia=["value"],ca={class:"grids"},da=S(()=>t("label",{class:"input-label"},"\u6C14\u8840%",-1)),ra=S(()=>t("label",{class:"input-label"},"\u7269\u653B%",-1)),pa=S(()=>t("label",{class:"input-label"},"\u7269\u9632%",-1)),_a=S(()=>t("label",{class:"input-label"},"\u6CD5\u653B%",-1)),va=S(()=>t("label",{class:"input-label"},"\u6CD5\u9632%",-1)),fa={class:"grid-group-item"},ha={class:"input-group-title"},ma=R(" \u661F\u4E4B\u6676 "),ba=S(()=>t("div",null,"\u6781\u9650\u653B\uFF1A202\u653B\uFF0C198\u8840\uFF0C70\u9632",-1)),$a=S(()=>t("div",null,"\u6781\u9650\u8840\uFF1A456\u8840\uFF0C70\u9632\uFF0C88\u653B",-1)),Fa=S(()=>t("div",null,"\u6781\u9650\u9632\uFF1A150\u9632\uFF0C198\u8840\uFF0C88\u653B",-1)),ga={class:"grids"},ya=S(()=>t("label",{class:"input-label"},"\u6C14\u8840",-1)),Ca=S(()=>t("label",{class:"input-label"},"\u7269\u653B",-1)),Ba=S(()=>t("label",{class:"input-label"},"\u7269\u9632",-1)),wa=S(()=>t("label",{class:"input-label"},"\u6CD5\u653B",-1)),xa=S(()=>t("label",{class:"input-label"},"\u6CD5\u9632",-1)),ka=S(()=>t("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),Ea={class:"grid-group-item"},Da=S(()=>t("div",{class:"input-group-title"},"\u9762\u677F",-1)),Sa={class:"grids"},Ma={class:"input-label"},Aa={class:"input-group"},Ua={class:"input green"},Va={class:"grid-group-item"},Ia=S(()=>t("div",{class:"input-group-title"},"\u4FEE\u6B63",-1)),Ha={class:"grids"},Pa={class:"input-label"},Ta={class:"grid-group-item"},Na=S(()=>t("div",{class:"input-group-title"},"\u53C2\u8003",-1)),qa={class:"grids"},Ra={class:"input-label"},ja=["value"],Ka=et({__name:"transform-tools-modal",props:{show:{type:Boolean}},emits:["init","reference","update:show"],setup(a,{emit:s}){const{state:e,pValue:d,ckValue:_,reset:r,defState:v}=Hn(),{list:w,put:T,del:M,importData:x,exportData:V}=In(),A=[{t:"\u6C14\u8840",n:"qixue"},{t:"\u7269\u653B",n:"patt"},{t:"\u7269\u9632",n:"pdef"},{t:"\u6CD5\u653B",n:"matt"},{t:"\u6CD5\u9632",n:"mdef"},{t:"\u4F1A\u5FC3",n:"huixin"}],G=[{t:"\u6C14\u8840%",c:"cQixue",r:"rQixue"},{t:"\u7269\u653B%",c:"cPatt",r:"rPatt"},{t:"\u7269\u9632%",c:"cPdef",r:"rPdef"},{t:"\u6CD5\u653B%",c:"cMatt",r:"rMatt"},{t:"\u6CD5\u9632%",c:"cMdef",r:"rMdef"},{t:"\u4F1A\u5FC3%",c:"cHuixin",r:"rHuixin"}],X=()=>{const q=Dt.cloneDeep(e.value);T(q).then(o=>{e.value._id=o,alert("\u5DF2\u4FDD\u5B58")}).catch(o=>{console.log(o),alert("\u4FDD\u5B58\u5931\u8D25")})},Z=()=>{!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F")||M(e.value).then(()=>{r()}).catch(o=>{console.log(o),alert("\u5220\u9664\u5931\u8D25")})},Q=q=>{const o=q.currentTarget,$=Array.prototype.slice.call(o.files);o.value="",$[0]&&x($[0])},st=()=>{V()},Y=(q,o)=>{e.value.name=q,e.value.qixue=o.qixue,e.value.patt=o.patt,e.value.pdef=o.pdef,e.value.matt=o.matt,e.value.mdef=o.mdef,e.value.huixin=o.huixin},I=()=>{s("reference")};return s("init",Y),(q,o)=>{const $=ut("c-col"),c=ut("c-space"),g=ut("c-row");return P((f(),b("div",Rn,[t("div",jn,[l(g,{flex:"",middle:"",gutter:8},{default:p(()=>[l($,null,{default:p(()=>[t("button",{class:"btn btn-sm btn-link",onClick:I}," \u53C2\u8003 ")]),_:1}),l($,null,{default:p(()=>[R("ID: "+k(n(e)._id),1)]),_:1}),l($,{flex:"1 1 auto"},{default:p(()=>[l(c,null,{default:p(()=>[P(t("select",{class:"input input-select",placeholder:"\u8BF7\u9009\u62E9\u5DF2\u6709\u6A21\u677F","onUpdate:modelValue":o[0]||(o[0]=u=>mt(e)?e.value=u:null)},[t("option",{value:n(v)()},"\u7A7A\u6A21\u7248",8,Kn),(f(!0),b(N,null,j(n(w),u=>(f(),b("option",{key:u._id,value:u},k(u.name),9,On))),128))],512),[[It,n(e)]]),t("button",{class:"btn btn-sm btn-primary",onClick:X},"\u4FDD\u5B58"),n(e)._id?(f(),b("button",{key:0,class:"btn btn-sm btn-danger",onClick:Z}," \u5220\u9664 ")):at("",!0),l(qn,{onInput:Q},{default:p(()=>[Gn]),_:1}),t("button",{class:"btn btn-sm btn-success",onClick:st}," \u5BFC\u51FA ")]),_:1})]),_:1}),l($,null,{default:p(()=>[t("span",{class:"transform-tools-popover-close",onClick:o[1]||(o[1]=u=>s("update:show",!1))}," \xD7 ")]),_:1})]),_:1})]),t("div",Ln,[t("div",Qn,[t("div",Jn,[t("div",zn,[l(c,null,{default:p(()=>[Wn,P(t("input",{type:"text",class:"input input-text","onUpdate:modelValue":o[2]||(o[2]=u=>n(e).name=u)},null,512),[[tt,n(e).name]])]),_:1})]),t("div",Xn,[l(c,null,{default:p(()=>[Zn,l(n(H),{value:n(e).qixue,"onUpdate:value":o[3]||(o[3]=u=>n(e).qixue=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[Yn,l(n(H),{value:n(e).patt,"onUpdate:value":o[4]||(o[4]=u=>n(e).patt=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[ta,l(n(H),{value:n(e).pdef,"onUpdate:value":o[5]||(o[5]=u=>n(e).pdef=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[ea,l(n(H),{value:n(e).matt,"onUpdate:value":o[6]||(o[6]=u=>n(e).matt=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[sa,l(n(H),{value:n(e).mdef,"onUpdate:value":o[7]||(o[7]=u=>n(e).mdef=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[na,l(n(H),{value:n(e).huixin,"onUpdate:value":o[8]||(o[8]=u=>n(e).huixin=u)},null,8,["value"])]),_:1})])]),t("div",aa,[t("div",oa,[l(c,null,{default:p(()=>[la,P(t("select",{class:"input input-select","onUpdate:modelValue":o[9]||(o[9]=u=>n(e).stoneName=u)},[ua,(f(!0),b(N,null,j(n(Rt),(u,L)=>(f(),b("option",{key:L,value:u.name},k(u.name),9,ia))),128))],512),[[It,n(e).stoneName]])]),_:1})]),t("div",ca,[l(c,null,{default:p(()=>[da,l(n(H),{value:n(e).hsQixue,"onUpdate:value":o[10]||(o[10]=u=>n(e).hsQixue=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[ra,l(n(H),{value:n(e).hsPatt,"onUpdate:value":o[11]||(o[11]=u=>n(e).hsPatt=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[pa,l(n(H),{value:n(e).hsPdef,"onUpdate:value":o[12]||(o[12]=u=>n(e).hsPdef=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[_a,l(n(H),{value:n(e).hsMatt,"onUpdate:value":o[13]||(o[13]=u=>n(e).hsMatt=u)},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[va,l(n(H),{value:n(e).hsMdef,"onUpdate:value":o[14]||(o[14]=u=>n(e).hsMdef=u)},null,8,["value"])]),_:1})])]),t("div",fa,[t("div",ha,[ma,l(n(it),{label:"?",inline:"",dir:"right"},{default:p(()=>[ba,$a,Fa]),_:1})]),t("div",ga,[l(c,null,{default:p(()=>[ya,l(n(H),{value:n(e).xQixue,"onUpdate:value":o[15]||(o[15]=u=>n(e).xQixue=u),min:0,max:456,placeholder:"0~456"},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[Ca,l(n(H),{value:n(e).xPatt,"onUpdate:value":o[16]||(o[16]=u=>n(e).xPatt=u),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[Ba,l(n(H),{value:n(e).xPdef,"onUpdate:value":o[17]||(o[17]=u=>n(e).xPdef=u),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[wa,l(n(H),{value:n(e).xMatt,"onUpdate:value":o[18]||(o[18]=u=>n(e).xMatt=u),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[xa,l(n(H),{value:n(e).xMdef,"onUpdate:value":o[19]||(o[19]=u=>n(e).xMdef=u),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),l(c,null,{default:p(()=>[ka,l(n(H),{value:n(e).xHuixin,"onUpdate:value":o[20]||(o[20]=u=>n(e).xHuixin=u),min:0,max:104,placeholder:"0~104"},null,8,["value"])]),_:1})])]),t("div",Ea,[Da,t("div",Sa,[(f(),b(N,null,j(A,u=>l(c,{key:u.n},{default:p(()=>[t("label",Ma,k(u.t),1),t("div",Aa,[l(n(H),{readonly:"",value:n(e)[u.n]},null,8,["value"]),t("div",Ua,"+"+k(n(d)[u.n]),1)])]),_:2},1024)),64))])]),t("div",Va,[Ia,t("div",Ha,[(f(),b(N,null,j(G,(u,L)=>l(c,{key:L},{default:p(()=>[t("label",Pa,k(u.t),1),l(n(bt),{modelValue:n(e)[u.c],"onUpdate:modelValue":J=>n(e)[u.c]=J,result:n(e)[u.r],"onUpdate:result":J=>n(e)[u.r]=J},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])]),_:2},1024)),64))])]),t("div",Ta,[Na,t("div",qa,[(f(),b(N,null,j(A,u=>l(c,{key:u.n},{default:p(()=>[t("label",Ra,k(u.t),1),t("input",{class:"input",readonly:"",value:n(_)[u.n]},null,8,ja)]),_:2},1024)),64))])])])])],512)),[[_e,a.show]])}}});const Oa=K(Ka,[["__scopeId","data-v-a18f361c"]]),ft=a=>($t("data-v-fd976cab"),a=a(),Ft(),a),Ga={class:"wrapper"},La={class:"toolbar"},Qa={style:{padding:"6px 16px"}},Ja=R("\u4F24\u5BB3\u8BA1\u7B97\u5668"),za={class:"c-upload"},Wa=ft(()=>t("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),Xa={style:{padding:"6px 16px"}},Za={class:"input-group"},Ya=ft(()=>t("div",{class:"input-ext"},"=",-1)),to={class:"content"},eo={class:"container"},so=["value"],no=R(" \u2007 "),ao=["onKeypress"],oo={key:1},lo=["onClick"],uo=["onClick"],io=["onClick"],co=R(" \u91CD\u547D\u540D "),ro=["onClick"],po=R(" \u590D\u5236 "),_o=["onClick"],vo=["onClick"],fo={style:{"text-align":"center"}},ho=ft(()=>t("span",null,"\u661F\u8000",-1)),mo=ft(()=>t("span",null,"\u5316\u81FB",-1)),bo=ft(()=>t("span",null,"\u661F\u9B42",-1)),$o=ft(()=>t("span",null,"\u661F\u8F89",-1)),Fo=et({__name:"Calculator",setup(a){const s=nt({id:"",title:"",selecteds:[],search:""}),e=z([]),d=D(()=>e.value.filter(F=>F.title.indexOf(s.search)>-1)),_=async()=>{const i={id:Pt(),title:"\u6A21\u677F",basic:ze(),state:Xe(),enemyState:ts(),items:Ye()};await Ge(i),e.value.push(i)},r=async F=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const y=e.value.findIndex(U=>U.id===F);y!==-1&&(await Le(e.value[y].id),e.value.splice(y,1))},v=async F=>{const i=s.title;if(!i){w();return}const y=e.value.findIndex(O=>O.id===F);if(y===-1)return;const U=e.value[y];U.title=i,w(),await gt(U)},w=()=>{s.id="",s.title=""},T=F=>{const i={type:"calculator",data:[F]},y=new Blob([JSON.stringify(i)],{type:"application/json"});xt(y,`${F.title}.json`)},M=async F=>{e.value=F},x=F=>new Promise((i,y)=>{const U=new FileReader;U.onload=()=>{i(U.result)},U.onerror=()=>{y(U.error)},U.readAsText(F)}),V=async()=>{if(!confirm("\u786E\u8BA4\u8981\u6E05\u7A7A\u6240\u6709\u6570\u636E\u5417\uFF1F"))return;let i=d.value;s.selecteds.length>0&&(i=s.selecteds.map(y=>d.value[y]).filter(y=>y)),await Je(i.map(y=>y.id)),pt()},A=async F=>{const i=F.currentTarget,y=Array.prototype.slice.call(i.files);if(i.value="",!y||!y[0])return;const U=y[0],O=await x(U),h=JSON.parse(O);let C=[];if(be(h))C=h;else if(qt(h)&&h.type==="calculator")C=h.data;else{alert("\u5BFC\u5165\u7684\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}await Qe(C),pt()},G=async()=>{let F="calculator.json",i=d.value;s.selecteds.length>0&&(i=s.selecteds.map(O=>d.value[O]).filter(O=>O),F="calculator-selected.json");const y={type:"calculator",data:i},U=new Blob([JSON.stringify(y)],{type:"application/json"});xt(U,F)};async function X(F,i){const y=e.value.findIndex(O=>O.id===i);y===-1||!e.value[y]||(e.value[y]=F,await gt(F))}const Z=z(-1),Q=nt({input:"2283/1.35*1.39",result:0}),{translate:st,xingyao:Y,huazhen:I,xinghun:q,xinghui:o}=me(),$=F=>Math.ceil(F),c=nt({show:!1}),g=F=>{const i=st(F);u.value&&u.value(F.name,i)},u=z(),L=z(!1),J=z(),rt=F=>{L.value=!0,J.value=F},yt=({item:F})=>{if(L.value=!1,J.value){const i=J.value,y=st(F);i.title==="\u6A21\u677F"&&(i.title=F.name),i.basic.w=Math.max(y.patt,y.matt),gt(i)}else g(F)},Ct=F=>{const i=Dt.cloneDeep(F);i.id=Pt(),console.log(i),e.value.push(i),gt(i)};async function pt(){const F=await Oe();s.selecteds=[],M(F)}return ve(()=>{pt()}),(F,i)=>{const y=ut("c-col"),U=ut("c-row"),O=ut("calc-input"),h=ut("c-space"),C=Nt("autofocus");return f(),b("div",Ga,[t("div",La,[t("div",Qa,[l(U,{flex:"",middle:"",gutter:16},{default:p(()=>[l(y,{flex:"0 0 auto"},{default:p(()=>[Ja]),_:1}),l(y,{flex:"0 0 auto"},{default:p(()=>[t("button",{class:"btn btn-sm btn-link",onClick:i[0]||(i[0]=m=>c.show=!c.show)}," \u9762\u677F "),s.selecteds.length>0?(f(),b("button",{key:0,class:"btn btn-success",onClick:i[1]||(i[1]=m=>s.selecteds=[])}," \u53D6\u6D88\u6240\u9009 ")):at("",!0)]),_:1}),l(y,{flex:"1 1 0"},{default:p(()=>[P(t("input",{type:"text",class:"input",placeholder:"\u540D\u79F0\u8FC7\u6EE4","onUpdate:modelValue":i[2]||(i[2]=m=>s.search=m)},null,512),[[tt,s.search]])]),_:1}),l(y,{flex:"0 0 auto"},{default:p(()=>[t("button",{class:"btn btn-danger",onClick:V},k(s.selecteds.length>0?"\u5220\u9664\u6240\u9009":"\u6E05\u7A7A"),1),t("div",za,[Wa,t("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:A},null,32)]),t("button",{class:"btn btn-success",onClick:G},k(s.selecteds.length>0?"\u5BFC\u51FA\u6240\u9009":"\u5BFC\u51FA"),1),t("button",{class:"btn btn-primary",onClick:i[3]||(i[3]=m=>_())},"\u6DFB\u52A0")]),_:1})]),_:1}),l(Oa,{show:c.show,"onUpdate:show":i[4]||(i[4]=m=>c.show=m),onReference:i[5]||(i[5]=m=>rt()),onInit:i[6]||(i[6]=m=>u.value=m)},null,8,["show"])]),t("div",Xa,[t("div",Za,[l(O,{modelValue:Q.input,"onUpdate:modelValue":i[7]||(i[7]=m=>Q.input=m),result:Q.result,"onUpdate:result":i[8]||(i[8]=m=>Q.result=m),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Ya,l(he,{readonly:"",value:$(Q.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),t("div",to,[t("div",eo,[(f(!0),b(N,null,j(n(d),(m,B)=>(f(),ct(n(Vn),{key:m.id,activeKey:B===Z.value,onToggle:E=>Z.value=E?B:-1},{header:p(()=>[l(U,{flex:"",middle:""},{default:p(()=>[l(y,null,{default:p(()=>[P(t("input",{class:"c-switch",type:"checkbox","onUpdate:modelValue":i[9]||(i[9]=E=>s.selecteds=E),value:B,onClick:i[10]||(i[10]=_t(()=>{},["stop"]))},null,8,so),[[ht,s.selecteds]]),no]),_:2},1024),l(y,null,{default:p(()=>[s.id===m.id?P((f(),b("input",{key:0,type:"text",class:"input","onUpdate:modelValue":i[11]||(i[11]=E=>s.title=E),onClick:i[12]||(i[12]=_t(()=>{},["stop"])),onKeypress:wt(E=>v(m.id),["enter"])},null,40,ao)),[[tt,s.title],[C]]):(f(),b("span",oo,k(m.title),1))]),_:2},1024),l(y,{class:"ml-4",onClick:i[13]||(i[13]=_t(()=>{},["stop"]))},{default:p(()=>[s.id===m.id?(f(),b("button",{key:0,class:"btn btn-sm btn-link",onClick:E=>v(m.id)}," \u786E\u8BA4 ",8,lo)):(f(),b(N,{key:1},[t("button",{class:"btn btn-sm btn-link",onClick:E=>rt(m)}," \u9009\u62E9 ",8,uo),t("button",{class:"btn btn-sm btn-link",onClick:E=>{s.id=m.id,s.title=m.title}},[l(n(je),{class:"svg-icon"}),co],8,io),t("button",{class:"btn btn-sm btn-link",onClick:E=>Ct(m)},[l(n(jt),{class:"svg-icon"}),po],8,ro)],64))]),_:2},1024)]),_:2},1024)]),actions:p(()=>[t("button",{class:"btn btn-sm btn-success-outline",onClick:E=>T(m)}," \u5BFC\u51FA ",8,_o),t("button",{class:"btn btn-sm btn-danger-outline",onClick:E=>r(m.id)}," \u5220\u9664 ",8,vo)]),default:p(()=>[B===Z.value?(f(),ct(n(hn),{key:0,data:m,"onUpdate:data":E=>X(E,m.id)},null,8,["data","onUpdate:data"])):at("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),l(n(xn),{show:L.value,"onUpdate:show":i[18]||(i[18]=m=>L.value=m),onClick:yt},{extra:p(()=>[t("div",fo,[l(h,null,{default:p(()=>[t("label",null,[ho,P(t("input",{type:"checkbox","onUpdate:modelValue":i[14]||(i[14]=m=>mt(Y)?Y.value=m:null)},null,512),[[ht,n(Y)]])]),t("label",null,[mo,P(t("input",{type:"checkbox","onUpdate:modelValue":i[15]||(i[15]=m=>mt(I)?I.value=m:null)},null,512),[[ht,n(I)]])]),t("label",null,[bo,P(t("input",{type:"checkbox","onUpdate:modelValue":i[16]||(i[16]=m=>mt(q)?q.value=m:null)},null,512),[[ht,n(q)]])]),t("label",null,[$o,P(t("input",{type:"checkbox","onUpdate:modelValue":i[17]||(i[17]=m=>mt(o)?o.value=m:null)},null,512),[[ht,n(o)]])])]),_:1})])]),_:1},8,["show"])])}}});const ko=K(Fo,[["__scopeId","data-v-fd976cab"]]);export{ko as default};
