import{d as vt,a as Ht,r as j,Z as Lt,a1 as Fe,_ as Ft,o as v,c as F,H as Qt,x as ot,g as st,P as kt,$ as Gt,a2 as we,F as yt,j as dt,f as o,D as ft,w as Q,E as ct,p as Dt,m as Et,b as bt,O as Pt,G as et,u as x,h as R,z as tt,q as ke,k as T,T as De,X as zt,a3 as Kt,e as O,v as xt,l as Ee,i as Ce,W as Be}from"./index.js";import{_ as wt}from"./lodash.js";import{u as Ie,D as $e}from"./useHeroes.js";import{_ as Ae}from"./Modal.vue_vue_type_style_index_0_lang.js";const Ve=vt({props:{value:[Boolean,Number,String,Object,Array],title:String},setup(n){const g=Fe("SelectComponent"),D=Ht(()=>{if(!g)return!1;const s=g.getValue();if(Array.isArray(s)){if(s.indexOf(n.value)>-1)return!0}else if(s===n.value)return!0;return!1}),f=()=>{var s;!g||g.clickItem({value:n.value,title:((s=m.value)==null?void 0:s.textContent)||""})},m=j();return Lt(()=>{D.value&&f()}),{active:D,clickItem:f,dom:m}}});function Se(n,g,D,f,m,s){return v(),F("div",{ref:"dom","select-option":"",class:kt(["select-item",{active:n.active}]),onClick:g[0]||(g[0]=(...l)=>n.clickItem&&n.clickItem(...l))},[Qt(n.$slots,"default",{},()=>[ot(st(n.title),1)],!0)],2)}const He=Ft(Ve,[["render",Se],["__scopeId","data-v-866766a1"]]),gt=He;gt.install=n=>{n.component("ac-icon",gt)};const Le=vt({components:{AcOption:gt},props:{modelValue:[Boolean,Number,String,Object,Array],modelModifiers:{default:()=>({})},list:{type:Array},mode:String,placeholder:String},setup(n,{emit:g}){const D=j(""),f=j(!1),m=Ht(()=>n.modelValue instanceof Array),s=()=>{f.value=!f.value},l=$=>{f.value=!1,D.value=$.title,n.modelModifiers.number?g("update:modelValue",Number($.value)||0):g("update:modelValue",$.value),$.value!==n.modelValue&&g("change")};we("SelectComponent",{getValue:()=>n.modelValue,clickItem:l});function E(){f.value=!1}return window.addEventListener("click",E,!1),Gt(()=>{window.removeEventListener("click",E,!1)}),{isArray:m,visible:f,title:D,clickItem:l,toggle:s}}});const Ge=n=>(Dt("data-v-67e9bbfd"),n=n(),Et(),n),Me={key:0},Re={key:1,class:"select-placeholder"},Ue=Ge(()=>o("div",{class:"select-arrow-down"},null,-1));function Oe(n,g,D,f,m,s){const l=gt;return v(),F("div",{class:"select-control",onClick:g[1]||(g[1]=ct(()=>{},["stop"]))},[n.isArray?(v(!0),F(yt,{key:0},dt(n.modelValue,i=>(v(),F("div",{key:i},st(i),1))),128)):(v(),F("div",{key:1,class:"select-title",onClick:g[0]||(g[0]=(...i)=>n.toggle&&n.toggle(...i))},[n.title?(v(),F("span",Me,st(n.title),1)):(v(),F("span",Re,st(n.placeholder),1)),Ue])),o("div",{class:kt(["select-dropdown",{visible:n.visible}])},[(v(!0),F(yt,null,dt(n.list,(i,E)=>(v(),ft(l,{key:E,value:i.value},{default:Q(()=>[ot(st(i.title),1)]),_:2},1032,["value"]))),128)),Qt(n.$slots,"default",{},void 0,!0)],2)])}const Ne=Ft(Le,[["render",Oe],["__scopeId","data-v-67e9bbfd"]]),St=Ne;St.install=n=>{n.component("ac-icon",St)};const qt=(n,g,D)=>{let f=0,m=0,s=0;n%=360;const l=Math.floor(n/60),i=n/60-l,E=D*(1-g),$=D*(1-g*i),U=D*(1-g*(1-i));switch(l){case 0:f=D,m=U,s=E;break;case 1:f=$,m=D,s=E;break;case 2:f=E,m=D,s=U;break;case 3:f=E,m=$,s=D;break;case 4:f=U,m=E,s=D;break;case 5:f=D,m=E,s=$;break}f=Math.floor(f*255),m=Math.floor(m*255),s=Math.floor(s*255);const N=("00"+f.toString(16)).slice(-2),z=("00"+m.toString(16)).slice(-2),G=("00"+s.toString(16)).slice(-2);return[n,g,D,f,m,s,"#"+N+z+G]},Xt=n=>{let g=0,D=0,f=0,m=0,s=0,l=0;if(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i.test(n))g=window.parseInt(RegExp.$1,16),D=window.parseInt(RegExp.$2,16),f=window.parseInt(RegExp.$3,16);else if(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i.test(n))g=window.parseInt(RegExp.$1,10),D=window.parseInt(RegExp.$2,10),f=window.parseInt(RegExp.$3,10);else return[0,0,0,0,0,0,"#000000"];m=g/255,s=D/255,l=f/255;let i=m;s>i&&(i=s),l>i&&(i=l);let E=m;s<E&&(E=s),l<E&&(E=l);let $=0,U=0,N=0;i===E?$=0:i===m&&s>=l?$=60*(s-l)/(i-E)+0:i===m&&s<l?$=60*(s-l)/(i-E)+360:i===s?$=60*(l-m)/(i-E)+120:i===l&&($=60*(m-s)/(i-E)+240),i===0?U=0:U=1-E/i,N=i;const z=("00"+g.toString(16)).slice(-2),G=("00"+D.toString(16)).slice(-2),q=("00"+f.toString(16)).slice(-2);return[Math.floor($),U,N,g,D,f,"#"+z+G+q]},Mt=n=>(Dt("data-v-e5b80cdc"),n=n(),Et(),n),We={class:"color-control"},Te={key:0,class:"color-picker"},ze={class:"color-picker-layer"},Ke=["onMousedown"],qe=["onMousedown"],Xe={class:"color-picker-view"},je=Mt(()=>o("div",{class:"color-picker-view__label"},"HSV",-1)),Ze=Mt(()=>o("div",{class:"color-picker-view__label"},"RGB",-1)),Je=Mt(()=>o("div",{class:"color-picker-view__label"},"Hex",-1)),Qe=vt({name:"ColorPicker"}),Pe=vt({...Qe,props:{modelValue:null},emits:["update:modelValue"],setup(n,{emit:g}){const D=n,f=j(!1),m=Ht({set:p=>{g("update:modelValue",p)},get:()=>D.modelValue}),s=bt({h:0,s:0,v:0,r:0,g:0,b:0}),l=bt({rect_down:!1,rect_left:0,rect_bottom:0,ver_down:!1,ver_bottom:0}),i={rect:{left:0,bottom:0,x:0,y:0},ver:{bottom:0,y:0}},E=j(!1),$=()=>{E.value=!0},U=wt.debounce(()=>{E.value=!1},300),N=()=>{$();const p=qt(s.h,s.s,s.v);s.r=p[3],s.g=p[4],s.b=p[5],m.value=p[6],l.ver_bottom=s.h,l.rect_left=s.s*360,l.rect_bottom=s.v*360,U()},z=()=>{$();const p=Xt(`${s.r},${s.g},${s.b}`);s.h=p[0],s.s=p[1],s.v=p[2],m.value=p[6],l.ver_bottom=s.h,l.rect_left=s.s*360,l.rect_bottom=s.v*360,U()},G=p=>{p=p||"#000000";const b=Xt(p);s.h=b[0],s.s=b[1],s.v=b[2],s.r=b[3],s.g=b[4],s.b=b[5],l.ver_bottom=s.h,l.rect_left=s.s*360,l.rect_bottom=s.v*360},q=()=>{const p=qt(l.ver_bottom,l.rect_left/360,l.rect_bottom/360);s.h=p[0],s.s=p[1],s.v=p[2],s.r=p[3],s.g=p[4],s.b=p[5],m.value=p[6]},at=p=>{l.rect_down=!0,i.rect.x=p.clientX,i.rect.y=p.clientY;const b=p.currentTarget,H=b.getBoundingClientRect().left,Ct=b.getBoundingClientRect().top;i.rect.left=l.rect_left=p.clientX-H,i.rect.bottom=l.rect_bottom=360-(p.clientY-Ct),q()},r=p=>{if(!l.rect_down)return;const b=p.clientX-i.rect.x,H=p.clientY-i.rect.y;l.rect_left=Math.max(0,Math.min(360,i.rect.left+b)),l.rect_bottom=Math.max(0,Math.min(360,i.rect.bottom-H)),q()},P=()=>{!l.rect_down||(l.rect_down=!1)},S=p=>{l.ver_down=!0,i.ver.y=p.clientY;const H=p.currentTarget.getBoundingClientRect().top;i.ver.bottom=l.ver_bottom=360-(p.clientY-H),q()},M=p=>{if(!l.ver_down)return;const b=p.clientY-i.ver.y;l.ver_bottom=Math.max(0,Math.min(360,i.ver.bottom-b)),q()},X=()=>{!l.ver_down||(l.ver_down=!1)},lt=()=>{f.value=!0},rt=()=>{f.value=!1};return Pt(()=>D.modelValue,p=>{l.ver_down||l.rect_down||E.value||G(p)}),G(D.modelValue),Lt(()=>{window.addEventListener("mousemove",r,!1),window.addEventListener("mouseup",P,!1),window.addEventListener("mousemove",M,!1),window.addEventListener("mouseup",X,!1)}),Gt(()=>{window.removeEventListener("mousemove",r,!1),window.removeEventListener("mouseup",P,!1),window.removeEventListener("mousemove",M,!1),window.removeEventListener("mouseup",X,!1)}),(p,b)=>(v(),F("div",We,[o("div",{class:"color-preview",style:et({backgroundColor:x(m)}),onClick:lt},null,4),(v(),ft(De,{to:"body",disabled:!f.value},[f.value?(v(),F("div",Te,[o("div",{class:"color-picker-mask",onWheel:b[0]||(b[0]=ct(()=>{},["prevent"])),onTouchstart:b[1]||(b[1]=ct(()=>{},["prevent"])),onClick:rt},null,32),o("div",ze,[o("div",{class:"color-picker-rect",style:et(`background-color: hsl(${s.h}deg, 100%, 50%)`),onMousedown:ct(at,["prevent","stop"])},[o("div",{class:"color-picker-rect-cur",style:et({left:`${l.rect_left}px`,bottom:`${l.rect_bottom}px`})},null,4)],44,Ke),o("div",{class:"color-picker-hue",onMousedown:ct(S,["prevent","stop"])},[o("div",{class:"color-picker-hue-cur",style:et({bottom:`${l.ver_bottom}px`})},null,4)],40,qe),o("div",Xe,[o("div",{class:"color-picker-view-color",style:et({background:x(m)})},null,4),je,R(o("input",{type:"number",max:"360",min:"0",step:"1","onUpdate:modelValue":b[2]||(b[2]=H=>s.h=H),class:"color-picker-view__input",onInput:N},null,544),[[tt,s.h]]),R(o("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":b[3]||(b[3]=H=>s.s=H),class:"color-picker-view__input",onInput:N},null,544),[[tt,s.s]]),R(o("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":b[4]||(b[4]=H=>s.v=H),class:"color-picker-view__input",onInput:N},null,544),[[tt,s.v]]),Ze,R(o("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":b[5]||(b[5]=H=>s.r=H),class:"color-picker-view__input",onInput:z},null,544),[[tt,s.r]]),R(o("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":b[6]||(b[6]=H=>s.g=H),class:"color-picker-view__input",onInput:z},null,544),[[tt,s.g]]),R(o("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":b[7]||(b[7]=H=>s.b=H),class:"color-picker-view__input",onInput:z},null,544),[[tt,s.b]]),Je,R(o("input",{type:"text","onUpdate:modelValue":b[8]||(b[8]=H=>ke(m)?m.value=H:null),class:"color-picker-view__input"},null,512),[[tt,x(m)]]),o("div",{class:"color-picker-view__enter",onClick:rt},"\u786E\u8BA4")])])])):T("",!0)],8,["disabled"]))]))}});const pt=Ft(Pe,[["__scopeId","data-v-e5b80cdc"]]);pt.install=function(n){n.component(pt.name,pt)};var W=(n=>(n[n.NONE=0]="NONE",n[n.GUARD=1]="GUARD",n[n.SHEEP=2]="SHEEP",n[n.ATTACKER=3]="ATTACKER",n))(W||{}),A=(n=>(n[n.NONE=0]="NONE",n[n.DISABLED=1]="DISABLED",n[n.BLOCKED=5]="BLOCKED",n[n.CLIFF=6]="CLIFF",n))(A||{}),K=(n=>(n[n.NONE=0]="NONE",n[n.ARROW_UP=1]="ARROW_UP",n[n.ARROW_RIGHT=2]="ARROW_RIGHT",n[n.ARROW_DOWN=3]="ARROW_DOWN",n[n.ARROW_LEFT=4]="ARROW_LEFT",n[n.HIGHLIGHT=5]="HIGHLIGHT",n))(K||{});const it=n=>(Dt("data-v-99d03bda"),n=n(),Et(),n),Ye=["title"],to=["onClick"],eo={key:0,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},oo=it(()=>o("path",{d:"M0,0h24v24h-24z",fill:"#E84F2E30"},null,-1)),no=it(()=>o("path",{d:"M16,13V21H8V13H2L12,3L22,13H16M7,11H10V19H14V11H17L12,6L7,11Z",fill:"#FFFF84"},null,-1)),so=[oo,no],ao={key:1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},lo=it(()=>o("path",{d:"M0,0h24v24h-24z",fill:"#E84F2E30"},null,-1)),ro=it(()=>o("path",{d:"M11,16H3V8H11V2L21,12L11,22V16M13,7V10H5V14H13V17L18,12L13,7Z",fill:"#FFFF84"},null,-1)),uo=[lo,ro],io={key:2,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},co=it(()=>o("path",{d:"M0,0h24v24h-24z",fill:"#E84F2E30"},null,-1)),yo=it(()=>o("path",{d:"M22,11L12,21L2,11H8V3H16V11H22M12,18L17,13H14V5H10V13H7L12,18Z",fill:"#FFFF84"},null,-1)),po=[co,yo],xo={key:3,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},fo=it(()=>o("path",{d:"M0,0h24v24h-24z",fill:"#E84F2E30"},null,-1)),vo=it(()=>o("path",{d:"M13,22L3,12L13,2V8H21V16H13V22M6,12L11,17V14H19V10H11V7L6,12Z",fill:"#FFFF84"},null,-1)),_o=[fo,vo],mo={key:4,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},ho=it(()=>o("path",{d:"M0,0h24v24h-24z",fill:"#E84F2E30"},null,-1)),bo=[ho],go={key:5,class:"tg lt"},Fo={key:6,class:"tg rt"},wo={key:7,class:"tg rb"},ko={class:"grid-item-overlay-dot"},Do={class:"grid-item-overlay-selected"},Eo=vt({__name:"grid-item",props:{disabled:{type:Boolean},selected:{type:Boolean},dot:{type:Boolean},data:null,terrain:null,overlay:null,unit:null},emits:["clickoverlay"],setup(n,{emit:g}){const D=n;function f(){g("clickoverlay",D.overlay)}return(m,s)=>{var l,i,E,$,U,N,z,G,q,at,r;return v(),F("div",{draggable:!0,class:kt(["grid-item",{disabled:n.disabled}])},[o("div",{class:"grid-item-data",style:et({backgroundColor:(l=n.data)==null?void 0:l.bgcolor,backgroundImage:(i=n.data)!=null&&i.image?`url(${n.data.image})`:"",opacity:(E=n.data)==null?void 0:E.opacity})},null,4),n.terrain?(v(),F("div",{key:0,class:"grid-item-terrain",style:et({backgroundImage:n.terrain.image?`url(${n.terrain.image})`:""})},null,4)):T("",!0),n.unit?(v(),F("div",{key:1,class:"grid-item-unit",title:n.unit.name,style:et({backgroundImage:n.unit.image?`url(${n.unit.image})`:""})},null,12,Ye)):T("",!0),($=n.data)!=null&&$.txt?(v(),F("div",{key:2,class:"grid-item-txt",style:et({fontSize:(U=n.data)!=null&&U.size?`${n.data.size}px`:"",color:(N=n.data)==null?void 0:N.color})},st(n.data.txt),5)):T("",!0),(z=n.unit)!=null&&z.team?(v(),F("div",{key:3,class:kt(["grid-item-overlay pointer-none","team-"+((G=n.unit)==null?void 0:G.team)])},null,2)):T("",!0),n.overlay?(v(),F("div",{key:4,class:"grid-item-overlay",onClick:ct(f,["stop"])},[n.overlay===x(K).ARROW_UP?(v(),F("svg",eo,so)):n.overlay===x(K).ARROW_RIGHT?(v(),F("svg",ao,uo)):n.overlay===x(K).ARROW_DOWN?(v(),F("svg",io,po)):n.overlay===x(K).ARROW_LEFT?(v(),F("svg",xo,_o)):n.overlay===x(K).HIGHLIGHT?(v(),F("svg",mo,bo)):T("",!0)],8,to)):T("",!0),(q=n.unit)!=null&&q.actorId?(v(),F("i",go,st(n.unit.actorId),1)):T("",!0),(at=n.data)!=null&&at.sup?(v(),F("i",Fo,st(n.data.sup),1)):T("",!0),(r=n.data)!=null&&r.sub?(v(),F("i",wo,st(n.data.sub),1)):T("",!0),R(o("div",ko,null,512),[[zt,n.dot]]),R(o("div",Do,null,512),[[zt,n.selected]])],2)}}});const ut=Ft(Eo,[["__scopeId","data-v-99d03bda"]]);function Co(){const n=j(15),g=j(15),D=j(0),f=j([]),m=j([]),s=[{color:"#202020",bgcolor:"transparent"},{color:"#f9f9fa",bgcolor:"#ff3333"},{color:"#f9f9fa",bgcolor:"#00d659"},{color:"#f9f9fa",bgcolor:"#369af7"},{color:"#f9f9fa",bgcolor:"#fec02f"},{color:"#f9f9fa",bgcolor:"#a865e7"}],l=()=>({d:0,d1:0,d2:0,q:0}),i=()=>({txt:"",size:14,color:s[0].color,bgcolor:s[0].bgcolor,image:"",opacity:1}),E=()=>({type:A.NONE,image:""}),$=()=>({actorId:0,unitId:0,team:0,actorType:W.NONE,name:"",image:""}),U=S=>({x:0,y:0,disabled:!1,data:i(),state:l(),terrain:E(),unit:S});function N(S){S.state=l(),S.data=i(),S.terrain=E(),S.overlay=void 0,S.unit=void 0}function z(){D.value=0,f.value.forEach(S=>{S.forEach(M=>{N(M)})}),m.value=[]}function G(S,M){const X=[];for(let lt=0;lt<S;lt++){const rt=[];for(let p=0;p<M;p++){const b=U();b.x=p,b.y=lt,rt.push(b)}X.push(rt)}f.value=X}function q(S,M){g.value=S,n.value=M,P()}function at(S,M){var X;return(X=f.value[M])==null?void 0:X[S]}function r(S){for(let M=0;M<n.value;M++)for(let X=0;X<g.value;X++)S(f.value[M][X])}function P(){G(n.value,g.value)}return P(),{rows:n,cols:g,actorId:D,grids:f,selects:m,gridColors:s,defGridState:l,defGridData:i,defGridTerrain:E,defGridUnit:$,defGrid:U,cleanGrid:N,cleanGrids:z,setSize:q,getGrid:at,gridForEach:r}}const jt=""+new URL("../assets/cliff.svg",import.meta.url).href,Zt=""+new URL("../assets/block.svg",import.meta.url).href,Jt=""+new URL("../assets/disabled.svg",import.meta.url).href,Bo=[{name:"\u7A7A\u767D\u573A\u666F",width:15,height:15,data:[]},{name:"\u5316\u8352\u5E7B\u5883",width:17,height:11,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:2,y:0,type:1},{x:14,y:0,type:1},{x:15,y:0,type:1},{x:16,y:0,type:1},{x:0,y:1,type:1},{x:1,y:1,type:1},{x:15,y:1,type:1},{x:16,y:1,type:1},{x:0,y:2,type:1},{x:7,y:2,type:6},{x:8,y:2,type:6},{x:9,y:2,type:6},{x:16,y:2,type:1},{x:6,y:3,type:6},{x:7,y:3,type:6},{x:8,y:3,type:6},{x:9,y:3,type:6},{x:10,y:3,type:6},{x:5,y:4,type:6},{x:6,y:4,type:6},{x:10,y:4,type:6},{x:11,y:4,type:6},{x:5,y:6,type:6},{x:6,y:6,type:6},{x:10,y:6,type:6},{x:11,y:6,type:6},{x:6,y:7,type:6},{x:7,y:7,type:6},{x:8,y:7,type:6},{x:9,y:7,type:6},{x:10,y:7,type:6},{x:0,y:8,type:1},{x:7,y:8,type:6},{x:8,y:8,type:6},{x:9,y:8,type:6},{x:16,y:8,type:1},{x:0,y:9,type:1},{x:1,y:9,type:1},{x:15,y:9,type:1},{x:16,y:9,type:1},{x:0,y:10,type:1},{x:1,y:10,type:1},{x:2,y:10,type:1},{x:14,y:10,type:1},{x:15,y:10,type:1},{x:16,y:10,type:1}]},{name:"\u96EA\u5CAD\u5E7B\u5883",width:15,height:11,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:2,y:0,type:1},{x:5,y:0,type:6},{x:6,y:0,type:6},{x:7,y:0,type:6},{x:8,y:0,type:6},{x:9,y:0,type:6},{x:12,y:0,type:1},{x:13,y:0,type:1},{x:14,y:0,type:1},{x:0,y:1,type:1},{x:1,y:1,type:1},{x:2,y:1,type:1},{x:3,y:1,type:6},{x:4,y:1,type:6},{x:5,y:1,type:6},{x:6,y:1,type:6},{x:7,y:1,type:6},{x:8,y:1,type:6},{x:9,y:1,type:6},{x:10,y:1,type:6},{x:11,y:1,type:6},{x:12,y:1,type:1},{x:13,y:1,type:1},{x:14,y:1,type:1},{x:0,y:2,type:1},{x:1,y:2,type:1},{x:2,y:2,type:1},{x:3,y:2,type:6},{x:11,y:2,type:6},{x:12,y:2,type:1},{x:13,y:2,type:1},{x:14,y:2,type:1},{x:6,y:4,type:6},{x:7,y:4,type:6},{x:8,y:4,type:6},{x:3,y:5,type:6},{x:11,y:5,type:6},{x:6,y:6,type:6},{x:7,y:6,type:6},{x:8,y:6,type:6},{x:0,y:8,type:1},{x:1,y:8,type:1},{x:2,y:8,type:1},{x:3,y:8,type:6},{x:11,y:8,type:6},{x:12,y:8,type:1},{x:13,y:8,type:1},{x:14,y:8,type:1},{x:0,y:9,type:1},{x:1,y:9,type:1},{x:2,y:9,type:1},{x:3,y:9,type:6},{x:4,y:9,type:6},{x:5,y:9,type:6},{x:6,y:9,type:6},{x:7,y:9,type:6},{x:8,y:9,type:6},{x:9,y:9,type:6},{x:10,y:9,type:6},{x:11,y:9,type:6},{x:12,y:9,type:1},{x:13,y:9,type:1},{x:14,y:9,type:1},{x:0,y:10,type:1},{x:1,y:10,type:1},{x:2,y:10,type:1},{x:5,y:10,type:6},{x:6,y:10,type:6},{x:7,y:10,type:6},{x:8,y:10,type:6},{x:9,y:10,type:6},{x:12,y:10,type:1},{x:13,y:10,type:1},{x:14,y:10,type:1}]},{name:"\u5730\u754C\u5E7B\u5883",width:17,height:13,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:2,y:0,type:1},{x:5,y:0,type:6},{x:6,y:0,type:6},{x:7,y:0,type:6},{x:8,y:0,type:6},{x:9,y:0,type:6},{x:10,y:0,type:6},{x:11,y:0,type:6},{x:14,y:0,type:1},{x:15,y:0,type:1},{x:16,y:0,type:1},{x:0,y:1,type:1},{x:1,y:1,type:1},{x:2,y:1,type:1},{x:6,y:1,type:6},{x:10,y:1,type:6},{x:14,y:1,type:1},{x:15,y:1,type:1},{x:16,y:1,type:1},{x:0,y:2,type:1},{x:1,y:2,type:1},{x:6,y:2,type:6},{x:10,y:2,type:6},{x:15,y:2,type:1},{x:16,y:2,type:1},{x:0,y:3,type:1},{x:1,y:3,type:1},{x:6,y:3,type:6},{x:7,y:3,type:6},{x:8,y:3,type:6},{x:9,y:3,type:6},{x:10,y:3,type:6},{x:15,y:3,type:1},{x:16,y:3,type:1},{x:7,y:4,type:6},{x:8,y:4,type:6},{x:9,y:4,type:6},{x:7,y:8,type:6},{x:8,y:8,type:6},{x:9,y:8,type:6},{x:0,y:9,type:1},{x:1,y:9,type:1},{x:6,y:9,type:6},{x:7,y:9,type:6},{x:8,y:9,type:6},{x:9,y:9,type:6},{x:10,y:9,type:6},{x:15,y:9,type:1},{x:16,y:9,type:1},{x:0,y:10,type:1},{x:1,y:10,type:1},{x:6,y:10,type:6},{x:10,y:10,type:6},{x:15,y:10,type:1},{x:16,y:10,type:1},{x:0,y:11,type:1},{x:1,y:11,type:1},{x:2,y:11,type:1},{x:6,y:11,type:6},{x:10,y:11,type:6},{x:14,y:11,type:1},{x:15,y:11,type:1},{x:16,y:11,type:1},{x:0,y:12,type:1},{x:1,y:12,type:1},{x:2,y:12,type:1},{x:5,y:12,type:6},{x:6,y:12,type:6},{x:7,y:12,type:6},{x:8,y:12,type:6},{x:9,y:12,type:6},{x:10,y:12,type:6},{x:11,y:12,type:6},{x:14,y:12,type:1},{x:15,y:12,type:1},{x:16,y:12,type:1}]},{name:"\u7ED3\u754C\u5E7B\u5883",width:11,height:11,data:[{x:5,y:8,type:1},{x:2,y:5,type:1},{x:5,y:5,type:1},{x:8,y:5,type:1},{x:5,y:2,type:1}]},{name:"\u57CE\u9685\u5E7B\u5883",width:15,height:11,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:2,y:0,type:1},{x:5,y:0,type:1},{x:6,y:0,type:1},{x:7,y:0,type:1},{x:8,y:0,type:1},{x:9,y:0,type:1},{x:12,y:0,type:1},{x:13,y:0,type:1},{x:14,y:0,type:1},{x:0,y:1,type:1},{x:1,y:1,type:1},{x:6,y:1,type:1},{x:8,y:1,type:1},{x:13,y:1,type:1},{x:14,y:1,type:1},{x:0,y:2,type:1},{x:14,y:2,type:1},{x:4,y:4,type:5},{x:5,y:5,type:5},{x:9,y:5,type:5},{x:10,y:6,type:5},{x:0,y:8,type:1},{x:14,y:8,type:1},{x:0,y:9,type:1},{x:1,y:9,type:1},{x:6,y:9,type:1},{x:8,y:9,type:1},{x:13,y:9,type:1},{x:14,y:9,type:1},{x:0,y:10,type:1},{x:1,y:10,type:1},{x:2,y:10,type:1},{x:5,y:10,type:1},{x:6,y:10,type:1},{x:7,y:10,type:1},{x:8,y:10,type:1},{x:9,y:10,type:1},{x:12,y:10,type:1},{x:13,y:10,type:1},{x:14,y:10,type:1}]},{name:"\u5E7D\u7A74\u5E7B\u5883",width:11,height:11,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:0,y:1,type:1},{x:0,y:2,type:1},{x:3,y:2,type:6},{x:4,y:2,type:6},{x:2,y:3,type:6},{x:3,y:3,type:6},{x:4,y:3,type:6},{x:6,y:7,type:6},{x:7,y:7,type:6},{x:8,y:7,type:6},{x:6,y:8,type:6},{x:7,y:8,type:6},{x:10,y:8,type:1},{x:10,y:9,type:1},{x:9,y:10,type:1},{x:10,y:10,type:1}]},{name:"\u5996\u5C71\u5E7B\u5883",width:17,height:11,data:[]},{name:"\u8D64\u7802\u5E7B\u5883",width:15,height:7,data:[{x:0,y:0,type:1},{x:1,y:0,type:1},{x:2,y:0,type:1},{x:6,y:0,type:1},{x:7,y:0,type:1},{x:8,y:0,type:1},{x:12,y:0,type:1},{x:13,y:0,type:1},{x:14,y:0,type:1},{x:0,y:1,type:1},{x:1,y:1,type:1},{x:2,y:1,type:1},{x:12,y:1,type:1},{x:13,y:1,type:1},{x:14,y:1,type:1},{x:0,y:5,type:1},{x:1,y:5,type:1},{x:2,y:5,type:1},{x:12,y:5,type:1},{x:13,y:5,type:1},{x:14,y:5,type:1},{x:0,y:6,type:1},{x:1,y:6,type:1},{x:2,y:6,type:1},{x:6,y:6,type:1},{x:7,y:6,type:1},{x:8,y:6,type:1},{x:12,y:6,type:1},{x:13,y:6,type:1},{x:14,y:6,type:1}]}],w=n=>(Dt("data-v-d649bd0e"),n=n(),Et(),n),Io={class:"wrapper"},$o={class:"toolbar"},Ao={class:"setting"},Vo={class:"label-control"},So=w(()=>o("span",null,"\u7F16\u8F91\u6A21\u5F0F",-1)),Ho=ot("\u7F16\u8F91\u7F51\u683C"),Lo=ot("\u5237\u5B50\u6A21\u5F0F"),Go=ot("\u9009\u62E9\u5F62\u72B6"),Mo=ot("\u62A4\u536B\u8BA1\u7B97"),Ro={class:"label-control"},Uo=w(()=>o("span",null,"\u8303\u56F4",-1)),Oo={class:"label-control"},No=w(()=>o("span",null,"\u5F62\u72B6",-1)),Wo=w(()=>o("option",{value:1},"\u83F1\u5F62",-1)),To=w(()=>o("option",{value:2},"\u5708\u6570",-1)),zo=[Wo,To],Ko={class:"label-control"},qo=w(()=>o("span",null,"\u6392\u5E8F",-1)),Xo=w(()=>o("option",{value:1},"\u8DDD\u79BBX",-1)),jo=w(()=>o("option",{value:2},"\u8DDD\u79BBY",-1)),Zo=w(()=>o("option",{value:3},"X\u4F18\u5148",-1)),Jo=w(()=>o("option",{value:4},"Y\u4F18\u5148",-1)),Qo=[Xo,jo,Zo,Jo],Po=w(()=>o("button",{class:"btn"},"\u9884\u8BBE\u573A\u666F",-1)),Yo={class:"list"},tn=["onClick"],en=w(()=>o("div",{style:{flex:"1 1 0"}},null,-1)),on=w(()=>o("article",null,[o("h2",null,"\u8BF4\u660E"),o("p",null,"\u70B9\u51FB\u9884\u8BBE\u573A\u666F\uFF0C\u53EF\u4EE5\u8F7D\u5165\u4E00\u4E9B\u9884\u8BBE\u7684\u573A\u666F\u3002"),o("p",null,"\u53F3\u4FA7\u5355\u4F4D\u53EF\u901A\u8FC7\u62D6\u66F3\u62C9\u5165\u7F51\u683C\u3002"),o("p",null,[ot(" \u9009\u4E2D\u7F51\u683C\u4E2D\u7684\u5355\u4F4D\u53EF\u4EE5\u4F7F\u7528\u201C\u602A\u529B\u4E71\u795E\u201D\u3001\u201C\u5F00\u8F66\u201D\u529F\u80FD\u3002"),o("br"),ot(" \u201C\u602A\u529B\u4E71\u795E\u201D\u529F\u80FD\u53EA\u4F1A\u4F5C\u7528\u4E8E\u975E\u540C\u961F\u5355\u4F4D\u3002"),o("br"),ot(" \u201C\u5F00\u8F66\u201D\u529F\u80FD\u53EA\u4F1A\u4F5C\u7528\u4E8E\u540C\u961F\u5355\u4F4D\u3002"),o("br"),ot(" \u4F7F\u7528\u529F\u80FD\u524D\uFF0C\u4F60\u53EF\u4EE5\u4FDD\u5B58\u5F53\u524D\u5E03\u5C40\uFF0C\u65B9\u4FBF\u9884\u89C8\u7ED3\u679C\u540E\u5FEB\u901F\u8FD8\u539F\u5E03\u5C40\u3002 ")])],-1)),nn={class:"color-container"},sn={class:"label-control"},an=w(()=>o("span",null,"\u9884\u89C8",-1)),ln={class:"label-control"},rn=w(()=>o("span",null,"\u6587\u5B57",-1)),un={class:"label-control"},cn=w(()=>o("span",null,"\u80CC\u666F",-1)),yn=w(()=>o("label",{class:"label-control"},[o("span",null,"\u9884\u8BBE")],-1)),dn={class:"color-tpls"},pn=ot(" E "),xn={width:"32",height:"32",viewBox:"0 0 24 24",fill:"#a9a9a9",style:{"pointer-events":"none"}},fn=w(()=>o("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"},null,-1)),vn=[fn],_n={class:"props-container"},mn={key:0,class:"props-content"},hn={class:"label-control"},bn=w(()=>o("span",null,"\u9884\u89C8",-1)),gn={class:"label-control"},Fn=w(()=>o("span",null,"\u6587\u5B57",-1)),wn={class:"label-control"},kn=w(()=>o("span",null,"\u80CC\u666F",-1)),Dn={class:"label-control"},En=w(()=>o("span",null,"\u5927\u5C0F",-1)),Cn={class:"label-control"},Bn=w(()=>o("span",null,"\u5185\u5BB9",-1)),In={class:"label-control"},$n=w(()=>o("span",null,"\u5730\u5F62",-1)),An=["value"],Vn=["value"],Sn=["value"],Hn=["value"],Ln={class:"label-control"},Gn=w(()=>o("span",null,"Id",-1)),Mn={class:"label-control"},Rn=w(()=>o("span",null,"\u7C7B\u578B",-1)),Un=["value"],On=["value"],Nn=["value"],Wn=["value"],Tn={class:"label-control"},zn=w(()=>o("span",null,"\u98DE\u884C",-1)),Kn={class:"controls"},qn={key:0,class:"label-control"},Xn=w(()=>o("span",null,"\u5355\u4F4DID",-1)),jn=["value"],Zn={key:1,class:"label-control"},Jn=w(()=>o("span",null,"\u961F\u4F0D",-1)),Qn=w(()=>o("option",{value:void 0},"\u961F\u4F0D\u7A7A",-1)),Pn=w(()=>o("option",{value:0},"\u961F\u4F0D0",-1)),Yn=w(()=>o("option",{value:1},"\u961F\u4F0D1",-1)),ts=w(()=>o("option",{value:2},"\u961F\u4F0D2",-1)),es=[Qn,Pn,Yn,ts],os={class:"content"},ns={class:"grids"},ss={class:"panel-right"},as={class:"controls"},ls={class:"label-control"},rs=w(()=>o("span",null,"\u961F\u4F0D",-1)),us=w(()=>o("option",{value:0},"\u961F\u4F0D0",-1)),is=w(()=>o("option",{value:1},"\u961F\u4F0D1",-1)),cs=w(()=>o("option",{value:2},"\u961F\u4F0D2",-1)),ys=[us,is,cs],ds={class:"heroes"},ps=vt({__name:"Grids",setup(n){const{rows:g,cols:D,actorId:f,grids:m,selects:s,gridColors:l,defGridUnit:i,defGridState:E,defGrid:$,cleanGrid:U,cleanGrids:N,setSize:z,getGrid:G,gridForEach:q}=Co(),at=j(),r=bt({editor:1,selectRange:5,shape:1,sortType:1,color:l[0].color,bgcolor:l[0].bgcolor,terrain:void 0}),P=$();P.terrain={image:Jt,type:A.DISABLED};const S=$();S.terrain={image:jt,type:A.CLIFF};const M=$();M.terrain={image:Zt,type:A.BLOCKED};function X(e){r.color=e.color,r.bgcolor=e.bgcolor,r.terrain=void 0}function lt(e){r.color="",r.bgcolor="",r.terrain=e.terrain}const{heroes:rt}=Ie(),p=Kt($(i())),b=Kt(rt.value.map(e=>{const t=$(),a=i();return a.unitId=e.id,a.image=`https://media.zlongame.com/media/news/cn/tdj/info/data/heroicon/${e.hero_icon}.png`,a.name=e.name,t.unit=a,t}));Pt(rt,()=>{b.value=rt.value.map(e=>{const t=$(),a=i();return a.image=`https://media.zlongame.com/media/news/cn/tdj/info/data/heroicon/${e.hero_icon}.png`,t.unit=a,t})});function H(e,t,a,C){const h=[];return q(B=>{B.state=E()}),q(B=>{const d=Math.abs(e-B.x),k=Math.abs(t-B.y),u=d+k,Y=Math.max(d,k),c=d>1?d-1:d+k>1?k-1:k;switch(C){case 1:u<=a&&(B.state.d=u,B.state.q=Y,B.state.d1=c,h.push(B));break;case 2:Math.abs(d)<=a&&Math.abs(k)<=a&&(B.state.d=u,B.state.q=Y,B.state.d1=c,h.push(B));break}}),h}function Ct(e,t,a,C,h,B,d){const k=H(e,t,a,C);switch(k.forEach(u=>{u.data.color=B,u.data.bgcolor=d}),s.value=k,h){case 1:s.value.sort(Yt);break;case 2:s.value.sort(Bt);break;case 3:s.value.sort(te);break;case 4:s.value.sort(ee);break}for(let u=0;u<s.value.length;u++){const Y=s.value[u];Y.data.txt=String(u+1)}}function Yt(e,t){return e.state.q!==t.state.q?e.state.q-t.state.q:e.state.d!==t.state.d?e.state.d-t.state.d:e.x!==t.x?e.x-t.x:e.y!==t.y?e.y-t.y:0}function Bt(e,t){return e.state.q!==t.state.q?e.state.q-t.state.q:e.state.d!==t.state.d?e.state.d-t.state.d:e.y!==t.y?e.y-t.y:e.x!==t.x?e.x-t.x:0}function te(e,t){return e.x!==t.x?e.x-t.x:e.y!==t.y?e.y-t.y:0}function ee(e,t){return e.y!==t.y?e.y-t.y:e.x!==t.x?e.x-t.x:0}const _=bt({enabled:!1});function oe(){N()}function Rt(){_.enabled=!1}function ne(e,t){var a;switch(r.editor){case 1:case 4:_.current=t,(a=at.value)==null||a.focus();break;case 3:N(),Ct(t.x,t.y,r.selectRange,r.shape,r.sortType,r.color,r.bgcolor);break}}function se(e,t){if(e.button===0)switch(r.editor){case 2:{_.enabled=!0,t.data.color=r.color,t.data.bgcolor=r.bgcolor,r.terrain?(t.terrain.type=r.terrain.type,t.terrain.image=r.terrain.image):(t.terrain.type=A.NONE,t.terrain.image="");break}}}function ae(e,t){e.button===0&&_.enabled&&(t.data.color=r.color,t.data.bgcolor=r.bgcolor,r.terrain?(t.terrain.type=r.terrain.type,t.terrain.image=r.terrain.image):(t.terrain.type=A.NONE,t.terrain.image=""))}function le(){_.current=void 0}const _t=j({width:15,height:15});function re(){try{const e=localStorage.getItem("grids");if(!e)return;const t=JSON.parse(e);_t.value=t}catch{}}function Ut(){if(!confirm("\u786E\u5B9A\u8981\u4FDD\u5B58\u5417\uFF1F"))return;let t=m.value.flat().filter(a=>a.terrain.type!==A.NONE||a.unit&&a.unit.actorId>0);t=wt.cloneDeep(t),_t.value={width:D.value,height:g.value,data:t},localStorage.setItem("grids",JSON.stringify(_t.value))}function ue(){const e=_t.value;if(!!e.data){z(e.width,e.height);for(const t of e.data){const a=G(t.x,t.y);!a||(t.data&&(a.data=t.data),t.terrain&&(a.terrain=t.terrain),t.unit&&t.unit.actorId>0&&(a.unit=t.unit))}}}const It=j(!1);function ie(e){z(e.width,e.height),e.data.forEach(t=>{const a=G(t.x,t.y);if(!!a)switch(t.type){case A.DISABLED:a.terrain={image:Jt,type:A.DISABLED};break;case A.CLIFF:a.terrain={image:jt,type:A.CLIFF};break;case A.BLOCKED:a.terrain={image:Zt,type:A.BLOCKED};break}}),It.value=!1}function ce(){var k;const e=_.current;if(!e)return;_t.value||Ut();const t=(k=e.unit)==null?void 0:k.team;let a,C,h=[];for(a=e.x-2;a<=e.x+2;a++)for(C=e.y-2;C<=e.y+2;C++){const u=G(a,C);!u||u.terrain.type!==A.DISABLED&&(u.x===e.x&&u.y===e.y?(h[0]&&h.push(h[0]),h[0]=u):h.push(u))}h=h.filter(u=>u.unit&&u.unit.team!==t&&!(u.x===e.x&&u.y===e.y));const B=h.map(u=>({data:u.data,unit:u.unit}));h.forEach(u=>{U(u)});const d=H(e.x,e.y,4,2).filter(u=>u.terrain.type!==A.BLOCKED&&!(u.x===e.x&&u.y===e.y)).sort(Bt).map(u=>[u.x,u.y]);for(const u of B)for(const[Y,c]of d){const y=G(Y,c);if(!!y&&!(y.unit&&y.unit.actorId>0)&&y.terrain.type!==A.DISABLED&&y.terrain.type!==A.BLOCKED&&!(y.terrain.type===A.CLIFF&&!u.unit.fly)){y.data=u.data,y.unit=u.unit;break}}}let Z;function ye(){const e=_.current;if(!e)return;const t=[{x:0,y:1,overlay:K.ARROW_UP},{x:1,y:0,overlay:K.ARROW_RIGHT},{x:0,y:-1,overlay:K.ARROW_DOWN},{x:-1,y:0,overlay:K.ARROW_LEFT}];for(const a of t){const C=G(e.x+a.x,e.y+a.y);if(!!C){C.overlay=a.overlay;for(let h=2;h<=4;h++){const B=G(e.x+a.x*h,e.y+a.y*h);!B||(B.overlay=K.HIGHLIGHT)}}}Z=e}function de(e){var c;if(!Z||!e||e===K.HIGHLIGHT)return;const t=(c=Z.unit)==null?void 0:c.team;let a,C,h=[];for(a=Z.x-1;a<=Z.x+1;a++)for(C=Z.y-1;C<=Z.y+1;C++){if(a===Z.x&&C===Z.y)continue;const y=G(a,C);!y||!y.unit||y.unit.team===t&&(y.state.d=At(Z,y),h.push(y))}h.sort((y,I)=>!y.unit||!I.unit?0:y.state.d!==I.state.d?y.state.d-I.state.d:y.unit.actorId-I.unit.actorId),h=h.slice(0,2);const B=h.map(y=>({data:y.data,unit:y.unit}));h.forEach(y=>{y.unit=void 0}),console.log(B);const k={[K.ARROW_UP]:{x:0,y:1},[K.ARROW_RIGHT]:{x:1,y:0},[K.ARROW_DOWN]:{x:0,y:-1},[K.ARROW_LEFT]:{x:-1,y:0}}[e];let u;for(let y=1;y<=4;y++){const I=G(Z.x+y*k.x,Z.y+y*k.y);I&&I.terrain.type===A.NONE&&(u=I)}if(!u)return;q(y=>{y.overlay=void 0});const Y=H(u.x,u.y,4,2).filter(y=>y.terrain.type!==A.BLOCKED&&!(y.x===(u==null?void 0:u.x)&&y.y===(u==null?void 0:u.y))).sort(Bt).map(y=>[y.x,y.y]);for(const y of B)for(const[I,L]of Y){const J=G(I,L);if(!!J&&!(J.unit&&J.unit.actorId>0)&&J.terrain.type!==A.DISABLED&&J.terrain.type!==A.BLOCKED&&!(J.terrain.type===A.CLIFF&&!y.unit.fly)){J.data=y.data,J.unit=y.unit;break}}u&&(Wt(u,Z),_.current=u)}const V=bt({team:1}),Ot=["#ffffff00","#FF3C4132","#0EBEFF32","#48CF7432","#FCD00032","#80008032"],pe=(e,t)=>{switch(r.editor){case 2:e.preventDefault();break;default:V.grid=t,V.action="swap",e.dataTransfer&&(e.dataTransfer.effectAllowed="move")}},xe=(e,t)=>{const a=$();a.data.color=t.color,a.data.bgcolor=t.bgcolor,a.data.txt="E",V.grid=a,V.action="color"},$t=(e,t)=>{V.grid=wt.cloneDeep(t),V.action="terrain"},Nt=(e,t)=>{V.grid=wt.cloneDeep(t),V.action="unit"},fe=(e,t)=>{if(e.preventDefault(),!V.grid)return;const a=V.grid.unit,C=V.grid.terrain;switch(V.action){case"color":t.unit||(t.unit=i()),t.unit.actorId||(t.unit.actorId=++f.value),t.data=V.grid.data;break;case"unit":if(t.unit||(t.unit=i()),t.unit.actorId||(t.unit.actorId=++f.value),!a)break;t.unit.image=a.image,t.unit.unitId=a.unitId,t.unit.team=V.team;break;case"swap":Wt(V.grid,t,!a||a.actorId===0);break;case"terrain":t.terrain=C;break}V.grid=void 0,V.action=void 0,_.current&&(_.current=t),r.editor===4&&mt()};function ve(e,t){let a=e[0].state[t];for(let C=1;C<e.length;C++)e[C].state[t]<a&&(a=e[C].state[t]);return a}function At(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function Wt(e,t,a){const C=e.data,h=e.unit,B=e.terrain;e.data=t.data,e.unit=t.unit,t.data=C,t.unit=h,a&&(e.terrain=t.terrain,t.terrain=B)}function Tt(e,t,a){e.sort((d,k)=>!d.unit||!k.unit?0:+d.unit.actorId-+k.unit.actorId),e.forEach(d=>{d.state.d1=At(d,a),d.state.d2=At(d,t),d.unit&&(d.unit.guard=!1)});const C=ve(e,"d1");if(e=e.filter(d=>d.state.d1===C),e.length===1)return e[0];let h=e[0],B=e.length;for(;B--;)if(e[B].state.d2<h.state.d2){h=e[B];break}return h}function _e(){z(15,15),f.value=0;const e=[{x:7,y:9,txt:"",type:W.GUARD,bg:"#0ebeff"},{x:9,y:7,txt:"",type:W.GUARD,bg:"#0ebeff"},{x:7,y:5,txt:"",type:W.GUARD,bg:"#0ebeff"},{x:5,y:7,txt:"",type:W.GUARD,bg:"#0ebeff"},{x:8,y:6,txt:"",type:W.ATTACKER,bg:"#ff3c41"},{x:7,y:7,txt:"",type:W.SHEEP,bg:"#fcd000"}];for(const t of e){const a=G(t.x,t.y);!a||(a.unit||(a.unit=i()),a.unit.actorId=++f.value,a.unit.actorType=t.type,a.disabled=!1,a.data.txt=t.txt,a.data.bgcolor=t.bg)}r.editor=4}const mt=()=>{const e=m.value.flat();e.forEach(d=>{d.data.opacity=1});const t=e.filter(d=>d.unit&&!d.disabled),a=t.filter(d=>{var k;return((k=d.unit)==null?void 0:k.actorType)===W.ATTACKER})[0],C=t.filter(d=>{var k;return((k=d.unit)==null?void 0:k.actorType)===W.SHEEP})[0],h=t.filter(d=>{var k;return((k=d.unit)==null?void 0:k.actorType)===W.GUARD});if(!C||h.length===0){alert("\u7F3A\u5C11\u89D2\u8272\uFF0C\u5C06\u81EA\u52A8\u751F\u6210"),_e(),mt();return}const B=e.filter(d=>!d.unit);for(const d of B){const k=Tt(h,d,C);!k.unit||(d.data.image=k.unit.image,d.data.bgcolor=Ot[k.unit.actorId]||Ot[0],k.data.image?d.data.sup="":d.data.sup=String(k.unit.actorId),d.data.opacity=.6)}if(a){const d=Tt(h,a,C);d.unit&&(d.unit.guard=!0)}},me=e=>{if(!!e.unit&&r.editor===4){switch(e.unit.actorType){case W.GUARD:e.disabled=!e.disabled;break}mt()}},he=e=>{var t;!V.grid||!e.dataTransfer||V.action==="swap"&&(r.editor===4&&((t=V.grid.unit)==null?void 0:t.actorType)===W.SHEEP||e.preventDefault())},be=e=>{if(!!V.grid&&!!e)switch(V.action){case"swap":U(e),V.grid=void 0,V.action=void 0,r.editor===4&&mt()}},Vt=j(!1);function ge(){Vt.value=!0}return Lt(()=>{re(),window.addEventListener("mouseup",Rt,!1)}),Gt(()=>{window.removeEventListener("mouseup",Rt,!1)}),(e,t)=>{var d,k,u,Y;const a=gt,C=St,h=Ee("c-space"),B=Be("autofocus");return v(),F("div",Io,[o("div",$o,[o("div",Ao,[o("label",Vo,[So,O(C,{placeholder:"\u9009\u62E9",modelValue:r.editor,"onUpdate:modelValue":t[0]||(t[0]=c=>r.editor=c)},{default:Q(()=>[O(a,{value:1},{default:Q(()=>[Ho]),_:1}),O(a,{value:2},{default:Q(()=>[Lo]),_:1}),O(a,{value:3},{default:Q(()=>[Go]),_:1}),O(a,{value:4},{default:Q(()=>[Mo]),_:1})]),_:1},8,["modelValue"])]),o("label",Ro,[Uo,R(o("input",{type:"number",min:"0","onUpdate:modelValue":t[1]||(t[1]=c=>r.selectRange=c),style:{width:"5em"}},null,512),[[tt,r.selectRange]])]),o("label",Oo,[No,R(o("select",{"onUpdate:modelValue":t[2]||(t[2]=c=>r.shape=c)},zo,512),[[xt,r.shape]])]),o("label",Ko,[qo,R(o("select",{"onUpdate:modelValue":t[3]||(t[3]=c=>r.sortType=c)},Qo,512),[[xt,r.sortType]])]),o("button",{class:"btn",onClick:oe},"\u6E05\u7A7A"),o("button",{class:"btn",onClick:mt},"\u8BA1\u7B97\u62A4\u536B"),o("button",{class:"btn btn-success",onClick:Ut},"\u4FDD\u5B58\u5E03\u5C40"),o("button",{class:"btn btn-success",onClick:ue},"\u8FD8\u539F\u5E03\u5C40"),T("",!0),O(x($e),{modelValue:It.value,"onUpdate:modelValue":t[4]||(t[4]=c=>It.value=c)},{popover:Q(()=>[o("div",Yo,[(v(!0),F(yt,null,dt(x(Bo),(c,y)=>(v(),F("div",{class:"list-item",key:y,onClick:I=>ie(c)},st(c.name),9,tn))),128))])]),default:Q(()=>[Po]),_:1},8,["modelValue"]),en,o("div",{class:"btn btn-link",onClick:ge},"\u5E2E\u52A9"),O(Ae,{show:Vt.value,"onUpdate:show":t[5]||(t[5]=c=>Vt.value=c),width:"600px"},{default:Q(()=>[on]),_:1},8,["show"])]),o("div",nn,[O(h,null,{default:Q(()=>{var c,y,I;return[o("label",sn,[an,O(x(ut),{draggable:!1,data:{txt:"E",size:14,opacity:1,color:r.color,bgcolor:r.bgcolor},terrain:r.terrain},null,8,["data","terrain"])]),o("label",ln,[rn,O(x(pt),{modelValue:r.color,"onUpdate:modelValue":t[6]||(t[6]=L=>r.color=L)},null,8,["modelValue"])]),o("label",un,[cn,O(x(pt),{modelValue:r.bgcolor,"onUpdate:modelValue":t[7]||(t[7]=L=>r.bgcolor=L)},null,8,["modelValue"])]),yn,o("div",dn,[(v(!0),F(yt,null,dt(x(l),(L,J)=>(v(),ft(x(ut),{key:J,selected:r.bgcolor===L.bgcolor,style:et([`--color:${L.color};--bgcolor:${L.bgcolor}`]),onClick:ht=>X(L),onDragstart:ht=>xe(ht,L)},{default:Q(()=>[pn]),_:2},1032,["selected","style","onClick","onDragstart"]))),128)),O(x(ut),{selected:((c=r.terrain)==null?void 0:c.type)===x(P).terrain.type,terrain:x(P).terrain,onClick:t[8]||(t[8]=L=>lt(x(P))),onDragstart:t[9]||(t[9]=L=>$t(L,x(P)))},null,8,["selected","terrain"]),O(x(ut),{selected:((y=r.terrain)==null?void 0:y.type)===x(S).terrain.type,terrain:x(S).terrain,onClick:t[10]||(t[10]=L=>lt(x(S))),onDragstart:t[11]||(t[11]=L=>$t(L,x(S)))},null,8,["selected","terrain"]),O(x(ut),{selected:((I=r.terrain)==null?void 0:I.type)===x(M).terrain.type,terrain:x(M).terrain,onClick:t[12]||(t[12]=L=>lt(x(M))),onDragstart:t[13]||(t[13]=L=>$t(L,x(M)))},null,8,["selected","terrain"])]),o("div",{class:"trush",onDragover:he,onDrop:t[14]||(t[14]=L=>be(V.grid))},[(v(),F("svg",xn,vn))],32)]}),_:1})]),o("div",_n,[_.current?(v(),F("div",mn,[O(h,null,{default:Q(()=>[o("label",hn,[bn,O(x(ut),{draggable:!1,style:et([`--color:${_.current.data.color};--bgcolor:${_.current.data.bgcolor}`]),data:_.current.data,terrain:_.current.terrain,overlay:_.current.overlay,unit:_.current.unit},null,8,["style","data","terrain","overlay","unit"])]),o("label",gn,[Fn,O(x(pt),{modelValue:_.current.data.color,"onUpdate:modelValue":t[15]||(t[15]=c=>_.current.data.color=c)},null,8,["modelValue"])]),o("label",wn,[kn,O(x(pt),{modelValue:_.current.data.bgcolor,"onUpdate:modelValue":t[16]||(t[16]=c=>_.current.data.bgcolor=c)},null,8,["modelValue"])]),o("label",Dn,[En,R(o("input",{type:"number",style:{width:"4em"},min:"12",step:"1","onUpdate:modelValue":t[17]||(t[17]=c=>_.current.data.size=c)},null,512),[[tt,_.current.data.size]])]),o("label",Cn,[Bn,R(o("input",{type:"text",ref_key:"txtInput",ref:at,"onUpdate:modelValue":t[18]||(t[18]=c=>_.current.data.txt=c),style:{width:"6em"}},null,512),[[B],[tt,_.current.data.txt]])]),o("label",In,[$n,R(o("select",{"onUpdate:modelValue":t[19]||(t[19]=c=>_.current.terrain.type=c)},[o("option",{value:x(A).NONE},"\u65E0",8,An),o("option",{value:x(A).DISABLED},"\u7981\u6B62",8,Vn),o("option",{value:x(A).BLOCKED},"\u969C\u788D",8,Sn),o("option",{value:x(A).CLIFF},"\u60AC\u5D16",8,Hn)],512),[[xt,_.current.terrain.type]])]),_.current.unit?(v(),ft(h,{key:0},{default:Q(()=>[o("label",Ln,[Gn,R(o("input",{type:"number","onUpdate:modelValue":t[20]||(t[20]=c=>_.current.unit.actorId=c),style:{width:"4em"}},null,512),[[tt,_.current.unit.actorId]])]),o("label",Mn,[Rn,R(o("select",{"onUpdate:modelValue":t[21]||(t[21]=c=>_.current.unit.actorType=c)},[o("option",{value:x(W).NONE},"\u65E0",8,Un),o("option",{value:x(W).GUARD},"\u62A4\u536B",8,On),o("option",{value:x(W).SHEEP},"\u9776\u5B50",8,Nn),o("option",{value:x(W).ATTACKER},"\u653B\u51FB\u8005",8,Wn)],512),[[xt,_.current.unit.actorType]])]),o("label",Tn,[zn,R(o("input",{type:"checkbox","onUpdate:modelValue":t[22]||(t[22]=c=>_.current.unit.fly=c)},null,512),[[Ce,_.current.unit.fly]])])]),_:1})):T("",!0),o("button",{class:"btn",onClick:le},"\u5B8C\u6210")]),_:1})])):T("",!0)]),o("div",Kn,[(d=_.current)!=null&&d.unit?(v(),F("label",qn,[Xn,o("input",{type:"text",readonly:"",value:_.current.unit.unitId,style:{width:"4em"}},null,8,jn)])):T("",!0),(k=_.current)!=null&&k.unit?(v(),F("label",Zn,[Jn,R(o("select",{"onUpdate:modelValue":t[23]||(t[23]=c=>_.current.unit.team=c)},es,512),[[xt,_.current.unit.team]])])):T("",!0),(u=_.current)!=null&&u.unit?(v(),F("button",{key:2,class:"btn btn-success",onClick:ce},"\u602A\u529B\u4E71\u795E")):T("",!0),(Y=_.current)!=null&&Y.unit?(v(),F("button",{key:3,class:"btn btn-success",onClick:ye},"\u5F00\u8F66")):T("",!0)])]),o("div",os,[o("div",ns,[(v(!0),F(yt,null,dt(x(m),(c,y)=>(v(),F("div",{class:"grids-row",key:y},[(v(!0),F(yt,null,dt(c,(I,L)=>{var J,ht;return v(),ft(x(ut),{key:L,draggable:!0,selected:I.x===((J=_.current)==null?void 0:J.x)&&I.y===((ht=_.current)==null?void 0:ht.y),disabled:I.disabled,dot:I.unit&&I.unit.guard,data:I.data,terrain:I.terrain,overlay:I.overlay,unit:I.unit,onDragstart:nt=>pe(nt,I),onDragover:t[24]||(t[24]=ct(()=>{},["prevent"])),onDrop:nt=>fe(nt,I),onContextmenu:ct(nt=>me(I),["prevent"]),onClick:nt=>ne(nt,I),onMousedown:nt=>se(nt,I),onMouseenter:nt=>ae(nt,I),onClickoverlay:de},null,8,["selected","disabled","dot","data","terrain","overlay","unit","onDragstart","onDrop","onContextmenu","onClick","onMousedown","onMouseenter"])}),128))]))),128))]),o("div",ss,[o("div",as,[o("label",ls,[rs,R(o("select",{"onUpdate:modelValue":t[25]||(t[25]=c=>V.team=c)},ys,512),[[xt,V.team]])])]),o("div",ds,[O(x(ut),{item:x(p),onDragstart:t[26]||(t[26]=c=>Nt(c,x(p)))},null,8,["item"]),(v(!0),F(yt,null,dt(x(b),(c,y)=>(v(),ft(x(ut),{key:y,data:c.data,terrain:c.terrain,overlay:c.overlay,unit:c.unit,onDragstart:I=>Nt(I,c)},null,8,["data","terrain","overlay","unit","onDragstart"]))),128))])])])])}}});const ms=Ft(ps,[["__scopeId","data-v-d649bd0e"]]);export{ms as default};
