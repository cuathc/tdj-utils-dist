import{E as oe,d as J,s as K,_ as L,o as b,c as g,G as q,A as V,f as S,e as s,k as X,n as fe,H as Ke,I as Be,J as Oe,K as je,L as Ge,M as Fe,q as G,a as k,r as B,N as Se,g as o,i as u,j as se,w as M,B as Q,O as De,F as R,h as H,p as le,l as ae,P as He,Q as ne,R as Je,b as Y,T as Le,S as Pe,U as ze,u as We,V as Qe,v as Xe,C as Ce}from"./index.js";import{_ as Ue}from"./lodash.js";import{u as Ye}from"./useHeroes.js";import Ze from"./InputNumber.js";import{a as xe}from"./useTransformTools.js";import{s as et}from"./data.js";let ve=0,ye=0;const tt=500;function ge(){const e=Math.floor(new Date().getTime()/1e3);ye===e?ve++:ve=0,ye=e;const t=e.toString(16);return`${(tt<<16|ve&255).toString(16)}.${t}`}async function ke(){try{return await oe.getAll("calculator")}catch{return[]}}async function st(e){try{await oe.add("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function te(e){try{await oe.put("calculator",JSON.parse(JSON.stringify(e)))}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}async function nt(e){try{await oe.delete("calculator",e)}catch(t){t instanceof Error?console.log(t.message):console.log(t)}}function ot(){return{w:2438,g:0,a:"403+363",c:20,x:0}}function lt(){return{a:0}}function at(){return{att:0,k:0}}function Ie(){return{a1:1.5,a2:0,att:"15+10+8",att2:"0",da:"10+10",db:"4+10+20",dc:"0",dx:"0",id:"0",cd:"30",name:"1.5\u6280\u80FD",defGain:"0"}}function ut(){return{a1:1.5,a2:0,att:0,att2:0,id:0,da:0,db:0,dc:0,dx:0,cd:0,defGain:0}}function it(){return[Ie()]}function dt(){return{hp:"10000",def:"1872",defGain:"15+5",ra:"0",rb:"4+10"}}const rt=J({props:{active:Boolean,label:String,dir:String,color:String},setup(e){const t=K({});function d(v){const C=v.currentTarget.getBoundingClientRect();switch(e.dir){case"left":t.value={top:`${C.top+C.height/2}px`,right:`${window.innerWidth-C.left}px`,maxWidth:"100%"};break;case"right":t.value={top:`${C.top+C.height/2}px`,left:`${C.right}px`,maxWidth:"100%"};break;case"top":t.value={bottom:`${window.innerHeight-C.top}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"};break;default:t.value={top:`${C.bottom}px`,left:`${C.left+C.width/2}px`,maxWidth:"100%"}}}return{style:t,onEnter:d}}});function ct(e,t,d,v,$,C){return b(),g("div",{class:X(["c-tooltip",{active:e.active}]),onMouseenter:t[0]||(t[0]=(..._)=>e.onEnter&&e.onEnter(..._))},[q(e.$slots,"label",{},()=>[V(S(e.label),1)]),s("div",{class:X(["c-tooltip-inner",e.dir?`c-tooltip-${e.dir}`:"c-tooltip-bottom",e.color?`c-tooltip-${e.color}`:""]),style:fe(e.style)},[q(e.$slots,"default")],6)],34)}var Ee=L(rt,[["render",ct]]);const pt=J({components:{Divider:Ke,Tooltip:Ee,CalcInput:Be,IconUp:Oe,IconDown:je,IconClose:Ge,IconCopy:Fe},props:{panel:{type:Object,required:!0},state:{type:Object,required:!0},enemyState:{type:Object,required:!0},itemState:{type:Object,required:!0},showUp:Boolean,showDown:Boolean},emits:["update:itemState","close","up","down","copy"],setup(e,{emit:t}){const d=G({editor:!1,name:""}),v=(n,i)=>{if(n==="name")return;const F=e.itemState;switch(n){case"a1":case"a2":typeof i=="number"&&(F[n]=i);break;default:typeof i=="string"&&(F[n]=i)}t("update:itemState",F)},$=G(ut()),C=k({set:n=>v("a1",n),get:()=>e.itemState.a1}),_=k({set:n=>v("a2",n),get:()=>e.itemState.a2}),w=k({set:n=>v("att",n),get:()=>e.itemState.att}),f=k({set:n=>v("att2",n),get:()=>e.itemState.att2}),h=k({set:n=>v("id",n),get:()=>e.itemState.id}),r=k({set:n=>v("da",n),get:()=>e.itemState.da}),c=k({set:n=>v("db",n),get:()=>e.itemState.db}),U=k({set:n=>v("dc",n),get:()=>e.itemState.dc}),T=k({set:n=>v("dx",n),get:()=>e.itemState.dx}),p=k({set:n=>v("cd",n),get:()=>e.itemState.cd}),I=k({set:n=>v("defGain",n),get:()=>e.itemState.defGain}),O=G({a1:C,a2:_,att:w,att2:f,da:r,db:c,dc:U,dx:T,id:h,cd:p,defGain:I}),l=k(()=>{const{state:n}=e,i=(100+$.att)/100;return Math.ceil(n.att*i)}),D=k(()=>{const{state:n}=e,i=(100+$.att+$.att2)/100;return Math.ceil(n.att*i)}),m=()=>{const{state:n,enemyState:i}=e,F=(100+n.k)/100,E=(100+$.da-i.ra)/100,P=(100+$.db-i.rb)/100,pe=(100+$.dc)/100,z=(100+$.dx)/100,ee=(100+$.cd)/100,me=(100-$.id)/100,Me=(100+i.defGain+$.defGain)/100,he=Math.max(0,Math.max(0,i.def*Me)*me),qe=Math.max(1,l.value*F-he),Re=Math.max(1,D.value*F-he),be=qe*C.value*E*P*z,Ne=Math.ceil(be*ee),$e=Re*_.value*E*P*pe*z,Te=Math.ceil($e*ee);return{r01:Math.ceil(be),r01c:Ne,r02:Math.ceil($e),r02c:Te}},a=k(()=>m().r01),A=k(()=>m().r01c),j=k(()=>m().r02),Z=k(()=>m().r02c);m();function x(){confirm(`\u786E\u8BA4\u8981\u5220\u9664\u6280\u80FD\u6A21\u677F"${e.itemState.name}"\u5417\uFF1F`)&&t("close")}function ue(){d.editor=!0,d.name=e.itemState.name}function ie(){const n=d.name;if(d.editor=!1,d.name="",!n)return;const i=e.itemState;i.name=n,t("update:itemState",i)}function de(){t("up")}function re(){t("down")}function ce(){t("copy")}return{vars:d,values:O,result:$,satt:l,r01:a,r01c:A,r02:j,r02c:Z,onClose:x,onRename:ue,onNameEnter:ie,onUp:de,onDown:re,onCopy:ce}}}),N=e=>(le("data-v-6008e541"),e=e(),ae(),e),mt={class:"row"},vt={class:"col-item"},_t=N(()=>s("div",{class:"label"},"\u6280\u80FD\u3001\u666E\u653B",-1)),ft=V(" \u6280\u80FD\u3001\u666E\u653B\u500D\u7387 "),ht={class:"input-group"},bt=["step"],$t=N(()=>s("div",{class:"input-ext"},"\u500D",-1)),Ct={class:"label"},yt={class:"input-group"},gt=N(()=>s("div",{style:{clear:"both"}},null,-1)),kt={class:"col-item"},wt=N(()=>s("div",{class:"label"},"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB",-1)),Bt=V(" \u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u500D\u7387 "),Ft={class:"input-group"},St=["step"],Dt=N(()=>s("div",{class:"input-ext"},"\u500D",-1)),Ut={class:"label"},It={class:"input-group"},Et={class:"col-item"},At=N(()=>s("div",{class:"label"},"\u6700\u7EC8\u653B\u51FB",-1)),Vt={class:"static-control text-center"},Mt={class:"darkgold"},qt=N(()=>s("div",{style:{clear:"both"}},null,-1)),Rt={class:"col-item"},Nt=N(()=>s("div",{class:"label"},[s("span",{class:"darkgold"},"\u4E00\u6BB5\u4F24\u5BB3"),s("span",{class:"red"},"(\u66B4\u51FB)")],-1)),Tt={class:"static-control text-center"},Kt={class:"darkgold"},Ot={class:"red bold"},jt={class:"col-item"},Gt=N(()=>s("div",{class:"label"},[s("span",{class:"darkgold"},"\u4E8C\u6BB5\u4F24\u5BB3"),s("span",{class:"red"},"(\u66B4\u51FB)")],-1)),Ht={class:"static-control text-center"},Jt={class:"darkgold"},Lt={class:"red bold"},Pt={class:"col-item"},zt=N(()=>s("div",{class:"label"},"\u5269\u4F59\u6C14\u8840",-1)),Wt={class:"static-control text-center"},Qt={class:"darkgold"},Xt={class:"red bold"};function Yt(e,t,d,v,$,C){const _=B("IconCopy"),w=B("IconUp"),f=B("IconDown"),h=B("IconClose"),r=B("Divider"),c=B("Tooltip"),U=B("CalcInput"),T=Se("autofocus");return b(),g(R,null,[o(r,{orientation:"left"},{action:u(()=>[s("span",{onClick:t[4]||(t[4]=(...p)=>e.onCopy&&e.onCopy(...p))},[o(_,{class:"close"})]),e.showUp?(b(),g("span",{key:0,onClick:t[5]||(t[5]=(...p)=>e.onUp&&e.onUp(...p))},[o(w,{class:"close"})])):se("",!0),e.showDown?(b(),g("span",{key:1,onClick:t[6]||(t[6]=(...p)=>e.onDown&&e.onDown(...p))},[o(f,{class:"close"})])):se("",!0),s("span",{onClick:t[7]||(t[7]=(...p)=>e.onClose&&e.onClose(...p))},[o(h,{class:"close"})])]),default:u(()=>[e.vars.editor?M((b(),g("input",{key:0,class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=p=>e.vars.name=p),onKeypress:t[1]||(t[1]=De((...p)=>e.onNameEnter&&e.onNameEnter(...p),["enter"])),onBlur:t[2]||(t[2]=(...p)=>e.onNameEnter&&e.onNameEnter(...p))},null,544)),[[Q,e.vars.name],[T]]):(b(),g("span",{key:1,class:"calc-item-title",onClick:t[3]||(t[3]=(...p)=>e.onRename&&e.onRename(...p))},S(e.itemState.name||"\u6A21\u677F"),1))]),_:1}),s("div",mt,[s("div",vt,[o(c,{dir:"top"},{label:u(()=>[_t]),default:u(()=>[ft]),_:1}),s("div",ht,[M(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[8]||(t[8]=p=>e.values.a1=p)},null,8,bt),[[Q,e.values.a1,void 0,{number:!0}]]),$t])]),(b(),g(R,null,H([{name:"att",label:"\u653B\u51FB%",tip:"\u4F5C\u7528\u4E8E\u6240\u6709\u60C5\u51B5"},{name:"da",label:"A\u7C7B\u589E\u4F24%",tip:"\u9970\u54C1\u3001\u5404\u7C7Bbuff\u3001\u5929\u8D4B"},{name:"db",label:"B\u7C7B\u589E\u4F24%",tip:"\u661F\u8000\u3001\u661F\u76D8\u3001\u8BCD\u6761"},{name:"dx",label:"X\u7C7B\u589E\u4F24%",tip:"\u6700\u7EC8\u4FEE\u6B63\uFF0C\u5982\u4E00\u5B57\u7535\u65A9"},{name:"id",label:"\u7A7F\u900F%",tip:"\u65E0\u89C6\u9632\u5FA1"},{name:"cd",label:"\u66B4\u4F24%",tip:"\u66B4\u51FB\u4F24\u5BB3"}],p=>s("div",{class:"col-item",key:p.name},[o(c,{dir:"top"},{label:u(()=>[s("div",Ct,S(p.label),1)]),default:u(()=>[V(" "+S(p.tip),1)]),_:2},1024),s("div",yt,[o(U,{class:"input",modelValue:e.values[p.name],"onUpdate:modelValue":I=>e.values[p.name]=I,result:e.result[p.name],"onUpdate:result":I=>e.result[p.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),gt,s("div",kt,[o(c,{dir:"top"},{label:u(()=>[wt]),default:u(()=>[Bt]),_:1}),s("div",Ft,[M(s("input",{type:"number",class:"input",min:"0",step:.1,"onUpdate:modelValue":t[9]||(t[9]=p=>e.values.a2=p)},null,8,St),[[Q,e.values.a2,void 0,{number:!0}]]),Dt])]),(b(),g(R,null,H([{name:"att2",label:"\u653B\u51FB2%",tip:"\u6389\u8840\u540E\u52A0\u653B\uFF0C\u4E00\u822C\u5728\u8FFD\u51FB\u6216\u53CD\u51FB\u65F6"},{name:"dc",label:"C\u7C7B\u589E\u4F24%",tip:"\u8FDE\u51FB\u3001\u8FFD\u51FB\u3001\u53CD\u51FB\u589E\u4F24"},{name:"defGain",label:"\u9632\u5FA1\u4FEE\u6B63%",tip:"\u9632\u5FA1\u4FEE\u6B63"}],p=>s("div",{class:"col-item",key:p.name},[o(c,{dir:"top"},{label:u(()=>[s("div",Ut,S(p.label),1)]),default:u(()=>[V(" "+S(p.tip),1)]),_:2},1024),s("div",It,[o(U,{class:"input",modelValue:e.values[p.name],"onUpdate:modelValue":I=>e.values[p.name]=I,result:e.result[p.name],"onUpdate:result":I=>e.result[p.name]=I},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result"])])])),64)),s("div",Et,[At,s("div",Vt,[s("span",Mt,S(e.satt),1)])]),qt,s("div",Rt,[Nt,s("div",Tt,[s("span",Kt,S(e.r01),1),s("span",Ot,"("+S(e.r01c)+")",1)])]),s("div",jt,[Gt,s("div",Ht,[s("span",Jt,S(e.r02),1),s("span",Lt,"("+S(e.r02c)+")",1)])]),s("div",Pt,[zt,s("div",Wt,[s("span",Qt,S((+e.enemyState.hp||0)-e.r01-e.r02),1),s("span",Xt," ("+S((+e.enemyState.hp||0)-e.r01c-e.r02c)+") ",1)])])])],64)}var Zt=L(pt,[["render",Yt],["__scopeId","data-v-6008e541"]]);const xt=["onClick"],es=J({props:{pos:{default:"lt"}},setup(e){const t=K(!1),d=()=>{t.value=!0},v=()=>{t.value=!1};return window.addEventListener("click",v,!1),He(()=>{window.removeEventListener("click",v,!1)}),($,C)=>(b(),g("div",{class:X(["dropdown",[{active:t.value}]]),onClick:ne(d,["stop"])},[q($.$slots,"default",{},void 0,!0),s("div",{class:X(["dropdown-popover",["dropdown-"+e.pos]]),onClick:C[0]||(C[0]=ne(()=>{},["stop"]))},[q($.$slots,"popover",{onClose:v},void 0,!0)],2)],10,xt))}});var Ae=L(es,[["__scopeId","data-v-782cbcbc"]]);Ae.install=e=>{e.component("dropdown",Ve)};const Ve=Ae;const ts=J({components:{CalcItem:Zt,CalcInput:Be,Tooltip:Ee,Dropdown:Ve},props:{data:{type:Object,required:!0}},emits:["update:data"],setup(e,{emit:t}){const d=k(()=>e.data.basic),v=k(()=>e.data.state),$=k(()=>e.data.enemyState),C=k(()=>e.data.items),_=G(lt()),w=G({hp:0,def:0,defGain:0,ra:0,rb:0}),f=[{label:"\u9762\u677F\u653B\u51FB",name:"w",step:1,align:"right"},{label:"\u9B42\u77F3\u653B\u51FB",name:"a",step:1},{label:"\u8BCD\u6761\u653B\u51FB%",name:"c",step:1},{label:"\u661F\u4E4B\u6676\u653B\u51FB",name:"x",step:1}],h=[{label:"\u6C14\u8840",name:"hp",step:1},{label:"\u9632\u5FA1",name:"def",step:1},{label:"\u9632\u5FA1\u4FEE\u6B63%",name:"defGain",step:1},{label:"A\u7C7B\u514D\u4F24%",name:"ra",step:1},{label:"B\u7C7B\u514D\u4F24%",name:"rb",step:1}],r=()=>{const m=d.value.c/100;d.value.g=Math.ceil(_.a+d.value.w*m+d.value.x),v.value.att=d.value.w+d.value.g},c=async()=>{t("update:data",e.data)},U=(m,a)=>{a==="panel"&&r(),c()},T=(m,a)=>{const A=e.data.items;!A||(A[a]=m,c())},p=()=>{const m=e.data.items;!m||(m.push(Ie()),c())},I=m=>{const a=e.data.items;!a||(a.splice(m,1),c())},O=m=>{const a=e.data.items;if(!a)return;const A=a[m],j=a[m-1];a[m-1]=A,a[m]=j,c()},l=m=>{const a=e.data.items;if(!a)return;const A=a[m],j=a[m+1];a[m+1]=A,a[m]=j,c()},D=m=>{const a=e.data.items;if(!a)return;const A=a[m];a.push(Ue.cloneDeep(A)),c()};return Je(()=>[e.data.basic.w],()=>{r()}),{panel:d,state:v,enemyState:$,panelResult:_,enemyStateResult:w,panelModels:f,enemyModels:h,update:U,items:C,updateItemState:T,addItem:p,delItem:I,upItem:O,downItem:l,copyItem:D}}}),W=e=>(le("data-v-104d0034"),e=e(),ae(),e),ss=W(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u57FA\u672C\u53C2\u6570")],-1)),ns={class:"row"},os={class:"label"},ls={class:"input-group"},as=["step","onUpdate:modelValue","onChange"],us=["value"],is={class:"col-item"},ds=W(()=>s("div",{class:"label"},"\u8FDB\u56FE\u653B\u51FB",-1)),rs={class:"static-control text-center"},cs={class:"darkgold"},ps={class:"col-item"},ms=W(()=>s("div",{class:"label"},"\u514B\u5236%",-1)),vs=V(" \u514B\u523630%"),_s=W(()=>s("br",null,null,-1)),fs=V("\u88AB\u514B\u5236-25%"),hs=W(()=>s("br",null,null,-1)),bs=V("\u6FC0\u836150% "),$s=["onClick"],Cs=W(()=>s("div",{class:"heading"},[s("div",{class:"heading-title"},"\u654C\u4EBA\u9762\u677F")],-1)),ys={class:"row"},gs={class:"label"},ks={class:"input-group"},ws={key:0,class:"input-ext"},Bs={class:"heading"},Fs=W(()=>s("div",{class:"heading-title"},"\u6280\u80FD\u6A21\u677F",-1)),Ss={class:"heading-actions"};function Ds(e,t,d,v,$,C){const _=B("CalcInput"),w=B("Tooltip"),f=B("Dropdown"),h=B("CalcItem");return b(),g("div",null,[ss,s("div",ns,[(b(!0),g(R,null,H(e.panelModels,r=>(b(),g("div",{class:"col-item",key:r.name},[s("div",os,S(r.label),1),s("div",ls,[r.name in e.panelResult?(b(),Y(_,{key:0,modelValue:e.panel[r.name],"onUpdate:modelValue":c=>e.panel[r.name]=c,result:e.panelResult[r.name],"onUpdate:result":c=>e.panelResult[r.name]=c,onChange:c=>e.update(r.name,"panel")},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"])):M((b(),g("input",{key:1,type:"number",class:"input",style:fe({textAlign:r.align}),min:"0",step:r.step,"onUpdate:modelValue":c=>e.panel[r.name]=c,onChange:c=>e.update(r.name,"panel")},null,44,as)),[[Q,e.panel[r.name],void 0,{number:!0}]]),r.name==="w"?(b(),g("input",{key:2,class:"input green",readonly:"",style:{textAlign:"left"},value:`+${e.panel.g}`},null,8,us)):se("",!0)])]))),128)),s("div",is,[ds,s("div",rs,[s("span",cs,S(e.state.att),1)])]),s("div",ps,[o(w,{dir:"top"},{label:u(()=>[ms]),default:u(()=>[vs,_s,fs,hs,bs]),_:1}),s("div",null,[o(f,null,{popover:u(({onClose:r})=>[s("div",{class:"list",onClick:()=>{r(),e.update("k","state")}},[s("div",{class:"list-item",onClick:t[2]||(t[2]=c=>e.state.k=0)},"\u666E\u901A"),s("div",{class:"list-item",onClick:t[3]||(t[3]=c=>e.state.k=30)},"\u514B\u5236"),s("div",{class:"list-item",onClick:t[4]||(t[4]=c=>e.state.k=-25)},"\u88AB\u514B\u5236"),s("div",{class:"list-item",onClick:t[5]||(t[5]=c=>e.state.k=50)},"\u6FC0\u8361")],8,$s)]),default:u(()=>[M(s("input",{class:"input",type:"number","onUpdate:modelValue":t[0]||(t[0]=r=>e.state.k=r),step:"0.01",onChange:t[1]||(t[1]=r=>e.update("k","state")),list:"d1"},null,544),[[Q,e.state.k,void 0,{number:!0}]])]),_:1})])])]),Cs,s("div",ys,[(b(!0),g(R,null,H(e.enemyModels,r=>(b(),g("div",{class:"col-item",key:r.name},[s("div",gs,S(r.label),1),s("div",ks,[o(_,{modelValue:e.enemyState[r.name],"onUpdate:modelValue":c=>e.enemyState[r.name]=c,result:e.enemyStateResult[r.name],"onUpdate:result":c=>e.enemyStateResult[r.name]=c,onChange:c=>e.update(r.name)},null,8,["modelValue","onUpdate:modelValue","result","onUpdate:result","onChange"]),r.precent?(b(),g("div",ws,"%")):se("",!0)])]))),128))]),s("div",Bs,[Fs,s("div",Ss,[s("div",{class:"btn btn-primary btn-sm",onClick:t[6]||(t[6]=(...r)=>e.addItem&&e.addItem(...r))},"\u6DFB\u52A0")])]),(b(!0),g(R,null,H(e.items,(r,c)=>(b(),Y(h,{key:r,panel:e.panel,state:e.state,enemyState:e.enemyStateResult,itemState:r,showUp:c>0,showDown:e.items&&c<e.items.length-1,"onUpdate:itemState":U=>e.updateItemState(U,c),onClose:U=>e.delItem(c),onUp:U=>e.upItem(c),onDown:U=>e.downItem(c),onCopy:U=>e.copyItem(c)},null,8,["panel","state","enemyState","itemState","showUp","showDown","onUpdate:itemState","onClose","onUp","onDown","onCopy"]))),128))])}var Us=L(ts,[["render",Ds],["__scopeId","data-v-104d0034"]]);const Is=J({props:{show:Boolean,list:Array,class:String,height:String},emits:["click","close","update:show"],setup(e,{emit:t}){return{wrapClass:k(()=>["c-action-sheet-wrapper",e.class,{show:e.show}]),onClick:(C,_)=>{t("click",{item:C,index:_}),t("close",!1)},onClose:()=>{t("update:show",!1),t("close",!1)}}}}),Es={class:"c-action-sheet-section"},As={class:"c-action-sheet-extra"},Vs={class:"c-action-sheet-list"},Ms=["onClick"];function qs(e,t,d,v,$,C){return b(),Y(Le,{to:"body"},[s("div",{class:X(e.wrapClass)},[s("div",{class:"c-action-sheet-mask",onClick:t[0]||(t[0]=(..._)=>e.onClose&&e.onClose(..._))}),s("div",Es,[s("div",{class:"c-action-sheet-body",style:fe({maxHeight:e.height})},[s("div",As,[q(e.$slots,"extra")]),s("div",Vs,[(b(!0),g(R,null,H(e.list,(_,w)=>(b(),g("div",{class:"c-action-sheet-item",key:w,onClick:f=>e.onClick(_,w)},[q(e.$slots,"default",{record:_})],8,Ms))),128))])],4)])],2)])}var _e=L(Is,[["render",qs]]);_e.install=e=>{e.component("action-sheet",_e)};const Rs=J({components:{ActionSheet:_e},props:{show:Boolean},emits:["click","update:show"],setup(e,{emit:t}){const{heroes:d,getHeroIcon:v}=Ye();return{heroes:d,getHeroIcon:v,onClick:C=>{t("click",C)}}}}),Ns={class:"hero-item"},Ts=["src","alt","title"],Ks={class:"hero-item-label"};function Os(e,t,d,v,$,C){const _=B("ActionSheet");return b(),Y(_,{class:"hero-select",show:e.show,list:e.heroes,height:"80vh",onClick:e.onClick,"onUpdate:show":t[0]||(t[0]=w=>e.$emit("update:show",w))},{extra:u(()=>[q(e.$slots,"extra")]),default:u(({record:w})=>[s("div",Ns,[s("img",{src:e.getHeroIcon(w),alt:w.name,title:w.name,width:"128",height:"128"},null,8,Ts),s("div",Ks,S(w.name),1)])]),_:3},8,["show","list","onClick"])}var js=L(Rs,[["render",Os]]);const Gs=J({props:{header:String,activeKey:Boolean},emits:["update:activeKey","toggle"],setup(e,{emit:t}){const d=k({get:()=>e.activeKey,set:$=>{t("update:activeKey",$)}});return{active:d,toggle:()=>{const $=!d.value;d.value=$,t("toggle",$)}}}}),Hs=e=>(le("data-v-2b5ca870"),e=e(),ae(),e),Js=Hs(()=>s("div",{class:"panel-icon"},[s("svg",{width:"16",height:"16",viewBox:"-16 -16 32 32"},[s("path",{d:"M6 0 l-12 -12 l0 2 l10 10 l-10 10 l0 2 l12 -12z",fill:"currentColor"})])],-1)),Ls={class:"panel-title"},Ps={class:"panel-body"},zs={class:"panel-content"};function Ws(e,t,d,v,$,C){return b(),g("div",{class:X(["panel",{active:e.active}])},[s("div",{class:"panel-header",onClick:t[1]||(t[1]=(..._)=>e.toggle&&e.toggle(..._))},[Js,s("div",Ls,[q(e.$slots,"header",{},()=>[V(S(e.header)+"\xA0",1)],!0)]),s("div",{class:"panel-actions",onClick:t[0]||(t[0]=ne(()=>{},["stop"]))},[q(e.$slots,"actions",{},void 0,!0)])]),s("div",Ps,[s("div",zs,[q(e.$slots,"default",{},void 0,!0)])])],2)}var Qs=L(Gs,[["render",Ws],["__scopeId","data-v-2b5ca870"]]);const we=(e,t)=>{const d=URL.createObjectURL(e),v=document.createElement("a");v.href=d,v.target="_blank",v.download=t,v.click(),URL.revokeObjectURL(d)};const Xs=J({components:{Calculator:Us,CollapsePanel:Qs,InputNumber:Ze,HeroSelect:js,IconCopy:Fe,IconEdit:Pe},setup(){const e=K(),t=G({index:-1,title:""}),d=K([]),v=async()=>{const i={id:ge(),title:"\u6A21\u677F",basic:ot(),state:at(),enemyState:dt(),items:it()};await st(i),d.value.push(i)},$=async n=>{if(!confirm("\u786E\u8BA4\u8981\u5220\u9664\u5417\uFF1F"))return;const F=d.value[n];await nt(F.id),d.value.splice(n,1)},C=async n=>{const i=d.value[n];if(!i)return;const F=t.title;if(!F){_();return}i.title=F,_(),await te(i)},_=()=>{t.index=-1,t.title=""},w=n=>{const i=new Blob([JSON.stringify([n])],{type:"application/json"});we(i,`${n.title}.json`)},f=async n=>{d.value=n},h=K(""),r=n=>new Promise((i,F)=>{const E=new FileReader;E.onload=()=>{i(E.result)},E.onerror=()=>{F(E.error)},E.readAsText(n)}),c=async n=>{const i=n.currentTarget,F=Array.prototype.slice.call(i.files);if(i.value="",!F||!F[0])return;const E=F[0],P=await r(E),pe=JSON.parse(P);for(const z of pe){await te(z);const ee=d.value.findIndex(me=>me.id===z.id);ee===-1?d.value.push(z):d.value[ee]=z}},U=async()=>{const n=await ke(),i=new Blob([JSON.stringify(n)],{type:"application/json"});we(i,"calculator.json")};async function T(n,i){!d.value[i]||(d.value[i]=n,await te(n))}const p=K(-1),I=G({input:"2283/1.35*1.39",result:0}),{translate:O,xinyao:l,huazhen:D}=xe(),m=n=>Math.ceil(n),a=G({show:!1,qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0,hs_qixue:0,hs_patt:0,hs_pdef:0,hs_matt:0,hs_mdef:0,hs_huixin:0,x_qixue:0,x_patt:0,x_pdef:0,x_matt:0,x_mdef:0,x_huixin:0}),A=k(()=>{const n={qixue:0,patt:0,pdef:0,matt:0,mdef:0,huixin:0};return e.value&&(n.qixue=e.value.t[0]+e.value.d[0]+e.value.h[0],n.patt=e.value.t[1]+e.value.d[1]+e.value.h[1],n.matt=e.value.t[2]+e.value.d[2]+e.value.h[2],n.pdef=e.value.t[3]+e.value.d[3]+e.value.h[3],n.mdef=e.value.t[4]+e.value.d[4]+e.value.h[4]),{qixue:Math.round(a.qixue+a.qixue*a.hs_qixue+n.qixue+a.x_qixue),patt:Math.round(a.patt+a.patt*a.hs_patt+n.patt+a.x_patt),pdef:Math.round(a.pdef+a.pdef*a.hs_pdef+n.pdef+a.x_pdef),matt:Math.round(a.matt+a.matt*a.hs_matt+n.matt+a.x_matt),mdef:Math.round(a.mdef+a.mdef*a.hs_mdef+n.mdef+a.x_mdef),huixin:Math.round(a.huixin+a.huixin*a.hs_huixin+n.huixin+a.x_huixin)}}),j=n=>{const i=O(n);a.show=!0,a.qixue=i.qixue,a.patt=i.patt,a.pdef=i.pdef,a.matt=i.matt,a.mdef=i.mdef,a.huixin=i.huixin},Z=K(!1),x=K(-1),ue=K(null),ie=n=>{Z.value=!0,x.value=n},de=({item:n})=>{Z.value=!1;const i=x.value;if(i===-1)j(n);else{const E=d.value[i],P=O(n);E.title==="\u6A21\u677F"&&(E.title=n.name),E.basic.w=Math.max(P.patt,P.matt),te(E)}},re=n=>{const i=Ue.cloneDeep(n);i.id=ge(),console.log(i),d.value.push(i),te(i)};async function ce(){const n=await ke();f(n)}return ze(()=>{ce()}),{stones:et,stone:e,vars:t,activeKey:p,quick:I,list:d,add:v,rename:C,renameClose:_,remove:$,itemExport:w,download:h,onUpdateData:T,importData:c,exportData:U,heroes:We,max:Math.max,modal:a,ckValue:A,ceilResult:m,selectTpl:j,selectShow:Z,selectIndex:x,selectValue:ue,openSelect:ie,selectHero:de,copyItem:re,xinyao:l,huazhen:D}}}),y=e=>(le("data-v-88ac5550"),e=e(),ae(),e),Ys={class:"wrapper"},Zs={class:"toolbar"},xs={style:{padding:"6px 16px"}},en=V("\u4F24\u5BB3\u8BA1\u7B97\u5668"),tn={class:"c-upload"},sn=y(()=>s("button",{class:"btn btn-success"},"\u5BFC\u5165",-1)),nn={class:"transform-tools-popover"},on={class:"transform-tools-popover-toolbar"},ln={class:"transform-tools-popover-content"},an=y(()=>s("div",{class:"input-group-title"},"\u57FA\u7840",-1)),un={class:"grids"},dn=y(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),rn=y(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),cn=y(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),pn=y(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),mn=y(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),vn=y(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),_n={class:"input-group-title"},fn=y(()=>s("span",null,"\u9B42\u77F3",-1)),hn=y(()=>s("option",{value:void 0},"\u65E0",-1)),bn=["value"],$n={class:"grids"},Cn=y(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),yn=y(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),gn=y(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),kn=y(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),wn=y(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),Bn=y(()=>s("div",{class:"input-group-title"},"\u661F\u4E4B\u6676",-1)),Fn={class:"grids"},Sn=y(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),Dn=y(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),Un=y(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),In=y(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),En=y(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),An=y(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),Vn=y(()=>s("div",{class:"input-group-title"},"\u53C2\u8003",-1)),Mn={class:"grids"},qn=y(()=>s("label",{class:"input-label"},"\u6C14\u8840",-1)),Rn=y(()=>s("label",{class:"input-label"},"\u7269\u653B",-1)),Nn=y(()=>s("label",{class:"input-label"},"\u7269\u9632",-1)),Tn=y(()=>s("label",{class:"input-label"},"\u6CD5\u653B",-1)),Kn=y(()=>s("label",{class:"input-label"},"\u6CD5\u9632",-1)),On=y(()=>s("label",{class:"input-label"},"\u4F1A\u5FC3",-1)),jn={style:{padding:"6px 16px"}},Gn={class:"input-group"},Hn=y(()=>s("div",{class:"input-ext"},"=",-1)),Jn={class:"content"},Ln={class:"container"},Pn=["onKeypress"],zn={key:1},Wn=["onClick"],Qn=["onClick"],Xn=["onClick"],Yn=V(" \u91CD\u547D\u540D "),Zn=["onClick"],xn=V(" \u590D\u5236 "),eo=["onClick"],to=["onClick"],so={style:{"text-align":"center"}},no=y(()=>s("span",null,"\u661F\u8000",-1)),oo=y(()=>s("span",null,"\u5316\u81FB",-1));function lo(e,t,d,v,$,C){const _=B("c-col"),w=B("c-row"),f=B("input-number"),h=B("c-space"),r=B("calc-input"),c=B("IconEdit"),U=B("IconCopy"),T=B("Calculator",!0),p=B("CollapsePanel"),I=B("HeroSelect"),O=Se("autofocus");return b(),g("div",Ys,[s("div",Zs,[s("div",xs,[o(w,{flex:"",middle:"",gutter:16},{default:u(()=>[o(_,{flex:"0 0 auto"},{default:u(()=>[en]),_:1}),o(_,{flex:"0 0 auto"},{default:u(()=>[s("button",{class:"btn btn-sm btn-link",onClick:t[0]||(t[0]=l=>e.modal.show=!e.modal.show)}," \u9762\u677F ")]),_:1}),o(_,{flex:"1 1 0"}),o(_,{flex:"0 0 auto"},{default:u(()=>[s("div",tn,[sn,s("input",{type:"file",class:"c-upload-input",accept:"application/json",onInput:t[1]||(t[1]=(...l)=>e.importData&&e.importData(...l))},null,32)]),s("button",{class:"btn btn-success",onClick:t[2]||(t[2]=(...l)=>e.exportData&&e.exportData(...l))},"\u5BFC\u51FA"),s("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=l=>e.add())},"\u6DFB\u52A0")]),_:1})]),_:1}),M(s("div",nn,[s("div",on,[o(w,{flex:"",middle:"",gutter:0},{default:u(()=>[o(_,{flex:"1 1 auto"},{default:u(()=>[s("button",{class:"btn btn-sm btn-link",onClick:t[4]||(t[4]=l=>e.openSelect(-1))}," \u53C2\u8003 ")]),_:1}),o(_,null,{default:u(()=>[s("span",{class:"transform-tools-popover-close",onClick:t[5]||(t[5]=l=>e.modal.show=!1)}," \xD7 ")]),_:1})]),_:1})]),s("div",ln,[an,s("div",un,[o(h,null,{default:u(()=>[dn,o(f,{value:e.modal.qixue,"onUpdate:value":t[6]||(t[6]=l=>e.modal.qixue=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[rn,o(f,{value:e.modal.patt,"onUpdate:value":t[7]||(t[7]=l=>e.modal.patt=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[cn,o(f,{value:e.modal.pdef,"onUpdate:value":t[8]||(t[8]=l=>e.modal.pdef=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[pn,o(f,{value:e.modal.matt,"onUpdate:value":t[9]||(t[9]=l=>e.modal.matt=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[mn,o(f,{value:e.modal.mdef,"onUpdate:value":t[10]||(t[10]=l=>e.modal.mdef=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[vn,o(f,{value:e.modal.huixin,"onUpdate:value":t[11]||(t[11]=l=>e.modal.huixin=l)},null,8,["value"])]),_:1})]),s("div",_n,[o(h,null,{default:u(()=>[fn,M(s("select",{class:"input","onUpdate:modelValue":t[12]||(t[12]=l=>e.stone=l)},[hn,(b(!0),g(R,null,H(e.stones,(l,D)=>(b(),g("option",{key:D,value:l},S(l.name),9,bn))),128))],512),[[Xe,e.stone]])]),_:1})]),s("div",$n,[o(h,null,{default:u(()=>[Cn,o(f,{value:e.modal.hs_qixue,"onUpdate:value":t[13]||(t[13]=l=>e.modal.hs_qixue=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[yn,o(f,{value:e.modal.hs_patt,"onUpdate:value":t[14]||(t[14]=l=>e.modal.hs_patt=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[gn,o(f,{value:e.modal.hs_pdef,"onUpdate:value":t[15]||(t[15]=l=>e.modal.hs_pdef=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[kn,o(f,{value:e.modal.hs_matt,"onUpdate:value":t[16]||(t[16]=l=>e.modal.hs_matt=l)},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[wn,o(f,{value:e.modal.hs_mdef,"onUpdate:value":t[17]||(t[17]=l=>e.modal.hs_mdef=l)},null,8,["value"])]),_:1})]),Bn,s("div",Fn,[o(h,null,{default:u(()=>[Sn,o(f,{value:e.modal.x_qixue,"onUpdate:value":t[18]||(t[18]=l=>e.modal.x_qixue=l),min:0,max:456,placeholder:"0~456"},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Dn,o(f,{value:e.modal.x_patt,"onUpdate:value":t[19]||(t[19]=l=>e.modal.x_patt=l),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Un,o(f,{value:e.modal.x_pdef,"onUpdate:value":t[20]||(t[20]=l=>e.modal.x_pdef=l),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[In,o(f,{value:e.modal.x_matt,"onUpdate:value":t[21]||(t[21]=l=>e.modal.x_matt=l),min:0,max:202,placeholder:"0~202"},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[En,o(f,{value:e.modal.x_mdef,"onUpdate:value":t[22]||(t[22]=l=>e.modal.x_mdef=l),min:0,max:150,placeholder:"0~150"},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[An,o(f,{value:e.modal.x_huixin,"onUpdate:value":t[23]||(t[23]=l=>e.modal.x_huixin=l),min:0,max:104,placeholder:"0~104"},null,8,["value"])]),_:1})]),Vn,s("div",Mn,[o(h,null,{default:u(()=>[qn,o(f,{readonly:"",value:e.ckValue.qixue},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Rn,o(f,{readonly:"",value:e.ckValue.patt},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Nn,o(f,{readonly:"",value:e.ckValue.pdef},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Tn,o(f,{readonly:"",value:e.ckValue.matt},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[Kn,o(f,{readonly:"",value:e.ckValue.mdef},null,8,["value"])]),_:1}),o(h,null,{default:u(()=>[On,o(f,{readonly:"",value:e.ckValue.huixin},null,8,["value"])]),_:1})])])],512),[[Qe,e.modal.show]])]),s("div",jn,[s("div",Gn,[o(r,{modelValue:e.quick.input,"onUpdate:modelValue":t[24]||(t[24]=l=>e.quick.input=l),result:e.quick.result,"onUpdate:result":t[25]||(t[25]=l=>e.quick.result=l),style:{flex:"3 3 0"}},null,8,["modelValue","result"]),Hn,o(f,{readonly:"",value:e.ceilResult(e.quick.result),style:{flex:"2 2 0"}},null,8,["value"])])])]),s("div",Jn,[s("div",Ln,[(b(!0),g(R,null,H(e.list,(l,D)=>(b(),Y(p,{key:l.id,activeKey:D===e.activeKey,onToggle:m=>e.activeKey=m?D:-1},{header:u(()=>[o(w,{flex:"",middle:""},{default:u(()=>[o(_,null,{default:u(()=>[e.vars.index===D?M((b(),g("input",{key:0,type:"text",class:"input","onUpdate:modelValue":t[26]||(t[26]=m=>e.vars.title=m),onClick:t[27]||(t[27]=ne(()=>{},["stop"])),onKeypress:De(m=>e.rename(D),["enter"])},null,40,Pn)),[[Q,e.vars.title],[O]]):(b(),g("span",zn,S(l.title),1))]),_:2},1024),o(_,{class:"ml-4",onClick:t[28]||(t[28]=ne(()=>{},["stop"]))},{default:u(()=>[e.vars.index===D?(b(),g("button",{key:0,class:"btn btn-sm btn-link",onClick:m=>e.rename(D)}," \u786E\u8BA4 ",8,Wn)):(b(),g(R,{key:1},[s("button",{class:"btn btn-sm btn-link",onClick:m=>e.openSelect(D)}," \u9009\u62E9 ",8,Qn),s("button",{class:"btn btn-sm btn-link",onClick:m=>{e.vars.index=D,e.vars.title=l.title}},[o(c,{class:"svg-icon"}),Yn],8,Xn),s("button",{class:"btn btn-sm btn-link",onClick:m=>e.copyItem(l)},[o(U,{class:"svg-icon"}),xn],8,Zn)],64))]),_:2},1024)]),_:2},1024)]),actions:u(()=>[s("button",{class:"btn btn-sm btn-success-outline",onClick:m=>e.itemExport(l)}," \u5BFC\u51FA ",8,eo),s("button",{class:"btn btn-sm btn-danger-outline",onClick:m=>e.remove(D)}," \u5220\u9664 ",8,to)]),default:u(()=>[D===e.activeKey?(b(),Y(T,{key:0,data:l,"onUpdate:data":m=>e.onUpdateData(m,D)},null,8,["data","onUpdate:data"])):se("",!0)]),_:2},1032,["activeKey","onToggle"]))),128))])]),o(I,{show:e.selectShow,"onUpdate:show":t[31]||(t[31]=l=>e.selectShow=l),onClick:e.selectHero},{extra:u(()=>[s("div",so,[o(h,null,{default:u(()=>[s("label",null,[no,M(s("input",{type:"checkbox","onUpdate:modelValue":t[29]||(t[29]=l=>e.xinyao=l)},null,512),[[Ce,e.xinyao]])]),s("label",null,[oo,M(s("input",{type:"checkbox","onUpdate:modelValue":t[30]||(t[30]=l=>e.huazhen=l)},null,512),[[Ce,e.huazhen]])])]),_:1})])]),_:1},8,["show","onClick"])])}var mo=L(Xs,[["render",lo],["__scopeId","data-v-88ac5550"]]);export{mo as default};
