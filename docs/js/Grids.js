import{d as ft,h as X,a as St,i as Z,N as Vt,$ as Ft,O as It,_ as pt,o as F,c as G,b as s,n as U,j as lt,m as E,X as rt,P,E as L,T as te,x as Gt,y as $t,g as Ct,C as vt,l as ot,f as at,r as ee,a0 as Dt,v as st,k as M,w as nt,e as w,F as ut,q as dt,s as oe,W as se}from"./index.js";import{_ as Y}from"./lodash.js";import{u as ne}from"./useHeroes.js";const Et=(o,a,p)=>{let v=0,r=0,c=0;o%=360;const n=Math.floor(o/60),h=o/60-n,g=p*(1-a),B=p*(1-a*h),I=p*(1-a*(1-h));switch(n){case 0:v=p,r=I,c=g;break;case 1:v=B,r=p,c=g;break;case 2:v=g,r=p,c=I;break;case 3:v=g,r=B,c=p;break;case 4:v=I,r=g,c=p;break;case 5:v=p,r=g,c=B;break}v=Math.floor(v*255),r=Math.floor(r*255),c=Math.floor(c*255);const S=("00"+v.toString(16)).slice(-2),$=("00"+r.toString(16)).slice(-2),u=("00"+c.toString(16)).slice(-2);return[o,a,p,v,r,c,"#"+S+$+u]},Bt=o=>{let a=0,p=0,v=0,r=0,c=0,n=0;if(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i.test(o))a=window.parseInt(RegExp.$1,16),p=window.parseInt(RegExp.$2,16),v=window.parseInt(RegExp.$3,16);else if(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i.test(o))a=window.parseInt(RegExp.$1,10),p=window.parseInt(RegExp.$2,10),v=window.parseInt(RegExp.$3,10);else return[0,0,0,0,0,0,"#000000"];r=a/255,c=p/255,n=v/255;let h=r;c>h&&(h=c),n>h&&(h=n);let g=r;c<g&&(g=c),n<g&&(g=n);let B=0,I=0,S=0;h===g?B=0:h===r&&c>=n?B=60*(c-n)/(h-g)+0:h===r&&c<n?B=60*(c-n)/(h-g)+360:h===c?B=60*(n-r)/(h-g)+120:h===n&&(B=60*(r-c)/(h-g)+240),h===0?I=0:I=1-g/h,S=h;const $=("00"+a.toString(16)).slice(-2),u=("00"+p.toString(16)).slice(-2),A=("00"+v.toString(16)).slice(-2);return[Math.floor(B),I,S,a,p,v,"#"+$+u+A]},le=ft({name:"ColorPicker",emits:["update:modelValue"],props:{modelValue:{type:String,required:!0}},setup(o,{emit:a}){const p=X(!1),v=St({set:d=>{a("update:modelValue",d)},get:()=>o.modelValue}),r=Z({h:0,s:0,v:0,r:0,g:0,b:0}),c=Z({rect_down:!1,rect_left:0,rect_bottom:0,ver_down:!1,ver_bottom:0}),n={rect:{left:0,bottom:0,x:0,y:0},ver:{bottom:0,y:0}},h=X(!1),g=()=>{h.value=!0},B=Y.debounce(()=>{h.value=!1},300),I=()=>{g();const d=Et(r.h,r.s,r.v);r.r=d[3],r.g=d[4],r.b=d[5],v.value=d[6],c.ver_bottom=r.h,c.rect_left=r.s*360,c.rect_bottom=r.v*360,B()},S=()=>{g();const d=Bt(`${r.r},${r.g},${r.b}`);r.h=d[0],r.s=d[1],r.v=d[2],v.value=d[6],c.ver_bottom=r.h,c.rect_left=r.s*360,c.rect_bottom=r.v*360,B()},$=d=>{d=d||"#000000";const V=Bt(d);r.h=V[0],r.s=V[1],r.v=V[2],r.r=V[3],r.g=V[4],r.b=V[5],c.ver_bottom=r.h,c.rect_left=r.s*360,c.rect_bottom=r.v*360},u=()=>{const d=Et(c.ver_bottom,c.rect_left/360,c.rect_bottom/360);r.h=d[0],r.s=d[1],r.v=d[2],r.r=d[3],r.g=d[4],r.b=d[5],v.value=d[6]},A=d=>{c.rect_down=!0,n.rect.x=d.clientX,n.rect.y=d.clientY;const V=d.currentTarget,q=V.getBoundingClientRect().left,ct=V.getBoundingClientRect().top;n.rect.left=c.rect_left=d.clientX-q,n.rect.bottom=c.rect_bottom=360-(d.clientY-ct),u()},R=d=>{if(!c.rect_down)return;const V=d.clientX-n.rect.x,q=d.clientY-n.rect.y;c.rect_left=Math.max(0,Math.min(360,n.rect.left+V)),c.rect_bottom=Math.max(0,Math.min(360,n.rect.bottom-q)),u()},T=()=>{!c.rect_down||(c.rect_down=!1)},j=d=>{c.ver_down=!0,n.ver.y=d.clientY;const q=d.currentTarget.getBoundingClientRect().top;n.ver.bottom=c.ver_bottom=360-(d.clientY-q),u()},z=d=>{if(!c.ver_down)return;const V=d.clientY-n.ver.y;c.ver_bottom=Math.max(0,Math.min(360,n.ver.bottom-V)),u()},Q=()=>{!c.ver_down||(c.ver_down=!1)},W=()=>{p.value=!0},tt=()=>{p.value=!1};return Vt(()=>o.modelValue,d=>{c.ver_down||c.rect_down||h.value||$(d)}),$(o.modelValue),Ft(()=>{window.addEventListener("mousemove",R,!1),window.addEventListener("mouseup",T,!1),window.addEventListener("mousemove",z,!1),window.addEventListener("mouseup",Q,!1)}),It(()=>{window.removeEventListener("mousemove",R,!1),window.removeEventListener("mouseup",T,!1),window.removeEventListener("mousemove",z,!1),window.removeEventListener("mouseup",Q,!1)}),{show:p,color:v,vars:r,state:c,colorRectPointerStart:A,colorVerPointerStart:j,updateHSV:I,updateRGB:S,updateHex:$,onOpen:W,onComfirm:tt}}});const mt=o=>(Gt("data-v-27cd0415"),o=o(),$t(),o),ae={class:"color-control"},re={class:"color-picker-layer"},ce={class:"color-picker-view"},ie=mt(()=>s("div",{class:"color-picker-view__label"},"HSV",-1)),ue=mt(()=>s("div",{class:"color-picker-view__label"},"RGB",-1)),de=mt(()=>s("div",{class:"color-picker-view__label"},"Hex",-1));function fe(o,a,p,v,r,c){return F(),G("div",ae,[s("div",{class:"color-preview",style:U({backgroundColor:o.color}),onClick:a[0]||(a[0]=(...n)=>o.onOpen&&o.onOpen(...n))},null,4),(F(),lt(te,{to:"body"},[E(s("div",{class:"color-picker-mask",onWheel:a[1]||(a[1]=P(()=>{},["prevent"])),onTouchstart:a[2]||(a[2]=P(()=>{},["prevent"])),onClick:a[3]||(a[3]=(...n)=>o.onComfirm&&o.onComfirm(...n))},null,544),[[rt,o.show]]),E(s("div",re,[s("div",{class:"color-picker-rect",style:U(`background-color: hsl(${o.vars.h}deg, 100%, 50%)`),onMousedown:a[4]||(a[4]=P((...n)=>o.colorRectPointerStart&&o.colorRectPointerStart(...n),["prevent","stop"]))},[s("div",{class:"color-picker-rect-cur",style:U({left:`${o.state.rect_left}px`,bottom:`${o.state.rect_bottom}px`})},null,4)],36),s("div",{class:"color-picker-hue",onMousedown:a[5]||(a[5]=P((...n)=>o.colorVerPointerStart&&o.colorVerPointerStart(...n),["prevent","stop"]))},[s("div",{class:"color-picker-hue-cur",style:U({bottom:`${o.state.ver_bottom}px`})},null,4)],32),s("div",ce,[s("div",{class:"color-picker-view-color",style:U({background:o.color})},null,4),ie,E(s("input",{type:"number",max:"360",min:"0",step:"1","onUpdate:modelValue":a[6]||(a[6]=n=>o.vars.h=n),class:"color-picker-view__input",onInput:a[7]||(a[7]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[L,o.vars.h]]),E(s("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":a[8]||(a[8]=n=>o.vars.s=n),class:"color-picker-view__input",onInput:a[9]||(a[9]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[L,o.vars.s]]),E(s("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":a[10]||(a[10]=n=>o.vars.v=n),class:"color-picker-view__input",onInput:a[11]||(a[11]=(...n)=>o.updateHSV&&o.updateHSV(...n))},null,544),[[L,o.vars.v]]),ue,E(s("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":a[12]||(a[12]=n=>o.vars.r=n),class:"color-picker-view__input",onInput:a[13]||(a[13]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[L,o.vars.r]]),E(s("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":a[14]||(a[14]=n=>o.vars.g=n),class:"color-picker-view__input",onInput:a[15]||(a[15]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[L,o.vars.g]]),E(s("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":a[16]||(a[16]=n=>o.vars.b=n),class:"color-picker-view__input",onInput:a[17]||(a[17]=(...n)=>o.updateRGB&&o.updateRGB(...n))},null,544),[[L,o.vars.b]]),de,E(s("input",{type:"text","onUpdate:modelValue":a[18]||(a[18]=n=>o.color=n),class:"color-picker-view__input"},null,512),[[L,o.color]]),s("div",{class:"color-picker-view__enter",onClick:a[19]||(a[19]=(...n)=>o.onComfirm&&o.onComfirm(...n))},"\u786E\u8BA4")])],512),[[rt,o.show]])]))])}const K=pt(le,[["render",fe],["__scopeId","data-v-27cd0415"]]);K.install=function(o){o.component(K.name,K)};const pe={draggable:!0,class:"grid-item"},ve={key:0,class:"lt"},me={key:1},ye={key:2},be={class:"overlay-dot"},ge={class:"overlay-selected"},_e=ft({__name:"GridItem",props:{disabled:{type:Boolean},selected:{type:Boolean},dot:{type:Boolean},item:null},setup(o){return(a,p)=>(F(),G("div",pe,[o.item?(F(),G("div",{key:0,class:Ct(["color-unit",{disabled:o.disabled}]),style:U({fontSize:`${o.item.data.size}px`,color:o.item.style.color,backgroundColor:o.item.style.bgcolor,backgroundImage:o.item.style.image?`url(${o.item.style.image})`:"",opacity:o.item.style.opacity})},[vt(ot(o.item.data.txt)+" ",1),o.item.data.actorId?(F(),G("span",ve,ot(o.item.data.actorId),1)):at("",!0),o.item.data.sub?(F(),G("sub",me,ot(o.item.data.sub),1)):at("",!0),o.item.data.sup?(F(),G("sup",ye,ot(o.item.data.sup),1)):at("",!0)],6)):(F(),G("div",{key:1,class:Ct(["color-unit",{disabled:o.disabled}])},[ee(a.$slots,"default",{},void 0,!0)],2)),E(s("div",be,null,512),[[rt,o.dot]]),E(s("div",ge,null,512),[[rt,o.selected]])]))}});const N=pt(_e,[["__scopeId","data-v-87883649"]]);var _=(o=>(o[o.NONE=0]="NONE",o[o.GUARD=1]="GUARD",o[o.SHEEP=2]="SHEEP",o[o.ATTACKER=3]="ATTACKER",o[o.FLY=4]="FLY",o[o.BLOCKED=5]="BLOCKED",o[o.CLIFF=6]="CLIFF",o))(_||{});function he(){const o=X(0),a=X([]),p=X([]),v=[{color:"#202020",bgcolor:"#f5fff0"},{color:"#f9f9fa",bgcolor:"#ff3333"},{color:"#f9f9fa",bgcolor:"#00d659"},{color:"#f9f9fa",bgcolor:"#369af7"},{color:"#f9f9fa",bgcolor:"#fec02f"},{color:"#f9f9fa",bgcolor:"#a865e7"}],r=()=>({actorId:0,actorType:_.NONE,size:14,txt:"",disabled:!1}),c=()=>({color:v[0].color,bgcolor:v[0].bgcolor,image:"",opacity:1}),n=()=>({d:0,d1:0,d2:0,q:0}),h=()=>({x:0,y:0,data:r(),style:c(),state:n()});function g(S){S.data=r(),S.style=c(),S.state=n()}function B(){o.value=0,a.value.forEach(S=>{g(S)}),p.value=[]}function I(S,$){const u=[];for(let A=0;A<S;A++)for(let R=0;R<$;R++){const T=h();T.x=R,T.y=S-A-1,u.push(T)}a.value=u}return{actorId:o,grids:a,selects:p,gridColors:v,defGridData:r,defGridStyle:c,defGridState:n,defGrid:h,cleanGrid:g,cleanGrids:B,generateGrids:I}}const we=""+new URL("../assets/cliff.svg",import.meta.url).href,ke=""+new URL("../assets/block.svg",import.meta.url).href,k=o=>(Gt("data-v-360fb454"),o=o(),$t(),o),xe={class:"wrapper"},Ce={class:"toolbar"},De={class:"setting"},Ee={class:"label-control"},Be=k(()=>s("span",null,"\u7F16\u8F91\u6A21\u5F0F\xA0",-1)),Se=k(()=>s("option",{value:1},"\u7F16\u8F91\u7F51\u683C",-1)),Ve=k(()=>s("option",{value:2},"\u7F51\u683C\u4E0A\u8272",-1)),Fe=k(()=>s("option",{value:3},"\u9009\u62E9\u5F62\u72B6",-1)),Ie=k(()=>s("option",{value:4},"\u62A4\u536B\u8BA1\u7B97",-1)),Ge=[Se,Ve,Fe,Ie],$e={class:"label-control"},Ae=k(()=>s("span",null,"\u8303\u56F4\xA0",-1)),Re={class:"label-control"},Me=k(()=>s("span",null,"\u5F62\u72B6\xA0",-1)),Le=k(()=>s("option",{value:1},"\u83F1\u5F62",-1)),Ue=k(()=>s("option",{value:2},"\u5708\u6570",-1)),He=[Le,Ue],Te={class:"label-control"},Ne=k(()=>s("span",null,"\u6392\u5E8F\xA0",-1)),qe=k(()=>s("option",{value:1},"\u8DDD\u79BBX",-1)),Ke=k(()=>s("option",{value:2},"\u8DDD\u79BBY",-1)),ze=k(()=>s("option",{value:3},"X\u4F18\u5148",-1)),Oe=k(()=>s("option",{value:4},"Y\u4F18\u5148",-1)),Pe=[qe,Ke,ze,Oe],Xe={class:"color-container"},je={class:"label-control"},We=k(()=>s("span",null,"\u9884\u89C8\xA0",-1)),Je=vt(" E "),Ye={class:"label-control"},Ze=k(()=>s("span",null,"\u6587\u5B57\xA0",-1)),Qe={class:"label-control"},to=k(()=>s("span",null,"\u80CC\u666F\xA0",-1)),eo=k(()=>s("label",{class:"label-control"},[s("span",null,"\u9884\u8BBE\xA0")],-1)),oo={class:"color-tpls"},so=vt(" E "),no={width:"32",height:"32",viewBox:"0 0 24 24",fill:"#a9a9a9",style:{"pointer-events":"none"}},lo=k(()=>s("path",{d:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"},null,-1)),ao=[lo],ro={class:"props-container"},co={key:0,class:"props-content"},io={class:"label-control"},uo=k(()=>s("span",null,"\u9884\u89C8\xA0",-1)),fo={class:"label-control"},po=k(()=>s("span",null,"\u6587\u5B57\xA0",-1)),vo={class:"label-control"},mo=k(()=>s("span",null,"\u80CC\u666F\xA0",-1)),yo={class:"label-control"},bo=k(()=>s("span",null,"\u5927\u5C0F\xA0",-1)),go={class:"label-control"},_o=k(()=>s("span",null,"Id\xA0",-1)),ho={class:"label-control"},wo=k(()=>s("span",null,"\u7C7B\u578B\xA0",-1)),ko=["value"],xo=["value"],Co=["value"],Do=["value"],Eo=["value"],Bo=["value"],So=["value"],Vo={class:"label-control"},Fo=k(()=>s("span",null,"\u5185\u5BB9\xA0",-1)),Io={class:"content"},Go={class:"heroes"},$o=ft({__name:"Grids",setup(o){const{actorId:a,grids:p,selects:v,gridColors:r,defGridData:c,defGridStyle:n,defGridState:h,defGrid:g,cleanGrid:B,cleanGrids:I,generateGrids:S}=he(),$=X(),u=Z({editor:1,selectRange:5,shape:1,sortType:1,color:r[0].color,bgcolor:r[0].bgcolor}),A=g();A.style.image=ke,A.data.actorType=_.BLOCKED;const R=g();R.style.image=we,R.data.actorType=_.CLIFF;function T(e){u.color=e.color,u.bgcolor=e.bgcolor}const j=15,z=15,Q=St(()=>`--rows:${z};--cols:${j}`),{heroes:W}=ne(),tt=Dt(g()),d=Dt(W.value.map(e=>{const t=g();return t.style.image=`https://media.zlongame.com/media/news/cn/tdj/info/data/heroicon/${e.hero_icon}.png`,t}));Vt(W,()=>{d.value=W.value.map(e=>{const t=g();return t.style.image=`https://media.zlongame.com/media/news/cn/tdj/info/data/heroicon/${e.hero_icon}.png`,t})});function V(e,t,f,m){const l=[];return p.value.forEach(i=>{i.state=h()}),p.value.forEach(i=>{const b=Math.abs(e-i.x),y=Math.abs(t-i.y),D=b+y,et=Math.max(b,y),H=b>1?b-1:b+y>1?y-1:y;switch(m){case 1:D<=f&&(i.state.d=D,i.state.q=et,i.state.d1=H,l.push(i));break;case 2:Math.abs(b)<=f&&Math.abs(y)<=f&&(i.state.d=D,i.state.q=et,i.state.d1=H,l.push(i));break}}),l}function q(e,t,f,m,l,i,b){const y=V(e,t,f,m);switch(y.forEach(D=>{D.style.color=i,D.style.bgcolor=b}),v.value=y,l){case 1:m===1?v.value.sort(ct):m===2&&v.value.sort(Rt);break;case 2:m===1?v.value.sort(At):m===2&&v.value.sort(yt);break;case 3:v.value.sort(Mt);break;case 4:v.value.sort(Lt);break}for(let D=0;D<v.value.length;D++)v.value[D].data.txt=String(D+1)}function ct(e,t){return e.state.d!==t.state.d?e.state.d-t.state.d:e.x!==t.x?e.x-t.x:e.y!==t.y?e.y-t.y:0}function At(e,t){return e.state.d!==t.state.d?e.state.d-t.state.d:e.y!==t.y?e.y-t.y:e.x!==t.x?e.x-t.x:0}function Rt(e,t){return e.state.q!==t.state.q?e.state.q-t.state.q:e.state.d!==t.state.d?e.state.d-t.state.d:e.x!==t.x?e.x-t.x:e.y!==t.y?e.y-t.y:0}function yt(e,t){return e.state.q!==t.state.q?e.state.q-t.state.q:e.state.d!==t.state.d?e.state.d-t.state.d:e.y!==t.y?e.y-t.y:e.x!==t.x?e.x-t.x:0}function Mt(e,t){return e.x!==t.x?e.x-t.x:e.y!==t.y?e.y-t.y:0}function Lt(e,t){return e.y!==t.y?e.y-t.y:e.x!==t.x?e.x-t.x:0}const x=Z({enabled:!1});function Ut(){I()}function bt(){x.enabled=!1}function Ht(e,t){var f;switch(u.editor){case 1:case 4:x.current=t,(f=$.value)==null||f.focus();break;case 3:I(),q(t.x,t.y,u.selectRange,u.shape,u.sortType,u.color,u.bgcolor);break}}function Tt(e,t){if(e.button===0)switch(u.editor){case 2:{x.enabled=!0,t.style.color=u.color,t.style.bgcolor=u.bgcolor;break}}}function Nt(e,t){e.button===0&&x.enabled&&(t.style.color=u.color,t.style.bgcolor=u.bgcolor)}function qt(){x.current=void 0}const O={};function Kt(){try{const e=localStorage.getItem("grids");e&&(O.value=JSON.parse(e))}catch{}}function gt(){O.value=p.value.map(e=>Y.cloneDeep(e)),localStorage.setItem("grids",JSON.stringify(O.value))}function zt(){!O.value||(p.value=Y.cloneDeep(O.value))}function Ot(){const e=x.current;if(!e)return;O.value||gt();let t,f,m=[];for(t=e.x-2;t<=e.x+2;t++)for(f=e.y-2;f<=e.y+2;f++){if(t===e.x&&f===e.y)continue;const y=p.value[it(t,f)];m.push(y)}const l=m[0];m[0]=m[12],m[12]=l,m=m.filter(y=>y.data.actorId>0&&y.data.actorType!==_.BLOCKED&&y.data.actorType!==_.CLIFF);const i=m.map(y=>({data:y.data,style:y.style}));m.forEach(y=>{B(y)}),console.log(i);const b=V(e.x,e.y,4,2).filter(y=>y.data.actorType!==_.BLOCKED&&!(y.x===e.x&&y.y===e.y)).sort(yt).map(y=>[y.x,y.y]);for(const y of i)for(const[D,et]of b){const H=p.value[it(D,et)];if(!!H&&!(H.data.actorId>0)&&H.data.actorType!==_.BLOCKED&&!(H.data.actorType===_.CLIFF&&y.data.actorType!==_.FLY)){H.data=y.data,H.style=y.style;break}}}const C=Z({}),_t=["#ffffff00","#FF3C4132","#0EBEFF32","#48CF7432","#FCD00032","#80008032"],Pt=(e,t)=>{switch(u.editor){case 2:e.preventDefault();break;default:C.grid=t,C.action="swap",e.dataTransfer&&(e.dataTransfer.effectAllowed="move")}},Xt=(e,t)=>{const f=g();f.style.color=t.color,f.style.bgcolor=t.bgcolor,f.data.txt="E",C.grid=f,C.action="color"},ht=(e,t)=>{C.grid=Y.cloneDeep(t),C.action="other"},wt=(e,t)=>{C.grid=Y.cloneDeep(t),C.action="image"},jt=(e,t)=>{if(e.preventDefault(),!C.grid)return;const f=C.grid.data,m=C.grid.style;switch(C.action){case"color":t.data.actorId||(t.data.actorId=++a.value),t.style.color=m.color,t.style.bgcolor=m.bgcolor;break;case"image":t.data.actorId||(t.data.actorId=++a.value),t.style.image=m.image;break;case"swap":C.grid.data=t.data,C.grid.style=t.style,t.data=f,t.style=m;break;case"other":t.style=m,t.data=f;break}C.grid=void 0,C.action=void 0,u.editor===4&&J()};function Wt(e,t){let f=e[0].state[t];for(let m=1;m<e.length;m++)e[m].state[t]<f&&(f=e[m].state[t]);return f}function kt(e,t){return Math.abs(e.x-t.x)+Math.abs(e.y-t.y)}function xt(e,t,f){e.sort((b,y)=>+b.data.actorId-+y.data.actorId),e.forEach(b=>{b.state.d1=kt(b,f),b.state.d2=kt(b,t),b.data.guard=!1});const m=Wt(e,"d1");if(e=e.filter(b=>b.state.d1===m),e.length===1)return e[0];let l=e[0],i=e.length;for(;i--;)if(e[i].state.d2<l.state.d2){l=e[i];break}return l}function it(e,t){return(z-t-1)*j+e}function Jt(){I(),a.value=0;const e=[{x:7,y:9,txt:"",type:_.GUARD,bg:"#0ebeff"},{x:9,y:7,txt:"",type:_.GUARD,bg:"#0ebeff"},{x:7,y:5,txt:"",type:_.GUARD,bg:"#0ebeff"},{x:5,y:7,txt:"",type:_.GUARD,bg:"#0ebeff"},{x:8,y:6,txt:"",type:_.ATTACKER,bg:"#ff3c41"},{x:7,y:7,txt:"",type:_.SHEEP,bg:"#fcd000"}];for(const t of e){const f=p.value[it(t.x,t.y)];f.data.actorId=++a.value,f.data.actorType=t.type,f.data.txt=t.txt,f.data.disabled=!1,f.style.bgcolor=t.bg}u.editor=4}const J=()=>{p.value.forEach(i=>i.style.opacity=1);const e=p.value.filter(i=>!i.data.disabled),t=e.filter(i=>i.data.actorType===_.ATTACKER)[0],f=e.filter(i=>i.data.actorType===_.SHEEP)[0],m=e.filter(i=>i.data.actorType===_.GUARD);if(!f||m.length===0){alert("\u7F3A\u5C11\u89D2\u8272\uFF0C\u5C06\u81EA\u52A8\u751F\u6210"),Jt(),J();return}const l=p.value.filter(i=>!i.data.disabled).filter(i=>i.data.actorType===_.NONE);for(const i of l){const b=xt(m,i,f);i.style.image=b.style.image,i.style.bgcolor=_t[b.data.actorId]||_t[0],b.style.image?i.data.sup="":i.data.sup=String(b.data.actorId),i.style.opacity=.6}if(t){const i=xt(m,t,f);i.data.guard=!0}},Yt=e=>{if(e.data.disabled=!e.data.disabled,u.editor===4){switch(e.data.actorType){case _.ATTACKER:case _.SHEEP:e.data.disabled=!1;break}J()}},Zt=e=>{!C.grid||!e.dataTransfer||C.action==="swap"&&(u.editor===4&&C.grid.data.actorType===_.SHEEP||e.preventDefault())},Qt=e=>{if(!!C.grid&&!!e)switch(C.action){case"swap":e.data=c(),e.style=n(),e.state=h(),C.grid=void 0,C.action=void 0,u.editor===4&&J()}};return S(z,j),Ft(()=>{Kt(),window.addEventListener("mouseup",bt,!1)}),It(()=>{window.removeEventListener("mouseup",bt,!1)}),(e,t)=>{const f=oe("c-space"),m=se("autofocus");return F(),G("div",xe,[s("div",Ce,[s("div",De,[s("label",Ee,[Be,E(s("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>u.editor=l)},Ge,512),[[st,u.editor,void 0,{number:!0}]])]),s("label",$e,[Ae,E(s("input",{type:"number",min:"0","onUpdate:modelValue":t[1]||(t[1]=l=>u.selectRange=l),style:{width:"5em"}},null,512),[[L,u.selectRange]])]),s("label",Re,[Me,E(s("select",{"onUpdate:modelValue":t[2]||(t[2]=l=>u.shape=l)},He,512),[[st,u.shape]])]),s("label",Te,[Ne,E(s("select",{"onUpdate:modelValue":t[3]||(t[3]=l=>u.sortType=l)},Pe,512),[[st,u.sortType]])]),s("button",{class:"btn",onClick:Ut},"\u6E05\u7A7A"),s("button",{class:"btn",onClick:J},"\u8BA1\u7B97\u62A4\u536B"),s("button",{class:"btn btn-success",onClick:gt},"\u4FDD\u5B58\u5E03\u5C40"),s("button",{class:"btn btn-success",onClick:zt},"\u8FD8\u539F\u5E03\u5C40")]),s("div",Xe,[M(f,null,{default:nt(()=>[s("label",je,[We,M(w(N),{draggable:!1,style:U([`--color:${u.color};--bgcolor:${u.bgcolor}`])},{default:nt(()=>[Je]),_:1},8,["style"])]),s("label",Ye,[Ze,M(w(K),{modelValue:u.color,"onUpdate:modelValue":t[4]||(t[4]=l=>u.color=l)},null,8,["modelValue"])]),s("label",Qe,[to,M(w(K),{modelValue:u.bgcolor,"onUpdate:modelValue":t[5]||(t[5]=l=>u.bgcolor=l)},null,8,["modelValue"])]),eo,s("div",oo,[(F(!0),G(ut,null,dt(w(r),(l,i)=>(F(),lt(w(N),{key:i,selected:u.bgcolor===l.bgcolor,style:U([`--color:${l.color};--bgcolor:${l.bgcolor}`]),onClick:b=>T(l),onDragstart:b=>Xt(b,l)},{default:nt(()=>[so]),_:2},1032,["selected","style","onClick","onDragstart"]))),128)),M(w(N),{item:w(R),onDragstart:t[6]||(t[6]=l=>ht(l,w(R)))},null,8,["item"]),M(w(N),{item:w(A),onDragstart:t[7]||(t[7]=l=>ht(l,w(A)))},null,8,["item"])]),s("div",{class:"trush",onDragover:Zt,onDrop:t[8]||(t[8]=l=>Qt(C.grid))},[(F(),G("svg",no,ao))],32)]),_:1})]),s("div",ro,[x.current?(F(),G("div",co,[M(f,null,{default:nt(()=>[s("label",io,[uo,M(w(N),{draggable:!1,style:U([`--color:${x.current.style.color};--bgcolor:${x.current.style.bgcolor}`]),item:x.current},null,8,["style","item"])]),s("label",fo,[po,M(w(K),{modelValue:x.current.style.color,"onUpdate:modelValue":t[9]||(t[9]=l=>x.current.style.color=l)},null,8,["modelValue"])]),s("label",vo,[mo,M(w(K),{modelValue:x.current.style.bgcolor,"onUpdate:modelValue":t[10]||(t[10]=l=>x.current.style.bgcolor=l)},null,8,["modelValue"])]),s("label",yo,[bo,E(s("input",{type:"number",style:{width:"4em"},min:"12",step:"1","onUpdate:modelValue":t[11]||(t[11]=l=>x.current.data.size=l)},null,512),[[L,x.current.data.size]])]),s("label",go,[_o,E(s("input",{type:"number","onUpdate:modelValue":t[12]||(t[12]=l=>x.current.data.actorId=l),style:{width:"4em"}},null,512),[[L,x.current.data.actorId]])]),s("label",ho,[wo,E(s("select",{"onUpdate:modelValue":t[13]||(t[13]=l=>x.current.data.actorType=l)},[s("option",{value:w(_).NONE},"\u65E0",8,ko),s("option",{value:w(_).GUARD},"\u62A4\u536B",8,xo),s("option",{value:w(_).SHEEP},"\u9776\u5B50",8,Co),s("option",{value:w(_).ATTACKER},"\u653B\u51FB\u8005",8,Do),s("option",{value:w(_).FLY},"\u98DE\u884C",8,Eo),s("option",{value:w(_).BLOCKED},"\u969C\u788D",8,Bo),s("option",{value:w(_).CLIFF},"\u60AC\u5D16",8,So)],512),[[st,x.current.data.actorType]])]),s("label",Vo,[Fo,E(s("input",{type:"text",ref_key:"txtInput",ref:$,"onUpdate:modelValue":t[14]||(t[14]=l=>x.current.data.txt=l)},null,512),[[m],[L,x.current.data.txt]])]),s("button",{class:"btn",onClick:qt},"\u5B8C\u6210"),s("button",{class:"btn btn-success",onClick:Ot},"\u602A\u529B\u4E71\u795E")]),_:1})])):at("",!0)])]),s("div",Io,[s("div",{class:"grids",style:U(w(Q))},[(F(!0),G(ut,null,dt(w(p),(l,i)=>{var b,y;return F(),lt(w(N),{key:i,draggable:!0,selected:l.x===((b=x.current)==null?void 0:b.x)&&l.y===((y=x.current)==null?void 0:y.y),disabled:l.data.disabled,dot:l.data.guard,item:l,onDragstart:D=>Pt(D,l),onDragover:t[15]||(t[15]=P(()=>{},["prevent"])),onDrop:D=>jt(D,l),onContextmenu:P(D=>Yt(l),["prevent"]),onClick:D=>Ht(D,l),onMousedown:D=>Tt(D,l),onMouseenter:D=>Nt(D,l)},null,8,["selected","disabled","dot","item","onDragstart","onDrop","onContextmenu","onClick","onMousedown","onMouseenter"])}),128))],4),s("div",Go,[M(w(N),{item:w(tt),onDragstart:t[16]||(t[16]=l=>wt(l,w(tt)))},null,8,["item"]),(F(!0),G(ut,null,dt(w(d),(l,i)=>(F(),lt(w(N),{key:i,item:l,onDragstart:b=>wt(b,l)},null,8,["item","onDragstart"]))),128))])])])}}});const Lo=pt($o,[["__scopeId","data-v-360fb454"]]);export{Lo as default};
