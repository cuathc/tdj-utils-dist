import{d as eo,s as I,a as to,q,P as ao,S as uo,V as lo,_ as no,o as k,c as B,e as l,n as h,b as co,w as _,U as io,Q as W,B as g,T as po,F as O,p as so,l as ro,v as H,g as U,h as J,j as vo,r as fo,k as K,f as bo}from"./index.js";import{_ as mo}from"./lodash.js";const Z=(o,e,p)=>{let i=0,n=0,u=0;o%=360,o/=60;const t=Math.floor(o),r=o-t,d=p*(1-e),v=p*(1-e*r),w=p*(1-e*(1-r));switch(t){case 0:i=p,n=w,u=d;break;case 1:i=v,n=p,u=d;break;case 2:i=d,n=p,u=w;break;case 3:i=d,n=v,u=p;break;case 4:i=w,n=d,u=p;break;case 5:i=p,n=d,u=v;break}i=Math.floor(i*255),n=Math.floor(n*255),u=Math.floor(u*255);const C=("00"+i.toString(16)).slice(-2),S=("00"+n.toString(16)).slice(-2),y=("00"+u.toString(16)).slice(-2);return[o,e,p,i,n,u,"#"+C+S+y]},oo=o=>{let e=0,p=0,i=0,n=0,u=0,t=0;if(/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})/i.test(o))e=window.parseInt(RegExp.$1,16),p=window.parseInt(RegExp.$2,16),i=window.parseInt(RegExp.$3,16);else if(/(\d+)\s*,\s*(\d+)\s*,\s*(\d+)/i.test(o))e=window.parseInt(RegExp.$1,10),p=window.parseInt(RegExp.$2,10),i=window.parseInt(RegExp.$3,10);else return[0,0,0,0,0,0,"#000000"];n=e/255,u=p/255,t=i/255;let r=n;u>r&&(r=u),t>r&&(r=t);let d=n;u<d&&(d=u),t<d&&(d=t);let v=0,w=0,C=0;r===d?v=0:r===n&&u>=t?v=60*(u-t)/(r-d)+0:r===n&&u<t?v=60*(u-t)/(r-d)+360:r===u?v=60*(t-n)/(r-d)+120:r===t&&(v=60*(n-u)/(r-d)+240),r===0?w=0:w=1-d/r,C=r;const S=("00"+e.toString(16)).slice(-2),y=("00"+p.toString(16)).slice(-2),P=("00"+i.toString(16)).slice(-2);return[Math.floor(v),w,C,e,p,i,"#"+S+y+P]};const _o=eo({name:"ColorPicker",emits:["update:modelValue"],props:{modelValue:{type:String,required:!0}},setup(o,{emit:e}){const p=I(!1),i=to({set:c=>{e("update:modelValue",c)},get:()=>o.modelValue}),n=q({h:0,s:0,v:0,r:0,g:0,b:0}),u=q({rect_down:!1,rect_left:0,rect_bottom:0,ver_down:!1,ver_bottom:0}),t={rect:{left:0,bottom:0,x:0,y:0},ver:{bottom:0,y:0}},r=I(!1),d=()=>{r.value=!0},v=mo.debounce(()=>{r.value=!1},300),w=()=>{d();const c=Z(n.h,n.s,n.v);n.r=c[3],n.g=c[4],n.b=c[5],i.value=c[6],u.ver_bottom=n.h,u.rect_left=n.s*360,u.rect_bottom=n.v*360,v()},C=()=>{d();const c=oo(`${n.r},${n.g},${n.b}`);n.h=c[0],n.s=c[1],n.v=c[2],i.value=c[6],u.ver_bottom=n.h,u.rect_left=n.s*360,u.rect_bottom=n.v*360,v()},S=c=>{c=c||"#000000";const m=oo(c);n.h=m[0],n.s=m[1],n.v=m[2],n.r=m[3],n.g=m[4],n.b=m[5],u.ver_bottom=n.h,u.rect_left=n.s*360,u.rect_bottom=n.v*360},y=()=>{const c=Z(u.ver_bottom,u.rect_left/360,u.rect_bottom/360);n.h=c[0],n.s=c[1],n.v=c[2],n.r=c[3],n.g=c[4],n.b=c[5],i.value=c[6]},P=c=>{u.rect_down=!0,t.rect.x=c.clientX,t.rect.y=c.clientY;const m=c.currentTarget,s=m.getBoundingClientRect().left,a=m.getBoundingClientRect().top;t.rect.left=u.rect_left=c.clientX-s,t.rect.bottom=u.rect_bottom=360-(c.clientY-a),y()},F=c=>{if(!u.rect_down)return;const m=c.clientX-t.rect.x,s=c.clientY-t.rect.y;u.rect_left=Math.max(0,Math.min(360,t.rect.left+m)),u.rect_bottom=Math.max(0,Math.min(360,t.rect.bottom-s)),y()},R=()=>{!u.rect_down||(u.rect_down=!1)},V=c=>{u.ver_down=!0,t.ver.y=c.clientY;const s=c.currentTarget.getBoundingClientRect().top;t.ver.bottom=u.ver_bottom=360-(c.clientY-s),y()},G=c=>{if(!u.ver_down)return;const m=c.clientY-t.ver.y;u.ver_bottom=Math.max(0,Math.min(360,t.ver.bottom-m)),y()},E=()=>{!u.ver_down||(u.ver_down=!1)},Y=()=>{p.value=!0},T=()=>{p.value=!1};return ao(()=>o.modelValue,c=>{u.ver_down||u.rect_down||r.value||(console.log("watch"),S(c))}),S(o.modelValue),uo(()=>{window.addEventListener("mousemove",F,!1),window.addEventListener("mouseup",R,!1),window.addEventListener("mousemove",G,!1),window.addEventListener("mouseup",E,!1)}),lo(()=>{window.removeEventListener("mousemove",F,!1),window.removeEventListener("mouseup",R,!1),window.removeEventListener("mousemove",G,!1),window.removeEventListener("mouseup",E,!1)}),{show:p,color:i,vars:n,state:u,colorRectPointerStart:P,colorVerPointerStart:V,updateHSV:w,updateRGB:C,updateHex:S,onOpen:Y,onComfirm:T}}}),L=o=>(so("data-v-16c91425"),o=o(),ro(),o),wo={class:"colorPanel_posLayer"},yo=L(()=>l("div",{class:"colorPanel_colorVerBg"},null,-1)),go={class:"colorPanel_viewbox"},So=L(()=>l("div",{class:"colorPanel_view__label"},"HSV",-1)),ho=L(()=>l("div",{class:"colorPanel_view__label"},"RGB",-1)),Co=L(()=>l("div",{class:"colorPanel_view__label"},"Hex",-1));function Vo(o,e,p,i,n,u){return k(),B(O,null,[l("div",{class:"color-control",style:h({backgroundColor:o.color}),onClick:e[0]||(e[0]=(...t)=>o.onOpen&&o.onOpen(...t))},null,4),(k(),co(po,{to:"body"},[_(l("div",wo,[l("div",{style:h(`background-color: hsl(${o.vars.h}deg, 100%, 50%)`),class:"colorPanel_colorRectBg"},[l("div",{class:"colorPanel_colorRect",onMousedown:e[1]||(e[1]=W((...t)=>o.colorRectPointerStart&&o.colorRectPointerStart(...t),["prevent","stop"]))},[l("div",{class:"colorPanel_colorRectPointer",style:h({left:`${o.state.rect_left}px`,bottom:`${o.state.rect_bottom}px`})},null,4)],32)],4),l("div",{class:"colorPanel_colorVer",onMousedown:e[2]||(e[2]=W((...t)=>o.colorVerPointerStart&&o.colorVerPointerStart(...t),["prevent","stop"]))},[yo,l("div",{class:"colorPanel_colorVerPointer",style:h({bottom:`${o.state.ver_bottom}px`})},null,4)],32),l("div",go,[l("div",{class:"colorPanel_viewcolor",style:h({background:o.color})},null,4),So,_(l("input",{type:"number",max:"360",min:"0",step:"1","onUpdate:modelValue":e[3]||(e[3]=t=>o.vars.h=t),class:"colorPanel_view__input",onInput:e[4]||(e[4]=(...t)=>o.updateHSV&&o.updateHSV(...t))},null,544),[[g,o.vars.h]]),_(l("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":e[5]||(e[5]=t=>o.vars.s=t),class:"colorPanel_view__input",onInput:e[6]||(e[6]=(...t)=>o.updateHSV&&o.updateHSV(...t))},null,544),[[g,o.vars.s]]),_(l("input",{type:"number",max:"1",min:"0",step:"0.01","onUpdate:modelValue":e[7]||(e[7]=t=>o.vars.v=t),class:"colorPanel_view__input",onInput:e[8]||(e[8]=(...t)=>o.updateHSV&&o.updateHSV(...t))},null,544),[[g,o.vars.v]]),ho,_(l("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":e[9]||(e[9]=t=>o.vars.r=t),class:"colorPanel_view__input",onInput:e[10]||(e[10]=(...t)=>o.updateRGB&&o.updateRGB(...t))},null,544),[[g,o.vars.r]]),_(l("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":e[11]||(e[11]=t=>o.vars.g=t),class:"colorPanel_view__input",onInput:e[12]||(e[12]=(...t)=>o.updateRGB&&o.updateRGB(...t))},null,544),[[g,o.vars.g]]),_(l("input",{type:"number",max:"255",min:"0",step:"1","onUpdate:modelValue":e[13]||(e[13]=t=>o.vars.b=t),class:"colorPanel_view__input",onInput:e[14]||(e[14]=(...t)=>o.updateRGB&&o.updateRGB(...t))},null,544),[[g,o.vars.b]]),Co,_(l("input",{type:"text","onUpdate:modelValue":e[15]||(e[15]=t=>o.color=t),class:"colorPanel_view__input"},null,512),[[g,o.color]]),l("div",{class:"colorPanel_enter",onClick:e[16]||(e[16]=(...t)=>o.onComfirm&&o.onComfirm(...t))},"\u786E\u8BA4")])],512),[[io,o.show]])]))],64)}var D=no(_o,[["render",Vo],["__scopeId","data-v-16c91425"]]);D.install=function(o){o.component(D.name,D)};const ko=eo({components:{ColorPicker:D},setup(){const o=[{color:"#202020",bgcolor:"#ffffff"},{color:"#202020",bgcolor:"#FF3C41"},{color:"#202020",bgcolor:"#48CF74"},{color:"#202020",bgcolor:"#0EBEFF"},{color:"#202020",bgcolor:"#FCD000"}],e=q({editor:1,selectRange:5,shape:1,sortType:1,color:o[0].color,bgcolor:o[0].bgcolor});function p(s){e.color=s.color,e.bgcolor=s.bgcolor}const i=I([]),n=I([]),u=15,t=15,r=to(()=>({gridTemplateColumns:"repeat("+u+", 48px)",gridTemplateRows:"repeat("+t+", 48px)"}));function d(){for(let s=0;s<t;s++)for(let a=0;a<u;a++){const $={x:a+1,y:t-s,d:0,q:0,color:o[0].color,bgcolor:o[0].bgcolor,size:12,txt:""};i.value.push($)}}function v(s,a,$,M,A,N,j){i.value.forEach(b=>{const X=s-b.x,x=a-b.y,z=Math.abs(X)+Math.abs(x),Q=Math.max(Math.abs(X),Math.abs(x));switch(M){case 1:z<=$&&(b.d=z,b.q=Q,b.color=N,b.bgcolor=j,n.value.push(b));break;case 2:Math.abs(X)<=$&&Math.abs(x)<=$&&(b.d=z,b.q=Q,b.color=N,b.bgcolor=j,n.value.push(b));break}}),A===1&&(M===1?n.value.sort(w):M===2&&n.value.sort(S)),A===2&&(M===1?n.value.sort(C):M===2&&n.value.sort(y)),A===3&&n.value.sort(P),A===4&&n.value.sort(F);for(let b=0;b<n.value.length;b++)n.value[b].txt=String(b+1)}function w(s,a){return s.d!==a.d?s.d-a.d:s.x!==a.x?s.x-a.x:s.y!==a.y?s.y-a.y:0}function C(s,a){return s.d!==a.d?s.d-a.d:s.y!==a.y?s.y-a.y:s.x!==a.x?s.x-a.x:0}function S(s,a){return s.q!==a.q?s.q-a.q:s.d!==a.d?s.d-a.d:s.x!==a.x?s.x-a.x:s.y!==a.y?s.y-a.y:0}function y(s,a){return s.q!==a.q?s.q-a.q:s.d!==a.d?s.d-a.d:s.y!==a.y?s.y-a.y:s.x!==a.x?s.x-a.x:0}function P(s,a){return s.x!==a.x?s.x-a.x:s.y!==a.y?s.y-a.y:0}function F(s,a){return s.y!==a.y?s.y-a.y:s.x!==a.x?s.x-a.x:0}function R(){i.value.forEach(s=>{s.q=0,s.d=0,s.color=o[0].color,s.bgcolor=o[0].bgcolor,s.txt=""}),n.value=[]}const V=q({enabled:!1});function G(){R()}function E(){V.enabled=!1}function Y(s,a){e.editor===1&&(V.current=a)}function T(s,a){if(s.button===0)switch(e.editor){case 2:{V.enabled=!0,a.color=e.color,a.bgcolor=e.bgcolor;break}case 3:{R(),v(a.x,a.y,e.selectRange,e.shape,e.sortType,e.color,e.bgcolor);break}}}function c(s,a){s.button===0&&V.enabled&&(a.color=e.color,a.bgcolor=e.bgcolor)}function m(){V.current=void 0}return window.addEventListener("mouseup",E,!1),lo(()=>{window.removeEventListener("mouseup",E,!1)}),d(),{state:e,colors:o,grids:i,selects:n,gridsStyle:r,selectState:V,onSelectColor:p,onResetClick:G,onGridClick:Y,onGridMouseDown:T,onGridMouseEnter:c,onGridEditorDone:m}}}),f=o=>(so("data-v-f9e485b8"),o=o(),ro(),o),Bo={class:"wrapper"},Po={class:"toolbar"},Ro={class:"setting"},Eo={class:"label-control"},$o=f(()=>l("span",null,"\u7F16\u8F91\u6A21\u5F0F\xA0",-1)),Mo=f(()=>l("option",{value:1},"\u7F16\u8F91",-1)),Fo=f(()=>l("option",{value:2},"\u4E0A\u8272",-1)),Go=f(()=>l("option",{value:3},"\u9009\u62E9",-1)),Ao=[Mo,Fo,Go],Uo={class:"label-control"},Do=f(()=>l("span",null,"\u8303\u56F4\xA0",-1)),Io={class:"label-control"},qo=f(()=>l("span",null,"\u5F62\u72B6\xA0",-1)),Lo=f(()=>l("option",{value:1},"\u83F1\u5F62",-1)),Yo=f(()=>l("option",{value:2},"\u5708\u6570",-1)),To=[Lo,Yo],Xo={class:"label-control"},xo=f(()=>l("span",null,"\u6392\u5E8F\xA0",-1)),zo=f(()=>l("option",{value:1},"\u8DDD\u79BBX",-1)),Ho=f(()=>l("option",{value:2},"\u8DDD\u79BBY",-1)),Oo=f(()=>l("option",{value:3},"X\u4F18\u5148",-1)),No=f(()=>l("option",{value:4},"Y\u4F18\u5148",-1)),jo=[zo,Ho,Oo,No],Qo={class:"color-container"},Wo={class:"label-control"},Jo=f(()=>l("span",null,"\u9884\u89C8\xA0",-1)),Ko={class:"label-control"},Zo=f(()=>l("span",null,"\u6587\u5B57\xA0",-1)),oe={class:"label-control"},ee=f(()=>l("span",null,"\u80CC\u666F\xA0",-1)),te=f(()=>l("label",{class:"label-control"},[l("span",null,"\u9884\u8BBE\xA0")],-1)),le=["onClick"],ne={class:"props-container"},se={key:0,class:"props-content"},re={class:"label-control"},ae=f(()=>l("span",null,"\u6587\u5B57\xA0",-1)),ue={class:"label-control"},ce=f(()=>l("span",null,"\u80CC\u666F\xA0",-1)),ie={class:"label-control"},de=f(()=>l("span",null,"\u5927\u5C0F\xA0",-1)),pe={class:"label-control"},ve=f(()=>l("span",null,"\u5185\u5BB9\xA0",-1)),fe={class:"content"},be=["onClick","onMousedown","onMouseenter"];function me(o,e,p,i,n,u){const t=fo("ColorPicker");return k(),B("div",Bo,[l("div",Po,[l("div",Ro,[l("label",Eo,[$o,_(l("select",{"onUpdate:modelValue":e[0]||(e[0]=r=>o.state.editor=r)},Ao,512),[[H,o.state.editor]])]),l("label",Uo,[Do,_(l("input",{type:"number",min:"0","onUpdate:modelValue":e[1]||(e[1]=r=>o.state.selectRange=r),style:{width:"5em"}},null,512),[[g,o.state.selectRange]])]),l("label",Io,[qo,_(l("select",{"onUpdate:modelValue":e[2]||(e[2]=r=>o.state.shape=r)},To,512),[[H,o.state.shape]])]),l("label",Xo,[xo,_(l("select",{"onUpdate:modelValue":e[3]||(e[3]=r=>o.state.sortType=r)},jo,512),[[H,o.state.sortType]])]),l("button",{class:"btn",onClick:e[4]||(e[4]=(...r)=>o.onResetClick&&o.onResetClick(...r))},"\u6E05\u7A7A")]),l("div",Qo,[l("label",Wo,[Jo,l("div",{class:"color-unit",style:h([`--color:${o.state.color};--bgcolor:${o.state.bgcolor}`])}," E ",4)]),l("label",Ko,[Zo,U(t,{modelValue:o.state.color,"onUpdate:modelValue":e[5]||(e[5]=r=>o.state.color=r)},null,8,["modelValue"])]),l("label",oe,[ee,U(t,{modelValue:o.state.bgcolor,"onUpdate:modelValue":e[6]||(e[6]=r=>o.state.bgcolor=r)},null,8,["modelValue"])]),te,(k(!0),B(O,null,J(o.colors,(r,d)=>(k(),B("div",{key:d,class:K(["color-unit",{selected:o.state.bgcolor===r.bgcolor}]),style:h([`--color:${r.color};--bgcolor:${r.bgcolor}`]),onClick:v=>o.onSelectColor(r)}," E ",14,le))),128))]),l("div",ne,[o.selectState.current?(k(),B("div",se,[l("label",re,[ae,U(t,{modelValue:o.selectState.current.color,"onUpdate:modelValue":e[7]||(e[7]=r=>o.selectState.current.color=r)},null,8,["modelValue"])]),l("label",ue,[ce,U(t,{modelValue:o.selectState.current.bgcolor,"onUpdate:modelValue":e[8]||(e[8]=r=>o.selectState.current.bgcolor=r)},null,8,["modelValue"])]),l("label",ie,[de,_(l("input",{type:"number",style:{width:"4em"},min:"12",step:"1","onUpdate:modelValue":e[9]||(e[9]=r=>o.selectState.current.size=r)},null,512),[[g,o.selectState.current.size]])]),l("label",pe,[ve,_(l("input",{type:"text","onUpdate:modelValue":e[10]||(e[10]=r=>o.selectState.current.txt=r)},null,512),[[g,o.selectState.current.txt]])]),l("button",{class:"btn",onClick:e[11]||(e[11]=(...r)=>o.onGridEditorDone&&o.onGridEditorDone(...r))},"\u5B8C\u6210")])):vo("",!0)])]),l("div",fe,[l("div",{class:"grids",style:h(o.gridsStyle)},[(k(!0),B(O,null,J(o.grids,(r,d)=>(k(),B("div",{key:d,class:K({selected:r===o.selectState.current}),style:h({fontSize:`${r.size}px`,color:r.color,backgroundColor:r.bgcolor}),onClick:v=>o.onGridClick(v,r),onMousedown:v=>o.onGridMouseDown(v,r),onMouseenter:v=>o.onGridMouseEnter(v,r)},bo(r.txt),47,be))),128))],4)])])}var ye=no(ko,[["render",me],["__scopeId","data-v-f9e485b8"]]);export{ye as default};
